var zi=Object.defineProperty;var Gi=(B,D,F)=>D in B?zi(B,D,{enumerable:!0,configurable:!0,writable:!0,value:F}):B[D]=F;var He=(B,D,F)=>(Gi(B,typeof D!="symbol"?D+"":D,F),F),Tr=(B,D,F)=>{if(!D.has(B))throw TypeError("Cannot "+F)};var lt=(B,D,F)=>(Tr(B,D,"read from private field"),F?F.call(B):D.get(B)),It=(B,D,F)=>{if(D.has(B))throw TypeError("Cannot add the same private member more than once");D instanceof WeakSet?D.add(B):D.set(B,F)},Kt=(B,D,F,O)=>(Tr(B,D,"write to private field"),O?O.call(B,F):D.set(B,F),F);var nr=(B,D,F,O)=>({set _(U){Kt(B,D,U,F)},get _(){return lt(B,D,O)}}),$t=(B,D,F)=>(Tr(B,D,"access private method"),F);(function(){const D=document.createElement("link").relList;if(D&&D.supports&&D.supports("modulepreload"))return;for(const U of document.querySelectorAll('link[rel="modulepreload"]'))O(U);new MutationObserver(U=>{for(const G of U)if(G.type==="childList")for(const X of G.addedNodes)X.tagName==="LINK"&&X.rel==="modulepreload"&&O(X)}).observe(document,{childList:!0,subtree:!0});function F(U){const G={};return U.integrity&&(G.integrity=U.integrity),U.referrerPolicy&&(G.referrerPolicy=U.referrerPolicy),U.crossOrigin==="use-credentials"?G.credentials="include":U.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function O(U){if(U.ep)return;U.ep=!0;const G=F(U);fetch(U.href,G)}})();const index="";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$2=globalThis,e$5=t$2.ShadowRoot&&(t$2.ShadyCSS===void 0||t$2.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$2=Symbol(),o$3=new WeakMap;let n$3=class{constructor(D,F,O){if(this._$cssResult$=!0,O!==s$2)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=D,this.t=F}get styleSheet(){let D=this.o;const F=this.t;if(e$5&&D===void 0){const O=F!==void 0&&F.length===1;O&&(D=o$3.get(F)),D===void 0&&((this.o=D=new CSSStyleSheet).replaceSync(this.cssText),O&&o$3.set(F,D))}return D}toString(){return this.cssText}};const r$5=B=>new n$3(typeof B=="string"?B:B+"",void 0,s$2),i$3=(B,...D)=>{const F=B.length===1?B[0]:D.reduce((O,U,G)=>O+(X=>{if(X._$cssResult$===!0)return X.cssText;if(typeof X=="number")return X;throw Error("Value passed to 'css' function must be a 'css' function result: "+X+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(U)+B[G+1],B[0]);return new n$3(F,B,s$2)},S$1=(B,D)=>{if(e$5)B.adoptedStyleSheets=D.map(F=>F instanceof CSSStyleSheet?F:F.styleSheet);else for(const F of D){const O=document.createElement("style"),U=t$2.litNonce;U!==void 0&&O.setAttribute("nonce",U),O.textContent=F.cssText,B.appendChild(O)}},c$3=e$5?B=>B:B=>B instanceof CSSStyleSheet?(D=>{let F="";for(const O of D.cssRules)F+=O.cssText;return r$5(F)})(B):B;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:i$2,defineProperty:e$4,getOwnPropertyDescriptor:r$4,getOwnPropertyNames:h$1,getOwnPropertySymbols:o$2,getPrototypeOf:n$2}=Object,a$1=globalThis,c$2=a$1.trustedTypes,l$1=c$2?c$2.emptyScript:"",p$1=a$1.reactiveElementPolyfillSupport,d$1=(B,D)=>B,u$1={toAttribute(B,D){switch(D){case Boolean:B=B?l$1:null;break;case Object:case Array:B=B==null?B:JSON.stringify(B)}return B},fromAttribute(B,D){let F=B;switch(D){case Boolean:F=B!==null;break;case Number:F=B===null?null:Number(B);break;case Object:case Array:try{F=JSON.parse(B)}catch{F=null}}return F}},f$1=(B,D)=>!i$2(B,D),y$1={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$1};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),a$1.litPropertyMetadata??(a$1.litPropertyMetadata=new WeakMap);class b extends HTMLElement{static addInitializer(D){this._$Ei(),(this.l??(this.l=[])).push(D)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(D,F=y$1){if(F.state&&(F.attribute=!1),this._$Ei(),this.elementProperties.set(D,F),!F.noAccessor){const O=Symbol(),U=this.getPropertyDescriptor(D,O,F);U!==void 0&&e$4(this.prototype,D,U)}}static getPropertyDescriptor(D,F,O){const{get:U,set:G}=r$4(this.prototype,D)??{get(){return this[F]},set(X){this[F]=X}};return{get(){return U==null?void 0:U.call(this)},set(X){const tt=U==null?void 0:U.call(this);G.call(this,X),this.requestUpdate(D,tt,O)},configurable:!0,enumerable:!0}}static getPropertyOptions(D){return this.elementProperties.get(D)??y$1}static _$Ei(){if(this.hasOwnProperty(d$1("elementProperties")))return;const D=n$2(this);D.finalize(),D.l!==void 0&&(this.l=[...D.l]),this.elementProperties=new Map(D.elementProperties)}static finalize(){if(this.hasOwnProperty(d$1("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d$1("properties"))){const F=this.properties,O=[...h$1(F),...o$2(F)];for(const U of O)this.createProperty(U,F[U])}const D=this[Symbol.metadata];if(D!==null){const F=litPropertyMetadata.get(D);if(F!==void 0)for(const[O,U]of F)this.elementProperties.set(O,U)}this._$Eh=new Map;for(const[F,O]of this.elementProperties){const U=this._$Eu(F,O);U!==void 0&&this._$Eh.set(U,F)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(D){const F=[];if(Array.isArray(D)){const O=new Set(D.flat(1/0).reverse());for(const U of O)F.unshift(c$3(U))}else D!==void 0&&F.push(c$3(D));return F}static _$Eu(D,F){const O=F.attribute;return O===!1?void 0:typeof O=="string"?O:typeof D=="string"?D.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var D;this._$ES=new Promise(F=>this.enableUpdating=F),this._$AL=new Map,this._$E_(),this.requestUpdate(),(D=this.constructor.l)==null||D.forEach(F=>F(this))}addController(D){var F;(this._$EO??(this._$EO=new Set)).add(D),this.renderRoot!==void 0&&this.isConnected&&((F=D.hostConnected)==null||F.call(D))}removeController(D){var F;(F=this._$EO)==null||F.delete(D)}_$E_(){const D=new Map,F=this.constructor.elementProperties;for(const O of F.keys())this.hasOwnProperty(O)&&(D.set(O,this[O]),delete this[O]);D.size>0&&(this._$Ep=D)}createRenderRoot(){const D=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return S$1(D,this.constructor.elementStyles),D}connectedCallback(){var D;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(D=this._$EO)==null||D.forEach(F=>{var O;return(O=F.hostConnected)==null?void 0:O.call(F)})}enableUpdating(D){}disconnectedCallback(){var D;(D=this._$EO)==null||D.forEach(F=>{var O;return(O=F.hostDisconnected)==null?void 0:O.call(F)})}attributeChangedCallback(D,F,O){this._$AK(D,O)}_$EC(D,F){var G;const O=this.constructor.elementProperties.get(D),U=this.constructor._$Eu(D,O);if(U!==void 0&&O.reflect===!0){const X=(((G=O.converter)==null?void 0:G.toAttribute)!==void 0?O.converter:u$1).toAttribute(F,O.type);this._$Em=D,X==null?this.removeAttribute(U):this.setAttribute(U,X),this._$Em=null}}_$AK(D,F){var G;const O=this.constructor,U=O._$Eh.get(D);if(U!==void 0&&this._$Em!==U){const X=O.getPropertyOptions(U),tt=typeof X.converter=="function"?{fromAttribute:X.converter}:((G=X.converter)==null?void 0:G.fromAttribute)!==void 0?X.converter:u$1;this._$Em=U,this[U]=tt.fromAttribute(F,X.type),this._$Em=null}}requestUpdate(D,F,O){if(D!==void 0){if(O??(O=this.constructor.getPropertyOptions(D)),!(O.hasChanged??f$1)(this[D],F))return;this.P(D,F,O)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(D,F,O){this._$AL.has(D)||this._$AL.set(D,F),O.reflect===!0&&this._$Em!==D&&(this._$Ej??(this._$Ej=new Set)).add(D)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(F){Promise.reject(F)}const D=this.scheduleUpdate();return D!=null&&await D,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var O;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[G,X]of this._$Ep)this[G]=X;this._$Ep=void 0}const U=this.constructor.elementProperties;if(U.size>0)for(const[G,X]of U)X.wrapped!==!0||this._$AL.has(G)||this[G]===void 0||this.P(G,this[G],X)}let D=!1;const F=this._$AL;try{D=this.shouldUpdate(F),D?(this.willUpdate(F),(O=this._$EO)==null||O.forEach(U=>{var G;return(G=U.hostUpdate)==null?void 0:G.call(U)}),this.update(F)):this._$EU()}catch(U){throw D=!1,this._$EU(),U}D&&this._$AE(F)}willUpdate(D){}_$AE(D){var F;(F=this._$EO)==null||F.forEach(O=>{var U;return(U=O.hostUpdated)==null?void 0:U.call(O)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(D)),this.updated(D)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(D){return!0}update(D){this._$Ej&&(this._$Ej=this._$Ej.forEach(F=>this._$EC(F,this[F]))),this._$EU()}updated(D){}firstUpdated(D){}}b.elementStyles=[],b.shadowRootOptions={mode:"open"},b[d$1("elementProperties")]=new Map,b[d$1("finalized")]=new Map,p$1==null||p$1({ReactiveElement:b}),(a$1.reactiveElementVersions??(a$1.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$1=globalThis,i$1=t$1.trustedTypes,s$1=i$1?i$1.createPolicy("lit-html",{createHTML:B=>B}):void 0,e$3="$lit$",h=`lit$${(Math.random()+"").slice(9)}$`,o$1="?"+h,n$1=`<${o$1}>`,r$3=document,l=()=>r$3.createComment(""),c$1=B=>B===null||typeof B!="object"&&typeof B!="function",a=Array.isArray,u=B=>a(B)||typeof(B==null?void 0:B[Symbol.iterator])=="function",d=`[ 	
\f\r]`,f=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\s"'>=/]+)(${d}*=${d}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),p=/'/g,g=/"/g,$=/^(?:script|style|textarea|title)$/i,y=B=>(D,...F)=>({_$litType$:B,strings:D,values:F}),x=y(1),w=Symbol.for("lit-noChange"),T=Symbol.for("lit-nothing"),A=new WeakMap,E=r$3.createTreeWalker(r$3,129);function C(B,D){if(!Array.isArray(B)||!B.hasOwnProperty("raw"))throw Error("invalid template strings array");return s$1!==void 0?s$1.createHTML(D):D}const P=(B,D)=>{const F=B.length-1,O=[];let U,G=D===2?"<svg>":"",X=f;for(let tt=0;tt<F;tt++){const Y=B[tt];let W,z,K=-1,J=0;for(;J<Y.length&&(X.lastIndex=J,z=X.exec(Y),z!==null);)J=X.lastIndex,X===f?z[1]==="!--"?X=v:z[1]!==void 0?X=_:z[2]!==void 0?($.test(z[2])&&(U=RegExp("</"+z[2],"g")),X=m):z[3]!==void 0&&(X=m):X===m?z[0]===">"?(X=U??f,K=-1):z[1]===void 0?K=-2:(K=X.lastIndex-z[2].length,W=z[1],X=z[3]===void 0?m:z[3]==='"'?g:p):X===g||X===p?X=m:X===v||X===_?X=f:(X=m,U=void 0);const Q=X===m&&B[tt+1].startsWith("/>")?" ":"";G+=X===f?Y+n$1:K>=0?(O.push(W),Y.slice(0,K)+e$3+Y.slice(K)+h+Q):Y+h+(K===-2?tt:Q)}return[C(B,G+(B[F]||"<?>")+(D===2?"</svg>":"")),O]};class V{constructor({strings:D,_$litType$:F},O){let U;this.parts=[];let G=0,X=0;const tt=D.length-1,Y=this.parts,[W,z]=P(D,F);if(this.el=V.createElement(W,O),E.currentNode=this.el.content,F===2){const K=this.el.content.firstChild;K.replaceWith(...K.childNodes)}for(;(U=E.nextNode())!==null&&Y.length<tt;){if(U.nodeType===1){if(U.hasAttributes())for(const K of U.getAttributeNames())if(K.endsWith(e$3)){const J=z[X++],Q=U.getAttribute(K).split(h),et=/([.?@])?(.*)/.exec(J);Y.push({type:1,index:G,name:et[2],strings:Q,ctor:et[1]==="."?k:et[1]==="?"?H:et[1]==="@"?I:R}),U.removeAttribute(K)}else K.startsWith(h)&&(Y.push({type:6,index:G}),U.removeAttribute(K));if($.test(U.tagName)){const K=U.textContent.split(h),J=K.length-1;if(J>0){U.textContent=i$1?i$1.emptyScript:"";for(let Q=0;Q<J;Q++)U.append(K[Q],l()),E.nextNode(),Y.push({type:2,index:++G});U.append(K[J],l())}}}else if(U.nodeType===8)if(U.data===o$1)Y.push({type:2,index:G});else{let K=-1;for(;(K=U.data.indexOf(h,K+1))!==-1;)Y.push({type:7,index:G}),K+=h.length-1}G++}}static createElement(D,F){const O=r$3.createElement("template");return O.innerHTML=D,O}}function N(B,D,F=B,O){var X,tt;if(D===w)return D;let U=O!==void 0?(X=F._$Co)==null?void 0:X[O]:F._$Cl;const G=c$1(D)?void 0:D._$litDirective$;return(U==null?void 0:U.constructor)!==G&&((tt=U==null?void 0:U._$AO)==null||tt.call(U,!1),G===void 0?U=void 0:(U=new G(B),U._$AT(B,F,O)),O!==void 0?(F._$Co??(F._$Co=[]))[O]=U:F._$Cl=U),U!==void 0&&(D=N(B,U._$AS(B,D.values),U,O)),D}class S{constructor(D,F){this._$AV=[],this._$AN=void 0,this._$AD=D,this._$AM=F}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(D){const{el:{content:F},parts:O}=this._$AD,U=((D==null?void 0:D.creationScope)??r$3).importNode(F,!0);E.currentNode=U;let G=E.nextNode(),X=0,tt=0,Y=O[0];for(;Y!==void 0;){if(X===Y.index){let W;Y.type===2?W=new M(G,G.nextSibling,this,D):Y.type===1?W=new Y.ctor(G,Y.name,Y.strings,this,D):Y.type===6&&(W=new L(G,this,D)),this._$AV.push(W),Y=O[++tt]}X!==(Y==null?void 0:Y.index)&&(G=E.nextNode(),X++)}return E.currentNode=r$3,U}p(D){let F=0;for(const O of this._$AV)O!==void 0&&(O.strings!==void 0?(O._$AI(D,O,F),F+=O.strings.length-2):O._$AI(D[F])),F++}}class M{get _$AU(){var D;return((D=this._$AM)==null?void 0:D._$AU)??this._$Cv}constructor(D,F,O,U){this.type=2,this._$AH=T,this._$AN=void 0,this._$AA=D,this._$AB=F,this._$AM=O,this.options=U,this._$Cv=(U==null?void 0:U.isConnected)??!0}get parentNode(){let D=this._$AA.parentNode;const F=this._$AM;return F!==void 0&&(D==null?void 0:D.nodeType)===11&&(D=F.parentNode),D}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(D,F=this){D=N(this,D,F),c$1(D)?D===T||D==null||D===""?(this._$AH!==T&&this._$AR(),this._$AH=T):D!==this._$AH&&D!==w&&this._(D):D._$litType$!==void 0?this.$(D):D.nodeType!==void 0?this.T(D):u(D)?this.k(D):this._(D)}S(D){return this._$AA.parentNode.insertBefore(D,this._$AB)}T(D){this._$AH!==D&&(this._$AR(),this._$AH=this.S(D))}_(D){this._$AH!==T&&c$1(this._$AH)?this._$AA.nextSibling.data=D:this.T(r$3.createTextNode(D)),this._$AH=D}$(D){var G;const{values:F,_$litType$:O}=D,U=typeof O=="number"?this._$AC(D):(O.el===void 0&&(O.el=V.createElement(C(O.h,O.h[0]),this.options)),O);if(((G=this._$AH)==null?void 0:G._$AD)===U)this._$AH.p(F);else{const X=new S(U,this),tt=X.u(this.options);X.p(F),this.T(tt),this._$AH=X}}_$AC(D){let F=A.get(D.strings);return F===void 0&&A.set(D.strings,F=new V(D)),F}k(D){a(this._$AH)||(this._$AH=[],this._$AR());const F=this._$AH;let O,U=0;for(const G of D)U===F.length?F.push(O=new M(this.S(l()),this.S(l()),this,this.options)):O=F[U],O._$AI(G),U++;U<F.length&&(this._$AR(O&&O._$AB.nextSibling,U),F.length=U)}_$AR(D=this._$AA.nextSibling,F){var O;for((O=this._$AP)==null?void 0:O.call(this,!1,!0,F);D&&D!==this._$AB;){const U=D.nextSibling;D.remove(),D=U}}setConnected(D){var F;this._$AM===void 0&&(this._$Cv=D,(F=this._$AP)==null||F.call(this,D))}}class R{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(D,F,O,U,G){this.type=1,this._$AH=T,this._$AN=void 0,this.element=D,this.name=F,this._$AM=U,this.options=G,O.length>2||O[0]!==""||O[1]!==""?(this._$AH=Array(O.length-1).fill(new String),this.strings=O):this._$AH=T}_$AI(D,F=this,O,U){const G=this.strings;let X=!1;if(G===void 0)D=N(this,D,F,0),X=!c$1(D)||D!==this._$AH&&D!==w,X&&(this._$AH=D);else{const tt=D;let Y,W;for(D=G[0],Y=0;Y<G.length-1;Y++)W=N(this,tt[O+Y],F,Y),W===w&&(W=this._$AH[Y]),X||(X=!c$1(W)||W!==this._$AH[Y]),W===T?D=T:D!==T&&(D+=(W??"")+G[Y+1]),this._$AH[Y]=W}X&&!U&&this.j(D)}j(D){D===T?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,D??"")}}class k extends R{constructor(){super(...arguments),this.type=3}j(D){this.element[this.name]=D===T?void 0:D}}class H extends R{constructor(){super(...arguments),this.type=4}j(D){this.element.toggleAttribute(this.name,!!D&&D!==T)}}class I extends R{constructor(D,F,O,U,G){super(D,F,O,U,G),this.type=5}_$AI(D,F=this){if((D=N(this,D,F,0)??T)===w)return;const O=this._$AH,U=D===T&&O!==T||D.capture!==O.capture||D.once!==O.once||D.passive!==O.passive,G=D!==T&&(O===T||U);U&&this.element.removeEventListener(this.name,this,O),G&&this.element.addEventListener(this.name,this,D),this._$AH=D}handleEvent(D){var F;typeof this._$AH=="function"?this._$AH.call(((F=this.options)==null?void 0:F.host)??this.element,D):this._$AH.handleEvent(D)}}class L{constructor(D,F,O){this.element=D,this.type=6,this._$AN=void 0,this._$AM=F,this.options=O}get _$AU(){return this._$AM._$AU}_$AI(D){N(this,D)}}const Z=t$1.litHtmlPolyfillSupport;Z==null||Z(V,M),(t$1.litHtmlVersions??(t$1.litHtmlVersions=[])).push("3.1.2");const j=(B,D,F)=>{const O=(F==null?void 0:F.renderBefore)??D;let U=O._$litPart$;if(U===void 0){const G=(F==null?void 0:F.renderBefore)??null;O._$litPart$=U=new M(D.insertBefore(l(),G),G,void 0,F??{})}return U._$AI(B),U};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class s extends b{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var F;const D=super.createRenderRoot();return(F=this.renderOptions).renderBefore??(F.renderBefore=D.firstChild),D}update(D){const F=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(D),this._$Do=j(F,this.renderRoot,this.renderOptions)}connectedCallback(){var D;super.connectedCallback(),(D=this._$Do)==null||D.setConnected(!0)}disconnectedCallback(){var D;super.disconnectedCallback(),(D=this._$Do)==null||D.setConnected(!1)}render(){return w}}var ci;s._$litElement$=!0,s.finalized=!0,(ci=globalThis.litElementHydrateSupport)==null||ci.call(globalThis,{LitElement:s});const r$2=globalThis.litElementPolyfillSupport;r$2==null||r$2({LitElement:s});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t=B=>(D,F)=>{F!==void 0?F.addInitializer(()=>{customElements.define(B,D)}):customElements.define(B,D)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$1},r$1=(B=o,D,F)=>{const{kind:O,metadata:U}=F;let G=globalThis.litPropertyMetadata.get(U);if(G===void 0&&globalThis.litPropertyMetadata.set(U,G=new Map),G.set(F.name,B),O==="accessor"){const{name:X}=F;return{set(tt){const Y=D.get.call(this);D.set.call(this,tt),this.requestUpdate(X,Y,B)},init(tt){return tt!==void 0&&this.P(X,void 0,B),tt}}}if(O==="setter"){const{name:X}=F;return function(tt){const Y=this[X];D.call(this,tt),this.requestUpdate(X,Y,B)}}throw Error("Unsupported decorator location: "+O)};function n(B){return(D,F)=>typeof F=="object"?r$1(B,D,F):((O,U,G)=>{const X=U.hasOwnProperty(G);return U.constructor.createProperty(G,X?{...O,wrapped:!0}:O),X?Object.getOwnPropertyDescriptor(U,G):void 0})(B,D,F)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const e$2=(B,D,F)=>(F.configurable=!0,F.enumerable=!0,Reflect.decorate&&typeof D!="object"&&Object.defineProperty(B,D,F),F);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function e$1(B,D){return(F,O,U)=>{const G=X=>{var tt;return((tt=X.renderRoot)==null?void 0:tt.querySelector(B))??null};if(D){const{get:X,set:tt}=typeof O=="object"?F:U??(()=>{const Y=Symbol();return{get(){return this[Y]},set(W){this[Y]=W}}})();return e$2(F,O,{get(){let Y=X.call(this);return Y===void 0&&(Y=G(this),(Y!==null||this.hasUpdated)&&tt.call(this,Y)),Y}})}return e$2(F,O,{get(){return G(this)}})}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let e;function r(B){return(D,F)=>e$2(D,F,{get(){return(this.renderRoot??e??(e=document.createDocumentFragment())).querySelectorAll(B)}})}var __defProp$d=Object.defineProperty,__getOwnPropDesc$d=Object.getOwnPropertyDescriptor,__decorateClass$d=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$d(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$d(D,F,U),U};let CollapsableContainer=class extends s{constructor(){super(...arguments),this.title="",this.description="",this.hidden=!1,this.collapsable=!1,this.open=!1}render(){return x`
      <div class="header">
        <div class="info" @click=${()=>{this.collapsable&&(this.open=!this.open)}}>
          <h3 class="title">${this.title}</h3>
          <p class="description">${this.description}</p>
        </div>
        <div class="tools">
          <slot name="header"></slot>
        </div>
      </div>

      <div class="content" @focusin=${()=>this.open=!0}>
        <slot></slot>
      </div>
    `}};CollapsableContainer.styles=i$3`
    :host {
      display: grid;
      grid-template-rows: auto 1fr;
      grid-template-columns: 1fr;
      box-sizing: border-box;
      border-top: 1px solid var(--theme-color-background-light);
      transition: grid-template-rows .2s;
    }
    :host([collapsable]) {
      grid-template-rows: 1fr 0fr;
    }
    :host([open]) {
      grid-template-rows: auto 1fr;
    }
    :host([hidden]) {
      grid-template-rows: 0fr 0fr;
      transition: display 0s .5s, grid-template-rows .5s;
      display: none;
    }

    .content {
      display: flex;
      flex-direction: column;
      gap: .5em;
      overflow: hidden;
      box-sizing: border-box;
      transition: padding 0.5s;
    }
    :host([collapsable]) .content {
      opacity: 0;
      transition: opacity 0.5s;
      padding: 0 1em;
    }
    :host([open]) .content {
      opacity: 1;
      padding: 0 1em 1em;
    }
    /* when open and not collapsable */
    :host(:not([collapsable])) .content {
      padding: 0;
    }

    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1em;
      overflow: hidden;
      min-height: 0;
      transition: padding .5s;
    }
    :host([hidden]) .header {
      padding: 0 1em;
    }
    .info {
      font-size: .9em;
      flex: 1;
      user-select: none;
    }
    :host([collapsable]) .info {
      cursor: pointer;
    }
    .title, .description {
      display: block;
      margin: 0;
    }
    .tools {
      display: flex;
      align-items: center;
      gap: .5em;
    }

  `;__decorateClass$d([n({type:String})],CollapsableContainer.prototype,"title",2);__decorateClass$d([n({type:String})],CollapsableContainer.prototype,"description",2);__decorateClass$d([n({type:Boolean,reflect:!0})],CollapsableContainer.prototype,"hidden",2);__decorateClass$d([n({type:Boolean,reflect:!0})],CollapsableContainer.prototype,"collapsable",2);__decorateClass$d([n({type:Boolean,reflect:!0})],CollapsableContainer.prototype,"open",2);CollapsableContainer=__decorateClass$d([t("app-container")],CollapsableContainer);const buttonStyle=i$3`
  button {
    background: var(--theme-color-background-light);
    border: none;
    outline: none;
    border-radius: 0.5em;
    padding: 0.5em 1em;
    color: var(--theme-color-text);
    cursor: pointer;
    font-weight: bold;
    text-transform: uppercase;
    user-select: none;
    transition: box-shadow .2s ease;
  }
  button:hover,
  button:focus {
    box-shadow: 0 0 0 .1em var(--theme-color-text-light) inset;
  }
  button.borderless {
    background: none;
    padding: 0.5em;
    border-radius: 2em;
  }
  button.primary {
    background: var(--theme-color-primary);
  }
  button[disabled] {
    cursor: not-allowed;
    filter: grayscale();
  }
`;var __defProp$c=Object.defineProperty,__getOwnPropDesc$c=Object.getOwnPropertyDescriptor,__decorateClass$c=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$c(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$c(D,F,U),U};const ui={get app(){return document.body.firstElementChild}};function popup(B,D){const F=document.createElement("app-popup");return F.content=B,F.inputs=D,document.body.appendChild(F),F.promise}let AppPopup=class extends s{constructor(){super(...arguments),this.promise=new Promise((B,D)=>{this.resolve=B,this.reject=D})}connectedCallback(){super.connectedCallback(),ui.app.setAttribute("tabindex","-1"),this.promise.then(()=>this.remove()).catch(()=>this.remove())}disconnectedCallback(){super.disconnectedCallback(),ui.app.removeAttribute("tabindex")}updated(){var B;this.inputs?(B=this.inputFields[0])==null||B.focus():this.okBtn.focus()}render(){return x`
      <div class="popup">
        <div id="popup-content">
          ${this.content}
        </div>
        <div id="popup-inputs" ?hidden=${!this.inputs} @keydown=${B=>{B.key==="Enter"&&this.resolve(this.getValues()),B.key==="Escape"&&this.reject()}}>
          ${this.inputs}
        </div>
        <div id="popup-actions">
          <button id="ok" class="primary" @click=${()=>this.resolve(this.getValues())}>Ok</button>
          <button @click=${()=>this.reject()} ?hidden=${!this.inputs}>Cancel</button>
        </div>
      </div>
    `}getValues(){const B=[...this.inputFields];if(B.length===0)return;const D=new Map;return B.forEach(F=>{const{id:O,value:U}=F;O&&D.set(O,U)}),D}};AppPopup.styles=[buttonStyle,i$3`
      :host {
        display: grid;
        place-items: center;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        width: 100dvw;
        height: 100vh;
        height: 100dvh;
        background-color: var(--theme-color-background)bc;
        backdrop-filter: blur(5px);
        z-index: 100;
      }
      .popup {
        width: 40vmin;
        min-width: 280px;
        box-sizing: border-box;
        overflow: auto;
        display: flex;
        flex-direction: column;
        gap: 1em;
        background-color: var(--theme-color-background);
        padding: 1.5em;
        border: 1px solid var(--theme-color-background-light);
        border-radius: 1em;
        box-shadow: 0 0.6em 1em var(--theme-color-shadow);
        z-index: 101;
      }
      h1, h2, h3, h4, h5, h6, p, span {
        margin: 0;
        padding: 0;
      }
      .popup > div {
        display: flex;
        flex-wrap: wrap;
        /* align-items: center; */
        justify-content: stretch;
      }
      #popup-content {
        flex: 1;
        flex-direction: column;
      }
      #popup-inputs > input {
        display: block;
        min-width: 0;
        width: 100%;
        padding: 0.5em;
      }
      #popup-actions {
        flex-direction: row-reverse;
        gap: .5em;
      }
    `];__decorateClass$c([r("#popup-inputs > *")],AppPopup.prototype,"inputFields",2);__decorateClass$c([e$1("#ok")],AppPopup.prototype,"okBtn",2);AppPopup=__decorateClass$c([t("app-popup")],AppPopup);function lerp(B,D,F){return B+(D-B)*F}function rlerp(B,D,F){return(F-B)/(D-B)}function distance(B,D){return Math.abs(B-D)}function clamp(B,D,F){return Math.min(Math.max(B,D),F)}function linesIntersection(B,D,F,O,U,G,X,tt){const Y=(X-U)*(D-G)-(tt-G)*(B-U),W=(G-D)*(B-F)-(U-B)*(D-O),z=(tt-G)*(F-B)-(X-U)*(O-D);if(z===0)return!1;const K=Y/z,J=W/z;return console.log(K),K<0||K>1||J<0||J>1?!1:{x:lerp(B,F,K),y:lerp(D,O,K),t:K}}var __defProp$b=Object.defineProperty,__getOwnPropDesc$b=Object.getOwnPropertyDescriptor,__decorateClass$b=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$b(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$b(D,F,U),U};let InputSlider=class extends s{constructor(){super(...arguments),this.value=0,this.min=0,this.max=100,this.step=1}render(){return x`
      <div 
        class="container"
        tabindex="0"
        @mousedown=${this._handleMouse}
        @touchstart=${this._handleTouch}
        @keydown=${this._handleKey}
      >
        <div class="track"></div>
        <div class="thumb" style="left: ${lerp(0,100,rlerp(this.min,this.max,this.value))}%"></div>
      </div>
    `}_handleMouse(B){const D=O=>{O.preventDefault();const U=this.getBoundingClientRect(),G=(O.clientX-U.left)/U.width,X=lerp(this.min,this.max,G);this.value=clamp(Math.round(X/this.step)*this.step,this.min,this.max),this._fireChangeEvent()},F=()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",F)};D(B),document.addEventListener("mousemove",D),document.addEventListener("mouseup",F)}_handleTouch(B){const D=O=>{const U=this.getBoundingClientRect(),G=(O.touches[0].clientX-U.left)/U.width,X=lerp(this.min,this.max,G);this.value=clamp(Math.round(X/this.step)*this.step,this.min,this.max),this._fireChangeEvent()},F=()=>{document.removeEventListener("touchmove",D),document.removeEventListener("touchend",F),document.removeEventListener("touchcancel",F)};D(B),document.addEventListener("touchmove",D),document.addEventListener("touchend",F),document.addEventListener("touchcancel",F)}_handleKey(B){switch(B.key){case"ArrowLeft":case"ArrowDown":this.value=Math.max(this.min,this.value-this.step),this._fireChangeEvent();break;case"ArrowRight":case"ArrowUp":this.value=Math.min(this.max,this.value+this.step),this._fireChangeEvent();break;case"Home":this.value=this.min,this._fireChangeEvent();break;case"End":this.value=this.max,this._fireChangeEvent();break}}_fireChangeEvent(){this.dispatchEvent(new CustomEvent("change",{detail:this.value}))}};InputSlider.styles=i$3`
    :host {
      display: block;
      width: 100%;
    }
    .container {
      position: relative;
      width: 100%;
      height: 1em;
    }
    .track {
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      height: .1em;
      background: var(--theme-color-background-light);
      transform: translateY(-50%);
      border-radius: .1em;
      pointer-events: none;
      touch-action: none;
    }
    .thumb {
      position: absolute;
      top: 50%;
      left: 0;
      width: .8em;
      height: .8em;
      background: var(--theme-color-primary);
      transform: translate(-50%, -50%);
      border-radius: .5em;
      pointer-events: none;
      touch-action: none;
    }
    .container:focus .thumb {
      width: 1em;
      height: 1em;
    }
  `;__decorateClass$b([n({type:Number})],InputSlider.prototype,"value",2);__decorateClass$b([n({type:Number})],InputSlider.prototype,"min",2);__decorateClass$b([n({type:Number})],InputSlider.prototype,"max",2);__decorateClass$b([n({type:Number})],InputSlider.prototype,"step",2);InputSlider=__decorateClass$b([t("input-slider")],InputSlider);var __defProp$a=Object.defineProperty,__getOwnPropDesc$a=Object.getOwnPropertyDescriptor,__decorateClass$a=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$a(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$a(D,F,U),U};let InputOptions=class extends s{constructor(){super(...arguments),this.options=[]}render(){return x`
      <div class="container" tabindex="0">
        ${this.options.map(B=>x`
          <div 
            class="option ${B.selected?"selected":""}"
            @click=${()=>{this.select(B)}}
          >
            ${B.label}
          </div>
        `)}
      </div>
    `}get value(){var B;return(B=this.options.find(D=>D.selected))==null?void 0:B.value}select(B){this.options.forEach(D=>{D.selected=!1}),B&&(B.selected=!0),this.requestUpdate(),this._fireChangeEvent()}selectIndex(B){this.select(this.options[B])}_fireChangeEvent(){this.dispatchEvent(new CustomEvent("change",{detail:{value:this.value}}))}};InputOptions.styles=i$3`
    :host {
      display: block;
      width: 100%;
      box-sizing: border-box;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5em;
    }
    .option {
      display: flex;
      padding: 0.5em 1em;
      box-shadow: 0 0 0 0.1em var(--theme-color-background-light) inset;
      border-radius: 0.5em;
      transition: background-color 0.2s, box-shadow 0.2s;
      cursor: pointer;
      user-select: none;
      line-height: 1;
    }
    .option.selected {
      background-color: var(--theme-color-background-light);
    }

  `;__decorateClass$a([n({type:Array})],InputOptions.prototype,"options",2);InputOptions=__decorateClass$a([t("input-options")],InputOptions);function createNoiseRemover(...B){const D=B.reduce((F,O)=>{for(let U=0;U<O.length;U++)F[U]=Math.max(F[U],O[U]);return F},new Uint8Array(B[0].length));return F=>{for(let O=0;O<F.length;O++)F[O]=Math.max(0,F[O]-D[O])}}function transformFrequencyData(B){const D=B.reduce((O,U)=>O+U,0)/B.length,F=Math.max(...B,50);for(let O=0;O<B.length;O++)B[O]=clamp(rlerp(D,F,B[O])*255,0,255)}class RecordingFollower{constructor(D){this.recording=D,this.position=0,this.searchDistance=1,this.recentSpeed=1}guess(D,{treshold:F=100,minDistance:O=7,maxDistance:U=42,seekStep:G=1.618}={}){if(this.position>=this.recording.data.length-this.searchDistance)return{over:!0};const X=this.recording.getDifferences(D,this.position,this.position+Math.max(Math.round(this.searchDistance),O)).map(J=>Math.max(...J)),tt=Math.min(...X),Y=X.lastIndexOf(tt);tt>F||Y<=0?(this.searchDistance=Math.min(this.searchDistance+G,U),this.recentSpeed=lerp(this.recentSpeed,0,.1)):(this.recentSpeed=lerp(this.recentSpeed,Y,.1),this.searchDistance=1,this.position+=Y);let W,z,K;if(this.recording.markings.length){const J=this.recording.markings.filter(st=>st[2]===void 0||st[2]==="page"),Q=this.recording.markings.filter(st=>st[2]==="measure"),et=[...J].reverse().find(st=>st[0]<=this.position),it=J.find(st=>st[0]>this.position);W=et?et[1]:void 0,z=et?rlerp(et[0],(it==null?void 0:it[0])||this.recording.data.length,this.position):void 0;const rt=Q.reverse().find(st=>st[0]<=this.position);K=rt?rt[1]:void 0}return{position:this.position,page:W,pagePct:z,measure:K,differences:X,speed:this.recentSpeed}}}function compress(B){const D=[];let F=B[0],O=0;for(let U=1;U<B.length;U++){const G=B[U];G.every((X,tt)=>X===F[tt])?O++:(D.push(compressFrame(F)),O>0&&D.push(O),F=G,O=0)}return D.push(compressFrame(F)),O>0&&D.push(O),D}function compressFrame(B){const D=[];let F=B[0],O=1;for(let U=1;U<B.length;U++)B[U]===F?O++:(O>1?D.push([F,O]):D.push(F),F=B[U],O=1);return O>1?D.push([F,O]):D.push(F),D}function decompress(B){const D=[];let F=0;for(;F<B.length;){const O=B[F];typeof O=="number"?D.push(...new Array(O).fill(D[D.length-1])):D.push(decompressFrame(O)),F++}return D}function decompressFrame(B){const D=[];for(const F of B)if(Array.isArray(F)){const[O,U]=F;D.push(...new Array(U).fill(O))}else D.push(F);return new Uint8Array(D)}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(B){if(B.__esModule)return B;var D=B.default;if(typeof D=="function"){var F=function O(){return this instanceof O?Reflect.construct(D,arguments,this.constructor):D.apply(this,arguments)};F.prototype=D.prototype}else F={};return Object.defineProperty(F,"__esModule",{value:!0}),Object.keys(B).forEach(function(O){var U=Object.getOwnPropertyDescriptor(B,O);Object.defineProperty(F,O,U.get?U:{enumerable:!0,get:function(){return B[O]}})}),F}function parseMidi$1(B){var D=new Parser(B),F=D.readChunk();if(F.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+F.id+"'";for(var O=parseHeader(F.data),U=[],G=0;!D.eof()&&G<O.numTracks;G++){var X=D.readChunk();if(X.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+X.id+"'";var tt=parseTrack(X.data);U.push(tt)}return{header:O,tracks:U}}function parseHeader(B){var D=new Parser(B),F=D.readUInt16(),O=D.readUInt16(),U={format:F,numTracks:O},G=D.readUInt16();return G&32768?(U.framesPerSecond=256-(G>>8),U.ticksPerFrame=G&255):U.ticksPerBeat=G,U}function parseTrack(B){for(var D=new Parser(B),F=[];!D.eof();){var O=G();F.push(O)}return F;var U;function G(){var X={};X.deltaTime=D.readVarInt();var tt=D.readUInt8();if((tt&240)===240)if(tt===255){X.meta=!0;var Y=D.readUInt8(),W=D.readVarInt();switch(Y){case 0:if(X.type="sequenceNumber",W!==2)throw"Expected length for sequenceNumber event is 2, got "+W;return X.number=D.readUInt16(),X;case 1:return X.type="text",X.text=D.readString(W),X;case 2:return X.type="copyrightNotice",X.text=D.readString(W),X;case 3:return X.type="trackName",X.text=D.readString(W),X;case 4:return X.type="instrumentName",X.text=D.readString(W),X;case 5:return X.type="lyrics",X.text=D.readString(W),X;case 6:return X.type="marker",X.text=D.readString(W),X;case 7:return X.type="cuePoint",X.text=D.readString(W),X;case 32:if(X.type="channelPrefix",W!=1)throw"Expected length for channelPrefix event is 1, got "+W;return X.channel=D.readUInt8(),X;case 33:if(X.type="portPrefix",W!=1)throw"Expected length for portPrefix event is 1, got "+W;return X.port=D.readUInt8(),X;case 47:if(X.type="endOfTrack",W!=0)throw"Expected length for endOfTrack event is 0, got "+W;return X;case 81:if(X.type="setTempo",W!=3)throw"Expected length for setTempo event is 3, got "+W;return X.microsecondsPerBeat=D.readUInt24(),X;case 84:if(X.type="smpteOffset",W!=5)throw"Expected length for smpteOffset event is 5, got "+W;var z=D.readUInt8(),K={0:24,32:25,64:29,96:30};return X.frameRate=K[z&96],X.hour=z&31,X.min=D.readUInt8(),X.sec=D.readUInt8(),X.frame=D.readUInt8(),X.subFrame=D.readUInt8(),X;case 88:if(X.type="timeSignature",W!=2&&W!=4)throw"Expected length for timeSignature event is 4 or 2, got "+W;return X.numerator=D.readUInt8(),X.denominator=1<<D.readUInt8(),W===4?(X.metronome=D.readUInt8(),X.thirtyseconds=D.readUInt8()):(X.metronome=36,X.thirtyseconds=8),X;case 89:if(X.type="keySignature",W!=2)throw"Expected length for keySignature event is 2, got "+W;return X.key=D.readInt8(),X.scale=D.readUInt8(),X;case 127:return X.type="sequencerSpecific",X.data=D.readBytes(W),X;default:return X.type="unknownMeta",X.data=D.readBytes(W),X.metatypeByte=Y,X}}else if(tt==240){X.type="sysEx";var W=D.readVarInt();return X.data=D.readBytes(W),X}else if(tt==247){X.type="endSysEx";var W=D.readVarInt();return X.data=D.readBytes(W),X}else throw"Unrecognised MIDI event type byte: "+tt;else{var J;if(tt&128)J=D.readUInt8(),U=tt;else{if(U===null)throw"Running status byte encountered before status byte";J=tt,tt=U,X.running=!0}var Q=tt>>4;switch(X.channel=tt&15,Q){case 8:return X.type="noteOff",X.noteNumber=J,X.velocity=D.readUInt8(),X;case 9:var et=D.readUInt8();return X.type=et===0?"noteOff":"noteOn",X.noteNumber=J,X.velocity=et,et===0&&(X.byte9=!0),X;case 10:return X.type="noteAftertouch",X.noteNumber=J,X.amount=D.readUInt8(),X;case 11:return X.type="controller",X.controllerType=J,X.value=D.readUInt8(),X;case 12:return X.type="programChange",X.programNumber=J,X;case 13:return X.type="channelAftertouch",X.amount=J,X;case 14:return X.type="pitchBend",X.value=J+(D.readUInt8()<<7)-8192,X;default:throw"Unrecognised MIDI event type: "+Q}}}}function Parser(B){this.buffer=B,this.bufferLen=this.buffer.length,this.pos=0}Parser.prototype.eof=function(){return this.pos>=this.bufferLen};Parser.prototype.readUInt8=function(){var B=this.buffer[this.pos];return this.pos+=1,B};Parser.prototype.readInt8=function(){var B=this.readUInt8();return B&128?B-256:B};Parser.prototype.readUInt16=function(){var B=this.readUInt8(),D=this.readUInt8();return(B<<8)+D};Parser.prototype.readInt16=function(){var B=this.readUInt16();return B&32768?B-65536:B};Parser.prototype.readUInt24=function(){var B=this.readUInt8(),D=this.readUInt8(),F=this.readUInt8();return(B<<16)+(D<<8)+F};Parser.prototype.readInt24=function(){var B=this.readUInt24();return B&8388608?B-16777216:B};Parser.prototype.readUInt32=function(){var B=this.readUInt8(),D=this.readUInt8(),F=this.readUInt8(),O=this.readUInt8();return(B<<24)+(D<<16)+(F<<8)+O};Parser.prototype.readBytes=function(B){var D=this.buffer.slice(this.pos,this.pos+B);return this.pos+=B,D};Parser.prototype.readString=function(B){var D=this.readBytes(B);return String.fromCharCode.apply(null,D)};Parser.prototype.readVarInt=function(){for(var B=0;!this.eof();){var D=this.readUInt8();if(D&128)B+=D&127,B<<=7;else return B+D}return B};Parser.prototype.readChunk=function(){var B=this.readString(4),D=this.readUInt32(),F=this.readBytes(D);return{id:B,length:D,data:F}};var midiParser=parseMidi$1,parseMidi=midiParser;class Recording{constructor(){this.data=[],this.markings=[],this.source={type:"mic",options:{transformation:1,noiseRecuction:1,resolution:12,crop:.125,smoothing:.5}}}getDifferences(D,F=0,O=this.data.length){return this.data.slice(F,O).map(U=>new Uint8Array(U.map((G,X)=>distance(G,D[X]))))}export(){return{data:compress(this.data),markings:this.markings,source:this.source}}static import({data:D,markings:F,source:O}){const U=new Recording;return U.data=decompress(D),U.markings=F,O&&(U.source=O),U}static fromMIDI(D,{ignoreVelocity:F=!1,importMeasures:O=!1}={}){const U=parseMidi(D);console.log(U);let G=0,X=0,tt=500,Y=4;const W=[],z=[0],K=U.header.ticksPerBeat||480;U.tracks.forEach((rt,st)=>{console.groupCollapsed("Track "+st);const at=[];rt.forEach(ct=>{const dt=ct.deltaTime;G+=dt;const nt=dt/K;if(X+=Math.round(nt*tt),G>=K*Y&&(G=0,console.log("Measure at",X+"ms"),z.push(X)),ct.type==="setTempo"&&(tt=ct.microsecondsPerBeat/1e3,console.log("Beat duration:",tt+"ms")),ct.type==="timeSignature"&&(Y=ct.numerator*(4/ct.denominator),console.log("Beats in measure:",Y)),ct.type==="noteOn"&&at.push({tone:ct.noteNumber,time:X,velocity:ct.velocity}),ct.type==="noteOff"){const ht=at.find(vt=>vt.tone===ct.noteNumber);ht&&(W.push({start:ht.time,end:X,height:ct.noteNumber,velocity:ht.velocity}),at.splice(at.indexOf(ht),1))}}),console.groupEnd()}),console.log(W),console.log(z);const J=50,Q=new Recording,et=Math.max(...W.map(rt=>rt.end)),it=Math.ceil(et/1e3*J);for(let rt=0;rt<it;rt++){const st=new Uint8Array(128),at=rt/J*1e3,ct=(rt+1)/J*1e3;if(W.filter(nt=>nt.start<=ct&&nt.end>at).forEach(nt=>{st[nt.height]=F?255:nt.velocity}),Q.data.push(st),O){const nt=z.find(ht=>ht>=at&&ht<ct);nt!==void 0&&Q.markings.push([rt,z.indexOf(nt)+1,"measure"])}}return Q.source={type:"midi",options:{ignoreVelocity:!0}},Q}removeSilence(D=128){for(let F=0;F<this.data.length;F++)Math.max(...this.data[F])<D&&(this.data.splice(F,1),this.markings.forEach(O=>{O[0]>F&&O[0]--}),F--)}createFollower(){return new RecordingFollower(this)}createProfile(){const D=new Uint8Array(this.data[0].length);for(let F=0;F<D.length;F++){const O=this.data.map(U=>U[F]);D[F]=Math.max(...O)}return D}}function record(B,D={},F){const O=()=>{const X=B.getData();Object.values(D).forEach(tt=>tt==null?void 0:tt(X))};let U,G;if(F)G=setInterval(O,F);else{const X=()=>{O(),U=requestAnimationFrame(X)};U=requestAnimationFrame(X)}return{stop:()=>{G&&clearInterval(G),U&&cancelAnimationFrame(U)}}}async function delay(B){return new Promise(D=>setTimeout(D,B))}async function mic({resolution:B=12,crop:D=.125,smoothing:F=.5}={}){const O=await navigator.mediaDevices.getUserMedia({audio:{noiseSuppression:!1,echoCancellation:!1,autoGainControl:!1}}),U=new AudioContext,G=U.createMediaStreamSource(O),X=new GainNode(U,{gain:1});G.connect(X);const tt=U.createAnalyser();tt.fftSize=Math.pow(2,B),tt.smoothingTimeConstant=F,G.connect(tt);function Y(){O.getTracks().forEach(z=>z.stop()),G.disconnect(),X.disconnect(),tt.disconnect(),U.close()}function W(){const z=tt.frequencyBinCount,K=new Uint8Array(Math.floor(z*D));return tt.getByteFrequencyData(K),K}return{disconnect:Y,getData:W}}async function midi({ignoreVelocity:B=!0}={}){const D=new Uint8Array(128).fill(0),F=await navigator.requestMIDIAccess(),O=F.inputs.values();if(F.inputs.size===0)throw new Error("No MIDI devices found");function U(tt){const Y=tt,[W,z,K]=Y.data;W===128||!K?D[z]=0:W===144&&(D[z]=B?255:K)}for(const tt of O)tt.addEventListener("midimessage",U);function G(){for(const tt of O)tt.removeEventListener("midimessage",U)}function X(){return new Uint8Array(D)}return{disconnect:G,getData:X}}var __defProp$9=Object.defineProperty,__getOwnPropDesc$9=Object.getOwnPropertyDescriptor,__decorateClass$9=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$9(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$9(D,F,U),U};let FrequencyRecorder=class extends s{constructor(){super(...arguments),this.currentlyRecording=!1,this.starting=!1,this._status=""}async start(){var D,F;if(this.currentlyRecording||this.starting)return;this.starting=!0;let B={options:{}};if(this.previousSource)B.type=this.previousSource.type;else try{const O=await popup(x`
            <h3>New Recording Settings</h3>
          `,x`
            <label for="options">Source</label>
            <input-options 
              id="source"
              .options=${[{value:"mic",label:"Microphone",selected:!0},{value:"midi",label:"MIDI"}]}
            ></input-options>
          `);B.type=O.get("source")}catch{this.starting=!1;return}try{this._status="connecting",this.source=B.type==="mic"?await mic():await midi();const O={removeNoise:void 0,transform:void 0,capture:void 0};if(this.recorder=record(this.source,O),await delay(500),B.type==="mic"){this._status="capturing noise";const U=new Recording;O.capture=tt=>{U.data.push(tt)},await delay(2500);const G=U.createProfile();B.options.noiseProfile=G;const X=[G];(D=this.previousSource)!=null&&D.options.noiseProfile&&X.push((F=this.previousSource)==null?void 0:F.options.noiseProfile),O.removeNoise=createNoiseRemover(...X),O.transform=transformFrequencyData}this._status="running",O.capture=U=>{this.dispatchEvent(new CustomEvent("data",{detail:U}))},this.currentlyRecording=!0,this.dispatchEvent(new CustomEvent("start",{detail:B}))}catch(O){this._status="",popup(x`<h3>Error</h3><p>${O.message||"Unknown error"}</p>`)}this.starting=!1}stop(){var B,D;!this.currentlyRecording||this.starting||((B=this.recorder)==null||B.stop(),(D=this.source)==null||D.disconnect(),this.dispatchEvent(new CustomEvent("stop")),this.currentlyRecording=!1,this._status="")}toggle(){this.currentlyRecording?this.stop():this.start()}render(){return x`
      <button @click=${this.toggle} class=${this._status==="running"?"active":""}>
        <slot></slot>
        <p>${this._status}</p>
      </button>
    `}};FrequencyRecorder.styles=[buttonStyle,i$3`
      :host {
        display: block;
      }
      button.active {
        background: var(--theme-color-primary);
      }
      button p {
        text-transform: none;
        font-weight: normal;
        font-size: 0.8em;
        line-height: 1em;
        margin: 0;
      }
    `];__decorateClass$9([n({type:Boolean})],FrequencyRecorder.prototype,"currentlyRecording",2);__decorateClass$9([n({type:String})],FrequencyRecorder.prototype,"_status",2);FrequencyRecorder=__decorateClass$9([t("input-recorder")],FrequencyRecorder);var __defProp$8=Object.defineProperty,__getOwnPropDesc$8=Object.getOwnPropertyDescriptor,__decorateClass$8=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$8(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$8(D,F,U),U};let InputBoolean=class extends s{constructor(){super(...arguments),this.tabIndex=0,this.value=!1,this.onkeyup=B=>{B.key===" "&&(this.value=!this.value)}}render(){return x`
      <div class="container" @click=${()=>this.value=!this.value}>
        <slot></slot>
        <div class="toggle">
          <div class="thumb"></div>
        </div>
      </div>
    `}};InputBoolean.styles=i$3`
    :host {
      width: 100%;
      display: block;
      cursor: pointer;
    }
    .container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.5em 0;
    }
    .toggle {
      width: 2em;
      height: 1em;
      box-shadow: inset 0 0 0 2px var(--theme-color-background-light);
      border-radius: 1em;
    }
    .thumb {
      width: 1em;
      height: 1em;
      background: var(--theme-color-background-light);
      border-radius: 1em;
      transition: transform .2s, background .2s;
    }
    :host([value]) .thumb {
      transform: translateX(1em);
      background: var(--theme-color-primary);
    }
  `;__decorateClass$8([n({type:Boolean,reflect:!0})],InputBoolean.prototype,"value",2);InputBoolean=__decorateClass$8([t("input-boolean")],InputBoolean);function heat(B){return`hsla(${360-B*360}, 100%, 50%, ${B})`}var __defProp$7=Object.defineProperty,__getOwnPropDesc$7=Object.getOwnPropertyDescriptor,__decorateClass$7=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$7(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$7(D,F,U),U};let Graph1D=class extends s{render(){return x`<canvas width="0" height="0"></canvas>`}updated(){const B=this.canvas,D=B.getContext("2d");if(!this.data){B.width=0,B.height=0;return}B.width=this.data.length,B.height=5,this.data.forEach((F,O)=>{D.fillStyle=heat(F/255),D.fillRect(O,0,1,5)})}};Graph1D.styles=i$3`
    :host {
      display: block;
    }
    canvas {
      display: block;
    }
  `;__decorateClass$7([n({type:Object})],Graph1D.prototype,"data",2);__decorateClass$7([e$1("canvas")],Graph1D.prototype,"canvas",2);Graph1D=__decorateClass$7([t("graph-1d")],Graph1D);function relativeClickPosition(B,D){const F=D.getBoundingClientRect();let O,U;return B instanceof MouseEvent?(O=B.clientX-F.left,U=B.clientY-F.top):(O=B.touches[0].clientX-F.left,U=B.touches[0].clientY-F.top),{x:O/F.width,y:U/F.height}}var __defProp$6=Object.defineProperty,__getOwnPropDesc$6=Object.getOwnPropertyDescriptor,__decorateClass$6=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$6(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$6(D,F,U),U};let Graph2D=class extends s{render(){return x`<canvas width="0" height="0" @click=${B=>{const{x:D,y:F}=relativeClickPosition(B,this.canvas),O=Math.floor(D*this.data.length||0),U=Math.floor((1-F)*this.data[0].length);this.dispatchEvent(new CustomEvent("select",{detail:{column:O,row:U}}))}}></canvas>`}updated(){var Y;if(!this.data||!this.data.length){this.canvas.width=0,this.canvas.height=0;return}this.frameId&&cancelAnimationFrame(this.frameId);const B=this.canvas,D=B.getContext("2d"),F=((Y=this.data[0])==null?void 0:Y.length)||0;B.width=this.data.length,B.height=F;let O=0,U=50,G;const X=45,tt=W=>{G&&(W-G<X?U++:U--),G=W;for(let z=O;z<Math.min(O+U,this.data.length);z++)for(let K=0;K<F;K++)D.fillStyle=heat(this.data[z][K]/255),D.fillRect(z,F-K,1,1);O+=U,O<this.data.length?this.frameId=requestAnimationFrame(tt):this.frameId=void 0};this.frameId=requestAnimationFrame(tt)}};Graph2D.styles=i$3`
    :host {
      display: block;
    }
    canvas {
      display: block;
    }
  `;__decorateClass$6([n({type:Array})],Graph2D.prototype,"data",2);__decorateClass$6([e$1("canvas")],Graph2D.prototype,"canvas",2);Graph2D=__decorateClass$6([t("graph-2d")],Graph2D);function commonjsRequire(B){throw new Error('Could not dynamically require "'+B+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"}),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(D,F){module.exports=D.pdfjsLib=F()})(globalThis,()=>(()=>{var __webpack_modules__=[,(B,D)=>{var Me;Object.defineProperty(D,"__esModule",{value:!0}),D.VerbosityLevel=D.Util=D.UnknownErrorException=D.UnexpectedResponseException=D.TextRenderingMode=D.RenderingIntentFlag=D.PromiseCapability=D.PermissionFlag=D.PasswordResponses=D.PasswordException=D.PageActionEventType=D.OPS=D.MissingPDFException=D.MAX_IMAGE_SIZE_TO_CACHE=D.LINE_FACTOR=D.LINE_DESCENT_FACTOR=D.InvalidPDFException=D.ImageKind=D.IDENTITY_MATRIX=D.FormatError=D.FeatureTest=D.FONT_IDENTITY_MATRIX=D.DocumentActionEventType=D.CMapCompressionType=D.BaseException=D.BASELINE_FACTOR=D.AnnotationType=D.AnnotationReplyType=D.AnnotationPrefix=D.AnnotationMode=D.AnnotationFlag=D.AnnotationFieldFlag=D.AnnotationEditorType=D.AnnotationEditorPrefix=D.AnnotationEditorParamsType=D.AnnotationBorderStyleType=D.AnnotationActionEventType=D.AbortException=void 0,D.assert=Ut,D.bytesToString=Bt,D.createValidAbsoluteUrl=Lt,D.getModificationDate=pe,D.getUuid=Oe,D.getVerbosityLevel=Pt,D.info=Ft,D.isArrayBuffer=ie,D.isArrayEqual=fe,D.isNodeJS=void 0,D.normalizeUnicode=Re,D.objectFromMap=ee,D.objectSize=Zt,D.setVerbosityLevel=xt,D.shadow=qt,D.string32=zt,D.stringToBytes=Yt,D.stringToPDFString=se,D.stringToUTF8String=Gt,D.unreachable=Dt,D.utf8StringToString=Vt,D.warn=Mt;const F=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");D.isNodeJS=F;const O=[1,0,0,1,0,0];D.IDENTITY_MATRIX=O;const U=[.001,0,0,.001,0,0];D.FONT_IDENTITY_MATRIX=U;const G=1e7;D.MAX_IMAGE_SIZE_TO_CACHE=G;const X=1.35;D.LINE_FACTOR=X;const tt=.35;D.LINE_DESCENT_FACTOR=tt;const Y=tt/X;D.BASELINE_FACTOR=Y;const W={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};D.RenderingIntentFlag=W;const z={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};D.AnnotationMode=z;const K="pdfjs_internal_editor_";D.AnnotationEditorPrefix=K;const J={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};D.AnnotationEditorType=J;const Q={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};D.AnnotationEditorParamsType=Q;const et={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};D.PermissionFlag=et;const it={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};D.TextRenderingMode=it;const rt={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};D.ImageKind=rt;const st={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};D.AnnotationType=st;const at={GROUP:"Group",REPLY:"R"};D.AnnotationReplyType=at;const ct={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};D.AnnotationFlag=ct;const dt={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};D.AnnotationFieldFlag=dt;const nt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};D.AnnotationBorderStyleType=nt;const ht={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};D.AnnotationActionEventType=ht;const vt={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};D.DocumentActionEventType=vt;const _t={O:"PageOpen",C:"PageClose"};D.PageActionEventType=_t;const ut={ERRORS:0,WARNINGS:1,INFOS:5};D.VerbosityLevel=ut;const bt={NONE:0,BINARY:1};D.CMapCompressionType=bt;const gt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};D.OPS=gt;const At={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};D.PasswordResponses=At;let St=ut.WARNINGS;function xt(te){Number.isInteger(te)&&(St=te)}function Pt(){return St}function Ft(te){St>=ut.INFOS&&console.log(`Info: ${te}`)}function Mt(te){St>=ut.WARNINGS&&console.log(`Warning: ${te}`)}function Dt(te){throw new Error(te)}function Ut(te,Xt){te||Dt(Xt)}function Qt(te){switch(te==null?void 0:te.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Lt(te,Xt=null,jt=null){if(!te)return null;try{if(jt&&typeof te=="string"){if(jt.addDefaultProtocol&&te.startsWith("www.")){const ce=te.match(/\./g);(ce==null?void 0:ce.length)>=2&&(te=`http://${te}`)}if(jt.tryConvertEncoding)try{te=Gt(te)}catch{}}const ae=Xt?new URL(te,Xt):new URL(te);if(Qt(ae))return ae}catch{}return null}function qt(te,Xt,jt,ae=!1){return Object.defineProperty(te,Xt,{value:jt,enumerable:!ae,configurable:!0,writable:!1}),jt}const wt=function(){function Xt(jt,ae){this.constructor===Xt&&Dt("Cannot initialize BaseException."),this.message=jt,this.name=ae}return Xt.prototype=new Error,Xt.constructor=Xt,Xt}();D.BaseException=wt;class ot extends wt{constructor(Xt,jt){super(Xt,"PasswordException"),this.code=jt}}D.PasswordException=ot;class mt extends wt{constructor(Xt,jt){super(Xt,"UnknownErrorException"),this.details=jt}}D.UnknownErrorException=mt;class pt extends wt{constructor(Xt){super(Xt,"InvalidPDFException")}}D.InvalidPDFException=pt;class Et extends wt{constructor(Xt){super(Xt,"MissingPDFException")}}D.MissingPDFException=Et;class yt extends wt{constructor(Xt,jt){super(Xt,"UnexpectedResponseException"),this.status=jt}}D.UnexpectedResponseException=yt;class Tt extends wt{constructor(Xt){super(Xt,"FormatError")}}D.FormatError=Tt;class kt extends wt{constructor(Xt){super(Xt,"AbortException")}}D.AbortException=kt;function Bt(te){(typeof te!="object"||(te==null?void 0:te.length)===void 0)&&Dt("Invalid argument for bytesToString");const Xt=te.length,jt=8192;if(Xt<jt)return String.fromCharCode.apply(null,te);const ae=[];for(let ce=0;ce<Xt;ce+=jt){const We=Math.min(ce+jt,Xt),je=te.subarray(ce,We);ae.push(String.fromCharCode.apply(null,je))}return ae.join("")}function Yt(te){typeof te!="string"&&Dt("Invalid argument for stringToBytes");const Xt=te.length,jt=new Uint8Array(Xt);for(let ae=0;ae<Xt;++ae)jt[ae]=te.charCodeAt(ae)&255;return jt}function zt(te){return String.fromCharCode(te>>24&255,te>>16&255,te>>8&255,te&255)}function Zt(te){return Object.keys(te).length}function ee(te){const Xt=Object.create(null);for(const[jt,ae]of te)Xt[jt]=ae;return Xt}function he(){const te=new Uint8Array(4);return te[0]=1,new Uint32Array(te.buffer,0,1)[0]===1}function ne(){try{return new Function(""),!0}catch{return!1}}class be{static get isLittleEndian(){return qt(this,"isLittleEndian",he())}static get isEvalSupported(){return qt(this,"isEvalSupported",ne())}static get isOffscreenCanvasSupported(){return qt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?qt(this,"platform",{isWin:!1,isMac:!1}):qt(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Xt,jt;return qt(this,"isCSSRoundSupported",(jt=(Xt=globalThis.CSS)==null?void 0:Xt.supports)==null?void 0:jt.call(Xt,"width: round(1.5px, 1px)"))}}D.FeatureTest=be;const Ce=[...Array(256).keys()].map(te=>te.toString(16).padStart(2,"0"));class de{static makeHexColor(Xt,jt,ae){return`#${Ce[Xt]}${Ce[jt]}${Ce[ae]}`}static scaleMinMax(Xt,jt){let ae;Xt[0]?(Xt[0]<0&&(ae=jt[0],jt[0]=jt[1],jt[1]=ae),jt[0]*=Xt[0],jt[1]*=Xt[0],Xt[3]<0&&(ae=jt[2],jt[2]=jt[3],jt[3]=ae),jt[2]*=Xt[3],jt[3]*=Xt[3]):(ae=jt[0],jt[0]=jt[2],jt[2]=ae,ae=jt[1],jt[1]=jt[3],jt[3]=ae,Xt[1]<0&&(ae=jt[2],jt[2]=jt[3],jt[3]=ae),jt[2]*=Xt[1],jt[3]*=Xt[1],Xt[2]<0&&(ae=jt[0],jt[0]=jt[1],jt[1]=ae),jt[0]*=Xt[2],jt[1]*=Xt[2]),jt[0]+=Xt[4],jt[1]+=Xt[4],jt[2]+=Xt[5],jt[3]+=Xt[5]}static transform(Xt,jt){return[Xt[0]*jt[0]+Xt[2]*jt[1],Xt[1]*jt[0]+Xt[3]*jt[1],Xt[0]*jt[2]+Xt[2]*jt[3],Xt[1]*jt[2]+Xt[3]*jt[3],Xt[0]*jt[4]+Xt[2]*jt[5]+Xt[4],Xt[1]*jt[4]+Xt[3]*jt[5]+Xt[5]]}static applyTransform(Xt,jt){const ae=Xt[0]*jt[0]+Xt[1]*jt[2]+jt[4],ce=Xt[0]*jt[1]+Xt[1]*jt[3]+jt[5];return[ae,ce]}static applyInverseTransform(Xt,jt){const ae=jt[0]*jt[3]-jt[1]*jt[2],ce=(Xt[0]*jt[3]-Xt[1]*jt[2]+jt[2]*jt[5]-jt[4]*jt[3])/ae,We=(-Xt[0]*jt[1]+Xt[1]*jt[0]+jt[4]*jt[1]-jt[5]*jt[0])/ae;return[ce,We]}static getAxialAlignedBoundingBox(Xt,jt){const ae=this.applyTransform(Xt,jt),ce=this.applyTransform(Xt.slice(2,4),jt),We=this.applyTransform([Xt[0],Xt[3]],jt),je=this.applyTransform([Xt[2],Xt[1]],jt);return[Math.min(ae[0],ce[0],We[0],je[0]),Math.min(ae[1],ce[1],We[1],je[1]),Math.max(ae[0],ce[0],We[0],je[0]),Math.max(ae[1],ce[1],We[1],je[1])]}static inverseTransform(Xt){const jt=Xt[0]*Xt[3]-Xt[1]*Xt[2];return[Xt[3]/jt,-Xt[1]/jt,-Xt[2]/jt,Xt[0]/jt,(Xt[2]*Xt[5]-Xt[4]*Xt[3])/jt,(Xt[4]*Xt[1]-Xt[5]*Xt[0])/jt]}static singularValueDecompose2dScale(Xt){const jt=[Xt[0],Xt[2],Xt[1],Xt[3]],ae=Xt[0]*jt[0]+Xt[1]*jt[2],ce=Xt[0]*jt[1]+Xt[1]*jt[3],We=Xt[2]*jt[0]+Xt[3]*jt[2],je=Xt[2]*jt[1]+Xt[3]*jt[3],Ht=(ae+je)/2,ue=Math.sqrt((ae+je)**2-4*(ae*je-We*ce))/2,Ee=Ht+ue||1,ge=Ht-ue||1;return[Math.sqrt(Ee),Math.sqrt(ge)]}static normalizeRect(Xt){const jt=Xt.slice(0);return Xt[0]>Xt[2]&&(jt[0]=Xt[2],jt[2]=Xt[0]),Xt[1]>Xt[3]&&(jt[1]=Xt[3],jt[3]=Xt[1]),jt}static intersect(Xt,jt){const ae=Math.max(Math.min(Xt[0],Xt[2]),Math.min(jt[0],jt[2])),ce=Math.min(Math.max(Xt[0],Xt[2]),Math.max(jt[0],jt[2]));if(ae>ce)return null;const We=Math.max(Math.min(Xt[1],Xt[3]),Math.min(jt[1],jt[3])),je=Math.min(Math.max(Xt[1],Xt[3]),Math.max(jt[1],jt[3]));return We>je?null:[ae,We,ce,je]}static bezierBoundingBox(Xt,jt,ae,ce,We,je,Ht,ue){const Ee=[],ge=[[],[]];let Se,we,Ne,le,Ue,ye,Rt,ft;for(let Wt=0;Wt<2;++Wt){if(Wt===0?(we=6*Xt-12*ae+6*We,Se=-3*Xt+9*ae-9*We+3*Ht,Ne=3*ae-3*Xt):(we=6*jt-12*ce+6*je,Se=-3*jt+9*ce-9*je+3*ue,Ne=3*ce-3*jt),Math.abs(Se)<1e-12){if(Math.abs(we)<1e-12)continue;le=-Ne/we,0<le&&le<1&&Ee.push(le);continue}Rt=we*we-4*Ne*Se,ft=Math.sqrt(Rt),!(Rt<0)&&(Ue=(-we+ft)/(2*Se),0<Ue&&Ue<1&&Ee.push(Ue),ye=(-we-ft)/(2*Se),0<ye&&ye<1&&Ee.push(ye))}let Ct=Ee.length,Ot;const Nt=Ct;for(;Ct--;)le=Ee[Ct],Ot=1-le,ge[0][Ct]=Ot*Ot*Ot*Xt+3*Ot*Ot*le*ae+3*Ot*le*le*We+le*le*le*Ht,ge[1][Ct]=Ot*Ot*Ot*jt+3*Ot*Ot*le*ce+3*Ot*le*le*je+le*le*le*ue;return ge[0][Nt]=Xt,ge[1][Nt]=jt,ge[0][Nt+1]=Ht,ge[1][Nt+1]=ue,ge[0].length=ge[1].length=Nt+2,[Math.min(...ge[0]),Math.min(...ge[1]),Math.max(...ge[0]),Math.max(...ge[1])]}}D.Util=de;const xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function se(te){if(te[0]>=""){let jt;if(te[0]===""&&te[1]===""?jt="utf-16be":te[0]===""&&te[1]===""?jt="utf-16le":te[0]===""&&te[1]===""&&te[2]===""&&(jt="utf-8"),jt)try{const ae=new TextDecoder(jt,{fatal:!0}),ce=Yt(te);return ae.decode(ce)}catch(ae){Mt(`stringToPDFString: "${ae}".`)}}const Xt=[];for(let jt=0,ae=te.length;jt<ae;jt++){const ce=xe[te.charCodeAt(jt)];Xt.push(ce?String.fromCharCode(ce):te.charAt(jt))}return Xt.join("")}function Gt(te){return decodeURIComponent(escape(te))}function Vt(te){return unescape(encodeURIComponent(te))}function ie(te){return typeof te=="object"&&(te==null?void 0:te.byteLength)!==void 0}function fe(te,Xt){if(te.length!==Xt.length)return!1;for(let jt=0,ae=te.length;jt<ae;jt++)if(te[jt]!==Xt[jt])return!1;return!0}function pe(te=new Date){return[te.getUTCFullYear().toString(),(te.getUTCMonth()+1).toString().padStart(2,"0"),te.getUTCDate().toString().padStart(2,"0"),te.getUTCHours().toString().padStart(2,"0"),te.getUTCMinutes().toString().padStart(2,"0"),te.getUTCSeconds().toString().padStart(2,"0")].join("")}class Te{constructor(){It(this,Me,!1);this.promise=new Promise((Xt,jt)=>{this.resolve=ae=>{Kt(this,Me,!0),Xt(ae)},this.reject=ae=>{Kt(this,Me,!0),jt(ae)}})}get settled(){return lt(this,Me)}}Me=new WeakMap,D.PromiseCapability=Te;let ke=null,Pe=null;function Re(te){return ke||(ke=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Pe=new Map([["","t"]])),te.replaceAll(ke,(Xt,jt,ae)=>jt?jt.normalize("NFKC"):Pe.get(ae))}function Oe(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const te=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(te);else for(let Xt=0;Xt<32;Xt++)te[Xt]=Math.floor(Math.random()*255);return Bt(te)}const Fe="pdfjs_internal_id_";D.AnnotationPrefix=Fe},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var B,F,O,U,Je,X,ur,Y,W,z,K,J,Q,et,it,rt,fr,at,ct,Pr,nt,ht;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(_t){if(typeof _t=="string"||_t instanceof URL?_t={url:_t}:(0,_util.isArrayBuffer)(_t)&&(_t={data:_t}),typeof _t!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!_t.url&&!_t.data&&!_t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const ut=new PDFDocumentLoadingTask,{docId:bt}=ut,gt=_t.url?getUrlProp(_t.url):null,At=_t.data?getDataProp(_t.data):null,St=_t.httpHeaders||null,xt=_t.withCredentials===!0,Pt=_t.password??null,Ft=_t.range instanceof PDFDataRangeTransport?_t.range:null,Mt=Number.isInteger(_t.rangeChunkSize)&&_t.rangeChunkSize>0?_t.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Dt=_t.worker instanceof PDFWorker?_t.worker:null;const Ut=_t.verbosity,Qt=typeof _t.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(_t.docBaseUrl)?_t.docBaseUrl:null,Lt=typeof _t.cMapUrl=="string"?_t.cMapUrl:null,qt=_t.cMapPacked!==!1,wt=_t.CMapReaderFactory||DefaultCMapReaderFactory,ot=typeof _t.standardFontDataUrl=="string"?_t.standardFontDataUrl:null,mt=_t.StandardFontDataFactory||DefaultStandardFontDataFactory,pt=_t.stopAtErrors!==!0,Et=Number.isInteger(_t.maxImageSize)&&_t.maxImageSize>-1?_t.maxImageSize:-1,yt=_t.isEvalSupported!==!1,Tt=typeof _t.isOffscreenCanvasSupported=="boolean"?_t.isOffscreenCanvasSupported:!_util.isNodeJS,kt=Number.isInteger(_t.canvasMaxAreaInBytes)?_t.canvasMaxAreaInBytes:-1,Bt=typeof _t.disableFontFace=="boolean"?_t.disableFontFace:_util.isNodeJS,Yt=_t.fontExtraProperties===!0,zt=_t.enableXfa===!0,Zt=_t.ownerDocument||globalThis.document,ee=_t.disableRange===!0,he=_t.disableStream===!0,ne=_t.disableAutoFetch===!0,be=_t.pdfBug===!0,Ce=Ft?Ft.length:_t.length??NaN,de=typeof _t.useSystemFonts=="boolean"?_t.useSystemFonts:!_util.isNodeJS&&!Bt,xe=typeof _t.useWorkerFetch=="boolean"?_t.useWorkerFetch:wt===_display_utils.DOMCMapReaderFactory&&mt===_display_utils.DOMStandardFontDataFactory&&Lt&&ot&&(0,_display_utils.isValidFetchUrl)(Lt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(ot,document.baseURI),se=_t.canvasFactory||new DefaultCanvasFactory({ownerDocument:Zt}),Gt=_t.filterFactory||new DefaultFilterFactory({docId:bt,ownerDocument:Zt}),Vt=null;(0,_util.setVerbosityLevel)(Ut);const ie={canvasFactory:se,filterFactory:Gt};if(xe||(ie.cMapReaderFactory=new wt({baseUrl:Lt,isCompressed:qt}),ie.standardFontDataFactory=new mt({baseUrl:ot})),!Dt){const Te={verbosity:Ut,port:_worker_options.GlobalWorkerOptions.workerPort};Dt=Te.port?PDFWorker.fromPort(Te):new PDFWorker(Te),ut._worker=Dt}const fe={docId:bt,apiVersion:"3.11.174",data:At,password:Pt,disableAutoFetch:ne,rangeChunkSize:Mt,length:Ce,docBaseUrl:Qt,enableXfa:zt,evaluatorOptions:{maxImageSize:Et,disableFontFace:Bt,ignoreErrors:pt,isEvalSupported:yt,isOffscreenCanvasSupported:Tt,canvasMaxAreaInBytes:kt,fontExtraProperties:Yt,useSystemFonts:de,cMapUrl:xe?Lt:null,standardFontDataUrl:xe?ot:null}},pe={ignoreErrors:pt,isEvalSupported:yt,disableFontFace:Bt,fontExtraProperties:Yt,enableXfa:zt,ownerDocument:Zt,disableAutoFetch:ne,pdfBug:be,styleElement:Vt};return Dt.promise.then(function(){if(ut.destroyed)throw new Error("Loading aborted");const Te=_fetchDocument(Dt,fe),ke=new Promise(function(Pe){let Re;Ft?Re=new _transport_stream.PDFDataTransportStream({length:Ce,initialData:Ft.initialData,progressiveDone:Ft.progressiveDone,contentDispositionFilename:Ft.contentDispositionFilename,disableRange:ee,disableStream:he},Ft):At||(Re=(Fe=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Fe):(0,_display_utils.isValidFetchUrl)(Fe.url)?new _displayFetch_stream.PDFFetchStream(Fe):new _displayNetwork.PDFNetworkStream(Fe))({url:gt,length:Ce,httpHeaders:St,withCredentials:xt,rangeChunkSize:Mt,disableRange:ee,disableStream:he})),Pe(Re)});return Promise.all([Te,ke]).then(function([Pe,Re]){if(ut.destroyed)throw new Error("Loading aborted");const Oe=new _message_handler.MessageHandler(bt,Pe,Dt.port),Fe=new WorkerTransport(Oe,ut,Re,pe,ie);ut._transport=Fe,Oe.send("Ready",null)})}).catch(ut._capability.reject),ut}async function _fetchDocument(_t,ut){if(_t.destroyed)throw new Error("Worker was destroyed");const bt=await _t.messageHandler.sendWithPromise("GetDocRequest",ut,ut.data?[ut.data.buffer]:null);if(_t.destroyed)throw new Error("Worker was destroyed");return bt}function getUrlProp(_t){if(_t instanceof URL)return _t.href;try{return new URL(_t,window.location).href}catch{if(_util.isNodeJS&&typeof _t=="string")return _t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(_t){if(_util.isNodeJS&&typeof Buffer<"u"&&_t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(_t instanceof Uint8Array&&_t.byteLength===_t.buffer.byteLength)return _t;if(typeof _t=="string")return(0,_util.stringToBytes)(_t);if(typeof _t=="object"&&!isNaN(_t==null?void 0:_t.length)||(0,_util.isArrayBuffer)(_t))return new Uint8Array(_t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const D=class D{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${nr(D,B)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var ut,bt,gt;this.destroyed=!0;try{(ut=this._worker)!=null&&ut.port&&(this._worker._pendingDestroy=!0),await((bt=this._transport)==null?void 0:bt.destroy())}catch(At){throw(gt=this._worker)!=null&&gt.port&&delete this._worker._pendingDestroy,At}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};B=new WeakMap,It(D,B,0);let PDFDocumentLoadingTask=D;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(ut,bt,gt=!1,At=null){this.length=ut,this.initialData=bt,this.progressiveDone=gt,this.contentDispositionFilename=At,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(ut){this._rangeListeners.push(ut)}addProgressListener(ut){this._progressListeners.push(ut)}addProgressiveReadListener(ut){this._progressiveReadListeners.push(ut)}addProgressiveDoneListener(ut){this._progressiveDoneListeners.push(ut)}onDataRange(ut,bt){for(const gt of this._rangeListeners)gt(ut,bt)}onDataProgress(ut,bt){this._readyCapability.promise.then(()=>{for(const gt of this._progressListeners)gt(ut,bt)})}onDataProgressiveRead(ut){this._readyCapability.promise.then(()=>{for(const bt of this._progressiveReadListeners)bt(ut)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const ut of this._progressiveDoneListeners)ut()})}transportReady(){this._readyCapability.resolve()}requestDataRange(ut,bt){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(ut,bt){this._pdfInfo=ut,this._transport=bt,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(gt=>{if(!gt)return gt;const At=[];for(const St in gt)At.push(...gt[St]);return At}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(ut){return this._transport.getPage(ut)}getPageIndex(ut){return this._transport.getPageIndex(ut)}getDestinations(){return this._transport.getDestinations()}getDestination(ut){return this._transport.getDestination(ut)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(ut=!1){return this._transport.startCleanup(ut||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(ut,bt,gt,At=!1){It(this,U);It(this,X);It(this,F,null);It(this,O,!1);this._pageIndex=ut,this._pageInfo=bt,this._transport=gt,this._stats=At?new _display_utils.StatTimer:null,this._pdfBug=At,this.commonObjs=gt.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:ut,rotation:bt=this.rotate,offsetX:gt=0,offsetY:At=0,dontFlip:St=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:ut,rotation:bt,offsetX:gt,offsetY:At,dontFlip:St})}getAnnotations({intent:ut="display"}={}){const bt=this._transport.getRenderingIntent(ut);return this._transport.getAnnotations(this._pageIndex,bt.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var ut;return((ut=this._transport._htmlForXfa)==null?void 0:ut.children[this._pageIndex])||null}render({canvasContext:ut,viewport:bt,intent:gt="display",annotationMode:At=_util.AnnotationMode.ENABLE,transform:St=null,background:xt=null,optionalContentConfigPromise:Pt=null,annotationCanvasMap:Ft=null,pageColors:Mt=null,printAnnotationStorage:Dt=null}){var mt,pt;(mt=this._stats)==null||mt.time("Overall");const Ut=this._transport.getRenderingIntent(gt,At,Dt);Kt(this,O,!1),$t(this,X,ur).call(this),Pt||(Pt=this._transport.getOptionalContentConfig());let Qt=this._intentStates.get(Ut.cacheKey);Qt||(Qt=Object.create(null),this._intentStates.set(Ut.cacheKey,Qt)),Qt.streamReaderCancelTimeout&&(clearTimeout(Qt.streamReaderCancelTimeout),Qt.streamReaderCancelTimeout=null);const Lt=!!(Ut.renderingIntent&_util.RenderingIntentFlag.PRINT);Qt.displayReadyCapability||(Qt.displayReadyCapability=new _util.PromiseCapability,Qt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(pt=this._stats)==null||pt.time("Page Request"),this._pumpOperatorList(Ut));const qt=Et=>{var yt,Tt;Qt.renderTasks.delete(wt),(this._maybeCleanupAfterRender||Lt)&&Kt(this,O,!0),$t(this,U,Je).call(this,!Lt),Et?(wt.capability.reject(Et),this._abortOperatorList({intentState:Qt,reason:Et instanceof Error?Et:new Error(Et)})):wt.capability.resolve(),(yt=this._stats)==null||yt.timeEnd("Rendering"),(Tt=this._stats)==null||Tt.timeEnd("Overall")},wt=new InternalRenderTask({callback:qt,params:{canvasContext:ut,viewport:bt,transform:St,background:xt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Ft,operatorList:Qt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Lt,pdfBug:this._pdfBug,pageColors:Mt});(Qt.renderTasks||(Qt.renderTasks=new Set)).add(wt);const ot=wt.task;return Promise.all([Qt.displayReadyCapability.promise,Pt]).then(([Et,yt])=>{var Tt;if(this.destroyed){qt();return}(Tt=this._stats)==null||Tt.time("Rendering"),wt.initializeGraphics({transparency:Et,optionalContentConfig:yt}),wt.operatorListChanged()}).catch(qt),ot}getOperatorList({intent:ut="display",annotationMode:bt=_util.AnnotationMode.ENABLE,printAnnotationStorage:gt=null}={}){var Ft;function At(){xt.operatorList.lastChunk&&(xt.opListReadCapability.resolve(xt.operatorList),xt.renderTasks.delete(Pt))}const St=this._transport.getRenderingIntent(ut,bt,gt,!0);let xt=this._intentStates.get(St.cacheKey);xt||(xt=Object.create(null),this._intentStates.set(St.cacheKey,xt));let Pt;return xt.opListReadCapability||(Pt=Object.create(null),Pt.operatorListChanged=At,xt.opListReadCapability=new _util.PromiseCapability,(xt.renderTasks||(xt.renderTasks=new Set)).add(Pt),xt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Ft=this._stats)==null||Ft.time("Page Request"),this._pumpOperatorList(St)),xt.opListReadCapability.promise}streamTextContent({includeMarkedContent:ut=!1,disableNormalization:bt=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:ut===!0,disableNormalization:bt===!0},{highWaterMark:100,size(At){return At.items.length}})}getTextContent(ut={}){if(this._transport._htmlForXfa)return this.getXfa().then(gt=>_xfa_text.XfaText.textContent(gt));const bt=this.streamTextContent(ut);return new Promise(function(gt,At){function St(){xt.read().then(function({value:Ft,done:Mt}){if(Mt){gt(Pt);return}Object.assign(Pt.styles,Ft.styles),Pt.items.push(...Ft.items),St()},At)}const xt=bt.getReader(),Pt={items:[],styles:Object.create(null)};St()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const ut=[];for(const bt of this._intentStates.values())if(this._abortOperatorList({intentState:bt,reason:new Error("Page was destroyed."),force:!0}),!bt.opListReadCapability)for(const gt of bt.renderTasks)ut.push(gt.completed),gt.cancel();return this.objs.clear(),Kt(this,O,!1),$t(this,X,ur).call(this),Promise.all(ut)}cleanup(ut=!1){Kt(this,O,!0);const bt=$t(this,U,Je).call(this,!1);return ut&&bt&&this._stats&&(this._stats=new _display_utils.StatTimer),bt}_startRenderPage(ut,bt){var At,St;const gt=this._intentStates.get(bt);gt&&((At=this._stats)==null||At.timeEnd("Page Request"),(St=gt.displayReadyCapability)==null||St.resolve(ut))}_renderPageChunk(ut,bt){for(let gt=0,At=ut.length;gt<At;gt++)bt.operatorList.fnArray.push(ut.fnArray[gt]),bt.operatorList.argsArray.push(ut.argsArray[gt]);bt.operatorList.lastChunk=ut.lastChunk,bt.operatorList.separateAnnots=ut.separateAnnots;for(const gt of bt.renderTasks)gt.operatorListChanged();ut.lastChunk&&$t(this,U,Je).call(this,!0)}_pumpOperatorList({renderingIntent:ut,cacheKey:bt,annotationStorageSerializable:gt}){const{map:At,transfers:St}=gt,Pt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:ut,cacheKey:bt,annotationStorage:At},St).getReader(),Ft=this._intentStates.get(bt);Ft.streamReader=Pt;const Mt=()=>{Pt.read().then(({value:Dt,done:Ut})=>{if(Ut){Ft.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Dt,Ft),Mt())},Dt=>{if(Ft.streamReader=null,!this._transport.destroyed){if(Ft.operatorList){Ft.operatorList.lastChunk=!0;for(const Ut of Ft.renderTasks)Ut.operatorListChanged();$t(this,U,Je).call(this,!0)}if(Ft.displayReadyCapability)Ft.displayReadyCapability.reject(Dt);else if(Ft.opListReadCapability)Ft.opListReadCapability.reject(Dt);else throw Dt}})};Mt()}_abortOperatorList({intentState:ut,reason:bt,force:gt=!1}){if(ut.streamReader){if(ut.streamReaderCancelTimeout&&(clearTimeout(ut.streamReaderCancelTimeout),ut.streamReaderCancelTimeout=null),!gt){if(ut.renderTasks.size>0)return;if(bt instanceof _display_utils.RenderingCancelledException){let At=RENDERING_CANCELLED_TIMEOUT;bt.extraDelay>0&&bt.extraDelay<1e3&&(At+=bt.extraDelay),ut.streamReaderCancelTimeout=setTimeout(()=>{ut.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:ut,reason:bt,force:!0})},At);return}}if(ut.streamReader.cancel(new _util.AbortException(bt.message)).catch(()=>{}),ut.streamReader=null,!this._transport.destroyed){for(const[At,St]of this._intentStates)if(St===ut){this._intentStates.delete(At);break}this.cleanup()}}}get stats(){return this._stats}}F=new WeakMap,O=new WeakMap,U=new WeakSet,Je=function(ut=!1){if($t(this,X,ur).call(this),!lt(this,O)||this.destroyed)return!1;if(ut)return Kt(this,F,setTimeout(()=>{Kt(this,F,null),$t(this,U,Je).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:bt,operatorList:gt}of this._intentStates.values())if(bt.size>0||!gt.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Kt(this,O,!1),!0},X=new WeakSet,ur=function(){lt(this,F)&&(clearTimeout(lt(this,F)),Kt(this,F,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){It(this,Y,new Set);It(this,W,Promise.resolve())}postMessage(ut,bt){const gt={data:structuredClone(ut,bt?{transfer:bt}:null)};lt(this,W).then(()=>{for(const At of lt(this,Y))At.call(this,gt)})}addEventListener(ut,bt){lt(this,Y).add(bt)}removeEventListener(ut,bt){lt(this,Y).delete(bt)}terminate(){lt(this,Y).clear()}}Y=new WeakMap,W=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const _t=(z=document==null?void 0:document.currentScript)==null?void 0:z.src;_t&&(PDFWorkerUtil.fallbackWorkerSrc=_t.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(_t,ut){let bt;try{if(bt=new URL(_t),!bt.origin||bt.origin==="null")return!1}catch{return!1}const gt=new URL(ut,bt);return bt.origin===gt.origin},PDFWorkerUtil.createCDNWrapper=function(_t){const ut=`importScripts("${_t}");`;return URL.createObjectURL(new Blob([ut]))}}const _PDFWorker=class _PDFWorker{constructor({name:_t=null,port:ut=null,verbosity:bt=(0,_util.getVerbosityLevel)()}={}){var gt;if(this.name=_t,this.destroyed=!1,this.verbosity=bt,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,ut){if((gt=lt(_PDFWorker,K))!=null&&gt.has(ut))throw new Error("Cannot use more than one PDFWorker per port.");(lt(_PDFWorker,K)||Kt(_PDFWorker,K,new WeakMap)).set(ut,this),this._initializeFromPort(ut);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(_t){this._port=_t,this._messageHandler=new _message_handler.MessageHandler("main","worker",_t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:_t}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,_t)||(_t=PDFWorkerUtil.createCDNWrapper(new URL(_t,window.location).href));const ut=new Worker(_t),bt=new _message_handler.MessageHandler("main","worker",ut),gt=()=>{ut.removeEventListener("error",At),bt.destroy(),ut.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},At=()=>{this._webWorker||gt()};ut.addEventListener("error",At),bt.on("test",xt=>{if(ut.removeEventListener("error",At),this.destroyed){gt();return}xt?(this._messageHandler=bt,this._port=ut,this._webWorker=ut,this._readyCapability.resolve(),bt.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),bt.destroy(),ut.terminate())}),bt.on("ready",xt=>{if(ut.removeEventListener("error",At),this.destroyed){gt();return}try{St()}catch{this._setupFakeWorker()}});const St=()=>{const xt=new Uint8Array;bt.send("test",xt,[xt.buffer])};St();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(_t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const ut=new LoopbackPort;this._port=ut;const bt=`fake${PDFWorkerUtil.fakeWorkerId++}`,gt=new _message_handler.MessageHandler(bt+"_worker",bt,ut);_t.setup(gt,ut);const At=new _message_handler.MessageHandler(bt,bt+"_worker",ut);this._messageHandler=At,this._readyCapability.resolve(),At.send("configure",{verbosity:this.verbosity})}).catch(_t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${_t.message}".`))})}destroy(){var _t;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(_t=lt(_PDFWorker,K))==null||_t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(_t){var bt;if(!(_t!=null&&_t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const ut=(bt=lt(this,K))==null?void 0:bt.get(_t.port);if(ut){if(ut._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return ut}return new _PDFWorker(_t)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var _t;try{return((_t=globalThis.pdfjsWorker)==null?void 0:_t.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};K=new WeakMap,It(_PDFWorker,K,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(ut,bt,gt,At,St){It(this,rt);It(this,J,new Map);It(this,Q,new Map);It(this,et,new Map);It(this,it,null);this.messageHandler=ut,this.loadingTask=bt,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:At.ownerDocument,styleElement:At.styleElement}),this._params=At,this.canvasFactory=St.canvasFactory,this.filterFactory=St.filterFactory,this.cMapReaderFactory=St.cMapReaderFactory,this.standardFontDataFactory=St.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=gt,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(ut,bt=_util.AnnotationMode.ENABLE,gt=null,At=!1){let St=_util.RenderingIntentFlag.DISPLAY,xt=_annotation_storage.SerializableEmpty;switch(ut){case"any":St=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":St=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${ut}`)}switch(bt){case _util.AnnotationMode.DISABLE:St+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:St+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:St+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,xt=(St&_util.RenderingIntentFlag.PRINT&&gt instanceof _annotation_storage.PrintAnnotationStorage?gt:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${bt}`)}return At&&(St+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:St,cacheKey:`${St}_${xt.hash}`,annotationStorageSerializable:xt}}destroy(){var gt;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(gt=lt(this,it))==null||gt.reject(new Error("Worker was destroyed during onPassword callback"));const ut=[];for(const At of lt(this,Q).values())ut.push(At._destroy());lt(this,Q).clear(),lt(this,et).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const bt=this.messageHandler.sendWithPromise("Terminate",null);return ut.push(bt),Promise.all(ut).then(()=>{var At;this.commonObjs.clear(),this.fontLoader.clear(),lt(this,J).clear(),this.filterFactory.destroy(),(At=this._networkStream)==null||At.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:ut,loadingTask:bt}=this;ut.on("GetReader",(gt,At)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=St=>{this._lastProgress={loaded:St.loaded,total:St.total}},At.onPull=()=>{this._fullReader.read().then(function({value:St,done:xt}){if(xt){At.close();return}(0,_util.assert)(St instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),At.enqueue(new Uint8Array(St),1,[St])}).catch(St=>{At.error(St)})},At.onCancel=St=>{this._fullReader.cancel(St),At.ready.catch(xt=>{if(!this.destroyed)throw xt})}}),ut.on("ReaderHeadersReady",gt=>{const At=new _util.PromiseCapability,St=this._fullReader;return St.headersReady.then(()=>{var xt;(!St.isStreamingSupported||!St.isRangeSupported)&&(this._lastProgress&&((xt=bt.onProgress)==null||xt.call(bt,this._lastProgress)),St.onProgress=Pt=>{var Ft;(Ft=bt.onProgress)==null||Ft.call(bt,{loaded:Pt.loaded,total:Pt.total})}),At.resolve({isStreamingSupported:St.isStreamingSupported,isRangeSupported:St.isRangeSupported,contentLength:St.contentLength})},At.reject),At.promise}),ut.on("GetRangeReader",(gt,At)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const St=this._networkStream.getRangeReader(gt.begin,gt.end);if(!St){At.close();return}At.onPull=()=>{St.read().then(function({value:xt,done:Pt}){if(Pt){At.close();return}(0,_util.assert)(xt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),At.enqueue(new Uint8Array(xt),1,[xt])}).catch(xt=>{At.error(xt)})},At.onCancel=xt=>{St.cancel(xt),At.ready.catch(Pt=>{if(!this.destroyed)throw Pt})}}),ut.on("GetDoc",({pdfInfo:gt})=>{this._numPages=gt.numPages,this._htmlForXfa=gt.htmlForXfa,delete gt.htmlForXfa,bt._capability.resolve(new PDFDocumentProxy(gt,this))}),ut.on("DocException",function(gt){let At;switch(gt.name){case"PasswordException":At=new _util.PasswordException(gt.message,gt.code);break;case"InvalidPDFException":At=new _util.InvalidPDFException(gt.message);break;case"MissingPDFException":At=new _util.MissingPDFException(gt.message);break;case"UnexpectedResponseException":At=new _util.UnexpectedResponseException(gt.message,gt.status);break;case"UnknownErrorException":At=new _util.UnknownErrorException(gt.message,gt.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}bt._capability.reject(At)}),ut.on("PasswordRequest",gt=>{if(Kt(this,it,new _util.PromiseCapability),bt.onPassword){const At=St=>{St instanceof Error?lt(this,it).reject(St):lt(this,it).resolve({password:St})};try{bt.onPassword(At,gt.code)}catch(St){lt(this,it).reject(St)}}else lt(this,it).reject(new _util.PasswordException(gt.message,gt.code));return lt(this,it).promise}),ut.on("DataLoaded",gt=>{var At;(At=bt.onProgress)==null||At.call(bt,{loaded:gt.length,total:gt.length}),this.downloadInfoCapability.resolve(gt)}),ut.on("StartRenderPage",gt=>{if(this.destroyed)return;lt(this,Q).get(gt.pageIndex)._startRenderPage(gt.transparency,gt.cacheKey)}),ut.on("commonobj",([gt,At,St])=>{var xt;if(!this.destroyed&&!this.commonObjs.has(gt))switch(At){case"Font":const Pt=this._params;if("error"in St){const Dt=St.error;(0,_util.warn)(`Error during font loading: ${Dt}`),this.commonObjs.resolve(gt,Dt);break}const Ft=Pt.pdfBug&&((xt=globalThis.FontInspector)!=null&&xt.enabled)?(Dt,Ut)=>globalThis.FontInspector.fontAdded(Dt,Ut):null,Mt=new _font_loader.FontFaceObject(St,{isEvalSupported:Pt.isEvalSupported,disableFontFace:Pt.disableFontFace,ignoreErrors:Pt.ignoreErrors,inspectFont:Ft});this.fontLoader.bind(Mt).catch(Dt=>ut.sendWithPromise("FontFallback",{id:gt})).finally(()=>{!Pt.fontExtraProperties&&Mt.data&&(Mt.data=null),this.commonObjs.resolve(gt,Mt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(gt,St);break;default:throw new Error(`Got unknown common object type ${At}`)}}),ut.on("obj",([gt,At,St,xt])=>{var Ft;if(this.destroyed)return;const Pt=lt(this,Q).get(At);if(!Pt.objs.has(gt))switch(St){case"Image":if(Pt.objs.resolve(gt,xt),xt){let Mt;if(xt.bitmap){const{width:Dt,height:Ut}=xt;Mt=Dt*Ut*4}else Mt=((Ft=xt.data)==null?void 0:Ft.length)||0;Mt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Pt._maybeCleanupAfterRender=!0)}break;case"Pattern":Pt.objs.resolve(gt,xt);break;default:throw new Error(`Got unknown object type ${St}`)}}),ut.on("DocProgress",gt=>{var At;this.destroyed||(At=bt.onProgress)==null||At.call(bt,{loaded:gt.loaded,total:gt.total})}),ut.on("FetchBuiltInCMap",gt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(gt):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),ut.on("FetchStandardFontData",gt=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(gt):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var gt;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:ut,transfers:bt}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:ut,filename:((gt=this._fullReader)==null?void 0:gt.filename)??null},bt).finally(()=>{this.annotationStorage.resetModified()})}getPage(ut){if(!Number.isInteger(ut)||ut<=0||ut>this._numPages)return Promise.reject(new Error("Invalid page request."));const bt=ut-1,gt=lt(this,et).get(bt);if(gt)return gt;const At=this.messageHandler.sendWithPromise("GetPage",{pageIndex:bt}).then(St=>{if(this.destroyed)throw new Error("Transport destroyed");const xt=new PDFPageProxy(bt,St,this,this._params.pdfBug);return lt(this,Q).set(bt,xt),xt});return lt(this,et).set(bt,At),At}getPageIndex(ut){return typeof ut!="object"||ut===null||!Number.isInteger(ut.num)||ut.num<0||!Number.isInteger(ut.gen)||ut.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:ut.num,gen:ut.gen})}getAnnotations(ut,bt){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:ut,intent:bt})}getFieldObjects(){return $t(this,rt,fr).call(this,"GetFieldObjects")}hasJSActions(){return $t(this,rt,fr).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(ut){return typeof ut!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:ut})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return $t(this,rt,fr).call(this,"GetDocJSActions")}getPageJSActions(ut){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:ut})}getStructTree(ut){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:ut})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(ut=>new _optional_content_config.OptionalContentConfig(ut))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const ut="GetMetadata",bt=lt(this,J).get(ut);if(bt)return bt;const gt=this.messageHandler.sendWithPromise(ut,null).then(At=>{var St,xt;return{info:At[0],metadata:At[1]?new _metadata.Metadata(At[1]):null,contentDispositionFilename:((St=this._fullReader)==null?void 0:St.filename)??null,contentLength:((xt=this._fullReader)==null?void 0:xt.contentLength)??null}});return lt(this,J).set(ut,gt),gt}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(ut=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const bt of lt(this,Q).values())if(!bt.cleanup())throw new Error(`startCleanup: Page ${bt.pageNumber} is currently rendering.`);this.commonObjs.clear(),ut||this.fontLoader.clear(),lt(this,J).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:ut,enableXfa:bt}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:ut,enableXfa:bt})}}J=new WeakMap,Q=new WeakMap,et=new WeakMap,it=new WeakMap,rt=new WeakSet,fr=function(ut,bt=null){const gt=lt(this,J).get(ut);if(gt)return gt;const At=this.messageHandler.sendWithPromise(ut,bt);return lt(this,J).set(ut,At),At};class PDFObjects{constructor(){It(this,ct);It(this,at,Object.create(null))}get(ut,bt=null){if(bt){const At=$t(this,ct,Pr).call(this,ut);return At.capability.promise.then(()=>bt(At.data)),null}const gt=lt(this,at)[ut];if(!(gt!=null&&gt.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${ut}.`);return gt.data}has(ut){const bt=lt(this,at)[ut];return(bt==null?void 0:bt.capability.settled)||!1}resolve(ut,bt=null){const gt=$t(this,ct,Pr).call(this,ut);gt.data=bt,gt.capability.resolve()}clear(){var ut;for(const bt in lt(this,at)){const{data:gt}=lt(this,at)[bt];(ut=gt==null?void 0:gt.bitmap)==null||ut.close()}Kt(this,at,Object.create(null))}}at=new WeakMap,ct=new WeakSet,Pr=function(ut){var bt;return(bt=lt(this,at))[ut]||(bt[ut]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(ut){It(this,nt,null);Kt(this,nt,ut),this.onContinue=null}get promise(){return lt(this,nt).capability.promise}cancel(ut=0){lt(this,nt).cancel(null,ut)}get separateAnnots(){const{separateAnnots:ut}=lt(this,nt).operatorList;if(!ut)return!1;const{annotationCanvasMap:bt}=lt(this,nt);return ut.form||ut.canvas&&(bt==null?void 0:bt.size)>0}}nt=new WeakMap,exports.RenderTask=RenderTask;const vt=class vt{constructor({callback:ut,params:bt,objs:gt,commonObjs:At,annotationCanvasMap:St,operatorList:xt,pageIndex:Pt,canvasFactory:Ft,filterFactory:Mt,useRequestAnimationFrame:Dt=!1,pdfBug:Ut=!1,pageColors:Qt=null}){this.callback=ut,this.params=bt,this.objs=gt,this.commonObjs=At,this.annotationCanvasMap=St,this.operatorListIdx=null,this.operatorList=xt,this._pageIndex=Pt,this.canvasFactory=Ft,this.filterFactory=Mt,this._pdfBug=Ut,this.pageColors=Qt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Dt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=bt.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:ut=!1,optionalContentConfig:bt}){var Pt,Ft;if(this.cancelled)return;if(this._canvas){if(lt(vt,ht).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");lt(vt,ht).add(this._canvas)}this._pdfBug&&((Pt=globalThis.StepperManager)!=null&&Pt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:gt,viewport:At,transform:St,background:xt}=this.params;this.gfx=new _canvas.CanvasGraphics(gt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:bt},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:St,viewport:At,transparency:ut,background:xt}),this.operatorListIdx=0,this.graphicsReady=!0,(Ft=this.graphicsReadyCallback)==null||Ft.call(this)}cancel(ut=null,bt=0){var gt;this.running=!1,this.cancelled=!0,(gt=this.gfx)==null||gt.endDrawing(),lt(vt,ht).delete(this._canvas),this.callback(ut||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,bt))}operatorListChanged(){var ut;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(ut=this.stepper)==null||ut.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),lt(vt,ht).delete(this._canvas),this.callback())))}};ht=new WeakMap,It(vt,ht,new WeakSet);let InternalRenderTask=vt;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(B,D,F)=>{var W,z,K,hi,Q;Object.defineProperty(D,"__esModule",{value:!0}),D.SerializableEmpty=D.PrintAnnotationStorage=D.AnnotationStorage=void 0;var O=F(1),U=F(4),G=F(8);const X=Object.freeze({map:null,hash:"",transfers:void 0});D.SerializableEmpty=X;class tt{constructor(){It(this,K);It(this,W,!1);It(this,z,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(it,rt){const st=lt(this,z).get(it);return st===void 0?rt:Object.assign(rt,st)}getRawValue(it){return lt(this,z).get(it)}remove(it){if(lt(this,z).delete(it),lt(this,z).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const rt of lt(this,z).values())if(rt instanceof U.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(it,rt){const st=lt(this,z).get(it);let at=!1;if(st!==void 0)for(const[ct,dt]of Object.entries(rt))st[ct]!==dt&&(at=!0,st[ct]=dt);else at=!0,lt(this,z).set(it,rt);at&&$t(this,K,hi).call(this),rt instanceof U.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(rt.constructor._type)}has(it){return lt(this,z).has(it)}getAll(){return lt(this,z).size>0?(0,O.objectFromMap)(lt(this,z)):null}setAll(it){for(const[rt,st]of Object.entries(it))this.setValue(rt,st)}get size(){return lt(this,z).size}resetModified(){lt(this,W)&&(Kt(this,W,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Y(this)}get serializable(){if(lt(this,z).size===0)return X;const it=new Map,rt=new G.MurmurHash3_64,st=[],at=Object.create(null);let ct=!1;for(const[dt,nt]of lt(this,z)){const ht=nt instanceof U.AnnotationEditor?nt.serialize(!1,at):nt;ht&&(it.set(dt,ht),rt.update(`${dt}:${JSON.stringify(ht)}`),ct||(ct=!!ht.bitmap))}if(ct)for(const dt of it.values())dt.bitmap&&st.push(dt.bitmap);return it.size>0?{map:it,hash:rt.hexdigest(),transfers:st}:X}}W=new WeakMap,z=new WeakMap,K=new WeakSet,hi=function(){lt(this,W)||(Kt(this,W,!0),typeof this.onSetModified=="function"&&this.onSetModified())},D.AnnotationStorage=tt;class Y extends tt{constructor(rt){super();It(this,Q,void 0);const{map:st,hash:at,transfers:ct}=rt.serializable,dt=structuredClone(st,ct?{transfer:ct}:null);Kt(this,Q,{map:dt,hash:at,transfers:ct})}get print(){(0,O.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return lt(this,Q)}}Q=new WeakMap,D.PrintAnnotationStorage=Y},(B,D,F)=>{var Y,W,z,K,J,Q,et,it,rt,st,at,ct,dt,nt,ht,Dr,_t,Rr,bt,kr,At,Fr,xt,di,Ft,fi,Dt,pi,Qt,Or,qt,gi;Object.defineProperty(D,"__esModule",{value:!0}),D.AnnotationEditor=void 0;var O=F(5),U=F(1),G=F(6);const ot=class ot{constructor(pt){It(this,ht);It(this,_t);It(this,At);It(this,xt);It(this,Ft);It(this,Dt);It(this,Qt);It(this,qt);It(this,Y,"");It(this,W,!1);It(this,z,null);It(this,K,null);It(this,J,null);It(this,Q,!1);It(this,et,null);It(this,it,this.focusin.bind(this));It(this,rt,this.focusout.bind(this));It(this,st,!1);It(this,at,!1);It(this,ct,!1);He(this,"_initialOptions",Object.create(null));He(this,"_uiManager",null);He(this,"_focusEventsAllowed",!0);He(this,"_l10nPromise",null);It(this,dt,!1);It(this,nt,ot._zIndex++);this.constructor===ot&&(0,U.unreachable)("Cannot initialize AnnotationEditor."),this.parent=pt.parent,this.id=pt.id,this.width=this.height=null,this.pageIndex=pt.parent.pageIndex,this.name=pt.name,this.div=null,this._uiManager=pt.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=pt.isCentered,this._structTreeParentId=null;const{rotation:Et,rawDims:{pageWidth:yt,pageHeight:Tt,pageX:kt,pageY:Bt}}=this.parent.viewport;this.rotation=Et,this.pageRotation=(360+Et-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[yt,Tt],this.pageTranslation=[kt,Bt];const[Yt,zt]=this.parentDimensions;this.x=pt.x/Yt,this.y=pt.y/zt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,U.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(pt){const Et=new tt({id:pt.parent.getNextId(),parent:pt.parent,uiManager:pt._uiManager});Et.annotationElementId=pt.annotationElementId,Et.deleted=!0,Et._uiManager.addToAnnotationStorage(Et)}static initialize(pt,Et=null){if(ot._l10nPromise||(ot._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Tt=>[Tt,pt.get(Tt)]))),Et!=null&&Et.strings)for(const Tt of Et.strings)ot._l10nPromise.set(Tt,pt.get(Tt));if(ot._borderLineWidth!==-1)return;const yt=getComputedStyle(document.documentElement);ot._borderLineWidth=parseFloat(yt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(pt,Et){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(pt){return!1}static paste(pt,Et){(0,U.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return lt(this,dt)}set _isDraggable(pt){var Et;Kt(this,dt,pt),(Et=this.div)==null||Et.classList.toggle("draggable",pt)}center(){const[pt,Et]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Et/(pt*2),this.y+=this.width*pt/(Et*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Et/(pt*2),this.y-=this.width*pt/(Et*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(pt){this._uiManager.addCommands(pt)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=lt(this,nt)}setParent(pt){pt!==null&&(this.pageIndex=pt.pageIndex,this.pageDimensions=pt.pageDimensions),this.parent=pt}focusin(pt){this._focusEventsAllowed&&(lt(this,st)?Kt(this,st,!1):this.parent.setSelected(this))}focusout(pt){var yt;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Et=pt.relatedTarget;Et!=null&&Et.closest(`#${this.id}`)||(pt.preventDefault(),(yt=this.parent)!=null&&yt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(pt,Et,yt,Tt){const[kt,Bt]=this.parentDimensions;[yt,Tt]=this.screenToPageTranslation(yt,Tt),this.x=(pt+yt)/kt,this.y=(Et+Tt)/Bt,this.fixAndSetPosition()}translate(pt,Et){$t(this,ht,Dr).call(this,this.parentDimensions,pt,Et)}translateInPage(pt,Et){$t(this,ht,Dr).call(this,this.pageDimensions,pt,Et),this.div.scrollIntoView({block:"nearest"})}drag(pt,Et){const[yt,Tt]=this.parentDimensions;if(this.x+=pt/yt,this.y+=Et/Tt,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Zt,y:ee}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Zt,ee)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:kt,y:Bt}=this;const[Yt,zt]=$t(this,_t,Rr).call(this);kt+=Yt,Bt+=zt,this.div.style.left=`${(100*kt).toFixed(2)}%`,this.div.style.top=`${(100*Bt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[pt,Et]=this.pageDimensions;let{x:yt,y:Tt,width:kt,height:Bt}=this;switch(kt*=pt,Bt*=Et,yt*=pt,Tt*=Et,this.rotation){case 0:yt=Math.max(0,Math.min(pt-kt,yt)),Tt=Math.max(0,Math.min(Et-Bt,Tt));break;case 90:yt=Math.max(0,Math.min(pt-Bt,yt)),Tt=Math.min(Et,Math.max(kt,Tt));break;case 180:yt=Math.min(pt,Math.max(kt,yt)),Tt=Math.min(Et,Math.max(Bt,Tt));break;case 270:yt=Math.min(pt,Math.max(Bt,yt)),Tt=Math.max(0,Math.min(Et-kt,Tt));break}this.x=yt/=pt,this.y=Tt/=Et;const[Yt,zt]=$t(this,_t,Rr).call(this);yt+=Yt,Tt+=zt;const{style:Zt}=this.div;Zt.left=`${(100*yt).toFixed(2)}%`,Zt.top=`${(100*Tt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(pt,Et){var yt;return $t(yt=ot,bt,kr).call(yt,pt,Et,this.parentRotation)}pageTranslationToScreen(pt,Et){var yt;return $t(yt=ot,bt,kr).call(yt,pt,Et,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:pt,pageDimensions:[Et,yt]}=this,Tt=Et*pt,kt=yt*pt;return U.FeatureTest.isCSSRoundSupported?[Math.round(Tt),Math.round(kt)]:[Tt,kt]}setDims(pt,Et){var kt;const[yt,Tt]=this.parentDimensions;this.div.style.width=`${(100*pt/yt).toFixed(2)}%`,lt(this,Q)||(this.div.style.height=`${(100*Et/Tt).toFixed(2)}%`),(kt=lt(this,z))==null||kt.classList.toggle("small",pt<ot.SMALL_EDITOR_SIZE||Et<ot.SMALL_EDITOR_SIZE)}fixDims(){const{style:pt}=this.div,{height:Et,width:yt}=pt,Tt=yt.endsWith("%"),kt=!lt(this,Q)&&Et.endsWith("%");if(Tt&&kt)return;const[Bt,Yt]=this.parentDimensions;Tt||(pt.width=`${(100*parseFloat(yt)/Bt).toFixed(2)}%`),!lt(this,Q)&&!kt&&(pt.height=`${(100*parseFloat(Et)/Yt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(lt(this,z))return;const pt=Kt(this,z,document.createElement("button"));pt.className="altText";const Et=await ot._l10nPromise.get("editor_alt_text_button_label");pt.textContent=Et,pt.setAttribute("aria-label",Et),pt.tabIndex="0",pt.addEventListener("contextmenu",G.noContextMenu),pt.addEventListener("pointerdown",yt=>yt.stopPropagation()),pt.addEventListener("click",yt=>{yt.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),pt.addEventListener("keydown",yt=>{yt.target===pt&&yt.key==="Enter"&&(yt.preventDefault(),this._uiManager.editAltText(this))}),$t(this,Qt,Or).call(this),this.div.append(pt),ot.SMALL_EDITOR_SIZE||(ot.SMALL_EDITOR_SIZE=Math.min(128,Math.round(pt.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:lt(this,Y),decorative:lt(this,W)}}set altTextData({altText:pt,decorative:Et}){lt(this,Y)===pt&&lt(this,W)===Et||(Kt(this,Y,pt),Kt(this,W,Et),$t(this,Qt,Or).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",lt(this,it)),this.div.addEventListener("focusout",lt(this,rt));const[pt,Et]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Et/pt).toFixed(2)}%`,this.div.style.maxHeight=`${(100*pt/Et).toFixed(2)}%`);const[yt,Tt]=this.getInitialTranslation();return this.translate(yt,Tt),(0,O.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(pt){const{isMac:Et}=U.FeatureTest.platform;if(pt.button!==0||pt.ctrlKey&&Et){pt.preventDefault();return}Kt(this,st,!0),$t(this,qt,gi).call(this,pt)}moveInDOM(){var pt;(pt=this.parent)==null||pt.moveEditorInDOM(this)}_setParentAndPosition(pt,Et,yt){pt.changeParent(this),this.x=Et,this.y=yt,this.fixAndSetPosition()}getRect(pt,Et){const yt=this.parentScale,[Tt,kt]=this.pageDimensions,[Bt,Yt]=this.pageTranslation,zt=pt/yt,Zt=Et/yt,ee=this.x*Tt,he=this.y*kt,ne=this.width*Tt,be=this.height*kt;switch(this.rotation){case 0:return[ee+zt+Bt,kt-he-Zt-be+Yt,ee+zt+ne+Bt,kt-he-Zt+Yt];case 90:return[ee+Zt+Bt,kt-he+zt+Yt,ee+Zt+be+Bt,kt-he+zt+ne+Yt];case 180:return[ee-zt-ne+Bt,kt-he+Zt+Yt,ee-zt+Bt,kt-he+Zt+be+Yt];case 270:return[ee-Zt-be+Bt,kt-he-zt-ne+Yt,ee-Zt+Bt,kt-he-zt+Yt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(pt,Et){const[yt,Tt,kt,Bt]=pt,Yt=kt-yt,zt=Bt-Tt;switch(this.rotation){case 0:return[yt,Et-Bt,Yt,zt];case 90:return[yt,Et-Tt,zt,Yt];case 180:return[kt,Et-Tt,Yt,zt];case 270:return[kt,Et-Bt,zt,Yt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Kt(this,ct,!0)}disableEditMode(){Kt(this,ct,!1)}isInEditMode(){return lt(this,ct)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var pt,Et;(pt=this.div)==null||pt.addEventListener("focusin",lt(this,it)),(Et=this.div)==null||Et.addEventListener("focusout",lt(this,rt))}serialize(pt=!1,Et=null){(0,U.unreachable)("An editor must be serializable")}static deserialize(pt,Et,yt){const Tt=new this.prototype.constructor({parent:Et,id:Et.getNextId(),uiManager:yt});Tt.rotation=pt.rotation;const[kt,Bt]=Tt.pageDimensions,[Yt,zt,Zt,ee]=Tt.getRectInCurrentCoords(pt.rect,Bt);return Tt.x=Yt/kt,Tt.y=zt/Bt,Tt.width=Zt/kt,Tt.height=ee/Bt,Tt}remove(){var pt;this.div.removeEventListener("focusin",lt(this,it)),this.div.removeEventListener("focusout",lt(this,rt)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(pt=lt(this,z))==null||pt.remove(),Kt(this,z,null),Kt(this,K,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&($t(this,xt,di).call(this),lt(this,et).classList.remove("hidden"))}select(){var pt;this.makeResizable(),(pt=this.div)==null||pt.classList.add("selectedEditor")}unselect(){var pt,Et,yt;(pt=lt(this,et))==null||pt.classList.add("hidden"),(Et=this.div)==null||Et.classList.remove("selectedEditor"),(yt=this.div)!=null&&yt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(pt,Et){}disableEditing(){lt(this,z)&&(lt(this,z).hidden=!0)}enableEditing(){lt(this,z)&&(lt(this,z).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return lt(this,at)}set isEditing(pt){Kt(this,at,pt),this.parent&&(pt?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(pt,Et){Kt(this,Q,!0);const yt=pt/Et,{style:Tt}=this.div;Tt.aspectRatio=yt,Tt.height="auto"}static get MIN_SIZE(){return 16}};Y=new WeakMap,W=new WeakMap,z=new WeakMap,K=new WeakMap,J=new WeakMap,Q=new WeakMap,et=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakMap,at=new WeakMap,ct=new WeakMap,dt=new WeakMap,nt=new WeakMap,ht=new WeakSet,Dr=function([pt,Et],yt,Tt){[yt,Tt]=this.screenToPageTranslation(yt,Tt),this.x+=yt/pt,this.y+=Tt/Et,this.fixAndSetPosition()},_t=new WeakSet,Rr=function(){const[pt,Et]=this.parentDimensions,{_borderLineWidth:yt}=ot,Tt=yt/pt,kt=yt/Et;switch(this.rotation){case 90:return[-Tt,kt];case 180:return[Tt,kt];case 270:return[Tt,-kt];default:return[-Tt,-kt]}},bt=new WeakSet,kr=function(pt,Et,yt){switch(yt){case 90:return[Et,-pt];case 180:return[-pt,-Et];case 270:return[-Et,pt];default:return[pt,Et]}},At=new WeakSet,Fr=function(pt){switch(pt){case 90:{const[Et,yt]=this.pageDimensions;return[0,-Et/yt,yt/Et,0]}case 180:return[-1,0,0,-1];case 270:{const[Et,yt]=this.pageDimensions;return[0,Et/yt,-yt/Et,0]}default:return[1,0,0,1]}},xt=new WeakSet,di=function(){if(lt(this,et))return;Kt(this,et,document.createElement("div")),lt(this,et).classList.add("resizers");const pt=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||pt.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Et of pt){const yt=document.createElement("div");lt(this,et).append(yt),yt.classList.add("resizer",Et),yt.addEventListener("pointerdown",$t(this,Ft,fi).bind(this,Et)),yt.addEventListener("contextmenu",G.noContextMenu)}this.div.prepend(lt(this,et))},Ft=new WeakSet,fi=function(pt,Et){Et.preventDefault();const{isMac:yt}=U.FeatureTest.platform;if(Et.button!==0||Et.ctrlKey&&yt)return;const Tt=$t(this,Dt,pi).bind(this,pt),kt=this._isDraggable;this._isDraggable=!1;const Bt={passive:!0,capture:!0};window.addEventListener("pointermove",Tt,Bt);const Yt=this.x,zt=this.y,Zt=this.width,ee=this.height,he=this.parent.div.style.cursor,ne=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Et.target).cursor;const be=()=>{this._isDraggable=kt,window.removeEventListener("pointerup",be),window.removeEventListener("blur",be),window.removeEventListener("pointermove",Tt,Bt),this.parent.div.style.cursor=he,this.div.style.cursor=ne;const Ce=this.x,de=this.y,xe=this.width,se=this.height;Ce===Yt&&de===zt&&xe===Zt&&se===ee||this.addCommands({cmd:()=>{this.width=xe,this.height=se,this.x=Ce,this.y=de;const[Gt,Vt]=this.parentDimensions;this.setDims(Gt*xe,Vt*se),this.fixAndSetPosition()},undo:()=>{this.width=Zt,this.height=ee,this.x=Yt,this.y=zt;const[Gt,Vt]=this.parentDimensions;this.setDims(Gt*Zt,Vt*ee),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",be),window.addEventListener("blur",be)},Dt=new WeakSet,pi=function(pt,Et){const[yt,Tt]=this.parentDimensions,kt=this.x,Bt=this.y,Yt=this.width,zt=this.height,Zt=ot.MIN_SIZE/yt,ee=ot.MIN_SIZE/Tt,he=ae=>Math.round(ae*1e4)/1e4,ne=$t(this,At,Fr).call(this,this.rotation),be=(ae,ce)=>[ne[0]*ae+ne[2]*ce,ne[1]*ae+ne[3]*ce],Ce=$t(this,At,Fr).call(this,360-this.rotation),de=(ae,ce)=>[Ce[0]*ae+Ce[2]*ce,Ce[1]*ae+Ce[3]*ce];let xe,se,Gt=!1,Vt=!1;switch(pt){case"topLeft":Gt=!0,xe=(ae,ce)=>[0,0],se=(ae,ce)=>[ae,ce];break;case"topMiddle":xe=(ae,ce)=>[ae/2,0],se=(ae,ce)=>[ae/2,ce];break;case"topRight":Gt=!0,xe=(ae,ce)=>[ae,0],se=(ae,ce)=>[0,ce];break;case"middleRight":Vt=!0,xe=(ae,ce)=>[ae,ce/2],se=(ae,ce)=>[0,ce/2];break;case"bottomRight":Gt=!0,xe=(ae,ce)=>[ae,ce],se=(ae,ce)=>[0,0];break;case"bottomMiddle":xe=(ae,ce)=>[ae/2,ce],se=(ae,ce)=>[ae/2,0];break;case"bottomLeft":Gt=!0,xe=(ae,ce)=>[0,ce],se=(ae,ce)=>[ae,0];break;case"middleLeft":Vt=!0,xe=(ae,ce)=>[0,ce/2],se=(ae,ce)=>[ae,ce/2];break}const ie=xe(Yt,zt),fe=se(Yt,zt);let pe=be(...fe);const Te=he(kt+pe[0]),ke=he(Bt+pe[1]);let Pe=1,Re=1,[Oe,Fe]=this.screenToPageTranslation(Et.movementX,Et.movementY);if([Oe,Fe]=de(Oe/yt,Fe/Tt),Gt){const ae=Math.hypot(Yt,zt);Pe=Re=Math.max(Math.min(Math.hypot(fe[0]-ie[0]-Oe,fe[1]-ie[1]-Fe)/ae,1/Yt,1/zt),Zt/Yt,ee/zt)}else Vt?Pe=Math.max(Zt,Math.min(1,Math.abs(fe[0]-ie[0]-Oe)))/Yt:Re=Math.max(ee,Math.min(1,Math.abs(fe[1]-ie[1]-Fe)))/zt;const Me=he(Yt*Pe),te=he(zt*Re);pe=be(...se(Me,te));const Xt=Te-pe[0],jt=ke-pe[1];this.width=Me,this.height=te,this.x=Xt,this.y=jt,this.setDims(yt*Me,Tt*te),this.fixAndSetPosition()},Qt=new WeakSet,Or=async function(){var yt;const pt=lt(this,z);if(!pt)return;if(!lt(this,Y)&&!lt(this,W)){pt.classList.remove("done"),(yt=lt(this,K))==null||yt.remove();return}ot._l10nPromise.get("editor_alt_text_edit_button_label").then(Tt=>{pt.setAttribute("aria-label",Tt)});let Et=lt(this,K);if(!Et){Kt(this,K,Et=document.createElement("span")),Et.className="tooltip",Et.setAttribute("role","tooltip");const Tt=Et.id=`alt-text-tooltip-${this.id}`;pt.setAttribute("aria-describedby",Tt);const kt=100;pt.addEventListener("mouseenter",()=>{Kt(this,J,setTimeout(()=>{Kt(this,J,null),lt(this,K).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},kt))}),pt.addEventListener("mouseleave",()=>{var Bt;clearTimeout(lt(this,J)),Kt(this,J,null),(Bt=lt(this,K))==null||Bt.classList.remove("show")})}pt.classList.add("done"),Et.innerText=lt(this,W)?await ot._l10nPromise.get("editor_alt_text_decorative_tooltip"):lt(this,Y),Et.parentNode||pt.append(Et)},qt=new WeakSet,gi=function(pt){if(!this._isDraggable)return;const Et=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let yt,Tt;Et&&(yt={passive:!0,capture:!0},Tt=Bt=>{const[Yt,zt]=this.screenToPageTranslation(Bt.movementX,Bt.movementY);this._uiManager.dragSelectedEditors(Yt,zt)},window.addEventListener("pointermove",Tt,yt));const kt=()=>{if(window.removeEventListener("pointerup",kt),window.removeEventListener("blur",kt),Et&&window.removeEventListener("pointermove",Tt,yt),Kt(this,st,!1),!this._uiManager.endDragSession()){const{isMac:Bt}=U.FeatureTest.platform;pt.ctrlKey&&!Bt||pt.shiftKey||pt.metaKey&&Bt?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",kt),window.addEventListener("blur",kt)},It(ot,bt),He(ot,"_borderLineWidth",-1),He(ot,"_colorManager",new O.ColorManager),He(ot,"_zIndex",1),He(ot,"SMALL_EDITOR_SIZE",0);let X=ot;D.AnnotationEditor=X;class tt extends X{constructor(pt){super(pt),this.annotationElementId=pt.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(B,D,F)=>{var Q,et,it,rt,st,Ir,dt,nt,ht,vt,_t,_i,gt,At,St,xt,Pt,Ft,Mt,Dt,Ut,Qt,Lt,qt,wt,ot,mt,pt,Et,yt,Tt,kt,Bt,Yt,zt,Zt,ee,he,ne,be,Ce,de,xe,se,Gt,Vt,ie,mi,pe,Mr,ke,Br,Re,pr,Fe,Ur,te,Nr,jt,Xe,ce,sr,je,bi,ue,xi,ge,Lr,we,ar,le,$r;Object.defineProperty(D,"__esModule",{value:!0}),D.KeyboardManager=D.CommandManager=D.ColorManager=D.AnnotationEditorUIManager=void 0,D.bindEvents=G,D.opacityToHex=X;var O=F(1),U=F(6);function G(Rt,ft,Ct){for(const Ot of Ct)ft.addEventListener(Ot,Rt[Ot].bind(Rt))}function X(Rt){return Math.round(Math.min(255,Math.max(1,255*Rt))).toString(16).padStart(2,"0")}class tt{constructor(){It(this,Q,0)}getId(){return`${O.AnnotationEditorPrefix}${nr(this,Q)._++}`}}Q=new WeakMap;const ct=class ct{constructor(){It(this,st);It(this,et,(0,O.getUuid)());It(this,it,0);It(this,rt,null)}static get _isSVGFittingCanvas(){const ft='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ot=new OffscreenCanvas(1,3).getContext("2d"),Nt=new Image;Nt.src=ft;const Wt=Nt.decode().then(()=>(Ot.drawImage(Nt,0,0,1,1,0,0,1,3),new Uint32Array(Ot.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,O.shadow)(this,"_isSVGFittingCanvas",Wt)}async getFromFile(ft){const{lastModified:Ct,name:Ot,size:Nt,type:Wt}=ft;return $t(this,st,Ir).call(this,`${Ct}_${Ot}_${Nt}_${Wt}`,ft)}async getFromUrl(ft){return $t(this,st,Ir).call(this,ft,ft)}async getFromId(ft){lt(this,rt)||Kt(this,rt,new Map);const Ct=lt(this,rt).get(ft);return Ct?Ct.bitmap?(Ct.refCounter+=1,Ct):Ct.file?this.getFromFile(Ct.file):this.getFromUrl(Ct.url):null}getSvgUrl(ft){const Ct=lt(this,rt).get(ft);return Ct!=null&&Ct.isSvg?Ct.svgUrl:null}deleteId(ft){lt(this,rt)||Kt(this,rt,new Map);const Ct=lt(this,rt).get(ft);Ct&&(Ct.refCounter-=1,Ct.refCounter===0&&(Ct.bitmap=null))}isValidId(ft){return ft.startsWith(`image_${lt(this,et)}_`)}};et=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakSet,Ir=async function(ft,Ct){lt(this,rt)||Kt(this,rt,new Map);let Ot=lt(this,rt).get(ft);if(Ot===null)return null;if(Ot!=null&&Ot.bitmap)return Ot.refCounter+=1,Ot;try{Ot||(Ot={bitmap:null,id:`image_${lt(this,et)}_${nr(this,it)._++}`,refCounter:0,isSvg:!1});let Nt;if(typeof Ct=="string"){Ot.url=Ct;const Wt=await fetch(Ct);if(!Wt.ok)throw new Error(Wt.statusText);Nt=await Wt.blob()}else Nt=Ot.file=Ct;if(Nt.type==="image/svg+xml"){const Wt=ct._isSVGFittingCanvas,Jt=new FileReader,oe=new Image,me=new Promise((_e,Ie)=>{oe.onload=()=>{Ot.bitmap=oe,Ot.isSvg=!0,_e()},Jt.onload=async()=>{const ve=Ot.svgUrl=Jt.result;oe.src=await Wt?`${ve}#svgView(preserveAspectRatio(none))`:ve},oe.onerror=Jt.onerror=Ie});Jt.readAsDataURL(Nt),await me}else Ot.bitmap=await createImageBitmap(Nt);Ot.refCounter=1}catch(Nt){console.error(Nt),Ot=null}return lt(this,rt).set(ft,Ot),Ot&&lt(this,rt).set(Ot.id,Ot),Ot};let Y=ct;class W{constructor(ft=128){It(this,dt,[]);It(this,nt,!1);It(this,ht,void 0);It(this,vt,-1);Kt(this,ht,ft)}add({cmd:ft,undo:Ct,mustExec:Ot,type:Nt=NaN,overwriteIfSameType:Wt=!1,keepUndo:Jt=!1}){if(Ot&&ft(),lt(this,nt))return;const oe={cmd:ft,undo:Ct,type:Nt};if(lt(this,vt)===-1){lt(this,dt).length>0&&(lt(this,dt).length=0),Kt(this,vt,0),lt(this,dt).push(oe);return}if(Wt&&lt(this,dt)[lt(this,vt)].type===Nt){Jt&&(oe.undo=lt(this,dt)[lt(this,vt)].undo),lt(this,dt)[lt(this,vt)]=oe;return}const me=lt(this,vt)+1;me===lt(this,ht)?lt(this,dt).splice(0,1):(Kt(this,vt,me),me<lt(this,dt).length&&lt(this,dt).splice(me)),lt(this,dt).push(oe)}undo(){lt(this,vt)!==-1&&(Kt(this,nt,!0),lt(this,dt)[lt(this,vt)].undo(),Kt(this,nt,!1),Kt(this,vt,lt(this,vt)-1))}redo(){lt(this,vt)<lt(this,dt).length-1&&(Kt(this,vt,lt(this,vt)+1),Kt(this,nt,!0),lt(this,dt)[lt(this,vt)].cmd(),Kt(this,nt,!1))}hasSomethingToUndo(){return lt(this,vt)!==-1}hasSomethingToRedo(){return lt(this,vt)<lt(this,dt).length-1}destroy(){Kt(this,dt,null)}}dt=new WeakMap,nt=new WeakMap,ht=new WeakMap,vt=new WeakMap,D.CommandManager=W;class z{constructor(ft){It(this,_t);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Ct}=O.FeatureTest.platform;for(const[Ot,Nt,Wt={}]of ft)for(const Jt of Ot){const oe=Jt.startsWith("mac+");Ct&&oe?(this.callbacks.set(Jt.slice(4),{callback:Nt,options:Wt}),this.allKeys.add(Jt.split("+").at(-1))):!Ct&&!oe&&(this.callbacks.set(Jt,{callback:Nt,options:Wt}),this.allKeys.add(Jt.split("+").at(-1)))}}exec(ft,Ct){if(!this.allKeys.has(Ct.key))return;const Ot=this.callbacks.get($t(this,_t,_i).call(this,Ct));if(!Ot)return;const{callback:Nt,options:{bubbles:Wt=!1,args:Jt=[],checker:oe=null}}=Ot;oe&&!oe(ft,Ct)||(Nt.bind(ft,...Jt)(),Wt||(Ct.stopPropagation(),Ct.preventDefault()))}}_t=new WeakSet,_i=function(ft){ft.altKey&&this.buffer.push("alt"),ft.ctrlKey&&this.buffer.push("ctrl"),ft.metaKey&&this.buffer.push("meta"),ft.shiftKey&&this.buffer.push("shift"),this.buffer.push(ft.key);const Ct=this.buffer.join("+");return this.buffer.length=0,Ct},D.KeyboardManager=z;const bt=class bt{get _colors(){const ft=new Map([["CanvasText",null],["Canvas",null]]);return(0,U.getColorValues)(ft),(0,O.shadow)(this,"_colors",ft)}convert(ft){const Ct=(0,U.getRGB)(ft);if(!window.matchMedia("(forced-colors: active)").matches)return Ct;for(const[Ot,Nt]of this._colors)if(Nt.every((Wt,Jt)=>Wt===Ct[Jt]))return bt._colorsMapping.get(Ot);return Ct}getHexCode(ft){const Ct=this._colors.get(ft);return Ct?O.Util.makeHexColor(...Ct):ft}};He(bt,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let K=bt;D.ColorManager=K;const ye=class ye{constructor(ft,Ct,Ot,Nt,Wt,Jt){It(this,ie);It(this,pe);It(this,ke);It(this,Re);It(this,Fe);It(this,te);It(this,jt);It(this,ce);It(this,je);It(this,ue);It(this,ge);It(this,we);It(this,le);It(this,gt,null);It(this,At,new Map);It(this,St,new Map);It(this,xt,null);It(this,Pt,null);It(this,Ft,new W);It(this,Mt,0);It(this,Dt,new Set);It(this,Ut,null);It(this,Qt,null);It(this,Lt,new Set);It(this,qt,null);It(this,wt,new tt);It(this,ot,!1);It(this,mt,!1);It(this,pt,null);It(this,Et,O.AnnotationEditorType.NONE);It(this,yt,new Set);It(this,Tt,null);It(this,kt,this.blur.bind(this));It(this,Bt,this.focus.bind(this));It(this,Yt,this.copy.bind(this));It(this,zt,this.cut.bind(this));It(this,Zt,this.paste.bind(this));It(this,ee,this.keydown.bind(this));It(this,he,this.onEditingAction.bind(this));It(this,ne,this.onPageChanging.bind(this));It(this,be,this.onScaleChanging.bind(this));It(this,Ce,this.onRotationChanging.bind(this));It(this,de,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});It(this,xe,[0,0]);It(this,se,null);It(this,Gt,null);It(this,Vt,null);Kt(this,Gt,ft),Kt(this,Vt,Ct),Kt(this,xt,Ot),this._eventBus=Nt,this._eventBus._on("editingaction",lt(this,he)),this._eventBus._on("pagechanging",lt(this,ne)),this._eventBus._on("scalechanging",lt(this,be)),this._eventBus._on("rotationchanging",lt(this,Ce)),Kt(this,Pt,Wt.annotationStorage),Kt(this,qt,Wt.filterFactory),Kt(this,Tt,Jt),this.viewParameters={realScale:U.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const ft=ye.prototype,Ct=Wt=>{const{activeElement:Jt}=document;return Jt&&lt(Wt,Gt).contains(Jt)&&Wt.hasSomethingToControl()},Ot=this.TRANSLATE_SMALL,Nt=this.TRANSLATE_BIG;return(0,O.shadow)(this,"_keyboardManager",new z([[["ctrl+a","mac+meta+a"],ft.selectAll],[["ctrl+z","mac+meta+z"],ft.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],ft.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],ft.delete],[["Escape","mac+Escape"],ft.unselectAll],[["ArrowLeft","mac+ArrowLeft"],ft.translateSelectedEditors,{args:[-Ot,0],checker:Ct}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],ft.translateSelectedEditors,{args:[-Nt,0],checker:Ct}],[["ArrowRight","mac+ArrowRight"],ft.translateSelectedEditors,{args:[Ot,0],checker:Ct}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],ft.translateSelectedEditors,{args:[Nt,0],checker:Ct}],[["ArrowUp","mac+ArrowUp"],ft.translateSelectedEditors,{args:[0,-Ot],checker:Ct}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],ft.translateSelectedEditors,{args:[0,-Nt],checker:Ct}],[["ArrowDown","mac+ArrowDown"],ft.translateSelectedEditors,{args:[0,Ot],checker:Ct}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],ft.translateSelectedEditors,{args:[0,Nt],checker:Ct}]]))}destroy(){$t(this,Re,pr).call(this),$t(this,pe,Mr).call(this),this._eventBus._off("editingaction",lt(this,he)),this._eventBus._off("pagechanging",lt(this,ne)),this._eventBus._off("scalechanging",lt(this,be)),this._eventBus._off("rotationchanging",lt(this,Ce));for(const ft of lt(this,St).values())ft.destroy();lt(this,St).clear(),lt(this,At).clear(),lt(this,Lt).clear(),Kt(this,gt,null),lt(this,yt).clear(),lt(this,Ft).destroy(),lt(this,xt).destroy()}get hcmFilter(){return(0,O.shadow)(this,"hcmFilter",lt(this,Tt)?lt(this,qt).addHCMFilter(lt(this,Tt).foreground,lt(this,Tt).background):"none")}get direction(){return(0,O.shadow)(this,"direction",getComputedStyle(lt(this,Gt)).direction)}editAltText(ft){var Ct;(Ct=lt(this,xt))==null||Ct.editAltText(this,ft)}onPageChanging({pageNumber:ft}){Kt(this,Mt,ft-1)}focusMainContainer(){lt(this,Gt).focus()}findParent(ft,Ct){for(const Ot of lt(this,St).values()){const{x:Nt,y:Wt,width:Jt,height:oe}=Ot.div.getBoundingClientRect();if(ft>=Nt&&ft<=Nt+Jt&&Ct>=Wt&&Ct<=Wt+oe)return Ot}return null}disableUserSelect(ft=!1){lt(this,Vt).classList.toggle("noUserSelect",ft)}addShouldRescale(ft){lt(this,Lt).add(ft)}removeShouldRescale(ft){lt(this,Lt).delete(ft)}onScaleChanging({scale:ft}){this.commitOrRemove(),this.viewParameters.realScale=ft*U.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Ct of lt(this,Lt))Ct.onScaleChanging()}onRotationChanging({pagesRotation:ft}){this.commitOrRemove(),this.viewParameters.rotation=ft}addToAnnotationStorage(ft){!ft.isEmpty()&&lt(this,Pt)&&!lt(this,Pt).has(ft.id)&&lt(this,Pt).setValue(ft.id,ft)}blur(){if(!this.hasSelection)return;const{activeElement:ft}=document;for(const Ct of lt(this,yt))if(Ct.div.contains(ft)){Kt(this,pt,[Ct,ft]),Ct._focusEventsAllowed=!1;break}}focus(){if(!lt(this,pt))return;const[ft,Ct]=lt(this,pt);Kt(this,pt,null),Ct.addEventListener("focusin",()=>{ft._focusEventsAllowed=!0},{once:!0}),Ct.focus()}addEditListeners(){$t(this,ke,Br).call(this),$t(this,Fe,Ur).call(this)}removeEditListeners(){$t(this,Re,pr).call(this),$t(this,te,Nr).call(this)}copy(ft){var Ot;if(ft.preventDefault(),(Ot=lt(this,gt))==null||Ot.commitOrRemove(),!this.hasSelection)return;const Ct=[];for(const Nt of lt(this,yt)){const Wt=Nt.serialize(!0);Wt&&Ct.push(Wt)}Ct.length!==0&&ft.clipboardData.setData("application/pdfjs",JSON.stringify(Ct))}cut(ft){this.copy(ft),this.delete()}paste(ft){ft.preventDefault();const{clipboardData:Ct}=ft;for(const Wt of Ct.items)for(const Jt of lt(this,Qt))if(Jt.isHandlingMimeForPasting(Wt.type)){Jt.paste(Wt,this.currentLayer);return}let Ot=Ct.getData("application/pdfjs");if(!Ot)return;try{Ot=JSON.parse(Ot)}catch(Wt){(0,O.warn)(`paste: "${Wt.message}".`);return}if(!Array.isArray(Ot))return;this.unselectAll();const Nt=this.currentLayer;try{const Wt=[];for(const me of Ot){const _e=Nt.deserialize(me);if(!_e)return;Wt.push(_e)}const Jt=()=>{for(const me of Wt)$t(this,ge,Lr).call(this,me);$t(this,le,$r).call(this,Wt)},oe=()=>{for(const me of Wt)me.remove()};this.addCommands({cmd:Jt,undo:oe,mustExec:!0})}catch(Wt){(0,O.warn)(`paste: "${Wt.message}".`)}}keydown(ft){var Ct;(Ct=this.getActive())!=null&&Ct.shouldGetKeyboardEvents()||ye._keyboardManager.exec(this,ft)}onEditingAction(ft){["undo","redo","delete","selectAll"].includes(ft.name)&&this[ft.name]()}setEditingState(ft){ft?($t(this,ie,mi).call(this),$t(this,ke,Br).call(this),$t(this,Fe,Ur).call(this),$t(this,jt,Xe).call(this,{isEditing:lt(this,Et)!==O.AnnotationEditorType.NONE,isEmpty:$t(this,we,ar).call(this),hasSomethingToUndo:lt(this,Ft).hasSomethingToUndo(),hasSomethingToRedo:lt(this,Ft).hasSomethingToRedo(),hasSelectedEditor:!1})):($t(this,pe,Mr).call(this),$t(this,Re,pr).call(this),$t(this,te,Nr).call(this),$t(this,jt,Xe).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(ft){if(!lt(this,Qt)){Kt(this,Qt,ft);for(const Ct of lt(this,Qt))$t(this,ce,sr).call(this,Ct.defaultPropertiesToUpdate)}}getId(){return lt(this,wt).getId()}get currentLayer(){return lt(this,St).get(lt(this,Mt))}getLayer(ft){return lt(this,St).get(ft)}get currentPageIndex(){return lt(this,Mt)}addLayer(ft){lt(this,St).set(ft.pageIndex,ft),lt(this,ot)?ft.enable():ft.disable()}removeLayer(ft){lt(this,St).delete(ft.pageIndex)}updateMode(ft,Ct=null){if(lt(this,Et)!==ft){if(Kt(this,Et,ft),ft===O.AnnotationEditorType.NONE){this.setEditingState(!1),$t(this,ue,xi).call(this);return}this.setEditingState(!0),$t(this,je,bi).call(this),this.unselectAll();for(const Ot of lt(this,St).values())Ot.updateMode(ft);if(Ct){for(const Ot of lt(this,At).values())if(Ot.annotationElementId===Ct){this.setSelected(Ot),Ot.enterInEditMode();break}}}}updateToolbar(ft){ft!==lt(this,Et)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:ft})}updateParams(ft,Ct){if(lt(this,Qt)){if(ft===O.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(ft);return}for(const Ot of lt(this,yt))Ot.updateParams(ft,Ct);for(const Ot of lt(this,Qt))Ot.updateDefaultParams(ft,Ct)}}enableWaiting(ft=!1){if(lt(this,mt)!==ft){Kt(this,mt,ft);for(const Ct of lt(this,St).values())ft?Ct.disableClick():Ct.enableClick(),Ct.div.classList.toggle("waiting",ft)}}getEditors(ft){const Ct=[];for(const Ot of lt(this,At).values())Ot.pageIndex===ft&&Ct.push(Ot);return Ct}getEditor(ft){return lt(this,At).get(ft)}addEditor(ft){lt(this,At).set(ft.id,ft)}removeEditor(ft){var Ct;lt(this,At).delete(ft.id),this.unselect(ft),(!ft.annotationElementId||!lt(this,Dt).has(ft.annotationElementId))&&((Ct=lt(this,Pt))==null||Ct.remove(ft.id))}addDeletedAnnotationElement(ft){lt(this,Dt).add(ft.annotationElementId),ft.deleted=!0}isDeletedAnnotationElement(ft){return lt(this,Dt).has(ft)}removeDeletedAnnotationElement(ft){lt(this,Dt).delete(ft.annotationElementId),ft.deleted=!1}setActiveEditor(ft){lt(this,gt)!==ft&&(Kt(this,gt,ft),ft&&$t(this,ce,sr).call(this,ft.propertiesToUpdate))}toggleSelected(ft){if(lt(this,yt).has(ft)){lt(this,yt).delete(ft),ft.unselect(),$t(this,jt,Xe).call(this,{hasSelectedEditor:this.hasSelection});return}lt(this,yt).add(ft),ft.select(),$t(this,ce,sr).call(this,ft.propertiesToUpdate),$t(this,jt,Xe).call(this,{hasSelectedEditor:!0})}setSelected(ft){for(const Ct of lt(this,yt))Ct!==ft&&Ct.unselect();lt(this,yt).clear(),lt(this,yt).add(ft),ft.select(),$t(this,ce,sr).call(this,ft.propertiesToUpdate),$t(this,jt,Xe).call(this,{hasSelectedEditor:!0})}isSelected(ft){return lt(this,yt).has(ft)}unselect(ft){ft.unselect(),lt(this,yt).delete(ft),$t(this,jt,Xe).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return lt(this,yt).size!==0}undo(){lt(this,Ft).undo(),$t(this,jt,Xe).call(this,{hasSomethingToUndo:lt(this,Ft).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:$t(this,we,ar).call(this)})}redo(){lt(this,Ft).redo(),$t(this,jt,Xe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:lt(this,Ft).hasSomethingToRedo(),isEmpty:$t(this,we,ar).call(this)})}addCommands(ft){lt(this,Ft).add(ft),$t(this,jt,Xe).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:$t(this,we,ar).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const ft=[...lt(this,yt)],Ct=()=>{for(const Nt of ft)Nt.remove()},Ot=()=>{for(const Nt of ft)$t(this,ge,Lr).call(this,Nt)};this.addCommands({cmd:Ct,undo:Ot,mustExec:!0})}commitOrRemove(){var ft;(ft=lt(this,gt))==null||ft.commitOrRemove()}hasSomethingToControl(){return lt(this,gt)||this.hasSelection}selectAll(){for(const ft of lt(this,yt))ft.commit();$t(this,le,$r).call(this,lt(this,At).values())}unselectAll(){if(lt(this,gt)){lt(this,gt).commitOrRemove();return}if(this.hasSelection){for(const ft of lt(this,yt))ft.unselect();lt(this,yt).clear(),$t(this,jt,Xe).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(ft,Ct,Ot=!1){if(Ot||this.commitOrRemove(),!this.hasSelection)return;lt(this,xe)[0]+=ft,lt(this,xe)[1]+=Ct;const[Nt,Wt]=lt(this,xe),Jt=[...lt(this,yt)],oe=1e3;lt(this,se)&&clearTimeout(lt(this,se)),Kt(this,se,setTimeout(()=>{Kt(this,se,null),lt(this,xe)[0]=lt(this,xe)[1]=0,this.addCommands({cmd:()=>{for(const me of Jt)lt(this,At).has(me.id)&&me.translateInPage(Nt,Wt)},undo:()=>{for(const me of Jt)lt(this,At).has(me.id)&&me.translateInPage(-Nt,-Wt)},mustExec:!1})},oe));for(const me of Jt)me.translateInPage(ft,Ct)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Kt(this,Ut,new Map);for(const ft of lt(this,yt))lt(this,Ut).set(ft,{savedX:ft.x,savedY:ft.y,savedPageIndex:ft.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!lt(this,Ut))return!1;this.disableUserSelect(!1);const ft=lt(this,Ut);Kt(this,Ut,null);let Ct=!1;for(const[{x:Nt,y:Wt,pageIndex:Jt},oe]of ft)oe.newX=Nt,oe.newY=Wt,oe.newPageIndex=Jt,Ct||(Ct=Nt!==oe.savedX||Wt!==oe.savedY||Jt!==oe.savedPageIndex);if(!Ct)return!1;const Ot=(Nt,Wt,Jt,oe)=>{if(lt(this,At).has(Nt.id)){const me=lt(this,St).get(oe);me?Nt._setParentAndPosition(me,Wt,Jt):(Nt.pageIndex=oe,Nt.x=Wt,Nt.y=Jt)}};return this.addCommands({cmd:()=>{for(const[Nt,{newX:Wt,newY:Jt,newPageIndex:oe}]of ft)Ot(Nt,Wt,Jt,oe)},undo:()=>{for(const[Nt,{savedX:Wt,savedY:Jt,savedPageIndex:oe}]of ft)Ot(Nt,Wt,Jt,oe)},mustExec:!0}),!0}dragSelectedEditors(ft,Ct){if(lt(this,Ut))for(const Ot of lt(this,Ut).keys())Ot.drag(ft,Ct)}rebuild(ft){if(ft.parent===null){const Ct=this.getLayer(ft.pageIndex);Ct?(Ct.changeParent(ft),Ct.addOrRebuild(ft)):(this.addEditor(ft),this.addToAnnotationStorage(ft),ft.rebuild())}else ft.parent.addOrRebuild(ft)}isActive(ft){return lt(this,gt)===ft}getActive(){return lt(this,gt)}getMode(){return lt(this,Et)}get imageManager(){return(0,O.shadow)(this,"imageManager",new Y)}};gt=new WeakMap,At=new WeakMap,St=new WeakMap,xt=new WeakMap,Pt=new WeakMap,Ft=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Ut=new WeakMap,Qt=new WeakMap,Lt=new WeakMap,qt=new WeakMap,wt=new WeakMap,ot=new WeakMap,mt=new WeakMap,pt=new WeakMap,Et=new WeakMap,yt=new WeakMap,Tt=new WeakMap,kt=new WeakMap,Bt=new WeakMap,Yt=new WeakMap,zt=new WeakMap,Zt=new WeakMap,ee=new WeakMap,he=new WeakMap,ne=new WeakMap,be=new WeakMap,Ce=new WeakMap,de=new WeakMap,xe=new WeakMap,se=new WeakMap,Gt=new WeakMap,Vt=new WeakMap,ie=new WeakSet,mi=function(){window.addEventListener("focus",lt(this,Bt)),window.addEventListener("blur",lt(this,kt))},pe=new WeakSet,Mr=function(){window.removeEventListener("focus",lt(this,Bt)),window.removeEventListener("blur",lt(this,kt))},ke=new WeakSet,Br=function(){window.addEventListener("keydown",lt(this,ee),{capture:!0})},Re=new WeakSet,pr=function(){window.removeEventListener("keydown",lt(this,ee),{capture:!0})},Fe=new WeakSet,Ur=function(){document.addEventListener("copy",lt(this,Yt)),document.addEventListener("cut",lt(this,zt)),document.addEventListener("paste",lt(this,Zt))},te=new WeakSet,Nr=function(){document.removeEventListener("copy",lt(this,Yt)),document.removeEventListener("cut",lt(this,zt)),document.removeEventListener("paste",lt(this,Zt))},jt=new WeakSet,Xe=function(ft){Object.entries(ft).some(([Ot,Nt])=>lt(this,de)[Ot]!==Nt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(lt(this,de),ft)})},ce=new WeakSet,sr=function(ft){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:ft})},je=new WeakSet,bi=function(){if(!lt(this,ot)){Kt(this,ot,!0);for(const ft of lt(this,St).values())ft.enable()}},ue=new WeakSet,xi=function(){if(this.unselectAll(),lt(this,ot)){Kt(this,ot,!1);for(const ft of lt(this,St).values())ft.disable()}},ge=new WeakSet,Lr=function(ft){const Ct=lt(this,St).get(ft.pageIndex);Ct?Ct.addOrRebuild(ft):this.addEditor(ft)},we=new WeakSet,ar=function(){if(lt(this,At).size===0)return!0;if(lt(this,At).size===1)for(const ft of lt(this,At).values())return ft.isEmpty();return!1},le=new WeakSet,$r=function(ft){lt(this,yt).clear();for(const Ct of ft)Ct.isEmpty()||(lt(this,yt).add(Ct),Ct.select());$t(this,jt,Xe).call(this,{hasSelectedEditor:!0})},He(ye,"TRANSLATE_SMALL",1),He(ye,"TRANSLATE_BIG",10);let J=ye;D.AnnotationEditorUIManager=J},(B,D,F)=>{var Mt,Dt,Ut,Qt,Lt,qt,wt,ot,mt,pt,Et,yt,Qe,kt,tr,Yt,jr,Zt,gr,he,_r,be,or,de,lr;Object.defineProperty(D,"__esModule",{value:!0}),D.StatTimer=D.RenderingCancelledException=D.PixelsPerInch=D.PageViewport=D.PDFDateString=D.DOMStandardFontDataFactory=D.DOMSVGFactory=D.DOMFilterFactory=D.DOMCanvasFactory=D.DOMCMapReaderFactory=void 0,D.deprecated=vt,D.getColorValues=At,D.getCurrentTransform=St,D.getCurrentTransformInverse=xt,D.getFilenameFromUrl=st,D.getPdfFilenameFromUrl=at,D.getRGB=gt,D.getXfaPageViewport=bt,D.isDataScheme=it,D.isPdfFile=rt,D.isValidFetchUrl=dt,D.loadScript=ht,D.noContextMenu=nt,D.setLayerDimensions=Pt;var O=F(7),U=F(1);const G="http://www.w3.org/2000/svg",Ft=class Ft{};He(Ft,"CSS",96),He(Ft,"PDF",72),He(Ft,"PDF_TO_CSS_UNITS",Ft.CSS/Ft.PDF);let X=Ft;D.PixelsPerInch=X;class tt extends O.BaseFilterFactory{constructor({docId:Vt,ownerDocument:ie=globalThis.document}={}){super();It(this,yt);It(this,kt);It(this,Yt);It(this,Zt);It(this,he);It(this,be);It(this,de);It(this,Mt,void 0);It(this,Dt,void 0);It(this,Ut,void 0);It(this,Qt,void 0);It(this,Lt,void 0);It(this,qt,void 0);It(this,wt,void 0);It(this,ot,void 0);It(this,mt,void 0);It(this,pt,void 0);It(this,Et,0);Kt(this,Ut,Vt),Kt(this,Qt,ie)}addFilter(Vt){if(!Vt)return"none";let ie=lt(this,yt,Qe).get(Vt);if(ie)return ie;let fe,pe,Te,ke;if(Vt.length===1){const Fe=Vt[0],Me=new Array(256);for(let te=0;te<256;te++)Me[te]=Fe[te]/255;ke=fe=pe=Te=Me.join(",")}else{const[Fe,Me,te]=Vt,Xt=new Array(256),jt=new Array(256),ae=new Array(256);for(let ce=0;ce<256;ce++)Xt[ce]=Fe[ce]/255,jt[ce]=Me[ce]/255,ae[ce]=te[ce]/255;fe=Xt.join(","),pe=jt.join(","),Te=ae.join(","),ke=`${fe}${pe}${Te}`}if(ie=lt(this,yt,Qe).get(ke),ie)return lt(this,yt,Qe).set(Vt,ie),ie;const Pe=`g_${lt(this,Ut)}_transfer_map_${nr(this,Et)._++}`,Re=`url(#${Pe})`;lt(this,yt,Qe).set(Vt,Re),lt(this,yt,Qe).set(ke,Re);const Oe=$t(this,Zt,gr).call(this,Pe);return $t(this,be,or).call(this,fe,pe,Te,Oe),Re}addHCMFilter(Vt,ie){var Me;const fe=`${Vt}-${ie}`;if(lt(this,qt)===fe)return lt(this,wt);if(Kt(this,qt,fe),Kt(this,wt,"none"),(Me=lt(this,Lt))==null||Me.remove(),!Vt||!ie)return lt(this,wt);const pe=$t(this,de,lr).call(this,Vt);Vt=U.Util.makeHexColor(...pe);const Te=$t(this,de,lr).call(this,ie);if(ie=U.Util.makeHexColor(...Te),lt(this,kt,tr).style.color="",Vt==="#000000"&&ie==="#ffffff"||Vt===ie)return lt(this,wt);const ke=new Array(256);for(let te=0;te<=255;te++){const Xt=te/255;ke[te]=Xt<=.03928?Xt/12.92:((Xt+.055)/1.055)**2.4}const Pe=ke.join(","),Re=`g_${lt(this,Ut)}_hcm_filter`,Oe=Kt(this,ot,$t(this,Zt,gr).call(this,Re));$t(this,be,or).call(this,Pe,Pe,Pe,Oe),$t(this,Yt,jr).call(this,Oe);const Fe=(te,Xt)=>{const jt=pe[te]/255,ae=Te[te]/255,ce=new Array(Xt+1);for(let We=0;We<=Xt;We++)ce[We]=jt+We/Xt*(ae-jt);return ce.join(",")};return $t(this,be,or).call(this,Fe(0,5),Fe(1,5),Fe(2,5),Oe),Kt(this,wt,`url(#${Re})`),lt(this,wt)}addHighlightHCMFilter(Vt,ie,fe,pe){var ae;const Te=`${Vt}-${ie}-${fe}-${pe}`;if(lt(this,mt)===Te)return lt(this,pt);if(Kt(this,mt,Te),Kt(this,pt,"none"),(ae=lt(this,ot))==null||ae.remove(),!Vt||!ie)return lt(this,pt);const[ke,Pe]=[Vt,ie].map($t(this,de,lr).bind(this));let Re=Math.round(.2126*ke[0]+.7152*ke[1]+.0722*ke[2]),Oe=Math.round(.2126*Pe[0]+.7152*Pe[1]+.0722*Pe[2]),[Fe,Me]=[fe,pe].map($t(this,de,lr).bind(this));Oe<Re&&([Re,Oe,Fe,Me]=[Oe,Re,Me,Fe]),lt(this,kt,tr).style.color="";const te=(ce,We,je)=>{const Ht=new Array(256),ue=(Oe-Re)/je,Ee=ce/255,ge=(We-ce)/(255*je);let Se=0;for(let we=0;we<=je;we++){const Ne=Math.round(Re+we*ue),le=Ee+we*ge;for(let Ue=Se;Ue<=Ne;Ue++)Ht[Ue]=le;Se=Ne+1}for(let we=Se;we<256;we++)Ht[we]=Ht[Se-1];return Ht.join(",")},Xt=`g_${lt(this,Ut)}_hcm_highlight_filter`,jt=Kt(this,ot,$t(this,Zt,gr).call(this,Xt));return $t(this,Yt,jr).call(this,jt),$t(this,be,or).call(this,te(Fe[0],Me[0],5),te(Fe[1],Me[1],5),te(Fe[2],Me[2],5),jt),Kt(this,pt,`url(#${Xt})`),lt(this,pt)}destroy(Vt=!1){Vt&&(lt(this,wt)||lt(this,pt))||(lt(this,Dt)&&(lt(this,Dt).parentNode.parentNode.remove(),Kt(this,Dt,null)),lt(this,Mt)&&(lt(this,Mt).clear(),Kt(this,Mt,null)),Kt(this,Et,0))}}Mt=new WeakMap,Dt=new WeakMap,Ut=new WeakMap,Qt=new WeakMap,Lt=new WeakMap,qt=new WeakMap,wt=new WeakMap,ot=new WeakMap,mt=new WeakMap,pt=new WeakMap,Et=new WeakMap,yt=new WeakSet,Qe=function(){return lt(this,Mt)||Kt(this,Mt,new Map)},kt=new WeakSet,tr=function(){if(!lt(this,Dt)){const Vt=lt(this,Qt).createElement("div"),{style:ie}=Vt;ie.visibility="hidden",ie.contain="strict",ie.width=ie.height=0,ie.position="absolute",ie.top=ie.left=0,ie.zIndex=-1;const fe=lt(this,Qt).createElementNS(G,"svg");fe.setAttribute("width",0),fe.setAttribute("height",0),Kt(this,Dt,lt(this,Qt).createElementNS(G,"defs")),Vt.append(fe),fe.append(lt(this,Dt)),lt(this,Qt).body.append(Vt)}return lt(this,Dt)},Yt=new WeakSet,jr=function(Vt){const ie=lt(this,Qt).createElementNS(G,"feColorMatrix");ie.setAttribute("type","matrix"),ie.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Vt.append(ie)},Zt=new WeakSet,gr=function(Vt){const ie=lt(this,Qt).createElementNS(G,"filter");return ie.setAttribute("color-interpolation-filters","sRGB"),ie.setAttribute("id",Vt),lt(this,kt,tr).append(ie),ie},he=new WeakSet,_r=function(Vt,ie,fe){const pe=lt(this,Qt).createElementNS(G,ie);pe.setAttribute("type","discrete"),pe.setAttribute("tableValues",fe),Vt.append(pe)},be=new WeakSet,or=function(Vt,ie,fe,pe){const Te=lt(this,Qt).createElementNS(G,"feComponentTransfer");pe.append(Te),$t(this,he,_r).call(this,Te,"feFuncR",Vt),$t(this,he,_r).call(this,Te,"feFuncG",ie),$t(this,he,_r).call(this,Te,"feFuncB",fe)},de=new WeakSet,lr=function(Vt){return lt(this,kt,tr).style.color=Vt,gt(getComputedStyle(lt(this,kt,tr)).getPropertyValue("color"))},D.DOMFilterFactory=tt;class Y extends O.BaseCanvasFactory{constructor({ownerDocument:Gt=globalThis.document}={}){super(),this._document=Gt}_createCanvas(Gt,Vt){const ie=this._document.createElement("canvas");return ie.width=Gt,ie.height=Vt,ie}}D.DOMCanvasFactory=Y;async function W(se,Gt=!1){if(dt(se,document.baseURI)){const Vt=await fetch(se);if(!Vt.ok)throw new Error(Vt.statusText);return Gt?new Uint8Array(await Vt.arrayBuffer()):(0,U.stringToBytes)(await Vt.text())}return new Promise((Vt,ie)=>{const fe=new XMLHttpRequest;fe.open("GET",se,!0),Gt&&(fe.responseType="arraybuffer"),fe.onreadystatechange=()=>{if(fe.readyState===XMLHttpRequest.DONE){if(fe.status===200||fe.status===0){let pe;if(Gt&&fe.response?pe=new Uint8Array(fe.response):!Gt&&fe.responseText&&(pe=(0,U.stringToBytes)(fe.responseText)),pe){Vt(pe);return}}ie(new Error(fe.statusText))}},fe.send(null)})}class z extends O.BaseCMapReaderFactory{_fetchData(Gt,Vt){return W(Gt,this.isCompressed).then(ie=>({cMapData:ie,compressionType:Vt}))}}D.DOMCMapReaderFactory=z;class K extends O.BaseStandardFontDataFactory{_fetchData(Gt){return W(Gt,!0)}}D.DOMStandardFontDataFactory=K;class J extends O.BaseSVGFactory{_createSVG(Gt){return document.createElementNS(G,Gt)}}D.DOMSVGFactory=J;class Q{constructor({viewBox:Gt,scale:Vt,rotation:ie,offsetX:fe=0,offsetY:pe=0,dontFlip:Te=!1}){this.viewBox=Gt,this.scale=Vt,this.rotation=ie,this.offsetX=fe,this.offsetY=pe;const ke=(Gt[2]+Gt[0])/2,Pe=(Gt[3]+Gt[1])/2;let Re,Oe,Fe,Me;switch(ie%=360,ie<0&&(ie+=360),ie){case 180:Re=-1,Oe=0,Fe=0,Me=1;break;case 90:Re=0,Oe=1,Fe=1,Me=0;break;case 270:Re=0,Oe=-1,Fe=-1,Me=0;break;case 0:Re=1,Oe=0,Fe=0,Me=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Te&&(Fe=-Fe,Me=-Me);let te,Xt,jt,ae;Re===0?(te=Math.abs(Pe-Gt[1])*Vt+fe,Xt=Math.abs(ke-Gt[0])*Vt+pe,jt=(Gt[3]-Gt[1])*Vt,ae=(Gt[2]-Gt[0])*Vt):(te=Math.abs(ke-Gt[0])*Vt+fe,Xt=Math.abs(Pe-Gt[1])*Vt+pe,jt=(Gt[2]-Gt[0])*Vt,ae=(Gt[3]-Gt[1])*Vt),this.transform=[Re*Vt,Oe*Vt,Fe*Vt,Me*Vt,te-Re*Vt*ke-Fe*Vt*Pe,Xt-Oe*Vt*ke-Me*Vt*Pe],this.width=jt,this.height=ae}get rawDims(){const{viewBox:Gt}=this;return(0,U.shadow)(this,"rawDims",{pageWidth:Gt[2]-Gt[0],pageHeight:Gt[3]-Gt[1],pageX:Gt[0],pageY:Gt[1]})}clone({scale:Gt=this.scale,rotation:Vt=this.rotation,offsetX:ie=this.offsetX,offsetY:fe=this.offsetY,dontFlip:pe=!1}={}){return new Q({viewBox:this.viewBox.slice(),scale:Gt,rotation:Vt,offsetX:ie,offsetY:fe,dontFlip:pe})}convertToViewportPoint(Gt,Vt){return U.Util.applyTransform([Gt,Vt],this.transform)}convertToViewportRectangle(Gt){const Vt=U.Util.applyTransform([Gt[0],Gt[1]],this.transform),ie=U.Util.applyTransform([Gt[2],Gt[3]],this.transform);return[Vt[0],Vt[1],ie[0],ie[1]]}convertToPdfPoint(Gt,Vt){return U.Util.applyInverseTransform([Gt,Vt],this.transform)}}D.PageViewport=Q;class et extends U.BaseException{constructor(Gt,Vt=0){super(Gt,"RenderingCancelledException"),this.extraDelay=Vt}}D.RenderingCancelledException=et;function it(se){const Gt=se.length;let Vt=0;for(;Vt<Gt&&se[Vt].trim()==="";)Vt++;return se.substring(Vt,Vt+5).toLowerCase()==="data:"}function rt(se){return typeof se=="string"&&/\.pdf$/i.test(se)}function st(se,Gt=!1){return Gt||([se]=se.split(/[#?]/,1)),se.substring(se.lastIndexOf("/")+1)}function at(se,Gt="document.pdf"){if(typeof se!="string")return Gt;if(it(se))return(0,U.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Gt;const Vt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,ie=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,fe=Vt.exec(se);let pe=ie.exec(fe[1])||ie.exec(fe[2])||ie.exec(fe[3]);if(pe&&(pe=pe[0],pe.includes("%")))try{pe=ie.exec(decodeURIComponent(pe))[0]}catch{}return pe||Gt}class ct{constructor(){He(this,"started",Object.create(null));He(this,"times",[])}time(Gt){Gt in this.started&&(0,U.warn)(`Timer is already running for ${Gt}`),this.started[Gt]=Date.now()}timeEnd(Gt){Gt in this.started||(0,U.warn)(`Timer has not been started for ${Gt}`),this.times.push({name:Gt,start:this.started[Gt],end:Date.now()}),delete this.started[Gt]}toString(){const Gt=[];let Vt=0;for(const{name:ie}of this.times)Vt=Math.max(ie.length,Vt);for(const{name:ie,start:fe,end:pe}of this.times)Gt.push(`${ie.padEnd(Vt)} ${pe-fe}ms
`);return Gt.join("")}}D.StatTimer=ct;function dt(se,Gt){try{const{protocol:Vt}=Gt?new URL(se,Gt):new URL(se);return Vt==="http:"||Vt==="https:"}catch{return!1}}function nt(se){se.preventDefault()}function ht(se,Gt=!1){return new Promise((Vt,ie)=>{const fe=document.createElement("script");fe.src=se,fe.onload=function(pe){Gt&&fe.remove(),Vt(pe)},fe.onerror=function(){ie(new Error(`Cannot load script at: ${fe.src}`))},(document.head||document.documentElement).append(fe)})}function vt(se){console.log("Deprecated API usage: "+se)}let _t;class ut{static toDateObject(Gt){if(!Gt||typeof Gt!="string")return null;_t||(_t=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Vt=_t.exec(Gt);if(!Vt)return null;const ie=parseInt(Vt[1],10);let fe=parseInt(Vt[2],10);fe=fe>=1&&fe<=12?fe-1:0;let pe=parseInt(Vt[3],10);pe=pe>=1&&pe<=31?pe:1;let Te=parseInt(Vt[4],10);Te=Te>=0&&Te<=23?Te:0;let ke=parseInt(Vt[5],10);ke=ke>=0&&ke<=59?ke:0;let Pe=parseInt(Vt[6],10);Pe=Pe>=0&&Pe<=59?Pe:0;const Re=Vt[7]||"Z";let Oe=parseInt(Vt[8],10);Oe=Oe>=0&&Oe<=23?Oe:0;let Fe=parseInt(Vt[9],10)||0;return Fe=Fe>=0&&Fe<=59?Fe:0,Re==="-"?(Te+=Oe,ke+=Fe):Re==="+"&&(Te-=Oe,ke-=Fe),new Date(Date.UTC(ie,fe,pe,Te,ke,Pe))}}D.PDFDateString=ut;function bt(se,{scale:Gt=1,rotation:Vt=0}){const{width:ie,height:fe}=se.attributes.style,pe=[0,0,parseInt(ie),parseInt(fe)];return new Q({viewBox:pe,scale:Gt,rotation:Vt})}function gt(se){if(se.startsWith("#")){const Gt=parseInt(se.slice(1),16);return[(Gt&16711680)>>16,(Gt&65280)>>8,Gt&255]}return se.startsWith("rgb(")?se.slice(4,-1).split(",").map(Gt=>parseInt(Gt)):se.startsWith("rgba(")?se.slice(5,-1).split(",").map(Gt=>parseInt(Gt)).slice(0,3):((0,U.warn)(`Not a valid color format: "${se}"`),[0,0,0])}function At(se){const Gt=document.createElement("span");Gt.style.visibility="hidden",document.body.append(Gt);for(const Vt of se.keys()){Gt.style.color=Vt;const ie=window.getComputedStyle(Gt).color;se.set(Vt,gt(ie))}Gt.remove()}function St(se){const{a:Gt,b:Vt,c:ie,d:fe,e:pe,f:Te}=se.getTransform();return[Gt,Vt,ie,fe,pe,Te]}function xt(se){const{a:Gt,b:Vt,c:ie,d:fe,e:pe,f:Te}=se.getTransform().invertSelf();return[Gt,Vt,ie,fe,pe,Te]}function Pt(se,Gt,Vt=!1,ie=!0){if(Gt instanceof Q){const{pageWidth:fe,pageHeight:pe}=Gt.rawDims,{style:Te}=se,ke=U.FeatureTest.isCSSRoundSupported,Pe=`var(--scale-factor) * ${fe}px`,Re=`var(--scale-factor) * ${pe}px`,Oe=ke?`round(${Pe}, 1px)`:`calc(${Pe})`,Fe=ke?`round(${Re}, 1px)`:`calc(${Re})`;!Vt||Gt.rotation%180===0?(Te.width=Oe,Te.height=Fe):(Te.width=Fe,Te.height=Oe)}ie&&se.setAttribute("data-main-rotation",Gt.rotation)}},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.BaseStandardFontDataFactory=D.BaseSVGFactory=D.BaseFilterFactory=D.BaseCanvasFactory=D.BaseCMapReaderFactory=void 0;var O=F(1);class U{constructor(){this.constructor===U&&(0,O.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(z){return"none"}addHCMFilter(z,K){return"none"}addHighlightHCMFilter(z,K,J,Q){return"none"}destroy(z=!1){}}D.BaseFilterFactory=U;class G{constructor(){this.constructor===G&&(0,O.unreachable)("Cannot initialize BaseCanvasFactory.")}create(z,K){if(z<=0||K<=0)throw new Error("Invalid canvas size");const J=this._createCanvas(z,K);return{canvas:J,context:J.getContext("2d")}}reset(z,K,J){if(!z.canvas)throw new Error("Canvas is not specified");if(K<=0||J<=0)throw new Error("Invalid canvas size");z.canvas.width=K,z.canvas.height=J}destroy(z){if(!z.canvas)throw new Error("Canvas is not specified");z.canvas.width=0,z.canvas.height=0,z.canvas=null,z.context=null}_createCanvas(z,K){(0,O.unreachable)("Abstract method `_createCanvas` called.")}}D.BaseCanvasFactory=G;class X{constructor({baseUrl:z=null,isCompressed:K=!0}){this.constructor===X&&(0,O.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=z,this.isCompressed=K}async fetch({name:z}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!z)throw new Error("CMap name must be specified.");const K=this.baseUrl+z+(this.isCompressed?".bcmap":""),J=this.isCompressed?O.CMapCompressionType.BINARY:O.CMapCompressionType.NONE;return this._fetchData(K,J).catch(Q=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${K}`)})}_fetchData(z,K){(0,O.unreachable)("Abstract method `_fetchData` called.")}}D.BaseCMapReaderFactory=X;class tt{constructor({baseUrl:z=null}){this.constructor===tt&&(0,O.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=z}async fetch({filename:z}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!z)throw new Error("Font filename must be specified.");const K=`${this.baseUrl}${z}`;return this._fetchData(K).catch(J=>{throw new Error(`Unable to load font data at: ${K}`)})}_fetchData(z){(0,O.unreachable)("Abstract method `_fetchData` called.")}}D.BaseStandardFontDataFactory=tt;class Y{constructor(){this.constructor===Y&&(0,O.unreachable)("Cannot initialize BaseSVGFactory.")}create(z,K,J=!1){if(z<=0||K<=0)throw new Error("Invalid SVG dimensions");const Q=this._createSVG("svg:svg");return Q.setAttribute("version","1.1"),J||(Q.setAttribute("width",`${z}px`),Q.setAttribute("height",`${K}px`)),Q.setAttribute("preserveAspectRatio","none"),Q.setAttribute("viewBox",`0 0 ${z} ${K}`),Q}createElement(z){if(typeof z!="string")throw new Error("Invalid SVG element type");return this._createSVG(z)}_createSVG(z){(0,O.unreachable)("Abstract method `_createSVG` called.")}}D.BaseSVGFactory=Y},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.MurmurHash3_64=void 0;var O=F(1);const U=3285377520,G=4294901760,X=65535;class tt{constructor(W){this.h1=W?W&4294967295:U,this.h2=W?W&4294967295:U}update(W){let z,K;if(typeof W=="string"){z=new Uint8Array(W.length*2),K=0;for(let vt=0,_t=W.length;vt<_t;vt++){const ut=W.charCodeAt(vt);ut<=255?z[K++]=ut:(z[K++]=ut>>>8,z[K++]=ut&255)}}else if((0,O.isArrayBuffer)(W))z=W.slice(),K=z.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const J=K>>2,Q=K-J*4,et=new Uint32Array(z.buffer,0,J);let it=0,rt=0,st=this.h1,at=this.h2;const ct=3432918353,dt=461845907,nt=ct&X,ht=dt&X;for(let vt=0;vt<J;vt++)vt&1?(it=et[vt],it=it*ct&G|it*nt&X,it=it<<15|it>>>17,it=it*dt&G|it*ht&X,st^=it,st=st<<13|st>>>19,st=st*5+3864292196):(rt=et[vt],rt=rt*ct&G|rt*nt&X,rt=rt<<15|rt>>>17,rt=rt*dt&G|rt*ht&X,at^=rt,at=at<<13|at>>>19,at=at*5+3864292196);switch(it=0,Q){case 3:it^=z[J*4+2]<<16;case 2:it^=z[J*4+1]<<8;case 1:it^=z[J*4],it=it*ct&G|it*nt&X,it=it<<15|it>>>17,it=it*dt&G|it*ht&X,J&1?st^=it:at^=it}this.h1=st,this.h2=at}hexdigest(){let W=this.h1,z=this.h2;return W^=z>>>1,W=W*3981806797&G|W*36045&X,z=z*4283543511&G|((z<<16|W>>>16)*2950163797&G)>>>16,W^=z>>>1,W=W*444984403&G|W*60499&X,z=z*3301882366&G|((z<<16|W>>>16)*3120437893&G)>>>16,W^=z>>>1,(W>>>0).toString(16).padStart(8,"0")+(z>>>0).toString(16).padStart(8,"0")}}D.MurmurHash3_64=tt},(B,D,F)=>{var X;Object.defineProperty(D,"__esModule",{value:!0}),D.FontLoader=D.FontFaceObject=void 0;var O=F(1);class U{constructor({ownerDocument:Y=globalThis.document,styleElement:W=null}){It(this,X,new Set);this._document=Y,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(Y){this.nativeFontFaces.add(Y),this._document.fonts.add(Y)}removeNativeFontFace(Y){this.nativeFontFaces.delete(Y),this._document.fonts.delete(Y)}insertRule(Y){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const W=this.styleElement.sheet;W.insertRule(Y,W.cssRules.length)}clear(){for(const Y of this.nativeFontFaces)this._document.fonts.delete(Y);this.nativeFontFaces.clear(),lt(this,X).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(Y){if(!(!Y||lt(this,X).has(Y.loadedName))){if((0,O.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:W,src:z,style:K}=Y,J=new FontFace(W,z,K);this.addNativeFontFace(J);try{await J.load(),lt(this,X).add(W)}catch{(0,O.warn)(`Cannot load system font: ${Y.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(J)}return}(0,O.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(Y){if(Y.attached||Y.missingFile&&!Y.systemFontInfo)return;if(Y.attached=!0,Y.systemFontInfo){await this.loadSystemFont(Y.systemFontInfo);return}if(this.isFontLoadingAPISupported){const z=Y.createNativeFontFace();if(z){this.addNativeFontFace(z);try{await z.loaded}catch(K){throw(0,O.warn)(`Failed to load font '${z.family}': '${K}'.`),Y.disableFontFace=!0,K}}return}const W=Y.createFontFaceRule();if(W){if(this.insertRule(W),this.isSyncFontLoadingSupported)return;await new Promise(z=>{const K=this._queueLoadingCallback(z);this._prepareFontLoadEvent(Y,K)})}}get isFontLoadingAPISupported(){var W;const Y=!!((W=this._document)!=null&&W.fonts);return(0,O.shadow)(this,"isFontLoadingAPISupported",Y)}get isSyncFontLoadingSupported(){let Y=!1;return(O.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(Y=!0),(0,O.shadow)(this,"isSyncFontLoadingSupported",Y)}_queueLoadingCallback(Y){function W(){for((0,O.assert)(!K.done,"completeRequest() cannot be called twice."),K.done=!0;z.length>0&&z[0].done;){const J=z.shift();setTimeout(J.callback,0)}}const{loadingRequests:z}=this,K={done:!1,complete:W,callback:Y};return z.push(K),K}get _loadTestFont(){const Y=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,O.shadow)(this,"_loadTestFont",Y)}_prepareFontLoadEvent(Y,W){function z(gt,At){return gt.charCodeAt(At)<<24|gt.charCodeAt(At+1)<<16|gt.charCodeAt(At+2)<<8|gt.charCodeAt(At+3)&255}function K(gt,At,St,xt){const Pt=gt.substring(0,At),Ft=gt.substring(At+St);return Pt+xt+Ft}let J,Q;const et=this._document.createElement("canvas");et.width=1,et.height=1;const it=et.getContext("2d");let rt=0;function st(gt,At){if(++rt>30){(0,O.warn)("Load test font never loaded."),At();return}if(it.font="30px "+gt,it.fillText(".",0,20),it.getImageData(0,0,1,1).data[3]>0){At();return}setTimeout(st.bind(null,gt,At))}const at=`lt${Date.now()}${this.loadTestFontId++}`;let ct=this._loadTestFont;ct=K(ct,976,at.length,at);const nt=16,ht=1482184792;let vt=z(ct,nt);for(J=0,Q=at.length-3;J<Q;J+=4)vt=vt-ht+z(at,J)|0;J<at.length&&(vt=vt-ht+z(at+"XXX",J)|0),ct=K(ct,nt,4,(0,O.string32)(vt));const _t=`url(data:font/opentype;base64,${btoa(ct)});`,ut=`@font-face {font-family:"${at}";src:${_t}}`;this.insertRule(ut);const bt=this._document.createElement("div");bt.style.visibility="hidden",bt.style.width=bt.style.height="10px",bt.style.position="absolute",bt.style.top=bt.style.left="0px";for(const gt of[Y.loadedName,at]){const At=this._document.createElement("span");At.textContent="Hi",At.style.fontFamily=gt,bt.append(At)}this._document.body.append(bt),st(at,()=>{bt.remove(),W.complete()})}}X=new WeakMap,D.FontLoader=U;class G{constructor(Y,{isEvalSupported:W=!0,disableFontFace:z=!1,ignoreErrors:K=!1,inspectFont:J=null}){this.compiledGlyphs=Object.create(null);for(const Q in Y)this[Q]=Y[Q];this.isEvalSupported=W!==!1,this.disableFontFace=z===!0,this.ignoreErrors=K===!0,this._inspectFont=J}createNativeFontFace(){var W;if(!this.data||this.disableFontFace)return null;let Y;if(!this.cssFontInfo)Y=new FontFace(this.loadedName,this.data,{});else{const z={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(z.style=`oblique ${this.cssFontInfo.italicAngle}deg`),Y=new FontFace(this.cssFontInfo.fontFamily,this.data,z)}return(W=this._inspectFont)==null||W.call(this,this),Y}createFontFaceRule(){var K;if(!this.data||this.disableFontFace)return null;const Y=(0,O.bytesToString)(this.data),W=`url(data:${this.mimetype};base64,${btoa(Y)});`;let z;if(!this.cssFontInfo)z=`@font-face {font-family:"${this.loadedName}";src:${W}}`;else{let J=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(J+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),z=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${J}src:${W}}`}return(K=this._inspectFont)==null||K.call(this,this,W),z}getPathGenerator(Y,W){if(this.compiledGlyphs[W]!==void 0)return this.compiledGlyphs[W];let z;try{z=Y.get(this.loadedName+"_path_"+W)}catch(K){if(!this.ignoreErrors)throw K;return(0,O.warn)(`getPathGenerator - ignoring character: "${K}".`),this.compiledGlyphs[W]=function(J,Q){}}if(this.isEvalSupported&&O.FeatureTest.isEvalSupported){const K=[];for(const J of z){const Q=J.args!==void 0?J.args.join(","):"";K.push("c.",J.cmd,"(",Q,`);
`)}return this.compiledGlyphs[W]=new Function("c","size",K.join(""))}return this.compiledGlyphs[W]=function(K,J){for(const Q of z)Q.cmd==="scale"&&(Q.args=[J,-J]),K[Q.cmd].apply(K,Q.args)}}}D.FontFaceObject=G},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.NodeStandardFontDataFactory=D.NodeFilterFactory=D.NodeCanvasFactory=D.NodeCMapReaderFactory=void 0;var O=F(7);F(1);const U=function(W){return new Promise((z,K)=>{require("fs").readFile(W,(Q,et)=>{if(Q||!et){K(new Error(Q));return}z(new Uint8Array(et))})})};class G extends O.BaseFilterFactory{}D.NodeFilterFactory=G;class X extends O.BaseCanvasFactory{_createCanvas(z,K){return require$$0.createCanvas(z,K)}}D.NodeCanvasFactory=X;class tt extends O.BaseCMapReaderFactory{_fetchData(z,K){return U(z).then(J=>({cMapData:J,compressionType:K}))}}D.NodeCMapReaderFactory=tt;class Y extends O.BaseStandardFontDataFactory{_fetchData(z){return U(z)}}D.NodeStandardFontDataFactory=Y},(B,D,F)=>{var Dt,Wr,Qt,Hr;Object.defineProperty(D,"__esModule",{value:!0}),D.CanvasGraphics=void 0;var O=F(1),U=F(6),G=F(12),X=F(13);const tt=16,Y=100,W=4096,z=15,K=10,J=1e3,Q=16;function et(wt,ot){if(wt._removeMirroring)throw new Error("Context is already forwarding operations.");wt.__originalSave=wt.save,wt.__originalRestore=wt.restore,wt.__originalRotate=wt.rotate,wt.__originalScale=wt.scale,wt.__originalTranslate=wt.translate,wt.__originalTransform=wt.transform,wt.__originalSetTransform=wt.setTransform,wt.__originalResetTransform=wt.resetTransform,wt.__originalClip=wt.clip,wt.__originalMoveTo=wt.moveTo,wt.__originalLineTo=wt.lineTo,wt.__originalBezierCurveTo=wt.bezierCurveTo,wt.__originalRect=wt.rect,wt.__originalClosePath=wt.closePath,wt.__originalBeginPath=wt.beginPath,wt._removeMirroring=()=>{wt.save=wt.__originalSave,wt.restore=wt.__originalRestore,wt.rotate=wt.__originalRotate,wt.scale=wt.__originalScale,wt.translate=wt.__originalTranslate,wt.transform=wt.__originalTransform,wt.setTransform=wt.__originalSetTransform,wt.resetTransform=wt.__originalResetTransform,wt.clip=wt.__originalClip,wt.moveTo=wt.__originalMoveTo,wt.lineTo=wt.__originalLineTo,wt.bezierCurveTo=wt.__originalBezierCurveTo,wt.rect=wt.__originalRect,wt.closePath=wt.__originalClosePath,wt.beginPath=wt.__originalBeginPath,delete wt._removeMirroring},wt.save=function(){ot.save(),this.__originalSave()},wt.restore=function(){ot.restore(),this.__originalRestore()},wt.translate=function(pt,Et){ot.translate(pt,Et),this.__originalTranslate(pt,Et)},wt.scale=function(pt,Et){ot.scale(pt,Et),this.__originalScale(pt,Et)},wt.transform=function(pt,Et,yt,Tt,kt,Bt){ot.transform(pt,Et,yt,Tt,kt,Bt),this.__originalTransform(pt,Et,yt,Tt,kt,Bt)},wt.setTransform=function(pt,Et,yt,Tt,kt,Bt){ot.setTransform(pt,Et,yt,Tt,kt,Bt),this.__originalSetTransform(pt,Et,yt,Tt,kt,Bt)},wt.resetTransform=function(){ot.resetTransform(),this.__originalResetTransform()},wt.rotate=function(pt){ot.rotate(pt),this.__originalRotate(pt)},wt.clip=function(pt){ot.clip(pt),this.__originalClip(pt)},wt.moveTo=function(mt,pt){ot.moveTo(mt,pt),this.__originalMoveTo(mt,pt)},wt.lineTo=function(mt,pt){ot.lineTo(mt,pt),this.__originalLineTo(mt,pt)},wt.bezierCurveTo=function(mt,pt,Et,yt,Tt,kt){ot.bezierCurveTo(mt,pt,Et,yt,Tt,kt),this.__originalBezierCurveTo(mt,pt,Et,yt,Tt,kt)},wt.rect=function(mt,pt,Et,yt){ot.rect(mt,pt,Et,yt),this.__originalRect(mt,pt,Et,yt)},wt.closePath=function(){ot.closePath(),this.__originalClosePath()},wt.beginPath=function(){ot.beginPath(),this.__originalBeginPath()}}class it{constructor(ot){this.canvasFactory=ot,this.cache=Object.create(null)}getCanvas(ot,mt,pt){let Et;return this.cache[ot]!==void 0?(Et=this.cache[ot],this.canvasFactory.reset(Et,mt,pt)):(Et=this.canvasFactory.create(mt,pt),this.cache[ot]=Et),Et}delete(ot){delete this.cache[ot]}clear(){for(const ot in this.cache){const mt=this.cache[ot];this.canvasFactory.destroy(mt),delete this.cache[ot]}}}function rt(wt,ot,mt,pt,Et,yt,Tt,kt,Bt,Yt){const[zt,Zt,ee,he,ne,be]=(0,U.getCurrentTransform)(wt);if(Zt===0&&ee===0){const xe=Tt*zt+ne,se=Math.round(xe),Gt=kt*he+be,Vt=Math.round(Gt),ie=(Tt+Bt)*zt+ne,fe=Math.abs(Math.round(ie)-se)||1,pe=(kt+Yt)*he+be,Te=Math.abs(Math.round(pe)-Vt)||1;return wt.setTransform(Math.sign(zt),0,0,Math.sign(he),se,Vt),wt.drawImage(ot,mt,pt,Et,yt,0,0,fe,Te),wt.setTransform(zt,Zt,ee,he,ne,be),[fe,Te]}if(zt===0&&he===0){const xe=kt*ee+ne,se=Math.round(xe),Gt=Tt*Zt+be,Vt=Math.round(Gt),ie=(kt+Yt)*ee+ne,fe=Math.abs(Math.round(ie)-se)||1,pe=(Tt+Bt)*Zt+be,Te=Math.abs(Math.round(pe)-Vt)||1;return wt.setTransform(0,Math.sign(Zt),Math.sign(ee),0,se,Vt),wt.drawImage(ot,mt,pt,Et,yt,0,0,Te,fe),wt.setTransform(zt,Zt,ee,he,ne,be),[Te,fe]}wt.drawImage(ot,mt,pt,Et,yt,Tt,kt,Bt,Yt);const Ce=Math.hypot(zt,Zt),de=Math.hypot(ee,he);return[Ce*Bt,de*Yt]}function st(wt){const{width:ot,height:mt}=wt;if(ot>J||mt>J)return null;const pt=1e3,Et=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),yt=ot+1;let Tt=new Uint8Array(yt*(mt+1)),kt,Bt,Yt;const zt=ot+7&-8;let Zt=new Uint8Array(zt*mt),ee=0;for(const de of wt.data){let xe=128;for(;xe>0;)Zt[ee++]=de&xe?0:255,xe>>=1}let he=0;for(ee=0,Zt[ee]!==0&&(Tt[0]=1,++he),Bt=1;Bt<ot;Bt++)Zt[ee]!==Zt[ee+1]&&(Tt[Bt]=Zt[ee]?2:1,++he),ee++;for(Zt[ee]!==0&&(Tt[Bt]=2,++he),kt=1;kt<mt;kt++){ee=kt*zt,Yt=kt*yt,Zt[ee-zt]!==Zt[ee]&&(Tt[Yt]=Zt[ee]?1:8,++he);let de=(Zt[ee]?4:0)+(Zt[ee-zt]?8:0);for(Bt=1;Bt<ot;Bt++)de=(de>>2)+(Zt[ee+1]?4:0)+(Zt[ee-zt+1]?8:0),Et[de]&&(Tt[Yt+Bt]=Et[de],++he),ee++;if(Zt[ee-zt]!==Zt[ee]&&(Tt[Yt+Bt]=Zt[ee]?2:4,++he),he>pt)return null}for(ee=zt*(mt-1),Yt=kt*yt,Zt[ee]!==0&&(Tt[Yt]=8,++he),Bt=1;Bt<ot;Bt++)Zt[ee]!==Zt[ee+1]&&(Tt[Yt+Bt]=Zt[ee]?4:8,++he),ee++;if(Zt[ee]!==0&&(Tt[Yt+Bt]=4,++he),he>pt)return null;const ne=new Int32Array([0,yt,-1,0,-yt,0,0,0,1]),be=new Path2D;for(kt=0;he&&kt<=mt;kt++){let de=kt*yt;const xe=de+ot;for(;de<xe&&!Tt[de];)de++;if(de===xe)continue;be.moveTo(de%yt,kt);const se=de;let Gt=Tt[de];do{const Vt=ne[Gt];do de+=Vt;while(!Tt[de]);const ie=Tt[de];ie!==5&&ie!==10?(Gt=ie,Tt[de]=0):(Gt=ie&51*Gt>>4,Tt[de]&=Gt>>2|Gt<<2),be.lineTo(de%yt,de/yt|0),Tt[de]||--he}while(se!==de);--kt}return Zt=null,Tt=null,function(de){de.save(),de.scale(1/ot,-1/mt),de.translate(0,-mt),de.fill(be),de.beginPath(),de.restore()}}class at{constructor(ot,mt){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=O.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=O.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=O.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ot,mt])}clone(){const ot=Object.create(this);return ot.clipBox=this.clipBox.slice(),ot}setCurrentPoint(ot,mt){this.x=ot,this.y=mt}updatePathMinMax(ot,mt,pt){[mt,pt]=O.Util.applyTransform([mt,pt],ot),this.minX=Math.min(this.minX,mt),this.minY=Math.min(this.minY,pt),this.maxX=Math.max(this.maxX,mt),this.maxY=Math.max(this.maxY,pt)}updateRectMinMax(ot,mt){const pt=O.Util.applyTransform(mt,ot),Et=O.Util.applyTransform(mt.slice(2),ot);this.minX=Math.min(this.minX,pt[0],Et[0]),this.minY=Math.min(this.minY,pt[1],Et[1]),this.maxX=Math.max(this.maxX,pt[0],Et[0]),this.maxY=Math.max(this.maxY,pt[1],Et[1])}updateScalingPathMinMax(ot,mt){O.Util.scaleMinMax(ot,mt),this.minX=Math.min(this.minX,mt[0]),this.maxX=Math.max(this.maxX,mt[1]),this.minY=Math.min(this.minY,mt[2]),this.maxY=Math.max(this.maxY,mt[3])}updateCurvePathMinMax(ot,mt,pt,Et,yt,Tt,kt,Bt,Yt,zt){const Zt=O.Util.bezierBoundingBox(mt,pt,Et,yt,Tt,kt,Bt,Yt);if(zt){zt[0]=Math.min(zt[0],Zt[0],Zt[2]),zt[1]=Math.max(zt[1],Zt[0],Zt[2]),zt[2]=Math.min(zt[2],Zt[1],Zt[3]),zt[3]=Math.max(zt[3],Zt[1],Zt[3]);return}this.updateRectMinMax(ot,Zt)}getPathBoundingBox(ot=G.PathType.FILL,mt=null){const pt=[this.minX,this.minY,this.maxX,this.maxY];if(ot===G.PathType.STROKE){mt||(0,O.unreachable)("Stroke bounding box must include transform.");const Et=O.Util.singularValueDecompose2dScale(mt),yt=Et[0]*this.lineWidth/2,Tt=Et[1]*this.lineWidth/2;pt[0]-=yt,pt[1]-=Tt,pt[2]+=yt,pt[3]+=Tt}return pt}updateClipFromPath(){const ot=O.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ot||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ot){this.clipBox=ot,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ot=G.PathType.FILL,mt=null){return O.Util.intersect(this.clipBox,this.getPathBoundingBox(ot,mt))}}function ct(wt,ot){if(typeof ImageData<"u"&&ot instanceof ImageData){wt.putImageData(ot,0,0);return}const mt=ot.height,pt=ot.width,Et=mt%Q,yt=(mt-Et)/Q,Tt=Et===0?yt:yt+1,kt=wt.createImageData(pt,Q);let Bt=0,Yt;const zt=ot.data,Zt=kt.data;let ee,he,ne,be;if(ot.kind===O.ImageKind.GRAYSCALE_1BPP){const Ce=zt.byteLength,de=new Uint32Array(Zt.buffer,0,Zt.byteLength>>2),xe=de.length,se=pt+7>>3,Gt=4294967295,Vt=O.FeatureTest.isLittleEndian?4278190080:255;for(ee=0;ee<Tt;ee++){for(ne=ee<yt?Q:Et,Yt=0,he=0;he<ne;he++){const ie=Ce-Bt;let fe=0;const pe=ie>se?pt:ie*8-7,Te=pe&-8;let ke=0,Pe=0;for(;fe<Te;fe+=8)Pe=zt[Bt++],de[Yt++]=Pe&128?Gt:Vt,de[Yt++]=Pe&64?Gt:Vt,de[Yt++]=Pe&32?Gt:Vt,de[Yt++]=Pe&16?Gt:Vt,de[Yt++]=Pe&8?Gt:Vt,de[Yt++]=Pe&4?Gt:Vt,de[Yt++]=Pe&2?Gt:Vt,de[Yt++]=Pe&1?Gt:Vt;for(;fe<pe;fe++)ke===0&&(Pe=zt[Bt++],ke=128),de[Yt++]=Pe&ke?Gt:Vt,ke>>=1}for(;Yt<xe;)de[Yt++]=0;wt.putImageData(kt,0,ee*Q)}}else if(ot.kind===O.ImageKind.RGBA_32BPP){for(he=0,be=pt*Q*4,ee=0;ee<yt;ee++)Zt.set(zt.subarray(Bt,Bt+be)),Bt+=be,wt.putImageData(kt,0,he),he+=Q;ee<Tt&&(be=pt*Et*4,Zt.set(zt.subarray(Bt,Bt+be)),wt.putImageData(kt,0,he))}else if(ot.kind===O.ImageKind.RGB_24BPP)for(ne=Q,be=pt*ne,ee=0;ee<Tt;ee++){for(ee>=yt&&(ne=Et,be=pt*ne),Yt=0,he=be;he--;)Zt[Yt++]=zt[Bt++],Zt[Yt++]=zt[Bt++],Zt[Yt++]=zt[Bt++],Zt[Yt++]=255;wt.putImageData(kt,0,ee*Q)}else throw new Error(`bad image kind: ${ot.kind}`)}function dt(wt,ot){if(ot.bitmap){wt.drawImage(ot.bitmap,0,0);return}const mt=ot.height,pt=ot.width,Et=mt%Q,yt=(mt-Et)/Q,Tt=Et===0?yt:yt+1,kt=wt.createImageData(pt,Q);let Bt=0;const Yt=ot.data,zt=kt.data;for(let Zt=0;Zt<Tt;Zt++){const ee=Zt<yt?Q:Et;({srcPos:Bt}=(0,X.convertBlackAndWhiteToRGBA)({src:Yt,srcPos:Bt,dest:zt,width:pt,height:ee,nonBlackColor:0})),wt.putImageData(kt,0,Zt*Q)}}function nt(wt,ot){const mt=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const pt of mt)wt[pt]!==void 0&&(ot[pt]=wt[pt]);wt.setLineDash!==void 0&&(ot.setLineDash(wt.getLineDash()),ot.lineDashOffset=wt.lineDashOffset)}function ht(wt){if(wt.strokeStyle=wt.fillStyle="#000000",wt.fillRule="nonzero",wt.globalAlpha=1,wt.lineWidth=1,wt.lineCap="butt",wt.lineJoin="miter",wt.miterLimit=10,wt.globalCompositeOperation="source-over",wt.font="10px sans-serif",wt.setLineDash!==void 0&&(wt.setLineDash([]),wt.lineDashOffset=0),!O.isNodeJS){const{filter:ot}=wt;ot!=="none"&&ot!==""&&(wt.filter="none")}}function vt(wt,ot,mt,pt){const Et=wt.length;for(let yt=3;yt<Et;yt+=4){const Tt=wt[yt];if(Tt===0)wt[yt-3]=ot,wt[yt-2]=mt,wt[yt-1]=pt;else if(Tt<255){const kt=255-Tt;wt[yt-3]=wt[yt-3]*Tt+ot*kt>>8,wt[yt-2]=wt[yt-2]*Tt+mt*kt>>8,wt[yt-1]=wt[yt-1]*Tt+pt*kt>>8}}}function _t(wt,ot,mt){const pt=wt.length,Et=1/255;for(let yt=3;yt<pt;yt+=4){const Tt=mt?mt[wt[yt]]:wt[yt];ot[yt]=ot[yt]*Tt*Et|0}}function ut(wt,ot,mt){const pt=wt.length;for(let Et=3;Et<pt;Et+=4){const yt=wt[Et-3]*77+wt[Et-2]*152+wt[Et-1]*28;ot[Et]=mt?ot[Et]*mt[yt>>8]>>8:ot[Et]*yt>>16}}function bt(wt,ot,mt,pt,Et,yt,Tt,kt,Bt,Yt,zt){const Zt=!!yt,ee=Zt?yt[0]:0,he=Zt?yt[1]:0,ne=Zt?yt[2]:0,be=Et==="Luminosity"?ut:_t,de=Math.min(pt,Math.ceil(1048576/mt));for(let xe=0;xe<pt;xe+=de){const se=Math.min(de,pt-xe),Gt=wt.getImageData(kt-Yt,xe+(Bt-zt),mt,se),Vt=ot.getImageData(kt,xe+Bt,mt,se);Zt&&vt(Gt.data,ee,he,ne),be(Gt.data,Vt.data,Tt),ot.putImageData(Vt,kt,xe+Bt)}}function gt(wt,ot,mt,pt){const Et=pt[0],yt=pt[1],Tt=pt[2]-Et,kt=pt[3]-yt;Tt===0||kt===0||(bt(ot.context,mt,Tt,kt,ot.subtype,ot.backdrop,ot.transferMap,Et,yt,ot.offsetX,ot.offsetY),wt.save(),wt.globalAlpha=1,wt.globalCompositeOperation="source-over",wt.setTransform(1,0,0,1,0,0),wt.drawImage(mt.canvas,0,0),wt.restore())}function At(wt,ot){const mt=O.Util.singularValueDecompose2dScale(wt);mt[0]=Math.fround(mt[0]),mt[1]=Math.fround(mt[1]);const pt=Math.fround((globalThis.devicePixelRatio||1)*U.PixelsPerInch.PDF_TO_CSS_UNITS);return ot!==void 0?ot:mt[0]<=pt||mt[1]<=pt}const St=["butt","round","square"],xt=["miter","round","bevel"],Pt={},Ft={},qt=class qt{constructor(ot,mt,pt,Et,yt,{optionalContentConfig:Tt,markedContentStack:kt=null},Bt,Yt){It(this,Dt);It(this,Qt);this.ctx=ot,this.current=new at(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=mt,this.objs=pt,this.canvasFactory=Et,this.filterFactory=yt,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=kt||[],this.optionalContentConfig=Tt,this.cachedCanvases=new it(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=Bt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Yt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ot,mt=null){return typeof ot=="string"?ot.startsWith("g_")?this.commonObjs.get(ot):this.objs.get(ot):mt}beginDrawing({transform:ot,viewport:mt,transparency:pt=!1,background:Et=null}){const yt=this.ctx.canvas.width,Tt=this.ctx.canvas.height,kt=this.ctx.fillStyle;if(this.ctx.fillStyle=Et||"#ffffff",this.ctx.fillRect(0,0,yt,Tt),this.ctx.fillStyle=kt,pt){const Bt=this.cachedCanvases.getCanvas("transparent",yt,Tt);this.compositeCtx=this.ctx,this.transparentCanvas=Bt.canvas,this.ctx=Bt.context,this.ctx.save(),this.ctx.transform(...(0,U.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),ht(this.ctx),ot&&(this.ctx.transform(...ot),this.outputScaleX=ot[0],this.outputScaleY=ot[0]),this.ctx.transform(...mt.transform),this.viewportScale=mt.scale,this.baseTransform=(0,U.getCurrentTransform)(this.ctx)}executeOperatorList(ot,mt,pt,Et){const yt=ot.argsArray,Tt=ot.fnArray;let kt=mt||0;const Bt=yt.length;if(Bt===kt)return kt;const Yt=Bt-kt>K&&typeof pt=="function",zt=Yt?Date.now()+z:0;let Zt=0;const ee=this.commonObjs,he=this.objs;let ne;for(;;){if(Et!==void 0&&kt===Et.nextBreakPoint)return Et.breakIt(kt,pt),kt;if(ne=Tt[kt],ne!==O.OPS.dependency)this[ne].apply(this,yt[kt]);else for(const be of yt[kt]){const Ce=be.startsWith("g_")?ee:he;if(!Ce.has(be))return Ce.get(be,pt),kt}if(kt++,kt===Bt)return kt;if(Yt&&++Zt>K){if(Date.now()>zt)return pt(),kt;Zt=0}}}endDrawing(){$t(this,Dt,Wr).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ot of this._cachedBitmapsMap.values()){for(const mt of ot.values())typeof HTMLCanvasElement<"u"&&mt instanceof HTMLCanvasElement&&(mt.width=mt.height=0);ot.clear()}this._cachedBitmapsMap.clear(),$t(this,Qt,Hr).call(this)}_scaleImage(ot,mt){const pt=ot.width,Et=ot.height;let yt=Math.max(Math.hypot(mt[0],mt[1]),1),Tt=Math.max(Math.hypot(mt[2],mt[3]),1),kt=pt,Bt=Et,Yt="prescale1",zt,Zt;for(;yt>2&&kt>1||Tt>2&&Bt>1;){let ee=kt,he=Bt;yt>2&&kt>1&&(ee=kt>=16384?Math.floor(kt/2)-1||1:Math.ceil(kt/2),yt/=kt/ee),Tt>2&&Bt>1&&(he=Bt>=16384?Math.floor(Bt/2)-1||1:Math.ceil(Bt)/2,Tt/=Bt/he),zt=this.cachedCanvases.getCanvas(Yt,ee,he),Zt=zt.context,Zt.clearRect(0,0,ee,he),Zt.drawImage(ot,0,0,kt,Bt,0,0,ee,he),ot=zt.canvas,kt=ee,Bt=he,Yt=Yt==="prescale1"?"prescale2":"prescale1"}return{img:ot,paintWidth:kt,paintHeight:Bt}}_createMaskCanvas(ot){const mt=this.ctx,{width:pt,height:Et}=ot,yt=this.current.fillColor,Tt=this.current.patternFill,kt=(0,U.getCurrentTransform)(mt);let Bt,Yt,zt,Zt;if((ot.bitmap||ot.data)&&ot.count>1){const fe=ot.bitmap||ot.data.buffer;Yt=JSON.stringify(Tt?kt:[kt.slice(0,4),yt]),Bt=this._cachedBitmapsMap.get(fe),Bt||(Bt=new Map,this._cachedBitmapsMap.set(fe,Bt));const pe=Bt.get(Yt);if(pe&&!Tt){const Te=Math.round(Math.min(kt[0],kt[2])+kt[4]),ke=Math.round(Math.min(kt[1],kt[3])+kt[5]);return{canvas:pe,offsetX:Te,offsetY:ke}}zt=pe}zt||(Zt=this.cachedCanvases.getCanvas("maskCanvas",pt,Et),dt(Zt.context,ot));let ee=O.Util.transform(kt,[1/pt,0,0,-1/Et,0,0]);ee=O.Util.transform(ee,[1,0,0,1,0,-Et]);const he=O.Util.applyTransform([0,0],ee),ne=O.Util.applyTransform([pt,Et],ee),be=O.Util.normalizeRect([he[0],he[1],ne[0],ne[1]]),Ce=Math.round(be[2]-be[0])||1,de=Math.round(be[3]-be[1])||1,xe=this.cachedCanvases.getCanvas("fillCanvas",Ce,de),se=xe.context,Gt=Math.min(he[0],ne[0]),Vt=Math.min(he[1],ne[1]);se.translate(-Gt,-Vt),se.transform(...ee),zt||(zt=this._scaleImage(Zt.canvas,(0,U.getCurrentTransformInverse)(se)),zt=zt.img,Bt&&Tt&&Bt.set(Yt,zt)),se.imageSmoothingEnabled=At((0,U.getCurrentTransform)(se),ot.interpolate),rt(se,zt,0,0,zt.width,zt.height,0,0,pt,Et),se.globalCompositeOperation="source-in";const ie=O.Util.transform((0,U.getCurrentTransformInverse)(se),[1,0,0,1,-Gt,-Vt]);return se.fillStyle=Tt?yt.getPattern(mt,this,ie,G.PathType.FILL):yt,se.fillRect(0,0,pt,Et),Bt&&!Tt&&(this.cachedCanvases.delete("fillCanvas"),Bt.set(Yt,xe.canvas)),{canvas:xe.canvas,offsetX:Math.round(Gt),offsetY:Math.round(Vt)}}setLineWidth(ot){ot!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=ot,this.ctx.lineWidth=ot}setLineCap(ot){this.ctx.lineCap=St[ot]}setLineJoin(ot){this.ctx.lineJoin=xt[ot]}setMiterLimit(ot){this.ctx.miterLimit=ot}setDash(ot,mt){const pt=this.ctx;pt.setLineDash!==void 0&&(pt.setLineDash(ot),pt.lineDashOffset=mt)}setRenderingIntent(ot){}setFlatness(ot){}setGState(ot){for(const[mt,pt]of ot)switch(mt){case"LW":this.setLineWidth(pt);break;case"LC":this.setLineCap(pt);break;case"LJ":this.setLineJoin(pt);break;case"ML":this.setMiterLimit(pt);break;case"D":this.setDash(pt[0],pt[1]);break;case"RI":this.setRenderingIntent(pt);break;case"FL":this.setFlatness(pt);break;case"Font":this.setFont(pt[0],pt[1]);break;case"CA":this.current.strokeAlpha=pt;break;case"ca":this.current.fillAlpha=pt,this.ctx.globalAlpha=pt;break;case"BM":this.ctx.globalCompositeOperation=pt;break;case"SMask":this.current.activeSMask=pt?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(pt);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ot=this.inSMaskMode;this.current.activeSMask&&!ot?this.beginSMaskMode():!this.current.activeSMask&&ot&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ot=this.ctx.canvas.width,mt=this.ctx.canvas.height,pt="smaskGroupAt"+this.groupLevel,Et=this.cachedCanvases.getCanvas(pt,ot,mt);this.suspendedCtx=this.ctx,this.ctx=Et.context;const yt=this.ctx;yt.setTransform(...(0,U.getCurrentTransform)(this.suspendedCtx)),nt(this.suspendedCtx,yt),et(yt,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),nt(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ot){if(!this.current.activeSMask)return;ot?(ot[0]=Math.floor(ot[0]),ot[1]=Math.floor(ot[1]),ot[2]=Math.ceil(ot[2]),ot[3]=Math.ceil(ot[3])):ot=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const mt=this.current.activeSMask,pt=this.suspendedCtx;gt(pt,mt,this.ctx,ot),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(nt(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ot=this.current;this.stateStack.push(ot),this.current=ot.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),nt(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(ot,mt,pt,Et,yt,Tt){this.ctx.transform(ot,mt,pt,Et,yt,Tt),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(ot,mt,pt){const Et=this.ctx,yt=this.current;let Tt=yt.x,kt=yt.y,Bt,Yt;const zt=(0,U.getCurrentTransform)(Et),Zt=zt[0]===0&&zt[3]===0||zt[1]===0&&zt[2]===0,ee=Zt?pt.slice(0):null;for(let he=0,ne=0,be=ot.length;he<be;he++)switch(ot[he]|0){case O.OPS.rectangle:Tt=mt[ne++],kt=mt[ne++];const Ce=mt[ne++],de=mt[ne++],xe=Tt+Ce,se=kt+de;Et.moveTo(Tt,kt),Ce===0||de===0?Et.lineTo(xe,se):(Et.lineTo(xe,kt),Et.lineTo(xe,se),Et.lineTo(Tt,se)),Zt||yt.updateRectMinMax(zt,[Tt,kt,xe,se]),Et.closePath();break;case O.OPS.moveTo:Tt=mt[ne++],kt=mt[ne++],Et.moveTo(Tt,kt),Zt||yt.updatePathMinMax(zt,Tt,kt);break;case O.OPS.lineTo:Tt=mt[ne++],kt=mt[ne++],Et.lineTo(Tt,kt),Zt||yt.updatePathMinMax(zt,Tt,kt);break;case O.OPS.curveTo:Bt=Tt,Yt=kt,Tt=mt[ne+4],kt=mt[ne+5],Et.bezierCurveTo(mt[ne],mt[ne+1],mt[ne+2],mt[ne+3],Tt,kt),yt.updateCurvePathMinMax(zt,Bt,Yt,mt[ne],mt[ne+1],mt[ne+2],mt[ne+3],Tt,kt,ee),ne+=6;break;case O.OPS.curveTo2:Bt=Tt,Yt=kt,Et.bezierCurveTo(Tt,kt,mt[ne],mt[ne+1],mt[ne+2],mt[ne+3]),yt.updateCurvePathMinMax(zt,Bt,Yt,Tt,kt,mt[ne],mt[ne+1],mt[ne+2],mt[ne+3],ee),Tt=mt[ne+2],kt=mt[ne+3],ne+=4;break;case O.OPS.curveTo3:Bt=Tt,Yt=kt,Tt=mt[ne+2],kt=mt[ne+3],Et.bezierCurveTo(mt[ne],mt[ne+1],Tt,kt,Tt,kt),yt.updateCurvePathMinMax(zt,Bt,Yt,mt[ne],mt[ne+1],Tt,kt,Tt,kt,ee),ne+=4;break;case O.OPS.closePath:Et.closePath();break}Zt&&yt.updateScalingPathMinMax(zt,ee),yt.setCurrentPoint(Tt,kt)}closePath(){this.ctx.closePath()}stroke(ot=!0){const mt=this.ctx,pt=this.current.strokeColor;mt.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof pt=="object"&&(pt!=null&&pt.getPattern)?(mt.save(),mt.strokeStyle=pt.getPattern(mt,this,(0,U.getCurrentTransformInverse)(mt),G.PathType.STROKE),this.rescaleAndStroke(!1),mt.restore()):this.rescaleAndStroke(!0)),ot&&this.consumePath(this.current.getClippedPathBoundingBox()),mt.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ot=!0){const mt=this.ctx,pt=this.current.fillColor,Et=this.current.patternFill;let yt=!1;Et&&(mt.save(),mt.fillStyle=pt.getPattern(mt,this,(0,U.getCurrentTransformInverse)(mt),G.PathType.FILL),yt=!0);const Tt=this.current.getClippedPathBoundingBox();this.contentVisible&&Tt!==null&&(this.pendingEOFill?(mt.fill("evenodd"),this.pendingEOFill=!1):mt.fill()),yt&&mt.restore(),ot&&this.consumePath(Tt)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Pt}eoClip(){this.pendingClip=Ft}beginText(){this.current.textMatrix=O.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ot=this.pendingTextPaths,mt=this.ctx;if(ot===void 0){mt.beginPath();return}mt.save(),mt.beginPath();for(const pt of ot)mt.setTransform(...pt.transform),mt.translate(pt.x,pt.y),pt.addToPath(mt,pt.fontSize);mt.restore(),mt.clip(),mt.beginPath(),delete this.pendingTextPaths}setCharSpacing(ot){this.current.charSpacing=ot}setWordSpacing(ot){this.current.wordSpacing=ot}setHScale(ot){this.current.textHScale=ot/100}setLeading(ot){this.current.leading=-ot}setFont(ot,mt){var zt;const pt=this.commonObjs.get(ot),Et=this.current;if(!pt)throw new Error(`Can't find font for ${ot}`);if(Et.fontMatrix=pt.fontMatrix||O.FONT_IDENTITY_MATRIX,(Et.fontMatrix[0]===0||Et.fontMatrix[3]===0)&&(0,O.warn)("Invalid font matrix for font "+ot),mt<0?(mt=-mt,Et.fontDirection=-1):Et.fontDirection=1,this.current.font=pt,this.current.fontSize=mt,pt.isType3Font)return;const yt=pt.loadedName||"sans-serif",Tt=((zt=pt.systemFontInfo)==null?void 0:zt.css)||`"${yt}", ${pt.fallbackName}`;let kt="normal";pt.black?kt="900":pt.bold&&(kt="bold");const Bt=pt.italic?"italic":"normal";let Yt=mt;mt<tt?Yt=tt:mt>Y&&(Yt=Y),this.current.fontSizeScale=mt/Yt,this.ctx.font=`${Bt} ${kt} ${Yt}px ${Tt}`}setTextRenderingMode(ot){this.current.textRenderingMode=ot}setTextRise(ot){this.current.textRise=ot}moveText(ot,mt){this.current.x=this.current.lineX+=ot,this.current.y=this.current.lineY+=mt}setLeadingMoveText(ot,mt){this.setLeading(-mt),this.moveText(ot,mt)}setTextMatrix(ot,mt,pt,Et,yt,Tt){this.current.textMatrix=[ot,mt,pt,Et,yt,Tt],this.current.textMatrixScale=Math.hypot(ot,mt),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ot,mt,pt,Et){const yt=this.ctx,Tt=this.current,kt=Tt.font,Bt=Tt.textRenderingMode,Yt=Tt.fontSize/Tt.fontSizeScale,zt=Bt&O.TextRenderingMode.FILL_STROKE_MASK,Zt=!!(Bt&O.TextRenderingMode.ADD_TO_PATH_FLAG),ee=Tt.patternFill&&!kt.missingFile;let he;(kt.disableFontFace||Zt||ee)&&(he=kt.getPathGenerator(this.commonObjs,ot)),kt.disableFontFace||ee?(yt.save(),yt.translate(mt,pt),yt.beginPath(),he(yt,Yt),Et&&yt.setTransform(...Et),(zt===O.TextRenderingMode.FILL||zt===O.TextRenderingMode.FILL_STROKE)&&yt.fill(),(zt===O.TextRenderingMode.STROKE||zt===O.TextRenderingMode.FILL_STROKE)&&yt.stroke(),yt.restore()):((zt===O.TextRenderingMode.FILL||zt===O.TextRenderingMode.FILL_STROKE)&&yt.fillText(ot,mt,pt),(zt===O.TextRenderingMode.STROKE||zt===O.TextRenderingMode.FILL_STROKE)&&yt.strokeText(ot,mt,pt)),Zt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,U.getCurrentTransform)(yt),x:mt,y:pt,fontSize:Yt,addToPath:he})}get isFontSubpixelAAEnabled(){const{context:ot}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ot.scale(1.5,1),ot.fillText("I",0,10);const mt=ot.getImageData(0,0,10,10).data;let pt=!1;for(let Et=3;Et<mt.length;Et+=4)if(mt[Et]>0&&mt[Et]<255){pt=!0;break}return(0,O.shadow)(this,"isFontSubpixelAAEnabled",pt)}showText(ot){const mt=this.current,pt=mt.font;if(pt.isType3Font)return this.showType3Text(ot);const Et=mt.fontSize;if(Et===0)return;const yt=this.ctx,Tt=mt.fontSizeScale,kt=mt.charSpacing,Bt=mt.wordSpacing,Yt=mt.fontDirection,zt=mt.textHScale*Yt,Zt=ot.length,ee=pt.vertical,he=ee?1:-1,ne=pt.defaultVMetrics,be=Et*mt.fontMatrix[0],Ce=mt.textRenderingMode===O.TextRenderingMode.FILL&&!pt.disableFontFace&&!mt.patternFill;yt.save(),yt.transform(...mt.textMatrix),yt.translate(mt.x,mt.y+mt.textRise),Yt>0?yt.scale(zt,-1):yt.scale(zt,1);let de;if(mt.patternFill){yt.save();const ie=mt.fillColor.getPattern(yt,this,(0,U.getCurrentTransformInverse)(yt),G.PathType.FILL);de=(0,U.getCurrentTransform)(yt),yt.restore(),yt.fillStyle=ie}let xe=mt.lineWidth;const se=mt.textMatrixScale;if(se===0||xe===0){const ie=mt.textRenderingMode&O.TextRenderingMode.FILL_STROKE_MASK;(ie===O.TextRenderingMode.STROKE||ie===O.TextRenderingMode.FILL_STROKE)&&(xe=this.getSinglePixelWidth())}else xe/=se;if(Tt!==1&&(yt.scale(Tt,Tt),xe/=Tt),yt.lineWidth=xe,pt.isInvalidPDFjsFont){const ie=[];let fe=0;for(const pe of ot)ie.push(pe.unicode),fe+=pe.width;yt.fillText(ie.join(""),0,0),mt.x+=fe*be*zt,yt.restore(),this.compose();return}let Gt=0,Vt;for(Vt=0;Vt<Zt;++Vt){const ie=ot[Vt];if(typeof ie=="number"){Gt+=he*ie*Et/1e3;continue}let fe=!1;const pe=(ie.isSpace?Bt:0)+kt,Te=ie.fontChar,ke=ie.accent;let Pe,Re,Oe=ie.width;if(ee){const Me=ie.vmetric||ne,te=-(ie.vmetric?Me[1]:Oe*.5)*be,Xt=Me[2]*be;Oe=Me?-Me[0]:Oe,Pe=te/Tt,Re=(Gt+Xt)/Tt}else Pe=Gt/Tt,Re=0;if(pt.remeasure&&Oe>0){const Me=yt.measureText(Te).width*1e3/Et*Tt;if(Oe<Me&&this.isFontSubpixelAAEnabled){const te=Oe/Me;fe=!0,yt.save(),yt.scale(te,1),Pe/=te}else Oe!==Me&&(Pe+=(Oe-Me)/2e3*Et/Tt)}if(this.contentVisible&&(ie.isInFont||pt.missingFile)){if(Ce&&!ke)yt.fillText(Te,Pe,Re);else if(this.paintChar(Te,Pe,Re,de),ke){const Me=Pe+Et*ke.offset.x/Tt,te=Re-Et*ke.offset.y/Tt;this.paintChar(ke.fontChar,Me,te,de)}}const Fe=ee?Oe*be-pe*Yt:Oe*be+pe*Yt;Gt+=Fe,fe&&yt.restore()}ee?mt.y-=Gt:mt.x+=Gt*zt,yt.restore(),this.compose()}showType3Text(ot){const mt=this.ctx,pt=this.current,Et=pt.font,yt=pt.fontSize,Tt=pt.fontDirection,kt=Et.vertical?1:-1,Bt=pt.charSpacing,Yt=pt.wordSpacing,zt=pt.textHScale*Tt,Zt=pt.fontMatrix||O.FONT_IDENTITY_MATRIX,ee=ot.length,he=pt.textRenderingMode===O.TextRenderingMode.INVISIBLE;let ne,be,Ce,de;if(!(he||yt===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,mt.save(),mt.transform(...pt.textMatrix),mt.translate(pt.x,pt.y),mt.scale(zt,Tt),ne=0;ne<ee;++ne){if(be=ot[ne],typeof be=="number"){de=kt*be*yt/1e3,this.ctx.translate(de,0),pt.x+=de*zt;continue}const xe=(be.isSpace?Yt:0)+Bt,se=Et.charProcOperatorList[be.operatorListId];if(!se){(0,O.warn)(`Type3 character "${be.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=be,this.save(),mt.scale(yt,yt),mt.transform(...Zt),this.executeOperatorList(se),this.restore()),Ce=O.Util.applyTransform([be.width,0],Zt)[0]*yt+xe,mt.translate(Ce,0),pt.x+=Ce*zt}mt.restore(),this.processingType3=null}}setCharWidth(ot,mt){}setCharWidthAndBounds(ot,mt,pt,Et,yt,Tt){this.ctx.rect(pt,Et,yt-pt,Tt-Et),this.ctx.clip(),this.endPath()}getColorN_Pattern(ot){let mt;if(ot[0]==="TilingPattern"){const pt=ot[1],Et=this.baseTransform||(0,U.getCurrentTransform)(this.ctx),yt={createCanvasGraphics:Tt=>new qt(Tt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};mt=new G.TilingPattern(ot,pt,this.ctx,yt,Et)}else mt=this._getPattern(ot[1],ot[2]);return mt}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ot,mt,pt){const Et=O.Util.makeHexColor(ot,mt,pt);this.ctx.strokeStyle=Et,this.current.strokeColor=Et}setFillRGBColor(ot,mt,pt){const Et=O.Util.makeHexColor(ot,mt,pt);this.ctx.fillStyle=Et,this.current.fillColor=Et,this.current.patternFill=!1}_getPattern(ot,mt=null){let pt;return this.cachedPatterns.has(ot)?pt=this.cachedPatterns.get(ot):(pt=(0,G.getShadingPattern)(this.getObject(ot)),this.cachedPatterns.set(ot,pt)),mt&&(pt.matrix=mt),pt}shadingFill(ot){if(!this.contentVisible)return;const mt=this.ctx;this.save();const pt=this._getPattern(ot);mt.fillStyle=pt.getPattern(mt,this,(0,U.getCurrentTransformInverse)(mt),G.PathType.SHADING);const Et=(0,U.getCurrentTransformInverse)(mt);if(Et){const{width:yt,height:Tt}=mt.canvas,[kt,Bt,Yt,zt]=O.Util.getAxialAlignedBoundingBox([0,0,yt,Tt],Et);this.ctx.fillRect(kt,Bt,Yt-kt,zt-Bt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,O.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,O.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ot,mt){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ot)&&ot.length===6&&this.transform(...ot),this.baseTransform=(0,U.getCurrentTransform)(this.ctx),mt)){const pt=mt[2]-mt[0],Et=mt[3]-mt[1];this.ctx.rect(mt[0],mt[1],pt,Et),this.current.updateRectMinMax((0,U.getCurrentTransform)(this.ctx),mt),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ot){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const mt=this.ctx;ot.isolated||(0,O.info)("TODO: Support non-isolated groups."),ot.knockout&&(0,O.warn)("Knockout groups not supported.");const pt=(0,U.getCurrentTransform)(mt);if(ot.matrix&&mt.transform(...ot.matrix),!ot.bbox)throw new Error("Bounding box is required.");let Et=O.Util.getAxialAlignedBoundingBox(ot.bbox,(0,U.getCurrentTransform)(mt));const yt=[0,0,mt.canvas.width,mt.canvas.height];Et=O.Util.intersect(Et,yt)||[0,0,0,0];const Tt=Math.floor(Et[0]),kt=Math.floor(Et[1]);let Bt=Math.max(Math.ceil(Et[2])-Tt,1),Yt=Math.max(Math.ceil(Et[3])-kt,1),zt=1,Zt=1;Bt>W&&(zt=Bt/W,Bt=W),Yt>W&&(Zt=Yt/W,Yt=W),this.current.startNewPathAndClipBox([0,0,Bt,Yt]);let ee="groupAt"+this.groupLevel;ot.smask&&(ee+="_smask_"+this.smaskCounter++%2);const he=this.cachedCanvases.getCanvas(ee,Bt,Yt),ne=he.context;ne.scale(1/zt,1/Zt),ne.translate(-Tt,-kt),ne.transform(...pt),ot.smask?this.smaskStack.push({canvas:he.canvas,context:ne,offsetX:Tt,offsetY:kt,scaleX:zt,scaleY:Zt,subtype:ot.smask.subtype,backdrop:ot.smask.backdrop,transferMap:ot.smask.transferMap||null,startTransformInverse:null}):(mt.setTransform(1,0,0,1,0,0),mt.translate(Tt,kt),mt.scale(zt,Zt),mt.save()),nt(mt,ne),this.ctx=ne,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(mt),this.groupLevel++}endGroup(ot){if(!this.contentVisible)return;this.groupLevel--;const mt=this.ctx,pt=this.groupStack.pop();if(this.ctx=pt,this.ctx.imageSmoothingEnabled=!1,ot.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Et=(0,U.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Et);const yt=O.Util.getAxialAlignedBoundingBox([0,0,mt.canvas.width,mt.canvas.height],Et);this.ctx.drawImage(mt.canvas,0,0),this.ctx.restore(),this.compose(yt)}}beginAnnotation(ot,mt,pt,Et,yt){if($t(this,Dt,Wr).call(this),ht(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(mt)&&mt.length===4){const Tt=mt[2]-mt[0],kt=mt[3]-mt[1];if(yt&&this.annotationCanvasMap){pt=pt.slice(),pt[4]-=mt[0],pt[5]-=mt[1],mt=mt.slice(),mt[0]=mt[1]=0,mt[2]=Tt,mt[3]=kt;const[Bt,Yt]=O.Util.singularValueDecompose2dScale((0,U.getCurrentTransform)(this.ctx)),{viewportScale:zt}=this,Zt=Math.ceil(Tt*this.outputScaleX*zt),ee=Math.ceil(kt*this.outputScaleY*zt);this.annotationCanvas=this.canvasFactory.create(Zt,ee);const{canvas:he,context:ne}=this.annotationCanvas;this.annotationCanvasMap.set(ot,he),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ne,this.ctx.save(),this.ctx.setTransform(Bt,0,0,-Yt,0,kt*Yt),ht(this.ctx)}else ht(this.ctx),this.ctx.rect(mt[0],mt[1],Tt,kt),this.ctx.clip(),this.endPath()}this.current=new at(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...pt),this.transform(...Et)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),$t(this,Qt,Hr).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ot){if(!this.contentVisible)return;const mt=ot.count;ot=this.getObject(ot.data,ot),ot.count=mt;const pt=this.ctx,Et=this.processingType3;if(Et&&(Et.compiled===void 0&&(Et.compiled=st(ot)),Et.compiled)){Et.compiled(pt);return}const yt=this._createMaskCanvas(ot),Tt=yt.canvas;pt.save(),pt.setTransform(1,0,0,1,0,0),pt.drawImage(Tt,yt.offsetX,yt.offsetY),pt.restore(),this.compose()}paintImageMaskXObjectRepeat(ot,mt,pt=0,Et=0,yt,Tt){if(!this.contentVisible)return;ot=this.getObject(ot.data,ot);const kt=this.ctx;kt.save();const Bt=(0,U.getCurrentTransform)(kt);kt.transform(mt,pt,Et,yt,0,0);const Yt=this._createMaskCanvas(ot);kt.setTransform(1,0,0,1,Yt.offsetX-Bt[4],Yt.offsetY-Bt[5]);for(let zt=0,Zt=Tt.length;zt<Zt;zt+=2){const ee=O.Util.transform(Bt,[mt,pt,Et,yt,Tt[zt],Tt[zt+1]]),[he,ne]=O.Util.applyTransform([0,0],ee);kt.drawImage(Yt.canvas,he,ne)}kt.restore(),this.compose()}paintImageMaskXObjectGroup(ot){if(!this.contentVisible)return;const mt=this.ctx,pt=this.current.fillColor,Et=this.current.patternFill;for(const yt of ot){const{data:Tt,width:kt,height:Bt,transform:Yt}=yt,zt=this.cachedCanvases.getCanvas("maskCanvas",kt,Bt),Zt=zt.context;Zt.save();const ee=this.getObject(Tt,yt);dt(Zt,ee),Zt.globalCompositeOperation="source-in",Zt.fillStyle=Et?pt.getPattern(Zt,this,(0,U.getCurrentTransformInverse)(mt),G.PathType.FILL):pt,Zt.fillRect(0,0,kt,Bt),Zt.restore(),mt.save(),mt.transform(...Yt),mt.scale(1,-1),rt(mt,zt.canvas,0,0,kt,Bt,0,-1,1,1),mt.restore()}this.compose()}paintImageXObject(ot){if(!this.contentVisible)return;const mt=this.getObject(ot);if(!mt){(0,O.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(mt)}paintImageXObjectRepeat(ot,mt,pt,Et){if(!this.contentVisible)return;const yt=this.getObject(ot);if(!yt){(0,O.warn)("Dependent image isn't ready yet");return}const Tt=yt.width,kt=yt.height,Bt=[];for(let Yt=0,zt=Et.length;Yt<zt;Yt+=2)Bt.push({transform:[mt,0,0,pt,Et[Yt],Et[Yt+1]],x:0,y:0,w:Tt,h:kt});this.paintInlineImageXObjectGroup(yt,Bt)}applyTransferMapsToCanvas(ot){return this.current.transferMaps!=="none"&&(ot.filter=this.current.transferMaps,ot.drawImage(ot.canvas,0,0),ot.filter="none"),ot.canvas}applyTransferMapsToBitmap(ot){if(this.current.transferMaps==="none")return ot.bitmap;const{bitmap:mt,width:pt,height:Et}=ot,yt=this.cachedCanvases.getCanvas("inlineImage",pt,Et),Tt=yt.context;return Tt.filter=this.current.transferMaps,Tt.drawImage(mt,0,0),Tt.filter="none",yt.canvas}paintInlineImageXObject(ot){if(!this.contentVisible)return;const mt=ot.width,pt=ot.height,Et=this.ctx;if(this.save(),!O.isNodeJS){const{filter:kt}=Et;kt!=="none"&&kt!==""&&(Et.filter="none")}Et.scale(1/mt,-1/pt);let yt;if(ot.bitmap)yt=this.applyTransferMapsToBitmap(ot);else if(typeof HTMLElement=="function"&&ot instanceof HTMLElement||!ot.data)yt=ot;else{const Bt=this.cachedCanvases.getCanvas("inlineImage",mt,pt).context;ct(Bt,ot),yt=this.applyTransferMapsToCanvas(Bt)}const Tt=this._scaleImage(yt,(0,U.getCurrentTransformInverse)(Et));Et.imageSmoothingEnabled=At((0,U.getCurrentTransform)(Et),ot.interpolate),rt(Et,Tt.img,0,0,Tt.paintWidth,Tt.paintHeight,0,-pt,mt,pt),this.compose(),this.restore()}paintInlineImageXObjectGroup(ot,mt){if(!this.contentVisible)return;const pt=this.ctx;let Et;if(ot.bitmap)Et=ot.bitmap;else{const yt=ot.width,Tt=ot.height,Bt=this.cachedCanvases.getCanvas("inlineImage",yt,Tt).context;ct(Bt,ot),Et=this.applyTransferMapsToCanvas(Bt)}for(const yt of mt)pt.save(),pt.transform(...yt.transform),pt.scale(1,-1),rt(pt,Et,yt.x,yt.y,yt.w,yt.h,0,-1,1,1),pt.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ot){}markPointProps(ot,mt){}beginMarkedContent(ot){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ot,mt){ot==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(mt)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ot){const mt=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ot);const pt=this.ctx;this.pendingClip&&(mt||(this.pendingClip===Ft?pt.clip("evenodd"):pt.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),pt.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ot=(0,U.getCurrentTransform)(this.ctx);if(ot[1]===0&&ot[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ot[0]),Math.abs(ot[3]));else{const mt=Math.abs(ot[0]*ot[3]-ot[2]*ot[1]),pt=Math.hypot(ot[0],ot[2]),Et=Math.hypot(ot[1],ot[3]);this._cachedGetSinglePixelWidth=Math.max(pt,Et)/mt}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:ot}=this.current,{a:mt,b:pt,c:Et,d:yt}=this.ctx.getTransform();let Tt,kt;if(pt===0&&Et===0){const Bt=Math.abs(mt),Yt=Math.abs(yt);if(Bt===Yt)if(ot===0)Tt=kt=1/Bt;else{const zt=Bt*ot;Tt=kt=zt<1?1/zt:1}else if(ot===0)Tt=1/Bt,kt=1/Yt;else{const zt=Bt*ot,Zt=Yt*ot;Tt=zt<1?1/zt:1,kt=Zt<1?1/Zt:1}}else{const Bt=Math.abs(mt*yt-pt*Et),Yt=Math.hypot(mt,pt),zt=Math.hypot(Et,yt);if(ot===0)Tt=zt/Bt,kt=Yt/Bt;else{const Zt=ot*Bt;Tt=zt>Zt?zt/Zt:1,kt=Yt>Zt?Yt/Zt:1}}this._cachedScaleForStroking[0]=Tt,this._cachedScaleForStroking[1]=kt}return this._cachedScaleForStroking}rescaleAndStroke(ot){const{ctx:mt}=this,{lineWidth:pt}=this.current,[Et,yt]=this.getScaleForStroking();if(mt.lineWidth=pt||1,Et===1&&yt===1){mt.stroke();return}const Tt=mt.getLineDash();if(ot&&mt.save(),mt.scale(Et,yt),Tt.length>0){const kt=Math.max(Et,yt);mt.setLineDash(Tt.map(Bt=>Bt/kt)),mt.lineDashOffset/=kt}mt.stroke(),ot&&mt.restore()}isContentVisible(){for(let ot=this.markedContentStack.length-1;ot>=0;ot--)if(!this.markedContentStack[ot].visible)return!1;return!0}};Dt=new WeakSet,Wr=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Qt=new WeakSet,Hr=function(){if(this.pageColors){const ot=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ot!=="none"){const mt=this.ctx.filter;this.ctx.filter=ot,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=mt}}};let Mt=qt;D.CanvasGraphics=Mt;for(const wt in O.OPS)Mt.prototype[wt]!==void 0&&(Mt.prototype[O.OPS[wt]]=Mt.prototype[wt])},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.TilingPattern=D.PathType=void 0,D.getShadingPattern=Q;var O=F(1),U=F(6);const G={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};D.PathType=G;function X(st,at){if(!at)return;const ct=at[2]-at[0],dt=at[3]-at[1],nt=new Path2D;nt.rect(at[0],at[1],ct,dt),st.clip(nt)}class tt{constructor(){this.constructor===tt&&(0,O.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,O.unreachable)("Abstract method `getPattern` called.")}}class Y extends tt{constructor(at){super(),this._type=at[1],this._bbox=at[2],this._colorStops=at[3],this._p0=at[4],this._p1=at[5],this._r0=at[6],this._r1=at[7],this.matrix=null}_createGradient(at){let ct;this._type==="axial"?ct=at.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(ct=at.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const dt of this._colorStops)ct.addColorStop(dt[0],dt[1]);return ct}getPattern(at,ct,dt,nt){let ht;if(nt===G.STROKE||nt===G.FILL){const vt=ct.current.getClippedPathBoundingBox(nt,(0,U.getCurrentTransform)(at))||[0,0,0,0],_t=Math.ceil(vt[2]-vt[0])||1,ut=Math.ceil(vt[3]-vt[1])||1,bt=ct.cachedCanvases.getCanvas("pattern",_t,ut,!0),gt=bt.context;gt.clearRect(0,0,gt.canvas.width,gt.canvas.height),gt.beginPath(),gt.rect(0,0,gt.canvas.width,gt.canvas.height),gt.translate(-vt[0],-vt[1]),dt=O.Util.transform(dt,[1,0,0,1,vt[0],vt[1]]),gt.transform(...ct.baseTransform),this.matrix&&gt.transform(...this.matrix),X(gt,this._bbox),gt.fillStyle=this._createGradient(gt),gt.fill(),ht=at.createPattern(bt.canvas,"no-repeat");const At=new DOMMatrix(dt);ht.setTransform(At)}else X(at,this._bbox),ht=this._createGradient(at);return ht}}function W(st,at,ct,dt,nt,ht,vt,_t){const ut=at.coords,bt=at.colors,gt=st.data,At=st.width*4;let St;ut[ct+1]>ut[dt+1]&&(St=ct,ct=dt,dt=St,St=ht,ht=vt,vt=St),ut[dt+1]>ut[nt+1]&&(St=dt,dt=nt,nt=St,St=vt,vt=_t,_t=St),ut[ct+1]>ut[dt+1]&&(St=ct,ct=dt,dt=St,St=ht,ht=vt,vt=St);const xt=(ut[ct]+at.offsetX)*at.scaleX,Pt=(ut[ct+1]+at.offsetY)*at.scaleY,Ft=(ut[dt]+at.offsetX)*at.scaleX,Mt=(ut[dt+1]+at.offsetY)*at.scaleY,Dt=(ut[nt]+at.offsetX)*at.scaleX,Ut=(ut[nt+1]+at.offsetY)*at.scaleY;if(Pt>=Ut)return;const Qt=bt[ht],Lt=bt[ht+1],qt=bt[ht+2],wt=bt[vt],ot=bt[vt+1],mt=bt[vt+2],pt=bt[_t],Et=bt[_t+1],yt=bt[_t+2],Tt=Math.round(Pt),kt=Math.round(Ut);let Bt,Yt,zt,Zt,ee,he,ne,be;for(let Ce=Tt;Ce<=kt;Ce++){if(Ce<Mt){const Vt=Ce<Pt?0:(Pt-Ce)/(Pt-Mt);Bt=xt-(xt-Ft)*Vt,Yt=Qt-(Qt-wt)*Vt,zt=Lt-(Lt-ot)*Vt,Zt=qt-(qt-mt)*Vt}else{let Vt;Ce>Ut?Vt=1:Mt===Ut?Vt=0:Vt=(Mt-Ce)/(Mt-Ut),Bt=Ft-(Ft-Dt)*Vt,Yt=wt-(wt-pt)*Vt,zt=ot-(ot-Et)*Vt,Zt=mt-(mt-yt)*Vt}let de;Ce<Pt?de=0:Ce>Ut?de=1:de=(Pt-Ce)/(Pt-Ut),ee=xt-(xt-Dt)*de,he=Qt-(Qt-pt)*de,ne=Lt-(Lt-Et)*de,be=qt-(qt-yt)*de;const xe=Math.round(Math.min(Bt,ee)),se=Math.round(Math.max(Bt,ee));let Gt=At*Ce+xe*4;for(let Vt=xe;Vt<=se;Vt++)de=(Bt-Vt)/(Bt-ee),de<0?de=0:de>1&&(de=1),gt[Gt++]=Yt-(Yt-he)*de|0,gt[Gt++]=zt-(zt-ne)*de|0,gt[Gt++]=Zt-(Zt-be)*de|0,gt[Gt++]=255}}function z(st,at,ct){const dt=at.coords,nt=at.colors;let ht,vt;switch(at.type){case"lattice":const _t=at.verticesPerRow,ut=Math.floor(dt.length/_t)-1,bt=_t-1;for(ht=0;ht<ut;ht++){let gt=ht*_t;for(let At=0;At<bt;At++,gt++)W(st,ct,dt[gt],dt[gt+1],dt[gt+_t],nt[gt],nt[gt+1],nt[gt+_t]),W(st,ct,dt[gt+_t+1],dt[gt+1],dt[gt+_t],nt[gt+_t+1],nt[gt+1],nt[gt+_t])}break;case"triangles":for(ht=0,vt=dt.length;ht<vt;ht+=3)W(st,ct,dt[ht],dt[ht+1],dt[ht+2],nt[ht],nt[ht+1],nt[ht+2]);break;default:throw new Error("illegal figure")}}class K extends tt{constructor(at){super(),this._coords=at[2],this._colors=at[3],this._figures=at[4],this._bounds=at[5],this._bbox=at[7],this._background=at[8],this.matrix=null}_createMeshCanvas(at,ct,dt){const _t=Math.floor(this._bounds[0]),ut=Math.floor(this._bounds[1]),bt=Math.ceil(this._bounds[2])-_t,gt=Math.ceil(this._bounds[3])-ut,At=Math.min(Math.ceil(Math.abs(bt*at[0]*1.1)),3e3),St=Math.min(Math.ceil(Math.abs(gt*at[1]*1.1)),3e3),xt=bt/At,Pt=gt/St,Ft={coords:this._coords,colors:this._colors,offsetX:-_t,offsetY:-ut,scaleX:1/xt,scaleY:1/Pt},Mt=At+2*2,Dt=St+2*2,Ut=dt.getCanvas("mesh",Mt,Dt,!1),Qt=Ut.context,Lt=Qt.createImageData(At,St);if(ct){const wt=Lt.data;for(let ot=0,mt=wt.length;ot<mt;ot+=4)wt[ot]=ct[0],wt[ot+1]=ct[1],wt[ot+2]=ct[2],wt[ot+3]=255}for(const wt of this._figures)z(Lt,wt,Ft);return Qt.putImageData(Lt,2,2),{canvas:Ut.canvas,offsetX:_t-2*xt,offsetY:ut-2*Pt,scaleX:xt,scaleY:Pt}}getPattern(at,ct,dt,nt){X(at,this._bbox);let ht;if(nt===G.SHADING)ht=O.Util.singularValueDecompose2dScale((0,U.getCurrentTransform)(at));else if(ht=O.Util.singularValueDecompose2dScale(ct.baseTransform),this.matrix){const _t=O.Util.singularValueDecompose2dScale(this.matrix);ht=[ht[0]*_t[0],ht[1]*_t[1]]}const vt=this._createMeshCanvas(ht,nt===G.SHADING?null:this._background,ct.cachedCanvases);return nt!==G.SHADING&&(at.setTransform(...ct.baseTransform),this.matrix&&at.transform(...this.matrix)),at.translate(vt.offsetX,vt.offsetY),at.scale(vt.scaleX,vt.scaleY),at.createPattern(vt.canvas,"no-repeat")}}class J extends tt{getPattern(){return"hotpink"}}function Q(st){switch(st[0]){case"RadialAxial":return new Y(st);case"Mesh":return new K(st);case"Dummy":return new J}throw new Error(`Unknown IR type: ${st[0]}`)}const et={COLORED:1,UNCOLORED:2},rt=class rt{constructor(at,ct,dt,nt,ht){this.operatorList=at[2],this.matrix=at[3]||[1,0,0,1,0,0],this.bbox=at[4],this.xstep=at[5],this.ystep=at[6],this.paintType=at[7],this.tilingType=at[8],this.color=ct,this.ctx=dt,this.canvasGraphicsFactory=nt,this.baseTransform=ht}createPatternCanvas(at){const ct=this.operatorList,dt=this.bbox,nt=this.xstep,ht=this.ystep,vt=this.paintType,_t=this.tilingType,ut=this.color,bt=this.canvasGraphicsFactory;(0,O.info)("TilingType: "+_t);const gt=dt[0],At=dt[1],St=dt[2],xt=dt[3],Pt=O.Util.singularValueDecompose2dScale(this.matrix),Ft=O.Util.singularValueDecompose2dScale(this.baseTransform),Mt=[Pt[0]*Ft[0],Pt[1]*Ft[1]],Dt=this.getSizeAndScale(nt,this.ctx.canvas.width,Mt[0]),Ut=this.getSizeAndScale(ht,this.ctx.canvas.height,Mt[1]),Qt=at.cachedCanvases.getCanvas("pattern",Dt.size,Ut.size,!0),Lt=Qt.context,qt=bt.createCanvasGraphics(Lt);qt.groupLevel=at.groupLevel,this.setFillAndStrokeStyleToContext(qt,vt,ut);let wt=gt,ot=At,mt=St,pt=xt;return gt<0&&(wt=0,mt+=Math.abs(gt)),At<0&&(ot=0,pt+=Math.abs(At)),Lt.translate(-(Dt.scale*wt),-(Ut.scale*ot)),qt.transform(Dt.scale,0,0,Ut.scale,0,0),Lt.save(),this.clipBbox(qt,wt,ot,mt,pt),qt.baseTransform=(0,U.getCurrentTransform)(qt.ctx),qt.executeOperatorList(ct),qt.endDrawing(),{canvas:Qt.canvas,scaleX:Dt.scale,scaleY:Ut.scale,offsetX:wt,offsetY:ot}}getSizeAndScale(at,ct,dt){at=Math.abs(at);const nt=Math.max(rt.MAX_PATTERN_SIZE,ct);let ht=Math.ceil(at*dt);return ht>=nt?ht=nt:dt=ht/at,{scale:dt,size:ht}}clipBbox(at,ct,dt,nt,ht){const vt=nt-ct,_t=ht-dt;at.ctx.rect(ct,dt,vt,_t),at.current.updateRectMinMax((0,U.getCurrentTransform)(at.ctx),[ct,dt,nt,ht]),at.clip(),at.endPath()}setFillAndStrokeStyleToContext(at,ct,dt){const nt=at.ctx,ht=at.current;switch(ct){case et.COLORED:const vt=this.ctx;nt.fillStyle=vt.fillStyle,nt.strokeStyle=vt.strokeStyle,ht.fillColor=vt.fillStyle,ht.strokeColor=vt.strokeStyle;break;case et.UNCOLORED:const _t=O.Util.makeHexColor(dt[0],dt[1],dt[2]);nt.fillStyle=_t,nt.strokeStyle=_t,ht.fillColor=_t,ht.strokeColor=_t;break;default:throw new O.FormatError(`Unsupported paint type: ${ct}`)}}getPattern(at,ct,dt,nt){let ht=dt;nt!==G.SHADING&&(ht=O.Util.transform(ht,ct.baseTransform),this.matrix&&(ht=O.Util.transform(ht,this.matrix)));const vt=this.createPatternCanvas(ct);let _t=new DOMMatrix(ht);_t=_t.translate(vt.offsetX,vt.offsetY),_t=_t.scale(1/vt.scaleX,1/vt.scaleY);const ut=at.createPattern(vt.canvas,"repeat");return ut.setTransform(_t),ut}};He(rt,"MAX_PATTERN_SIZE",3e3);let it=rt;D.TilingPattern=it},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.convertBlackAndWhiteToRGBA=G,D.convertToRGBA=U,D.grayToRGBA=tt;var O=F(1);function U(Y){switch(Y.kind){case O.ImageKind.GRAYSCALE_1BPP:return G(Y);case O.ImageKind.RGB_24BPP:return X(Y)}return null}function G({src:Y,srcPos:W=0,dest:z,width:K,height:J,nonBlackColor:Q=4294967295,inverseDecode:et=!1}){const it=O.FeatureTest.isLittleEndian?4278190080:255,[rt,st]=et?[Q,it]:[it,Q],at=K>>3,ct=K&7,dt=Y.length;z=new Uint32Array(z.buffer);let nt=0;for(let ht=0;ht<J;ht++){for(const _t=W+at;W<_t;W++){const ut=W<dt?Y[W]:255;z[nt++]=ut&128?st:rt,z[nt++]=ut&64?st:rt,z[nt++]=ut&32?st:rt,z[nt++]=ut&16?st:rt,z[nt++]=ut&8?st:rt,z[nt++]=ut&4?st:rt,z[nt++]=ut&2?st:rt,z[nt++]=ut&1?st:rt}if(ct===0)continue;const vt=W<dt?Y[W++]:255;for(let _t=0;_t<ct;_t++)z[nt++]=vt&1<<7-_t?st:rt}return{srcPos:W,destPos:nt}}function X({src:Y,srcPos:W=0,dest:z,destPos:K=0,width:J,height:Q}){let et=0;const it=Y.length>>2,rt=new Uint32Array(Y.buffer,W,it);if(O.FeatureTest.isLittleEndian){for(;et<it-2;et+=3,K+=4){const st=rt[et],at=rt[et+1],ct=rt[et+2];z[K]=st|4278190080,z[K+1]=st>>>24|at<<8|4278190080,z[K+2]=at>>>16|ct<<16|4278190080,z[K+3]=ct>>>8|4278190080}for(let st=et*4,at=Y.length;st<at;st+=3)z[K++]=Y[st]|Y[st+1]<<8|Y[st+2]<<16|4278190080}else{for(;et<it-2;et+=3,K+=4){const st=rt[et],at=rt[et+1],ct=rt[et+2];z[K]=st|255,z[K+1]=st<<24|at>>>8|255,z[K+2]=at<<16|ct>>>16|255,z[K+3]=ct<<8|255}for(let st=et*4,at=Y.length;st<at;st+=3)z[K++]=Y[st]<<24|Y[st+1]<<16|Y[st+2]<<8|255}return{srcPos:W,destPos:K}}function tt(Y,W){if(O.FeatureTest.isLittleEndian)for(let z=0,K=Y.length;z<K;z++)W[z]=Y[z]*65793|4278190080;else for(let z=0,K=Y.length;z<K;z++)W[z]=Y[z]*16843008|255}},(B,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.GlobalWorkerOptions=void 0;const F=Object.create(null);D.GlobalWorkerOptions=F,F.workerPort=null,F.workerSrc=""},(B,D,F)=>{var Y,vi,z,Ai,J,mr;Object.defineProperty(D,"__esModule",{value:!0}),D.MessageHandler=void 0;var O=F(1);const U={UNKNOWN:0,DATA:1,ERROR:2},G={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function X(et){switch(et instanceof Error||typeof et=="object"&&et!==null||(0,O.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),et.name){case"AbortException":return new O.AbortException(et.message);case"MissingPDFException":return new O.MissingPDFException(et.message);case"PasswordException":return new O.PasswordException(et.message,et.code);case"UnexpectedResponseException":return new O.UnexpectedResponseException(et.message,et.status);case"UnknownErrorException":return new O.UnknownErrorException(et.message,et.details);default:return new O.UnknownErrorException(et.message,et.toString())}}class tt{constructor(it,rt,st){It(this,Y);It(this,z);It(this,J);this.sourceName=it,this.targetName=rt,this.comObj=st,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=at=>{const ct=at.data;if(ct.targetName!==this.sourceName)return;if(ct.stream){$t(this,z,Ai).call(this,ct);return}if(ct.callback){const nt=ct.callbackId,ht=this.callbackCapabilities[nt];if(!ht)throw new Error(`Cannot resolve callback ${nt}`);if(delete this.callbackCapabilities[nt],ct.callback===U.DATA)ht.resolve(ct.data);else if(ct.callback===U.ERROR)ht.reject(X(ct.reason));else throw new Error("Unexpected callback case");return}const dt=this.actionHandler[ct.action];if(!dt)throw new Error(`Unknown action from worker: ${ct.action}`);if(ct.callbackId){const nt=this.sourceName,ht=ct.sourceName;new Promise(function(vt){vt(dt(ct.data))}).then(function(vt){st.postMessage({sourceName:nt,targetName:ht,callback:U.DATA,callbackId:ct.callbackId,data:vt})},function(vt){st.postMessage({sourceName:nt,targetName:ht,callback:U.ERROR,callbackId:ct.callbackId,reason:X(vt)})});return}if(ct.streamId){$t(this,Y,vi).call(this,ct);return}dt(ct.data)},st.addEventListener("message",this._onComObjOnMessage)}on(it,rt){const st=this.actionHandler;if(st[it])throw new Error(`There is already an actionName called "${it}"`);st[it]=rt}send(it,rt,st){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:it,data:rt},st)}sendWithPromise(it,rt,st){const at=this.callbackId++,ct=new O.PromiseCapability;this.callbackCapabilities[at]=ct;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:it,callbackId:at,data:rt},st)}catch(dt){ct.reject(dt)}return ct.promise}sendWithStream(it,rt,st,at){const ct=this.streamId++,dt=this.sourceName,nt=this.targetName,ht=this.comObj;return new ReadableStream({start:vt=>{const _t=new O.PromiseCapability;return this.streamControllers[ct]={controller:vt,startCall:_t,pullCall:null,cancelCall:null,isClosed:!1},ht.postMessage({sourceName:dt,targetName:nt,action:it,streamId:ct,data:rt,desiredSize:vt.desiredSize},at),_t.promise},pull:vt=>{const _t=new O.PromiseCapability;return this.streamControllers[ct].pullCall=_t,ht.postMessage({sourceName:dt,targetName:nt,stream:G.PULL,streamId:ct,desiredSize:vt.desiredSize}),_t.promise},cancel:vt=>{(0,O.assert)(vt instanceof Error,"cancel must have a valid reason");const _t=new O.PromiseCapability;return this.streamControllers[ct].cancelCall=_t,this.streamControllers[ct].isClosed=!0,ht.postMessage({sourceName:dt,targetName:nt,stream:G.CANCEL,streamId:ct,reason:X(vt)}),_t.promise}},st)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}Y=new WeakSet,vi=function(it){const rt=it.streamId,st=this.sourceName,at=it.sourceName,ct=this.comObj,dt=this,nt=this.actionHandler[it.action],ht={enqueue(vt,_t=1,ut){if(this.isCancelled)return;const bt=this.desiredSize;this.desiredSize-=_t,bt>0&&this.desiredSize<=0&&(this.sinkCapability=new O.PromiseCapability,this.ready=this.sinkCapability.promise),ct.postMessage({sourceName:st,targetName:at,stream:G.ENQUEUE,streamId:rt,chunk:vt},ut)},close(){this.isCancelled||(this.isCancelled=!0,ct.postMessage({sourceName:st,targetName:at,stream:G.CLOSE,streamId:rt}),delete dt.streamSinks[rt])},error(vt){(0,O.assert)(vt instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,ct.postMessage({sourceName:st,targetName:at,stream:G.ERROR,streamId:rt,reason:X(vt)}))},sinkCapability:new O.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:it.desiredSize,ready:null};ht.sinkCapability.resolve(),ht.ready=ht.sinkCapability.promise,this.streamSinks[rt]=ht,new Promise(function(vt){vt(nt(it.data,ht))}).then(function(){ct.postMessage({sourceName:st,targetName:at,stream:G.START_COMPLETE,streamId:rt,success:!0})},function(vt){ct.postMessage({sourceName:st,targetName:at,stream:G.START_COMPLETE,streamId:rt,reason:X(vt)})})},z=new WeakSet,Ai=function(it){const rt=it.streamId,st=this.sourceName,at=it.sourceName,ct=this.comObj,dt=this.streamControllers[rt],nt=this.streamSinks[rt];switch(it.stream){case G.START_COMPLETE:it.success?dt.startCall.resolve():dt.startCall.reject(X(it.reason));break;case G.PULL_COMPLETE:it.success?dt.pullCall.resolve():dt.pullCall.reject(X(it.reason));break;case G.PULL:if(!nt){ct.postMessage({sourceName:st,targetName:at,stream:G.PULL_COMPLETE,streamId:rt,success:!0});break}nt.desiredSize<=0&&it.desiredSize>0&&nt.sinkCapability.resolve(),nt.desiredSize=it.desiredSize,new Promise(function(ht){var vt;ht((vt=nt.onPull)==null?void 0:vt.call(nt))}).then(function(){ct.postMessage({sourceName:st,targetName:at,stream:G.PULL_COMPLETE,streamId:rt,success:!0})},function(ht){ct.postMessage({sourceName:st,targetName:at,stream:G.PULL_COMPLETE,streamId:rt,reason:X(ht)})});break;case G.ENQUEUE:if((0,O.assert)(dt,"enqueue should have stream controller"),dt.isClosed)break;dt.controller.enqueue(it.chunk);break;case G.CLOSE:if((0,O.assert)(dt,"close should have stream controller"),dt.isClosed)break;dt.isClosed=!0,dt.controller.close(),$t(this,J,mr).call(this,dt,rt);break;case G.ERROR:(0,O.assert)(dt,"error should have stream controller"),dt.controller.error(X(it.reason)),$t(this,J,mr).call(this,dt,rt);break;case G.CANCEL_COMPLETE:it.success?dt.cancelCall.resolve():dt.cancelCall.reject(X(it.reason)),$t(this,J,mr).call(this,dt,rt);break;case G.CANCEL:if(!nt)break;new Promise(function(ht){var vt;ht((vt=nt.onCancel)==null?void 0:vt.call(nt,X(it.reason)))}).then(function(){ct.postMessage({sourceName:st,targetName:at,stream:G.CANCEL_COMPLETE,streamId:rt,success:!0})},function(ht){ct.postMessage({sourceName:st,targetName:at,stream:G.CANCEL_COMPLETE,streamId:rt,reason:X(ht)})}),nt.sinkCapability.reject(X(it.reason)),nt.isCancelled=!0,delete this.streamSinks[rt];break;default:throw new Error("Unexpected stream case")}},J=new WeakSet,mr=async function(it,rt){var st,at,ct;await Promise.allSettled([(st=it.startCall)==null?void 0:st.promise,(at=it.pullCall)==null?void 0:at.promise,(ct=it.cancelCall)==null?void 0:ct.promise]),delete this.streamControllers[rt]},D.MessageHandler=tt},(B,D,F)=>{var G,X;Object.defineProperty(D,"__esModule",{value:!0}),D.Metadata=void 0;var O=F(1);class U{constructor({parsedData:Y,rawData:W}){It(this,G,void 0);It(this,X,void 0);Kt(this,G,Y),Kt(this,X,W)}getRaw(){return lt(this,X)}get(Y){return lt(this,G).get(Y)??null}getAll(){return(0,O.objectFromMap)(lt(this,G))}has(Y){return lt(this,G).has(Y)}}G=new WeakMap,X=new WeakMap,D.Metadata=U},(B,D,F)=>{var Y,W,z,K,J,Q,qr;Object.defineProperty(D,"__esModule",{value:!0}),D.OptionalContentConfig=void 0;var O=F(1),U=F(8);const G=Symbol("INTERNAL");class X{constructor(rt,st){It(this,Y,!0);this.name=rt,this.intent=st}get visible(){return lt(this,Y)}_setVisible(rt,st){rt!==G&&(0,O.unreachable)("Internal method `_setVisible` called."),Kt(this,Y,st)}}Y=new WeakMap;class tt{constructor(rt){It(this,Q);It(this,W,null);It(this,z,new Map);It(this,K,null);It(this,J,null);if(this.name=null,this.creator=null,rt!==null){this.name=rt.name,this.creator=rt.creator,Kt(this,J,rt.order);for(const st of rt.groups)lt(this,z).set(st.id,new X(st.name,st.intent));if(rt.baseState==="OFF")for(const st of lt(this,z).values())st._setVisible(G,!1);for(const st of rt.on)lt(this,z).get(st)._setVisible(G,!0);for(const st of rt.off)lt(this,z).get(st)._setVisible(G,!1);Kt(this,K,this.getHash())}}isVisible(rt){if(lt(this,z).size===0)return!0;if(!rt)return(0,O.warn)("Optional content group not defined."),!0;if(rt.type==="OCG")return lt(this,z).has(rt.id)?lt(this,z).get(rt.id).visible:((0,O.warn)(`Optional content group not found: ${rt.id}`),!0);if(rt.type==="OCMD"){if(rt.expression)return $t(this,Q,qr).call(this,rt.expression);if(!rt.policy||rt.policy==="AnyOn"){for(const st of rt.ids){if(!lt(this,z).has(st))return(0,O.warn)(`Optional content group not found: ${st}`),!0;if(lt(this,z).get(st).visible)return!0}return!1}else if(rt.policy==="AllOn"){for(const st of rt.ids){if(!lt(this,z).has(st))return(0,O.warn)(`Optional content group not found: ${st}`),!0;if(!lt(this,z).get(st).visible)return!1}return!0}else if(rt.policy==="AnyOff"){for(const st of rt.ids){if(!lt(this,z).has(st))return(0,O.warn)(`Optional content group not found: ${st}`),!0;if(!lt(this,z).get(st).visible)return!0}return!1}else if(rt.policy==="AllOff"){for(const st of rt.ids){if(!lt(this,z).has(st))return(0,O.warn)(`Optional content group not found: ${st}`),!0;if(lt(this,z).get(st).visible)return!1}return!0}return(0,O.warn)(`Unknown optional content policy ${rt.policy}.`),!0}return(0,O.warn)(`Unknown group type ${rt.type}.`),!0}setVisibility(rt,st=!0){if(!lt(this,z).has(rt)){(0,O.warn)(`Optional content group not found: ${rt}`);return}lt(this,z).get(rt)._setVisible(G,!!st),Kt(this,W,null)}get hasInitialVisibility(){return lt(this,K)===null||this.getHash()===lt(this,K)}getOrder(){return lt(this,z).size?lt(this,J)?lt(this,J).slice():[...lt(this,z).keys()]:null}getGroups(){return lt(this,z).size>0?(0,O.objectFromMap)(lt(this,z)):null}getGroup(rt){return lt(this,z).get(rt)||null}getHash(){if(lt(this,W)!==null)return lt(this,W);const rt=new U.MurmurHash3_64;for(const[st,at]of lt(this,z))rt.update(`${st}:${at.visible}`);return Kt(this,W,rt.hexdigest())}}W=new WeakMap,z=new WeakMap,K=new WeakMap,J=new WeakMap,Q=new WeakSet,qr=function(rt){const st=rt.length;if(st<2)return!0;const at=rt[0];for(let ct=1;ct<st;ct++){const dt=rt[ct];let nt;if(Array.isArray(dt))nt=$t(this,Q,qr).call(this,dt);else if(lt(this,z).has(dt))nt=lt(this,z).get(dt).visible;else return(0,O.warn)(`Optional content group not found: ${dt}`),!0;switch(at){case"And":if(!nt)return!1;break;case"Or":if(nt)return!0;break;case"Not":return!nt;default:return!0}}return at==="And"},D.OptionalContentConfig=tt},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.PDFDataTransportStream=void 0;var O=F(1),U=F(6);class G{constructor({length:W,initialData:z,progressiveDone:K=!1,contentDispositionFilename:J=null,disableRange:Q=!1,disableStream:et=!1},it){if((0,O.assert)(it,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=K,this._contentDispositionFilename=J,(z==null?void 0:z.length)>0){const rt=z instanceof Uint8Array&&z.byteLength===z.buffer.byteLength?z.buffer:new Uint8Array(z).buffer;this._queuedChunks.push(rt)}this._pdfDataRangeTransport=it,this._isStreamingSupported=!et,this._isRangeSupported=!Q,this._contentLength=W,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((rt,st)=>{this._onReceiveData({begin:rt,chunk:st})}),this._pdfDataRangeTransport.addProgressListener((rt,st)=>{this._onProgress({loaded:rt,total:st})}),this._pdfDataRangeTransport.addProgressiveReadListener(rt=>{this._onReceiveData({chunk:rt})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:W,chunk:z}){const K=z instanceof Uint8Array&&z.byteLength===z.buffer.byteLength?z.buffer:new Uint8Array(z).buffer;if(W===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(K):this._queuedChunks.push(K);else{const J=this._rangeReaders.some(function(Q){return Q._begin!==W?!1:(Q._enqueue(K),!0)});(0,O.assert)(J,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var W;return((W=this._fullRequestReader)==null?void 0:W._loaded)??0}_onProgress(W){var z,K,J,Q;W.total===void 0?(K=(z=this._rangeReaders[0])==null?void 0:z.onProgress)==null||K.call(z,{loaded:W.loaded}):(Q=(J=this._fullRequestReader)==null?void 0:J.onProgress)==null||Q.call(J,{loaded:W.loaded,total:W.total})}_onProgressiveDone(){var W;(W=this._fullRequestReader)==null||W.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(W){const z=this._rangeReaders.indexOf(W);z>=0&&this._rangeReaders.splice(z,1)}getFullReader(){(0,O.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const W=this._queuedChunks;return this._queuedChunks=null,new X(this,W,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(W,z){if(z<=this._progressiveDataLength)return null;const K=new tt(this,W,z);return this._pdfDataRangeTransport.requestDataRange(W,z),this._rangeReaders.push(K),K}cancelAllRequests(W){var z;(z=this._fullRequestReader)==null||z.cancel(W);for(const K of this._rangeReaders.slice(0))K.cancel(W);this._pdfDataRangeTransport.abort()}}D.PDFDataTransportStream=G;class X{constructor(W,z,K=!1,J=null){this._stream=W,this._done=K||!1,this._filename=(0,U.isPdfFile)(J)?J:null,this._queuedChunks=z||[],this._loaded=0;for(const Q of this._queuedChunks)this._loaded+=Q.byteLength;this._requests=[],this._headersReady=Promise.resolve(),W._fullRequestReader=this,this.onProgress=null}_enqueue(W){this._done||(this._requests.length>0?this._requests.shift().resolve({value:W,done:!1}):this._queuedChunks.push(W),this._loaded+=W.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const W=new O.PromiseCapability;return this._requests.push(W),W.promise}cancel(W){this._done=!0;for(const z of this._requests)z.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tt{constructor(W,z,K){this._stream=W,this._begin=z,this._end=K,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(W){if(!this._done){if(this._requests.length===0)this._queuedChunk=W;else{this._requests.shift().resolve({value:W,done:!1});for(const K of this._requests)K.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const z=this._queuedChunk;return this._queuedChunk=null,{value:z,done:!1}}if(this._done)return{value:void 0,done:!0};const W=new O.PromiseCapability;return this._requests.push(W),W.promise}cancel(W){this._done=!0;for(const z of this._requests)z.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.PDFFetchStream=void 0;var O=F(1),U=F(20);function G(K,J,Q){return{method:"GET",headers:K,signal:Q.signal,mode:"cors",credentials:J?"include":"same-origin",redirect:"follow"}}function X(K){const J=new Headers;for(const Q in K){const et=K[Q];et!==void 0&&J.append(Q,et)}return J}function tt(K){return K instanceof Uint8Array?K.buffer:K instanceof ArrayBuffer?K:((0,O.warn)(`getArrayBuffer - unexpected data format: ${K}`),new Uint8Array(K).buffer)}class Y{constructor(J){this.source=J,this.isHttp=/^https?:/i.test(J.url),this.httpHeaders=this.isHttp&&J.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var J;return((J=this._fullRequestReader)==null?void 0:J._loaded)??0}getFullReader(){return(0,O.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new W(this),this._fullRequestReader}getRangeReader(J,Q){if(Q<=this._progressiveDataLength)return null;const et=new z(this,J,Q);return this._rangeRequestReaders.push(et),et}cancelAllRequests(J){var Q;(Q=this._fullRequestReader)==null||Q.cancel(J);for(const et of this._rangeRequestReaders.slice(0))et.cancel(J)}}D.PDFFetchStream=Y;class W{constructor(J){this._stream=J,this._reader=null,this._loaded=0,this._filename=null;const Q=J.source;this._withCredentials=Q.withCredentials||!1,this._contentLength=Q.length,this._headersCapability=new O.PromiseCapability,this._disableRange=Q.disableRange||!1,this._rangeChunkSize=Q.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!Q.disableStream,this._isRangeSupported=!Q.disableRange,this._headers=X(this._stream.httpHeaders);const et=Q.url;fetch(et,G(this._headers,this._withCredentials,this._abortController)).then(it=>{if(!(0,U.validateResponseStatus)(it.status))throw(0,U.createResponseStatusError)(it.status,et);this._reader=it.body.getReader(),this._headersCapability.resolve();const rt=ct=>it.headers.get(ct),{allowRangeRequests:st,suggestedLength:at}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:rt,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=st,this._contentLength=at||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(rt),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new O.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var et;await this._headersCapability.promise;const{value:J,done:Q}=await this._reader.read();return Q?{value:J,done:Q}:(this._loaded+=J.byteLength,(et=this.onProgress)==null||et.call(this,{loaded:this._loaded,total:this._contentLength}),{value:tt(J),done:!1})}cancel(J){var Q;(Q=this._reader)==null||Q.cancel(J),this._abortController.abort()}}class z{constructor(J,Q,et){this._stream=J,this._reader=null,this._loaded=0;const it=J.source;this._withCredentials=it.withCredentials||!1,this._readCapability=new O.PromiseCapability,this._isStreamingSupported=!it.disableStream,this._abortController=new AbortController,this._headers=X(this._stream.httpHeaders),this._headers.append("Range",`bytes=${Q}-${et-1}`);const rt=it.url;fetch(rt,G(this._headers,this._withCredentials,this._abortController)).then(st=>{if(!(0,U.validateResponseStatus)(st.status))throw(0,U.createResponseStatusError)(st.status,rt);this._readCapability.resolve(),this._reader=st.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var et;await this._readCapability.promise;const{value:J,done:Q}=await this._reader.read();return Q?{value:J,done:Q}:(this._loaded+=J.byteLength,(et=this.onProgress)==null||et.call(this,{loaded:this._loaded}),{value:tt(J),done:!1})}cancel(J){var Q;(Q=this._reader)==null||Q.cancel(J),this._abortController.abort()}}},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.createResponseStatusError=Y,D.extractFilenameFromHeader=tt,D.validateRangeRequestCapabilities=X,D.validateResponseStatus=W;var O=F(1),U=F(21),G=F(6);function X({getResponseHeader:z,isHttp:K,rangeChunkSize:J,disableRange:Q}){const et={allowRangeRequests:!1,suggestedLength:void 0},it=parseInt(z("Content-Length"),10);return!Number.isInteger(it)||(et.suggestedLength=it,it<=2*J)||Q||!K||z("Accept-Ranges")!=="bytes"||(z("Content-Encoding")||"identity")!=="identity"||(et.allowRangeRequests=!0),et}function tt(z){const K=z("Content-Disposition");if(K){let J=(0,U.getFilenameFromContentDispositionHeader)(K);if(J.includes("%"))try{J=decodeURIComponent(J)}catch{}if((0,G.isPdfFile)(J))return J}return null}function Y(z,K){return z===404||z===0&&K.startsWith("file:")?new O.MissingPDFException('Missing PDF "'+K+'".'):new O.UnexpectedResponseException(`Unexpected server response (${z}) while retrieving PDF "${K}".`,z)}function W(z){return z===200||z===206}},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.getFilenameFromContentDispositionHeader=U;var O=F(1);function U(G){let X=!0,tt=Y("filename\\*","i").exec(G);if(tt){tt=tt[1];let it=J(tt);return it=unescape(it),it=Q(it),it=et(it),z(it)}if(tt=K(G),tt){const it=et(tt);return z(it)}if(tt=Y("filename","i").exec(G),tt){tt=tt[1];let it=J(tt);return it=et(it),z(it)}function Y(it,rt){return new RegExp("(?:^|;)\\s*"+it+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',rt)}function W(it,rt){if(it){if(!/^[\x00-\xFF]+$/.test(rt))return rt;try{const st=new TextDecoder(it,{fatal:!0}),at=(0,O.stringToBytes)(rt);rt=st.decode(at),X=!1}catch{}}return rt}function z(it){return X&&/[\x80-\xff]/.test(it)&&(it=W("utf-8",it),X&&(it=W("iso-8859-1",it))),it}function K(it){const rt=[];let st;const at=Y("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(st=at.exec(it))!==null;){let[,dt,nt,ht]=st;if(dt=parseInt(dt,10),dt in rt){if(dt===0)break;continue}rt[dt]=[nt,ht]}const ct=[];for(let dt=0;dt<rt.length&&dt in rt;++dt){let[nt,ht]=rt[dt];ht=J(ht),nt&&(ht=unescape(ht),dt===0&&(ht=Q(ht))),ct.push(ht)}return ct.join("")}function J(it){if(it.startsWith('"')){const rt=it.slice(1).split('\\"');for(let st=0;st<rt.length;++st){const at=rt[st].indexOf('"');at!==-1&&(rt[st]=rt[st].slice(0,at),rt.length=st+1),rt[st]=rt[st].replaceAll(/\\(.)/g,"$1")}it=rt.join('"')}return it}function Q(it){const rt=it.indexOf("'");if(rt===-1)return it;const st=it.slice(0,rt),ct=it.slice(rt+1).replace(/^[^']*'/,"");return W(st,ct)}function et(it){return!it.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(it)?it:it.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(rt,st,at,ct){if(at==="q"||at==="Q")return ct=ct.replaceAll("_"," "),ct=ct.replaceAll(/=([0-9a-fA-F]{2})/g,function(dt,nt){return String.fromCharCode(parseInt(nt,16))}),W(st,ct);try{ct=atob(ct)}catch{}return W(st,ct)})}return""}},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.PDFNetworkStream=void 0;var O=F(1),U=F(20);const G=200,X=206;function tt(J){const Q=J.response;return typeof Q!="string"?Q:(0,O.stringToBytes)(Q).buffer}class Y{constructor(Q,et={}){this.url=Q,this.isHttp=/^https?:/i.test(Q),this.httpHeaders=this.isHttp&&et.httpHeaders||Object.create(null),this.withCredentials=et.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(Q,et,it){const rt={begin:Q,end:et};for(const st in it)rt[st]=it[st];return this.request(rt)}requestFull(Q){return this.request(Q)}request(Q){const et=new XMLHttpRequest,it=this.currXhrId++,rt=this.pendingRequests[it]={xhr:et};et.open("GET",this.url),et.withCredentials=this.withCredentials;for(const st in this.httpHeaders){const at=this.httpHeaders[st];at!==void 0&&et.setRequestHeader(st,at)}return this.isHttp&&"begin"in Q&&"end"in Q?(et.setRequestHeader("Range",`bytes=${Q.begin}-${Q.end-1}`),rt.expectedStatus=X):rt.expectedStatus=G,et.responseType="arraybuffer",Q.onError&&(et.onerror=function(st){Q.onError(et.status)}),et.onreadystatechange=this.onStateChange.bind(this,it),et.onprogress=this.onProgress.bind(this,it),rt.onHeadersReceived=Q.onHeadersReceived,rt.onDone=Q.onDone,rt.onError=Q.onError,rt.onProgress=Q.onProgress,et.send(null),it}onProgress(Q,et){var rt;const it=this.pendingRequests[Q];it&&((rt=it.onProgress)==null||rt.call(it,et))}onStateChange(Q,et){var dt,nt,ht;const it=this.pendingRequests[Q];if(!it)return;const rt=it.xhr;if(rt.readyState>=2&&it.onHeadersReceived&&(it.onHeadersReceived(),delete it.onHeadersReceived),rt.readyState!==4||!(Q in this.pendingRequests))return;if(delete this.pendingRequests[Q],rt.status===0&&this.isHttp){(dt=it.onError)==null||dt.call(it,rt.status);return}const st=rt.status||G;if(!(st===G&&it.expectedStatus===X)&&st!==it.expectedStatus){(nt=it.onError)==null||nt.call(it,rt.status);return}const ct=tt(rt);if(st===X){const vt=rt.getResponseHeader("Content-Range"),_t=/bytes (\d+)-(\d+)\/(\d+)/.exec(vt);it.onDone({begin:parseInt(_t[1],10),chunk:ct})}else ct?it.onDone({begin:0,chunk:ct}):(ht=it.onError)==null||ht.call(it,rt.status)}getRequestXhr(Q){return this.pendingRequests[Q].xhr}isPendingRequest(Q){return Q in this.pendingRequests}abortRequest(Q){const et=this.pendingRequests[Q].xhr;delete this.pendingRequests[Q],et.abort()}}class W{constructor(Q){this._source=Q,this._manager=new Y(Q.url,{httpHeaders:Q.httpHeaders,withCredentials:Q.withCredentials}),this._rangeChunkSize=Q.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(Q){const et=this._rangeRequestReaders.indexOf(Q);et>=0&&this._rangeRequestReaders.splice(et,1)}getFullReader(){return(0,O.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new z(this._manager,this._source),this._fullRequestReader}getRangeReader(Q,et){const it=new K(this._manager,Q,et);return it.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(it),it}cancelAllRequests(Q){var et;(et=this._fullRequestReader)==null||et.cancel(Q);for(const it of this._rangeRequestReaders.slice(0))it.cancel(Q)}}D.PDFNetworkStream=W;class z{constructor(Q,et){this._manager=Q;const it={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=et.url,this._fullRequestId=Q.requestFull(it),this._headersReceivedCapability=new O.PromiseCapability,this._disableRange=et.disableRange||!1,this._contentLength=et.length,this._rangeChunkSize=et.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const Q=this._fullRequestId,et=this._manager.getRequestXhr(Q),it=at=>et.getResponseHeader(at),{allowRangeRequests:rt,suggestedLength:st}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:it,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});rt&&(this._isRangeSupported=!0),this._contentLength=st||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(it),this._isRangeSupported&&this._manager.abortRequest(Q),this._headersReceivedCapability.resolve()}_onDone(Q){if(Q&&(this._requests.length>0?this._requests.shift().resolve({value:Q.chunk,done:!1}):this._cachedChunks.push(Q.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const et of this._requests)et.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(Q){this._storedError=(0,U.createResponseStatusError)(Q,this._url),this._headersReceivedCapability.reject(this._storedError);for(const et of this._requests)et.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(Q){var et;(et=this.onProgress)==null||et.call(this,{loaded:Q.loaded,total:Q.lengthComputable?Q.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Q=new O.PromiseCapability;return this._requests.push(Q),Q.promise}cancel(Q){this._done=!0,this._headersReceivedCapability.reject(Q);for(const et of this._requests)et.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class K{constructor(Q,et,it){this._manager=Q;const rt={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Q.url,this._requestId=Q.requestRange(et,it,rt),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var Q;(Q=this.onClosed)==null||Q.call(this,this)}_onDone(Q){const et=Q.chunk;this._requests.length>0?this._requests.shift().resolve({value:et,done:!1}):this._queuedChunk=et,this._done=!0;for(const it of this._requests)it.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(Q){this._storedError=(0,U.createResponseStatusError)(Q,this._url);for(const et of this._requests)et.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(Q){var et;this.isStreamingSupported||(et=this.onProgress)==null||et.call(this,{loaded:Q.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const et=this._queuedChunk;return this._queuedChunk=null,{value:et,done:!1}}if(this._done)return{value:void 0,done:!0};const Q=new O.PromiseCapability;return this._requests.push(Q),Q.promise}cancel(Q){this._done=!0;for(const et of this._requests)et.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.PDFNodeStream=void 0;var O=F(1),U=F(20);const G=/^file:\/\/\/[a-zA-Z]:\//;function X(it){const rt=require("url"),st=rt.parse(it);return st.protocol==="file:"||st.host?st:/^[a-z]:[/\\]/i.test(it)?rt.parse(`file:///${it}`):(st.host||(st.protocol="file:"),st)}class tt{constructor(rt){this.source=rt,this.url=X(rt.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&rt.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var rt;return((rt=this._fullRequestReader)==null?void 0:rt._loaded)??0}getFullReader(){return(0,O.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Q(this):new K(this),this._fullRequestReader}getRangeReader(rt,st){if(st<=this._progressiveDataLength)return null;const at=this.isFsUrl?new et(this,rt,st):new J(this,rt,st);return this._rangeRequestReaders.push(at),at}cancelAllRequests(rt){var st;(st=this._fullRequestReader)==null||st.cancel(rt);for(const at of this._rangeRequestReaders.slice(0))at.cancel(rt)}}D.PDFNodeStream=tt;class Y{constructor(rt){this._url=rt.url,this._done=!1,this._storedError=null,this.onProgress=null;const st=rt.source;this._contentLength=st.length,this._loaded=0,this._filename=null,this._disableRange=st.disableRange||!1,this._rangeChunkSize=st.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!st.disableStream,this._isRangeSupported=!st.disableRange,this._readableStream=null,this._readCapability=new O.PromiseCapability,this._headersCapability=new O.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var at;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const rt=this._readableStream.read();return rt===null?(this._readCapability=new O.PromiseCapability,this.read()):(this._loaded+=rt.length,(at=this.onProgress)==null||at.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(rt).buffer,done:!1})}cancel(rt){if(!this._readableStream){this._error(rt);return}this._readableStream.destroy(rt)}_error(rt){this._storedError=rt,this._readCapability.resolve()}_setReadableStream(rt){this._readableStream=rt,rt.on("readable",()=>{this._readCapability.resolve()}),rt.on("end",()=>{rt.destroy(),this._done=!0,this._readCapability.resolve()}),rt.on("error",st=>{this._error(st)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new O.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class W{constructor(rt){this._url=rt.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new O.PromiseCapability;const st=rt.source;this._isStreamingSupported=!st.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var at;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const rt=this._readableStream.read();return rt===null?(this._readCapability=new O.PromiseCapability,this.read()):(this._loaded+=rt.length,(at=this.onProgress)==null||at.call(this,{loaded:this._loaded}),{value:new Uint8Array(rt).buffer,done:!1})}cancel(rt){if(!this._readableStream){this._error(rt);return}this._readableStream.destroy(rt)}_error(rt){this._storedError=rt,this._readCapability.resolve()}_setReadableStream(rt){this._readableStream=rt,rt.on("readable",()=>{this._readCapability.resolve()}),rt.on("end",()=>{rt.destroy(),this._done=!0,this._readCapability.resolve()}),rt.on("error",st=>{this._error(st)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function z(it,rt){return{protocol:it.protocol,auth:it.auth,host:it.hostname,port:it.port,path:it.path,method:"GET",headers:rt}}class K extends Y{constructor(rt){super(rt);const st=at=>{if(at.statusCode===404){const ht=new O.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ht,this._headersCapability.reject(ht);return}this._headersCapability.resolve(),this._setReadableStream(at);const ct=ht=>this._readableStream.headers[ht.toLowerCase()],{allowRangeRequests:dt,suggestedLength:nt}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:ct,isHttp:rt.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=dt,this._contentLength=nt||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(ct)};if(this._request=null,this._url.protocol==="http:"){const at=require("http");this._request=at.request(z(this._url,rt.httpHeaders),st)}else{const at=require("https");this._request=at.request(z(this._url,rt.httpHeaders),st)}this._request.on("error",at=>{this._storedError=at,this._headersCapability.reject(at)}),this._request.end()}}class J extends W{constructor(rt,st,at){super(rt),this._httpHeaders={};for(const dt in rt.httpHeaders){const nt=rt.httpHeaders[dt];nt!==void 0&&(this._httpHeaders[dt]=nt)}this._httpHeaders.Range=`bytes=${st}-${at-1}`;const ct=dt=>{if(dt.statusCode===404){const nt=new O.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=nt;return}this._setReadableStream(dt)};if(this._request=null,this._url.protocol==="http:"){const dt=require("http");this._request=dt.request(z(this._url,this._httpHeaders),ct)}else{const dt=require("https");this._request=dt.request(z(this._url,this._httpHeaders),ct)}this._request.on("error",dt=>{this._storedError=dt}),this._request.end()}}class Q extends Y{constructor(rt){super(rt);let st=decodeURIComponent(this._url.path);G.test(this._url.href)&&(st=st.replace(/^\//,""));const at=require("fs");at.lstat(st,(ct,dt)=>{if(ct){ct.code==="ENOENT"&&(ct=new O.MissingPDFException(`Missing PDF "${st}".`)),this._storedError=ct,this._headersCapability.reject(ct);return}this._contentLength=dt.size,this._setReadableStream(at.createReadStream(st)),this._headersCapability.resolve()})}}class et extends W{constructor(rt,st,at){super(rt);let ct=decodeURIComponent(this._url.path);G.test(this._url.href)&&(ct=ct.replace(/^\//,""));const dt=require("fs");this._setReadableStream(dt.createReadStream(ct,{start:st,end:at-1}))}}},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.SVGGraphics=void 0;var O=F(6),U=F(1);const G={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},X="http://www.w3.org/XML/1998/namespace",tt="http://www.w3.org/1999/xlink",Y=["butt","round","square"],W=["miter","round","bevel"],z=function(dt,nt="",ht=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!ht)return URL.createObjectURL(new Blob([dt],{type:nt}));const vt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let _t=`data:${nt};base64,`;for(let ut=0,bt=dt.length;ut<bt;ut+=3){const gt=dt[ut]&255,At=dt[ut+1]&255,St=dt[ut+2]&255,xt=gt>>2,Pt=(gt&3)<<4|At>>4,Ft=ut+1<bt?(At&15)<<2|St>>6:64,Mt=ut+2<bt?St&63:64;_t+=vt[xt]+vt[Pt]+vt[Ft]+vt[Mt]}return _t},K=function(){const dt=new Uint8Array([137,80,78,71,13,10,26,10]),nt=12,ht=new Int32Array(256);for(let St=0;St<256;St++){let xt=St;for(let Pt=0;Pt<8;Pt++)xt=xt&1?3988292384^xt>>1&2147483647:xt>>1&2147483647;ht[St]=xt}function vt(St,xt,Pt){let Ft=-1;for(let Mt=xt;Mt<Pt;Mt++){const Dt=(Ft^St[Mt])&255,Ut=ht[Dt];Ft=Ft>>>8^Ut}return Ft^-1}function _t(St,xt,Pt,Ft){let Mt=Ft;const Dt=xt.length;Pt[Mt]=Dt>>24&255,Pt[Mt+1]=Dt>>16&255,Pt[Mt+2]=Dt>>8&255,Pt[Mt+3]=Dt&255,Mt+=4,Pt[Mt]=St.charCodeAt(0)&255,Pt[Mt+1]=St.charCodeAt(1)&255,Pt[Mt+2]=St.charCodeAt(2)&255,Pt[Mt+3]=St.charCodeAt(3)&255,Mt+=4,Pt.set(xt,Mt),Mt+=xt.length;const Ut=vt(Pt,Ft+4,Mt);Pt[Mt]=Ut>>24&255,Pt[Mt+1]=Ut>>16&255,Pt[Mt+2]=Ut>>8&255,Pt[Mt+3]=Ut&255}function ut(St,xt,Pt){let Ft=1,Mt=0;for(let Dt=xt;Dt<Pt;++Dt)Ft=(Ft+(St[Dt]&255))%65521,Mt=(Mt+Ft)%65521;return Mt<<16|Ft}function bt(St){if(!U.isNodeJS)return gt(St);try{const xt=parseInt(process.versions.node)>=8?St:Buffer.from(St),Pt=require("zlib").deflateSync(xt,{level:9});return Pt instanceof Uint8Array?Pt:new Uint8Array(Pt)}catch(xt){(0,U.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+xt)}return gt(St)}function gt(St){let xt=St.length;const Pt=65535,Ft=Math.ceil(xt/Pt),Mt=new Uint8Array(2+xt+Ft*5+4);let Dt=0;Mt[Dt++]=120,Mt[Dt++]=156;let Ut=0;for(;xt>Pt;)Mt[Dt++]=0,Mt[Dt++]=255,Mt[Dt++]=255,Mt[Dt++]=0,Mt[Dt++]=0,Mt.set(St.subarray(Ut,Ut+Pt),Dt),Dt+=Pt,Ut+=Pt,xt-=Pt;Mt[Dt++]=1,Mt[Dt++]=xt&255,Mt[Dt++]=xt>>8&255,Mt[Dt++]=~xt&65535&255,Mt[Dt++]=(~xt&65535)>>8&255,Mt.set(St.subarray(Ut),Dt),Dt+=St.length-Ut;const Qt=ut(St,0,St.length);return Mt[Dt++]=Qt>>24&255,Mt[Dt++]=Qt>>16&255,Mt[Dt++]=Qt>>8&255,Mt[Dt++]=Qt&255,Mt}function At(St,xt,Pt,Ft){const Mt=St.width,Dt=St.height;let Ut,Qt,Lt;const qt=St.data;switch(xt){case U.ImageKind.GRAYSCALE_1BPP:Qt=0,Ut=1,Lt=Mt+7>>3;break;case U.ImageKind.RGB_24BPP:Qt=2,Ut=8,Lt=Mt*3;break;case U.ImageKind.RGBA_32BPP:Qt=6,Ut=8,Lt=Mt*4;break;default:throw new Error("invalid format")}const wt=new Uint8Array((1+Lt)*Dt);let ot=0,mt=0;for(let Bt=0;Bt<Dt;++Bt)wt[ot++]=0,wt.set(qt.subarray(mt,mt+Lt),ot),mt+=Lt,ot+=Lt;if(xt===U.ImageKind.GRAYSCALE_1BPP&&Ft){ot=0;for(let Bt=0;Bt<Dt;Bt++){ot++;for(let Yt=0;Yt<Lt;Yt++)wt[ot++]^=255}}const pt=new Uint8Array([Mt>>24&255,Mt>>16&255,Mt>>8&255,Mt&255,Dt>>24&255,Dt>>16&255,Dt>>8&255,Dt&255,Ut,Qt,0,0,0]),Et=bt(wt),yt=dt.length+nt*3+pt.length+Et.length,Tt=new Uint8Array(yt);let kt=0;return Tt.set(dt,kt),kt+=dt.length,_t("IHDR",pt,Tt,kt),kt+=nt+pt.length,_t("IDATA",Et,Tt,kt),kt+=nt+Et.length,_t("IEND",new Uint8Array(0),Tt,kt),z(Tt,"image/png",Pt)}return function(xt,Pt,Ft){const Mt=xt.kind===void 0?U.ImageKind.GRAYSCALE_1BPP:xt.kind;return At(xt,Mt,Pt,Ft)}}();class J{constructor(){this.fontSizeScale=1,this.fontWeight=G.fontWeight,this.fontSize=0,this.textMatrix=U.IDENTITY_MATRIX,this.fontMatrix=U.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=U.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=G.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(nt,ht){this.x=nt,this.y=ht}}function Q(dt){let nt=[];const ht=[];for(const vt of dt){if(vt.fn==="save"){nt.push({fnId:92,fn:"group",items:[]}),ht.push(nt),nt=nt.at(-1).items;continue}vt.fn==="restore"?nt=ht.pop():nt.push(vt)}return nt}function et(dt){if(Number.isInteger(dt))return dt.toString();const nt=dt.toFixed(10);let ht=nt.length-1;if(nt[ht]!=="0")return nt;do ht--;while(nt[ht]==="0");return nt.substring(0,nt[ht]==="."?ht:ht+1)}function it(dt){if(dt[4]===0&&dt[5]===0){if(dt[1]===0&&dt[2]===0)return dt[0]===1&&dt[3]===1?"":`scale(${et(dt[0])} ${et(dt[3])})`;if(dt[0]===dt[3]&&dt[1]===-dt[2]){const nt=Math.acos(dt[0])*180/Math.PI;return`rotate(${et(nt)})`}}else if(dt[0]===1&&dt[1]===0&&dt[2]===0&&dt[3]===1)return`translate(${et(dt[4])} ${et(dt[5])})`;return`matrix(${et(dt[0])} ${et(dt[1])} ${et(dt[2])} ${et(dt[3])} ${et(dt[4])} ${et(dt[5])})`}let rt=0,st=0,at=0;class ct{constructor(nt,ht,vt=!1){(0,O.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new O.DOMSVGFactory,this.current=new J,this.transformMatrix=U.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=nt,this.objs=ht,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!vt,this._operatorIdMapping=[];for(const _t in U.OPS)this._operatorIdMapping[U.OPS[_t]]=_t}getObject(nt,ht=null){return typeof nt=="string"?nt.startsWith("g_")?this.commonObjs.get(nt):this.objs.get(nt):ht}save(){this.transformStack.push(this.transformMatrix);const nt=this.current;this.extraStack.push(nt),this.current=nt.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(nt){this.save(),this.executeOpTree(nt),this.restore()}loadDependencies(nt){const ht=nt.fnArray,vt=nt.argsArray;for(let _t=0,ut=ht.length;_t<ut;_t++)if(ht[_t]===U.OPS.dependency)for(const bt of vt[_t]){const gt=bt.startsWith("g_")?this.commonObjs:this.objs,At=new Promise(St=>{gt.get(bt,St)});this.current.dependencies.push(At)}return Promise.all(this.current.dependencies)}transform(nt,ht,vt,_t,ut,bt){const gt=[nt,ht,vt,_t,ut,bt];this.transformMatrix=U.Util.transform(this.transformMatrix,gt),this.tgrp=null}getSVG(nt,ht){this.viewport=ht;const vt=this._initialize(ht);return this.loadDependencies(nt).then(()=>(this.transformMatrix=U.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(nt)),vt))}convertOpList(nt){const ht=this._operatorIdMapping,vt=nt.argsArray,_t=nt.fnArray,ut=[];for(let bt=0,gt=_t.length;bt<gt;bt++){const At=_t[bt];ut.push({fnId:At,fn:ht[At],args:vt[bt]})}return Q(ut)}executeOpTree(nt){for(const ht of nt){const vt=ht.fn,_t=ht.fnId,ut=ht.args;switch(_t|0){case U.OPS.beginText:this.beginText();break;case U.OPS.dependency:break;case U.OPS.setLeading:this.setLeading(ut);break;case U.OPS.setLeadingMoveText:this.setLeadingMoveText(ut[0],ut[1]);break;case U.OPS.setFont:this.setFont(ut);break;case U.OPS.showText:this.showText(ut[0]);break;case U.OPS.showSpacedText:this.showText(ut[0]);break;case U.OPS.endText:this.endText();break;case U.OPS.moveText:this.moveText(ut[0],ut[1]);break;case U.OPS.setCharSpacing:this.setCharSpacing(ut[0]);break;case U.OPS.setWordSpacing:this.setWordSpacing(ut[0]);break;case U.OPS.setHScale:this.setHScale(ut[0]);break;case U.OPS.setTextMatrix:this.setTextMatrix(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5]);break;case U.OPS.setTextRise:this.setTextRise(ut[0]);break;case U.OPS.setTextRenderingMode:this.setTextRenderingMode(ut[0]);break;case U.OPS.setLineWidth:this.setLineWidth(ut[0]);break;case U.OPS.setLineJoin:this.setLineJoin(ut[0]);break;case U.OPS.setLineCap:this.setLineCap(ut[0]);break;case U.OPS.setMiterLimit:this.setMiterLimit(ut[0]);break;case U.OPS.setFillRGBColor:this.setFillRGBColor(ut[0],ut[1],ut[2]);break;case U.OPS.setStrokeRGBColor:this.setStrokeRGBColor(ut[0],ut[1],ut[2]);break;case U.OPS.setStrokeColorN:this.setStrokeColorN(ut);break;case U.OPS.setFillColorN:this.setFillColorN(ut);break;case U.OPS.shadingFill:this.shadingFill(ut[0]);break;case U.OPS.setDash:this.setDash(ut[0],ut[1]);break;case U.OPS.setRenderingIntent:this.setRenderingIntent(ut[0]);break;case U.OPS.setFlatness:this.setFlatness(ut[0]);break;case U.OPS.setGState:this.setGState(ut[0]);break;case U.OPS.fill:this.fill();break;case U.OPS.eoFill:this.eoFill();break;case U.OPS.stroke:this.stroke();break;case U.OPS.fillStroke:this.fillStroke();break;case U.OPS.eoFillStroke:this.eoFillStroke();break;case U.OPS.clip:this.clip("nonzero");break;case U.OPS.eoClip:this.clip("evenodd");break;case U.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case U.OPS.paintImageXObject:this.paintImageXObject(ut[0]);break;case U.OPS.paintInlineImageXObject:this.paintInlineImageXObject(ut[0]);break;case U.OPS.paintImageMaskXObject:this.paintImageMaskXObject(ut[0]);break;case U.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(ut[0],ut[1]);break;case U.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case U.OPS.closePath:this.closePath();break;case U.OPS.closeStroke:this.closeStroke();break;case U.OPS.closeFillStroke:this.closeFillStroke();break;case U.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case U.OPS.nextLine:this.nextLine();break;case U.OPS.transform:this.transform(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5]);break;case U.OPS.constructPath:this.constructPath(ut[0],ut[1]);break;case U.OPS.endPath:this.endPath();break;case 92:this.group(ht.items);break;default:(0,U.warn)(`Unimplemented operator ${vt}`);break}}}setWordSpacing(nt){this.current.wordSpacing=nt}setCharSpacing(nt){this.current.charSpacing=nt}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(nt,ht,vt,_t,ut,bt){const gt=this.current;gt.textMatrix=gt.lineMatrix=[nt,ht,vt,_t,ut,bt],gt.textMatrixScale=Math.hypot(nt,ht),gt.x=gt.lineX=0,gt.y=gt.lineY=0,gt.xcoords=[],gt.ycoords=[],gt.tspan=this.svgFactory.createElement("svg:tspan"),gt.tspan.setAttributeNS(null,"font-family",gt.fontFamily),gt.tspan.setAttributeNS(null,"font-size",`${et(gt.fontSize)}px`),gt.tspan.setAttributeNS(null,"y",et(-gt.y)),gt.txtElement=this.svgFactory.createElement("svg:text"),gt.txtElement.append(gt.tspan)}beginText(){const nt=this.current;nt.x=nt.lineX=0,nt.y=nt.lineY=0,nt.textMatrix=U.IDENTITY_MATRIX,nt.lineMatrix=U.IDENTITY_MATRIX,nt.textMatrixScale=1,nt.tspan=this.svgFactory.createElement("svg:tspan"),nt.txtElement=this.svgFactory.createElement("svg:text"),nt.txtgrp=this.svgFactory.createElement("svg:g"),nt.xcoords=[],nt.ycoords=[]}moveText(nt,ht){const vt=this.current;vt.x=vt.lineX+=nt,vt.y=vt.lineY+=ht,vt.xcoords=[],vt.ycoords=[],vt.tspan=this.svgFactory.createElement("svg:tspan"),vt.tspan.setAttributeNS(null,"font-family",vt.fontFamily),vt.tspan.setAttributeNS(null,"font-size",`${et(vt.fontSize)}px`),vt.tspan.setAttributeNS(null,"y",et(-vt.y))}showText(nt){const ht=this.current,vt=ht.font,_t=ht.fontSize;if(_t===0)return;const ut=ht.fontSizeScale,bt=ht.charSpacing,gt=ht.wordSpacing,At=ht.fontDirection,St=ht.textHScale*At,xt=vt.vertical,Pt=xt?1:-1,Ft=vt.defaultVMetrics,Mt=_t*ht.fontMatrix[0];let Dt=0;for(const Lt of nt){if(Lt===null){Dt+=At*gt;continue}else if(typeof Lt=="number"){Dt+=Pt*Lt*_t/1e3;continue}const qt=(Lt.isSpace?gt:0)+bt,wt=Lt.fontChar;let ot,mt,pt=Lt.width;if(xt){let yt;const Tt=Lt.vmetric||Ft;yt=Lt.vmetric?Tt[1]:pt*.5,yt=-yt*Mt;const kt=Tt[2]*Mt;pt=Tt?-Tt[0]:pt,ot=yt/ut,mt=(Dt+kt)/ut}else ot=Dt/ut,mt=0;(Lt.isInFont||vt.missingFile)&&(ht.xcoords.push(ht.x+ot),xt&&ht.ycoords.push(-ht.y+mt),ht.tspan.textContent+=wt);const Et=xt?pt*Mt-qt*At:pt*Mt+qt*At;Dt+=Et}ht.tspan.setAttributeNS(null,"x",ht.xcoords.map(et).join(" ")),xt?ht.tspan.setAttributeNS(null,"y",ht.ycoords.map(et).join(" ")):ht.tspan.setAttributeNS(null,"y",et(-ht.y)),xt?ht.y-=Dt:ht.x+=Dt*St,ht.tspan.setAttributeNS(null,"font-family",ht.fontFamily),ht.tspan.setAttributeNS(null,"font-size",`${et(ht.fontSize)}px`),ht.fontStyle!==G.fontStyle&&ht.tspan.setAttributeNS(null,"font-style",ht.fontStyle),ht.fontWeight!==G.fontWeight&&ht.tspan.setAttributeNS(null,"font-weight",ht.fontWeight);const Ut=ht.textRenderingMode&U.TextRenderingMode.FILL_STROKE_MASK;if(Ut===U.TextRenderingMode.FILL||Ut===U.TextRenderingMode.FILL_STROKE?(ht.fillColor!==G.fillColor&&ht.tspan.setAttributeNS(null,"fill",ht.fillColor),ht.fillAlpha<1&&ht.tspan.setAttributeNS(null,"fill-opacity",ht.fillAlpha)):ht.textRenderingMode===U.TextRenderingMode.ADD_TO_PATH?ht.tspan.setAttributeNS(null,"fill","transparent"):ht.tspan.setAttributeNS(null,"fill","none"),Ut===U.TextRenderingMode.STROKE||Ut===U.TextRenderingMode.FILL_STROKE){const Lt=1/(ht.textMatrixScale||1);this._setStrokeAttributes(ht.tspan,Lt)}let Qt=ht.textMatrix;ht.textRise!==0&&(Qt=Qt.slice(),Qt[5]+=ht.textRise),ht.txtElement.setAttributeNS(null,"transform",`${it(Qt)} scale(${et(St)}, -1)`),ht.txtElement.setAttributeNS(X,"xml:space","preserve"),ht.txtElement.append(ht.tspan),ht.txtgrp.append(ht.txtElement),this._ensureTransformGroup().append(ht.txtElement)}setLeadingMoveText(nt,ht){this.setLeading(-ht),this.moveText(nt,ht)}addFontStyle(nt){if(!nt.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const ht=z(nt.data,nt.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${nt.loadedName}"; src: url(${ht}); }
`}setFont(nt){const ht=this.current,vt=this.commonObjs.get(nt[0]);let _t=nt[1];ht.font=vt,this.embedFonts&&!vt.missingFile&&!this.embeddedFonts[vt.loadedName]&&(this.addFontStyle(vt),this.embeddedFonts[vt.loadedName]=vt),ht.fontMatrix=vt.fontMatrix||U.FONT_IDENTITY_MATRIX;let ut="normal";vt.black?ut="900":vt.bold&&(ut="bold");const bt=vt.italic?"italic":"normal";_t<0?(_t=-_t,ht.fontDirection=-1):ht.fontDirection=1,ht.fontSize=_t,ht.fontFamily=vt.loadedName,ht.fontWeight=ut,ht.fontStyle=bt,ht.tspan=this.svgFactory.createElement("svg:tspan"),ht.tspan.setAttributeNS(null,"y",et(-ht.y)),ht.xcoords=[],ht.ycoords=[]}endText(){var ht;const nt=this.current;nt.textRenderingMode&U.TextRenderingMode.ADD_TO_PATH_FLAG&&((ht=nt.txtElement)!=null&&ht.hasChildNodes())&&(nt.element=nt.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(nt){nt>0&&(this.current.lineWidth=nt)}setLineCap(nt){this.current.lineCap=Y[nt]}setLineJoin(nt){this.current.lineJoin=W[nt]}setMiterLimit(nt){this.current.miterLimit=nt}setStrokeAlpha(nt){this.current.strokeAlpha=nt}setStrokeRGBColor(nt,ht,vt){this.current.strokeColor=U.Util.makeHexColor(nt,ht,vt)}setFillAlpha(nt){this.current.fillAlpha=nt}setFillRGBColor(nt,ht,vt){this.current.fillColor=U.Util.makeHexColor(nt,ht,vt),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(nt){this.current.strokeColor=this._makeColorN_Pattern(nt)}setFillColorN(nt){this.current.fillColor=this._makeColorN_Pattern(nt)}shadingFill(nt){const{width:ht,height:vt}=this.viewport,_t=U.Util.inverseTransform(this.transformMatrix),[ut,bt,gt,At]=U.Util.getAxialAlignedBoundingBox([0,0,ht,vt],_t),St=this.svgFactory.createElement("svg:rect");St.setAttributeNS(null,"x",ut),St.setAttributeNS(null,"y",bt),St.setAttributeNS(null,"width",gt-ut),St.setAttributeNS(null,"height",At-bt),St.setAttributeNS(null,"fill",this._makeShadingPattern(nt)),this.current.fillAlpha<1&&St.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(St)}_makeColorN_Pattern(nt){return nt[0]==="TilingPattern"?this._makeTilingPattern(nt):this._makeShadingPattern(nt)}_makeTilingPattern(nt){const ht=nt[1],vt=nt[2],_t=nt[3]||U.IDENTITY_MATRIX,[ut,bt,gt,At]=nt[4],St=nt[5],xt=nt[6],Pt=nt[7],Ft=`shading${at++}`,[Mt,Dt,Ut,Qt]=U.Util.normalizeRect([...U.Util.applyTransform([ut,bt],_t),...U.Util.applyTransform([gt,At],_t)]),[Lt,qt]=U.Util.singularValueDecompose2dScale(_t),wt=St*Lt,ot=xt*qt,mt=this.svgFactory.createElement("svg:pattern");mt.setAttributeNS(null,"id",Ft),mt.setAttributeNS(null,"patternUnits","userSpaceOnUse"),mt.setAttributeNS(null,"width",wt),mt.setAttributeNS(null,"height",ot),mt.setAttributeNS(null,"x",`${Mt}`),mt.setAttributeNS(null,"y",`${Dt}`);const pt=this.svg,Et=this.transformMatrix,yt=this.current.fillColor,Tt=this.current.strokeColor,kt=this.svgFactory.create(Ut-Mt,Qt-Dt);if(this.svg=kt,this.transformMatrix=_t,Pt===2){const Bt=U.Util.makeHexColor(...ht);this.current.fillColor=Bt,this.current.strokeColor=Bt}return this.executeOpTree(this.convertOpList(vt)),this.svg=pt,this.transformMatrix=Et,this.current.fillColor=yt,this.current.strokeColor=Tt,mt.append(kt.childNodes[0]),this.defs.append(mt),`url(#${Ft})`}_makeShadingPattern(nt){switch(typeof nt=="string"&&(nt=this.objs.get(nt)),nt[0]){case"RadialAxial":const ht=`shading${at++}`,vt=nt[3];let _t;switch(nt[1]){case"axial":const ut=nt[4],bt=nt[5];_t=this.svgFactory.createElement("svg:linearGradient"),_t.setAttributeNS(null,"id",ht),_t.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),_t.setAttributeNS(null,"x1",ut[0]),_t.setAttributeNS(null,"y1",ut[1]),_t.setAttributeNS(null,"x2",bt[0]),_t.setAttributeNS(null,"y2",bt[1]);break;case"radial":const gt=nt[4],At=nt[5],St=nt[6],xt=nt[7];_t=this.svgFactory.createElement("svg:radialGradient"),_t.setAttributeNS(null,"id",ht),_t.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),_t.setAttributeNS(null,"cx",At[0]),_t.setAttributeNS(null,"cy",At[1]),_t.setAttributeNS(null,"r",xt),_t.setAttributeNS(null,"fx",gt[0]),_t.setAttributeNS(null,"fy",gt[1]),_t.setAttributeNS(null,"fr",St);break;default:throw new Error(`Unknown RadialAxial type: ${nt[1]}`)}for(const ut of vt){const bt=this.svgFactory.createElement("svg:stop");bt.setAttributeNS(null,"offset",ut[0]),bt.setAttributeNS(null,"stop-color",ut[1]),_t.append(bt)}return this.defs.append(_t),`url(#${ht})`;case"Mesh":return(0,U.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${nt[0]}`)}}setDash(nt,ht){this.current.dashArray=nt,this.current.dashPhase=ht}constructPath(nt,ht){const vt=this.current;let _t=vt.x,ut=vt.y,bt=[],gt=0;for(const At of nt)switch(At|0){case U.OPS.rectangle:_t=ht[gt++],ut=ht[gt++];const St=ht[gt++],xt=ht[gt++],Pt=_t+St,Ft=ut+xt;bt.push("M",et(_t),et(ut),"L",et(Pt),et(ut),"L",et(Pt),et(Ft),"L",et(_t),et(Ft),"Z");break;case U.OPS.moveTo:_t=ht[gt++],ut=ht[gt++],bt.push("M",et(_t),et(ut));break;case U.OPS.lineTo:_t=ht[gt++],ut=ht[gt++],bt.push("L",et(_t),et(ut));break;case U.OPS.curveTo:_t=ht[gt+4],ut=ht[gt+5],bt.push("C",et(ht[gt]),et(ht[gt+1]),et(ht[gt+2]),et(ht[gt+3]),et(_t),et(ut)),gt+=6;break;case U.OPS.curveTo2:bt.push("C",et(_t),et(ut),et(ht[gt]),et(ht[gt+1]),et(ht[gt+2]),et(ht[gt+3])),_t=ht[gt+2],ut=ht[gt+3],gt+=4;break;case U.OPS.curveTo3:_t=ht[gt+2],ut=ht[gt+3],bt.push("C",et(ht[gt]),et(ht[gt+1]),et(_t),et(ut),et(_t),et(ut)),gt+=4;break;case U.OPS.closePath:bt.push("Z");break}bt=bt.join(" "),vt.path&&nt.length>0&&nt[0]!==U.OPS.rectangle&&nt[0]!==U.OPS.moveTo?bt=vt.path.getAttributeNS(null,"d")+bt:(vt.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(vt.path)),vt.path.setAttributeNS(null,"d",bt),vt.path.setAttributeNS(null,"fill","none"),vt.element=vt.path,vt.setCurrentPoint(_t,ut)}endPath(){const nt=this.current;if(nt.path=null,!this.pendingClip)return;if(!nt.element){this.pendingClip=null;return}const ht=`clippath${rt++}`,vt=this.svgFactory.createElement("svg:clipPath");vt.setAttributeNS(null,"id",ht),vt.setAttributeNS(null,"transform",it(this.transformMatrix));const _t=nt.element.cloneNode(!0);if(this.pendingClip==="evenodd"?_t.setAttributeNS(null,"clip-rule","evenodd"):_t.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,vt.append(_t),this.defs.append(vt),nt.activeClipUrl){nt.clipGroup=null;for(const ut of this.extraStack)ut.clipGroup=null;vt.setAttributeNS(null,"clip-path",nt.activeClipUrl)}nt.activeClipUrl=`url(#${ht})`,this.tgrp=null}clip(nt){this.pendingClip=nt}closePath(){const nt=this.current;if(nt.path){const ht=`${nt.path.getAttributeNS(null,"d")}Z`;nt.path.setAttributeNS(null,"d",ht)}}setLeading(nt){this.current.leading=-nt}setTextRise(nt){this.current.textRise=nt}setTextRenderingMode(nt){this.current.textRenderingMode=nt}setHScale(nt){this.current.textHScale=nt/100}setRenderingIntent(nt){}setFlatness(nt){}setGState(nt){for(const[ht,vt]of nt)switch(ht){case"LW":this.setLineWidth(vt);break;case"LC":this.setLineCap(vt);break;case"LJ":this.setLineJoin(vt);break;case"ML":this.setMiterLimit(vt);break;case"D":this.setDash(vt[0],vt[1]);break;case"RI":this.setRenderingIntent(vt);break;case"FL":this.setFlatness(vt);break;case"Font":this.setFont(vt);break;case"CA":this.setStrokeAlpha(vt);break;case"ca":this.setFillAlpha(vt);break;default:(0,U.warn)(`Unimplemented graphic state operator ${ht}`);break}}fill(){const nt=this.current;nt.element&&(nt.element.setAttributeNS(null,"fill",nt.fillColor),nt.element.setAttributeNS(null,"fill-opacity",nt.fillAlpha),this.endPath())}stroke(){const nt=this.current;nt.element&&(this._setStrokeAttributes(nt.element),nt.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(nt,ht=1){const vt=this.current;let _t=vt.dashArray;ht!==1&&_t.length>0&&(_t=_t.map(function(ut){return ht*ut})),nt.setAttributeNS(null,"stroke",vt.strokeColor),nt.setAttributeNS(null,"stroke-opacity",vt.strokeAlpha),nt.setAttributeNS(null,"stroke-miterlimit",et(vt.miterLimit)),nt.setAttributeNS(null,"stroke-linecap",vt.lineCap),nt.setAttributeNS(null,"stroke-linejoin",vt.lineJoin),nt.setAttributeNS(null,"stroke-width",et(ht*vt.lineWidth)+"px"),nt.setAttributeNS(null,"stroke-dasharray",_t.map(et).join(" ")),nt.setAttributeNS(null,"stroke-dashoffset",et(ht*vt.dashPhase)+"px")}eoFill(){var nt;(nt=this.current.element)==null||nt.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var nt;(nt=this.current.element)==null||nt.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const nt=this.svgFactory.createElement("svg:rect");nt.setAttributeNS(null,"x","0"),nt.setAttributeNS(null,"y","0"),nt.setAttributeNS(null,"width","1px"),nt.setAttributeNS(null,"height","1px"),nt.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(nt)}paintImageXObject(nt){const ht=this.getObject(nt);if(!ht){(0,U.warn)(`Dependent image with object ID ${nt} is not ready yet`);return}this.paintInlineImageXObject(ht)}paintInlineImageXObject(nt,ht){const vt=nt.width,_t=nt.height,ut=K(nt,this.forceDataSchema,!!ht),bt=this.svgFactory.createElement("svg:rect");bt.setAttributeNS(null,"x","0"),bt.setAttributeNS(null,"y","0"),bt.setAttributeNS(null,"width",et(vt)),bt.setAttributeNS(null,"height",et(_t)),this.current.element=bt,this.clip("nonzero");const gt=this.svgFactory.createElement("svg:image");gt.setAttributeNS(tt,"xlink:href",ut),gt.setAttributeNS(null,"x","0"),gt.setAttributeNS(null,"y",et(-_t)),gt.setAttributeNS(null,"width",et(vt)+"px"),gt.setAttributeNS(null,"height",et(_t)+"px"),gt.setAttributeNS(null,"transform",`scale(${et(1/vt)} ${et(-1/_t)})`),ht?ht.append(gt):this._ensureTransformGroup().append(gt)}paintImageMaskXObject(nt){const ht=this.getObject(nt.data,nt);if(ht.bitmap){(0,U.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const vt=this.current,_t=ht.width,ut=ht.height,bt=vt.fillColor;vt.maskId=`mask${st++}`;const gt=this.svgFactory.createElement("svg:mask");gt.setAttributeNS(null,"id",vt.maskId);const At=this.svgFactory.createElement("svg:rect");At.setAttributeNS(null,"x","0"),At.setAttributeNS(null,"y","0"),At.setAttributeNS(null,"width",et(_t)),At.setAttributeNS(null,"height",et(ut)),At.setAttributeNS(null,"fill",bt),At.setAttributeNS(null,"mask",`url(#${vt.maskId})`),this.defs.append(gt),this._ensureTransformGroup().append(At),this.paintInlineImageXObject(ht,gt)}paintFormXObjectBegin(nt,ht){if(Array.isArray(nt)&&nt.length===6&&this.transform(nt[0],nt[1],nt[2],nt[3],nt[4],nt[5]),ht){const vt=ht[2]-ht[0],_t=ht[3]-ht[1],ut=this.svgFactory.createElement("svg:rect");ut.setAttributeNS(null,"x",ht[0]),ut.setAttributeNS(null,"y",ht[1]),ut.setAttributeNS(null,"width",et(vt)),ut.setAttributeNS(null,"height",et(_t)),this.current.element=ut,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(nt){const ht=this.svgFactory.create(nt.width,nt.height),vt=this.svgFactory.createElement("svg:defs");ht.append(vt),this.defs=vt;const _t=this.svgFactory.createElement("svg:g");return _t.setAttributeNS(null,"transform",it(nt.transform)),ht.append(_t),this.svg=_t,ht}_ensureClipGroup(){if(!this.current.clipGroup){const nt=this.svgFactory.createElement("svg:g");nt.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(nt),this.current.clipGroup=nt}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",it(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}D.SVGGraphics=ct},(B,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.XfaText=void 0;class F{static textContent(U){const G=[],X={items:G,styles:Object.create(null)};function tt(Y){var K;if(!Y)return;let W=null;const z=Y.name;if(z==="#text")W=Y.value;else if(F.shouldBuildText(z))(K=Y==null?void 0:Y.attributes)!=null&&K.textContent?W=Y.attributes.textContent:Y.value&&(W=Y.value);else return;if(W!==null&&G.push({str:W}),!!Y.children)for(const J of Y.children)tt(J)}return tt(U),X}static shouldBuildText(U){return!(U==="textarea"||U==="input"||U==="option"||U==="select")}}D.XfaText=F},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.TextLayerRenderTask=void 0,D.renderTextLayer=it,D.updateTextLayer=rt;var O=F(1),U=F(6);const G=1e5,X=30,tt=.8,Y=new Map;function W(st,at){let ct;if(at&&O.FeatureTest.isOffscreenCanvasSupported)ct=new OffscreenCanvas(st,st).getContext("2d",{alpha:!1});else{const dt=document.createElement("canvas");dt.width=dt.height=st,ct=dt.getContext("2d",{alpha:!1})}return ct}function z(st,at){const ct=Y.get(st);if(ct)return ct;const dt=W(X,at);dt.font=`${X}px ${st}`;const nt=dt.measureText("");let ht=nt.fontBoundingBoxAscent,vt=Math.abs(nt.fontBoundingBoxDescent);if(ht){const ut=ht/(ht+vt);return Y.set(st,ut),dt.canvas.width=dt.canvas.height=0,ut}dt.strokeStyle="red",dt.clearRect(0,0,X,X),dt.strokeText("g",0,0);let _t=dt.getImageData(0,0,X,X).data;vt=0;for(let ut=_t.length-1-3;ut>=0;ut-=4)if(_t[ut]>0){vt=Math.ceil(ut/4/X);break}dt.clearRect(0,0,X,X),dt.strokeText("A",0,X),_t=dt.getImageData(0,0,X,X).data,ht=0;for(let ut=0,bt=_t.length;ut<bt;ut+=4)if(_t[ut]>0){ht=X-Math.floor(ut/4/X);break}if(dt.canvas.width=dt.canvas.height=0,ht){const ut=ht/(ht+vt);return Y.set(st,ut),ut}return Y.set(st,tt),tt}function K(st,at,ct){const dt=document.createElement("span"),nt={angle:0,canvasWidth:0,hasText:at.str!=="",hasEOL:at.hasEOL,fontSize:0};st._textDivs.push(dt);const ht=O.Util.transform(st._transform,at.transform);let vt=Math.atan2(ht[1],ht[0]);const _t=ct[at.fontName];_t.vertical&&(vt+=Math.PI/2);const ut=Math.hypot(ht[2],ht[3]),bt=ut*z(_t.fontFamily,st._isOffscreenCanvasSupported);let gt,At;vt===0?(gt=ht[4],At=ht[5]-bt):(gt=ht[4]+bt*Math.sin(vt),At=ht[5]-bt*Math.cos(vt));const St="calc(var(--scale-factor)*",xt=dt.style;st._container===st._rootContainer?(xt.left=`${(100*gt/st._pageWidth).toFixed(2)}%`,xt.top=`${(100*At/st._pageHeight).toFixed(2)}%`):(xt.left=`${St}${gt.toFixed(2)}px)`,xt.top=`${St}${At.toFixed(2)}px)`),xt.fontSize=`${St}${ut.toFixed(2)}px)`,xt.fontFamily=_t.fontFamily,nt.fontSize=ut,dt.setAttribute("role","presentation"),dt.textContent=at.str,dt.dir=at.dir,st._fontInspectorEnabled&&(dt.dataset.fontName=at.fontName),vt!==0&&(nt.angle=vt*(180/Math.PI));let Pt=!1;if(at.str.length>1)Pt=!0;else if(at.str!==" "&&at.transform[0]!==at.transform[3]){const Ft=Math.abs(at.transform[0]),Mt=Math.abs(at.transform[3]);Ft!==Mt&&Math.max(Ft,Mt)/Math.min(Ft,Mt)>1.5&&(Pt=!0)}Pt&&(nt.canvasWidth=_t.vertical?at.height:at.width),st._textDivProperties.set(dt,nt),st._isReadableStream&&st._layoutText(dt)}function J(st){const{div:at,scale:ct,properties:dt,ctx:nt,prevFontSize:ht,prevFontFamily:vt}=st,{style:_t}=at;let ut="";if(dt.canvasWidth!==0&&dt.hasText){const{fontFamily:bt}=_t,{canvasWidth:gt,fontSize:At}=dt;(ht!==At||vt!==bt)&&(nt.font=`${At*ct}px ${bt}`,st.prevFontSize=At,st.prevFontFamily=bt);const{width:St}=nt.measureText(at.textContent);St>0&&(ut=`scaleX(${gt*ct/St})`)}dt.angle!==0&&(ut=`rotate(${dt.angle}deg) ${ut}`),ut.length>0&&(_t.transform=ut)}function Q(st){if(st._canceled)return;const at=st._textDivs,ct=st._capability;if(at.length>G){ct.resolve();return}if(!st._isReadableStream)for(const nt of at)st._layoutText(nt);ct.resolve()}class et{constructor({textContentSource:at,container:ct,viewport:dt,textDivs:nt,textDivProperties:ht,textContentItemsStr:vt,isOffscreenCanvasSupported:_t}){var St;this._textContentSource=at,this._isReadableStream=at instanceof ReadableStream,this._container=this._rootContainer=ct,this._textDivs=nt||[],this._textContentItemsStr=vt||[],this._isOffscreenCanvasSupported=_t,this._fontInspectorEnabled=!!((St=globalThis.FontInspector)!=null&&St.enabled),this._reader=null,this._textDivProperties=ht||new WeakMap,this._canceled=!1,this._capability=new O.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:dt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:W(0,_t)};const{pageWidth:ut,pageHeight:bt,pageX:gt,pageY:At}=dt.rawDims;this._transform=[1,0,0,-1,-gt,At+bt],this._pageWidth=ut,this._pageHeight=bt,(0,U.setLayerDimensions)(ct,dt),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new O.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new O.AbortException("TextLayer task cancelled."))}_processItems(at,ct){for(const dt of at){if(dt.str===void 0){if(dt.type==="beginMarkedContentProps"||dt.type==="beginMarkedContent"){const nt=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),dt.id!==null&&this._container.setAttribute("id",`${dt.id}`),nt.append(this._container)}else dt.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(dt.str),K(this,dt,ct)}}_layoutText(at){const ct=this._layoutTextParams.properties=this._textDivProperties.get(at);if(this._layoutTextParams.div=at,J(this._layoutTextParams),ct.hasText&&this._container.append(at),ct.hasEOL){const dt=document.createElement("br");dt.setAttribute("role","presentation"),this._container.append(dt)}}_render(){const at=new O.PromiseCapability;let ct=Object.create(null);if(this._isReadableStream){const dt=()=>{this._reader.read().then(({value:nt,done:ht})=>{if(ht){at.resolve();return}Object.assign(ct,nt.styles),this._processItems(nt.items,ct),dt()},at.reject)};this._reader=this._textContentSource.getReader(),dt()}else if(this._textContentSource){const{items:dt,styles:nt}=this._textContentSource;this._processItems(dt,nt),at.resolve()}else throw new Error('No "textContentSource" parameter specified.');at.promise.then(()=>{ct=null,Q(this)},this._capability.reject)}}D.TextLayerRenderTask=et;function it(st){!st.textContentSource&&(st.textContent||st.textContentStream)&&((0,U.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),st.textContentSource=st.textContent||st.textContentStream);const{container:at,viewport:ct}=st,dt=getComputedStyle(at),nt=dt.getPropertyValue("visibility"),ht=parseFloat(dt.getPropertyValue("--scale-factor"));nt==="visible"&&(!ht||Math.abs(ht-ct.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const vt=new et(st);return vt._render(),vt}function rt({container:st,viewport:at,textDivs:ct,textDivProperties:dt,isOffscreenCanvasSupported:nt,mustRotate:ht=!0,mustRescale:vt=!0}){if(ht&&(0,U.setLayerDimensions)(st,{rotation:at.rotation}),vt){const _t=W(0,nt),bt={prevFontSize:null,prevFontFamily:null,div:null,scale:at.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:_t};for(const gt of ct)bt.properties=dt.get(gt),bt.div=gt,J(bt)}}},(B,D,F)=>{var z,K,J,Q,et,it,rt,st,at,ct,dt,zr,ht,br,_t,Gr,bt,Xr;Object.defineProperty(D,"__esModule",{value:!0}),D.AnnotationEditorLayer=void 0;var O=F(1),U=F(4),G=F(28),X=F(33),tt=F(6),Y=F(34);const At=class At{constructor({uiManager:xt,pageIndex:Pt,div:Ft,accessibilityManager:Mt,annotationLayer:Dt,viewport:Ut,l10n:Qt}){It(this,dt);It(this,ht);It(this,_t);It(this,bt);It(this,z,void 0);It(this,K,!1);It(this,J,null);It(this,Q,this.pointerup.bind(this));It(this,et,this.pointerdown.bind(this));It(this,it,new Map);It(this,rt,!1);It(this,st,!1);It(this,at,!1);It(this,ct,void 0);const Lt=[G.FreeTextEditor,X.InkEditor,Y.StampEditor];if(!At._initialized){At._initialized=!0;for(const qt of Lt)qt.initialize(Qt)}xt.registerEditorTypes(Lt),Kt(this,ct,xt),this.pageIndex=Pt,this.div=Ft,Kt(this,z,Mt),Kt(this,J,Dt),this.viewport=Ut,lt(this,ct).addLayer(this)}get isEmpty(){return lt(this,it).size===0}updateToolbar(xt){lt(this,ct).updateToolbar(xt)}updateMode(xt=lt(this,ct).getMode()){$t(this,bt,Xr).call(this),xt===O.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),xt!==O.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",xt===O.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",xt===O.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",xt===O.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(xt){if(!xt&&lt(this,ct).getMode()!==O.AnnotationEditorType.INK)return;if(!xt){for(const Ft of lt(this,it).values())if(Ft.isEmpty()){Ft.setInBackground();return}}$t(this,ht,br).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(xt){lt(this,ct).setEditingState(xt)}addCommands(xt){lt(this,ct).addCommands(xt)}enable(){this.div.style.pointerEvents="auto";const xt=new Set;for(const Ft of lt(this,it).values())Ft.enableEditing(),Ft.annotationElementId&&xt.add(Ft.annotationElementId);if(!lt(this,J))return;const Pt=lt(this,J).getEditableAnnotations();for(const Ft of Pt){if(Ft.hide(),lt(this,ct).isDeletedAnnotationElement(Ft.data.id)||xt.has(Ft.data.id))continue;const Mt=this.deserialize(Ft);Mt&&(this.addOrRebuild(Mt),Mt.enableEditing())}}disable(){var Pt;Kt(this,at,!0),this.div.style.pointerEvents="none";const xt=new Set;for(const Ft of lt(this,it).values()){if(Ft.disableEditing(),!Ft.annotationElementId||Ft.serialize()!==null){xt.add(Ft.annotationElementId);continue}(Pt=this.getEditableAnnotation(Ft.annotationElementId))==null||Pt.show(),Ft.remove()}if(lt(this,J)){const Ft=lt(this,J).getEditableAnnotations();for(const Mt of Ft){const{id:Dt}=Mt.data;xt.has(Dt)||lt(this,ct).isDeletedAnnotationElement(Dt)||Mt.show()}}$t(this,bt,Xr).call(this),this.isEmpty&&(this.div.hidden=!0),Kt(this,at,!1)}getEditableAnnotation(xt){var Pt;return((Pt=lt(this,J))==null?void 0:Pt.getEditableAnnotation(xt))||null}setActiveEditor(xt){lt(this,ct).getActive()!==xt&&lt(this,ct).setActiveEditor(xt)}enableClick(){this.div.addEventListener("pointerdown",lt(this,et)),this.div.addEventListener("pointerup",lt(this,Q))}disableClick(){this.div.removeEventListener("pointerdown",lt(this,et)),this.div.removeEventListener("pointerup",lt(this,Q))}attach(xt){lt(this,it).set(xt.id,xt);const{annotationElementId:Pt}=xt;Pt&&lt(this,ct).isDeletedAnnotationElement(Pt)&&lt(this,ct).removeDeletedAnnotationElement(xt)}detach(xt){var Pt;lt(this,it).delete(xt.id),(Pt=lt(this,z))==null||Pt.removePointerInTextLayer(xt.contentDiv),!lt(this,at)&&xt.annotationElementId&&lt(this,ct).addDeletedAnnotationElement(xt)}remove(xt){this.detach(xt),lt(this,ct).removeEditor(xt),xt.div.contains(document.activeElement)&&setTimeout(()=>{lt(this,ct).focusMainContainer()},0),xt.div.remove(),xt.isAttachedToDOM=!1,lt(this,st)||this.addInkEditorIfNeeded(!1)}changeParent(xt){var Pt;xt.parent!==this&&(xt.annotationElementId&&(lt(this,ct).addDeletedAnnotationElement(xt.annotationElementId),U.AnnotationEditor.deleteAnnotationElement(xt),xt.annotationElementId=null),this.attach(xt),(Pt=xt.parent)==null||Pt.detach(xt),xt.setParent(this),xt.div&&xt.isAttachedToDOM&&(xt.div.remove(),this.div.append(xt.div)))}add(xt){if(this.changeParent(xt),lt(this,ct).addEditor(xt),this.attach(xt),!xt.isAttachedToDOM){const Pt=xt.render();this.div.append(Pt),xt.isAttachedToDOM=!0}xt.fixAndSetPosition(),xt.onceAdded(),lt(this,ct).addToAnnotationStorage(xt)}moveEditorInDOM(xt){var Ft;if(!xt.isAttachedToDOM)return;const{activeElement:Pt}=document;xt.div.contains(Pt)&&(xt._focusEventsAllowed=!1,setTimeout(()=>{xt.div.contains(document.activeElement)?xt._focusEventsAllowed=!0:(xt.div.addEventListener("focusin",()=>{xt._focusEventsAllowed=!0},{once:!0}),Pt.focus())},0)),xt._structTreeParentId=(Ft=lt(this,z))==null?void 0:Ft.moveElementInDOM(this.div,xt.div,xt.contentDiv,!0)}addOrRebuild(xt){xt.needsToBeRebuilt()?xt.rebuild():this.add(xt)}addUndoableEditor(xt){const Pt=()=>xt._uiManager.rebuild(xt),Ft=()=>{xt.remove()};this.addCommands({cmd:Pt,undo:Ft,mustExec:!1})}getNextId(){return lt(this,ct).getId()}pasteEditor(xt,Pt){lt(this,ct).updateToolbar(xt),lt(this,ct).updateMode(xt);const{offsetX:Ft,offsetY:Mt}=$t(this,_t,Gr).call(this),Dt=this.getNextId(),Ut=$t(this,dt,zr).call(this,{parent:this,id:Dt,x:Ft,y:Mt,uiManager:lt(this,ct),isCentered:!0,...Pt});Ut&&this.add(Ut)}deserialize(xt){switch(xt.annotationType??xt.annotationEditorType){case O.AnnotationEditorType.FREETEXT:return G.FreeTextEditor.deserialize(xt,this,lt(this,ct));case O.AnnotationEditorType.INK:return X.InkEditor.deserialize(xt,this,lt(this,ct));case O.AnnotationEditorType.STAMP:return Y.StampEditor.deserialize(xt,this,lt(this,ct))}return null}addNewEditor(){$t(this,ht,br).call(this,$t(this,_t,Gr).call(this),!0)}setSelected(xt){lt(this,ct).setSelected(xt)}toggleSelected(xt){lt(this,ct).toggleSelected(xt)}isSelected(xt){return lt(this,ct).isSelected(xt)}unselect(xt){lt(this,ct).unselect(xt)}pointerup(xt){const{isMac:Pt}=O.FeatureTest.platform;if(!(xt.button!==0||xt.ctrlKey&&Pt)&&xt.target===this.div&&lt(this,rt)){if(Kt(this,rt,!1),!lt(this,K)){Kt(this,K,!0);return}if(lt(this,ct).getMode()===O.AnnotationEditorType.STAMP){lt(this,ct).unselectAll();return}$t(this,ht,br).call(this,xt,!1)}}pointerdown(xt){if(lt(this,rt)){Kt(this,rt,!1);return}const{isMac:Pt}=O.FeatureTest.platform;if(xt.button!==0||xt.ctrlKey&&Pt||xt.target!==this.div)return;Kt(this,rt,!0);const Ft=lt(this,ct).getActive();Kt(this,K,!Ft||Ft.isEmpty())}findNewParent(xt,Pt,Ft){const Mt=lt(this,ct).findParent(Pt,Ft);return Mt===null||Mt===this?!1:(Mt.changeParent(xt),!0)}destroy(){var xt,Pt;((xt=lt(this,ct).getActive())==null?void 0:xt.parent)===this&&(lt(this,ct).commitOrRemove(),lt(this,ct).setActiveEditor(null));for(const Ft of lt(this,it).values())(Pt=lt(this,z))==null||Pt.removePointerInTextLayer(Ft.contentDiv),Ft.setParent(null),Ft.isAttachedToDOM=!1,Ft.div.remove();this.div=null,lt(this,it).clear(),lt(this,ct).removeLayer(this)}render({viewport:xt}){this.viewport=xt,(0,tt.setLayerDimensions)(this.div,xt);for(const Pt of lt(this,ct).getEditors(this.pageIndex))this.add(Pt);this.updateMode()}update({viewport:xt}){lt(this,ct).commitOrRemove(),this.viewport=xt,(0,tt.setLayerDimensions)(this.div,{rotation:xt.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:xt,pageHeight:Pt}=this.viewport.rawDims;return[xt,Pt]}};z=new WeakMap,K=new WeakMap,J=new WeakMap,Q=new WeakMap,et=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakMap,at=new WeakMap,ct=new WeakMap,dt=new WeakSet,zr=function(xt){switch(lt(this,ct).getMode()){case O.AnnotationEditorType.FREETEXT:return new G.FreeTextEditor(xt);case O.AnnotationEditorType.INK:return new X.InkEditor(xt);case O.AnnotationEditorType.STAMP:return new Y.StampEditor(xt)}return null},ht=new WeakSet,br=function(xt,Pt){const Ft=this.getNextId(),Mt=$t(this,dt,zr).call(this,{parent:this,id:Ft,x:xt.offsetX,y:xt.offsetY,uiManager:lt(this,ct),isCentered:Pt});return Mt&&this.add(Mt),Mt},_t=new WeakSet,Gr=function(){const{x:xt,y:Pt,width:Ft,height:Mt}=this.div.getBoundingClientRect(),Dt=Math.max(0,xt),Ut=Math.max(0,Pt),Qt=Math.min(window.innerWidth,xt+Ft),Lt=Math.min(window.innerHeight,Pt+Mt),qt=(Dt+Qt)/2-xt,wt=(Ut+Lt)/2-Pt,[ot,mt]=this.viewport.rotation%180===0?[qt,wt]:[wt,qt];return{offsetX:ot,offsetY:mt}},bt=new WeakSet,Xr=function(){Kt(this,st,!0);for(const xt of lt(this,it).values())xt.isEmpty()&&xt.remove();Kt(this,st,!1)},He(At,"_initialized",!1);let W=At;D.AnnotationEditorLayer=W},(B,D,F)=>{var Y,W,z,K,J,Q,et,it,rt,st,yi,ct,Ei,nt,Si,vt,cr,ut,Vr,gt,wi,St,Yr;Object.defineProperty(D,"__esModule",{value:!0}),D.FreeTextEditor=void 0;var O=F(1),U=F(5),G=F(4),X=F(29);const Pt=class Pt extends G.AnnotationEditor{constructor(Dt){super({...Dt,name:"freeTextEditor"});It(this,st);It(this,ct);It(this,nt);It(this,vt);It(this,ut);It(this,gt);It(this,St);It(this,Y,this.editorDivBlur.bind(this));It(this,W,this.editorDivFocus.bind(this));It(this,z,this.editorDivInput.bind(this));It(this,K,this.editorDivKeydown.bind(this));It(this,J,void 0);It(this,Q,"");It(this,et,`${this.id}-editor`);It(this,it,void 0);It(this,rt,null);Kt(this,J,Dt.color||Pt._defaultColor||G.AnnotationEditor._defaultLineColor),Kt(this,it,Dt.fontSize||Pt._defaultFontSize)}static get _keyboardManager(){const Dt=Pt.prototype,Ut=qt=>qt.isEmpty(),Qt=U.AnnotationEditorUIManager.TRANSLATE_SMALL,Lt=U.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,O.shadow)(this,"_keyboardManager",new U.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Dt.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Dt.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Dt._translateEmpty,{args:[-Qt,0],checker:Ut}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Dt._translateEmpty,{args:[-Lt,0],checker:Ut}],[["ArrowRight","mac+ArrowRight"],Dt._translateEmpty,{args:[Qt,0],checker:Ut}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Dt._translateEmpty,{args:[Lt,0],checker:Ut}],[["ArrowUp","mac+ArrowUp"],Dt._translateEmpty,{args:[0,-Qt],checker:Ut}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Dt._translateEmpty,{args:[0,-Lt],checker:Ut}],[["ArrowDown","mac+ArrowDown"],Dt._translateEmpty,{args:[0,Qt],checker:Ut}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Dt._translateEmpty,{args:[0,Lt],checker:Ut}]]))}static initialize(Dt){G.AnnotationEditor.initialize(Dt,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Ut=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Ut.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Dt,Ut){switch(Dt){case O.AnnotationEditorParamsType.FREETEXT_SIZE:Pt._defaultFontSize=Ut;break;case O.AnnotationEditorParamsType.FREETEXT_COLOR:Pt._defaultColor=Ut;break}}updateParams(Dt,Ut){switch(Dt){case O.AnnotationEditorParamsType.FREETEXT_SIZE:$t(this,st,yi).call(this,Ut);break;case O.AnnotationEditorParamsType.FREETEXT_COLOR:$t(this,ct,Ei).call(this,Ut);break}}static get defaultPropertiesToUpdate(){return[[O.AnnotationEditorParamsType.FREETEXT_SIZE,Pt._defaultFontSize],[O.AnnotationEditorParamsType.FREETEXT_COLOR,Pt._defaultColor||G.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[O.AnnotationEditorParamsType.FREETEXT_SIZE,lt(this,it)],[O.AnnotationEditorParamsType.FREETEXT_COLOR,lt(this,J)]]}_translateEmpty(Dt,Ut){this._uiManager.translateSelectedEditors(Dt,Ut,!0)}getInitialTranslation(){const Dt=this.parentScale;return[-Pt._internalPadding*Dt,-(Pt._internalPadding+lt(this,it))*Dt]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(O.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",lt(this,K)),this.editorDiv.addEventListener("focus",lt(this,W)),this.editorDiv.addEventListener("blur",lt(this,Y)),this.editorDiv.addEventListener("input",lt(this,z)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",lt(this,et)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",lt(this,K)),this.editorDiv.removeEventListener("focus",lt(this,W)),this.editorDiv.removeEventListener("blur",lt(this,Y)),this.editorDiv.removeEventListener("input",lt(this,z)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Dt){this._focusEventsAllowed&&(super.focusin(Dt),Dt.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Dt;if(this.width){$t(this,St,Yr).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Dt=this._initialOptions)!=null&&Dt.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Dt=lt(this,Q),Ut=Kt(this,Q,$t(this,nt,Si).call(this).trimEnd());if(Dt===Ut)return;const Qt=Lt=>{if(Kt(this,Q,Lt),!Lt){this.remove();return}$t(this,ut,Vr).call(this),this._uiManager.rebuild(this),$t(this,vt,cr).call(this)};this.addCommands({cmd:()=>{Qt(Ut)},undo:()=>{Qt(Dt)},mustExec:!1}),$t(this,vt,cr).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Dt){this.enterInEditMode()}keydown(Dt){Dt.target===this.div&&Dt.key==="Enter"&&(this.enterInEditMode(),Dt.preventDefault())}editorDivKeydown(Dt){Pt._keyboardManager.exec(this,Dt)}editorDivFocus(Dt){this.isEditing=!0}editorDivBlur(Dt){this.isEditing=!1}editorDivInput(Dt){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Dt,Ut;this.width&&(Dt=this.x,Ut=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",lt(this,et)),this.enableEditing(),G.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Lt=>{var qt;return(qt=this.editorDiv)==null?void 0:qt.setAttribute("aria-label",Lt)}),G.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Lt=>{var qt;return(qt=this.editorDiv)==null?void 0:qt.setAttribute("default-content",Lt)}),this.editorDiv.contentEditable=!0;const{style:Qt}=this.editorDiv;if(Qt.fontSize=`calc(${lt(this,it)}px * var(--scale-factor))`,Qt.color=lt(this,J),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,U.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Lt,qt]=this.parentDimensions;if(this.annotationElementId){const{position:wt}=lt(this,rt);let[ot,mt]=this.getInitialTranslation();[ot,mt]=this.pageTranslationToScreen(ot,mt);const[pt,Et]=this.pageDimensions,[yt,Tt]=this.pageTranslation;let kt,Bt;switch(this.rotation){case 0:kt=Dt+(wt[0]-yt)/pt,Bt=Ut+this.height-(wt[1]-Tt)/Et;break;case 90:kt=Dt+(wt[0]-yt)/pt,Bt=Ut-(wt[1]-Tt)/Et,[ot,mt]=[mt,-ot];break;case 180:kt=Dt-this.width+(wt[0]-yt)/pt,Bt=Ut-(wt[1]-Tt)/Et,[ot,mt]=[-ot,-mt];break;case 270:kt=Dt+(wt[0]-yt-this.height*Et)/pt,Bt=Ut+(wt[1]-Tt-this.width*pt)/Et,[ot,mt]=[-mt,ot];break}this.setAt(kt*Lt,Bt*qt,ot,mt)}else this.setAt(Dt*Lt,Ut*qt,this.width*Lt,this.height*qt);$t(this,ut,Vr).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Dt,Ut,Qt){let Lt=null;if(Dt instanceof X.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:wt,fontColor:ot},rect:mt,rotation:pt,id:Et},textContent:yt,textPosition:Tt,parent:{page:{pageNumber:kt}}}=Dt;if(!yt||yt.length===0)return null;Lt=Dt={annotationType:O.AnnotationEditorType.FREETEXT,color:Array.from(ot),fontSize:wt,value:yt.join(`
`),position:Tt,pageIndex:kt-1,rect:mt,rotation:pt,id:Et,deleted:!1}}const qt=super.deserialize(Dt,Ut,Qt);return Kt(qt,it,Dt.fontSize),Kt(qt,J,O.Util.makeHexColor(...Dt.color)),Kt(qt,Q,Dt.value),qt.annotationElementId=Dt.id||null,Kt(qt,rt,Lt),qt}serialize(Dt=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Ut=Pt._internalPadding*this.parentScale,Qt=this.getRect(Ut,Ut),Lt=G.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:lt(this,J)),qt={annotationType:O.AnnotationEditorType.FREETEXT,color:Lt,fontSize:lt(this,it),value:lt(this,Q),pageIndex:this.pageIndex,rect:Qt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Dt?qt:this.annotationElementId&&!$t(this,gt,wi).call(this,qt)?null:(qt.id=this.annotationElementId,qt)}};Y=new WeakMap,W=new WeakMap,z=new WeakMap,K=new WeakMap,J=new WeakMap,Q=new WeakMap,et=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakSet,yi=function(Dt){const Ut=Lt=>{this.editorDiv.style.fontSize=`calc(${Lt}px * var(--scale-factor))`,this.translate(0,-(Lt-lt(this,it))*this.parentScale),Kt(this,it,Lt),$t(this,vt,cr).call(this)},Qt=lt(this,it);this.addCommands({cmd:()=>{Ut(Dt)},undo:()=>{Ut(Qt)},mustExec:!0,type:O.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ct=new WeakSet,Ei=function(Dt){const Ut=lt(this,J);this.addCommands({cmd:()=>{Kt(this,J,this.editorDiv.style.color=Dt)},undo:()=>{Kt(this,J,this.editorDiv.style.color=Ut)},mustExec:!0,type:O.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},nt=new WeakSet,Si=function(){const Dt=this.editorDiv.getElementsByTagName("div");if(Dt.length===0)return this.editorDiv.innerText;const Ut=[];for(const Qt of Dt)Ut.push(Qt.innerText.replace(/\r\n?|\n/,""));return Ut.join(`
`)},vt=new WeakSet,cr=function(){const[Dt,Ut]=this.parentDimensions;let Qt;if(this.isAttachedToDOM)Qt=this.div.getBoundingClientRect();else{const{currentLayer:Lt,div:qt}=this,wt=qt.style.display;qt.style.display="hidden",Lt.div.append(this.div),Qt=qt.getBoundingClientRect(),qt.remove(),qt.style.display=wt}this.rotation%180===this.parentRotation%180?(this.width=Qt.width/Dt,this.height=Qt.height/Ut):(this.width=Qt.height/Dt,this.height=Qt.width/Ut),this.fixAndSetPosition()},ut=new WeakSet,Vr=function(){if(this.editorDiv.replaceChildren(),!!lt(this,Q))for(const Dt of lt(this,Q).split(`
`)){const Ut=document.createElement("div");Ut.append(Dt?document.createTextNode(Dt):document.createElement("br")),this.editorDiv.append(Ut)}},gt=new WeakSet,wi=function(Dt){const{value:Ut,fontSize:Qt,color:Lt,rect:qt,pageIndex:wt}=lt(this,rt);return Dt.value!==Ut||Dt.fontSize!==Qt||Dt.rect.some((ot,mt)=>Math.abs(ot-qt[mt])>=1)||Dt.color.some((ot,mt)=>ot!==Lt[mt])||Dt.pageIndex!==wt},St=new WeakSet,Yr=function(Dt=!1){if(!this.annotationElementId)return;if($t(this,vt,cr).call(this),!Dt&&(this.width===0||this.height===0)){setTimeout(()=>$t(this,St,Yr).call(this,!0),0);return}const Ut=Pt._internalPadding*this.parentScale;lt(this,rt).rect=this.getRect(Ut,Ut)},He(Pt,"_freeTextDefaultContent",""),He(Pt,"_internalPadding",0),He(Pt,"_defaultColor",null),He(Pt,"_defaultFontSize",10),He(Pt,"_type","freetext");let tt=Pt;D.FreeTextEditor=tt},(B,D,F)=>{var mt,Et,Ze,Tt,Ci,Bt,Yt,zt,Zt,ee,he,ne,be,Ce,de,xe,se,Gt,Vt,ie,fe,pe,Te,Ti,Pe,xr,Oe,Kr,Me,Zr,Xt,jt,ae,ce,We,je,Ht,Jr,Ee,ge,Se,we,Pi,le,Qr;Object.defineProperty(D,"__esModule",{value:!0}),D.StampAnnotationElement=D.InkAnnotationElement=D.FreeTextAnnotationElement=D.AnnotationLayer=void 0;var O=F(1),U=F(6),G=F(3),X=F(30),tt=F(31),Y=F(32);const W=1e3,z=9,K=new WeakSet;function J(ye){return{width:ye[2]-ye[0],height:ye[3]-ye[1]}}class Q{static create(Rt){switch(Rt.data.annotationType){case O.AnnotationType.LINK:return new it(Rt);case O.AnnotationType.TEXT:return new rt(Rt);case O.AnnotationType.WIDGET:switch(Rt.data.fieldType){case"Tx":return new at(Rt);case"Btn":return Rt.data.radioButton?new nt(Rt):Rt.data.checkBox?new dt(Rt):new ht(Rt);case"Ch":return new vt(Rt);case"Sig":return new ct(Rt)}return new st(Rt);case O.AnnotationType.POPUP:return new _t(Rt);case O.AnnotationType.FREETEXT:return new bt(Rt);case O.AnnotationType.LINE:return new gt(Rt);case O.AnnotationType.SQUARE:return new At(Rt);case O.AnnotationType.CIRCLE:return new St(Rt);case O.AnnotationType.POLYLINE:return new xt(Rt);case O.AnnotationType.CARET:return new Ft(Rt);case O.AnnotationType.INK:return new Mt(Rt);case O.AnnotationType.POLYGON:return new Pt(Rt);case O.AnnotationType.HIGHLIGHT:return new Dt(Rt);case O.AnnotationType.UNDERLINE:return new Ut(Rt);case O.AnnotationType.SQUIGGLY:return new Qt(Rt);case O.AnnotationType.STRIKEOUT:return new Lt(Rt);case O.AnnotationType.STAMP:return new qt(Rt);case O.AnnotationType.FILEATTACHMENT:return new wt(Rt);default:return new et(Rt)}}}const pt=class pt{constructor(Rt,{isRenderable:ft=!1,ignoreBorder:Ct=!1,createQuadrilaterals:Ot=!1}={}){It(this,mt,!1);this.isRenderable=ft,this.data=Rt.data,this.layer=Rt.layer,this.linkService=Rt.linkService,this.downloadManager=Rt.downloadManager,this.imageResourcesPath=Rt.imageResourcesPath,this.renderForms=Rt.renderForms,this.svgFactory=Rt.svgFactory,this.annotationStorage=Rt.annotationStorage,this.enableScripting=Rt.enableScripting,this.hasJSActions=Rt.hasJSActions,this._fieldObjects=Rt.fieldObjects,this.parent=Rt.parent,ft&&(this.container=this._createContainer(Ct)),Ot&&this._createQuadrilaterals()}static _hasPopupData({titleObj:Rt,contentsObj:ft,richText:Ct}){return!!(Rt!=null&&Rt.str||ft!=null&&ft.str||Ct!=null&&Ct.str)}get hasPopupData(){return pt._hasPopupData(this.data)}_createContainer(Rt){const{data:ft,parent:{page:Ct,viewport:Ot}}=this,Nt=document.createElement("section");Nt.setAttribute("data-annotation-id",ft.id),this instanceof st||(Nt.tabIndex=W),Nt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Nt.setAttribute("aria-haspopup","dialog"),ft.noRotate&&Nt.classList.add("norotate");const{pageWidth:Wt,pageHeight:Jt,pageX:oe,pageY:me}=Ot.rawDims;if(!ft.rect||this instanceof _t){const{rotation:De}=ft;return!ft.hasOwnCanvas&&De!==0&&this.setRotation(De,Nt),Nt}const{width:_e,height:Ie}=J(ft.rect),ve=O.Util.normalizeRect([ft.rect[0],Ct.view[3]-ft.rect[1]+Ct.view[1],ft.rect[2],Ct.view[3]-ft.rect[3]+Ct.view[1]]);if(!Rt&&ft.borderStyle.width>0){Nt.style.borderWidth=`${ft.borderStyle.width}px`;const De=ft.borderStyle.horizontalCornerRadius,Be=ft.borderStyle.verticalCornerRadius;if(De>0||Be>0){const $e=`calc(${De}px * var(--scale-factor)) / calc(${Be}px * var(--scale-factor))`;Nt.style.borderRadius=$e}else if(this instanceof nt){const $e=`calc(${_e}px * var(--scale-factor)) / calc(${Ie}px * var(--scale-factor))`;Nt.style.borderRadius=$e}switch(ft.borderStyle.style){case O.AnnotationBorderStyleType.SOLID:Nt.style.borderStyle="solid";break;case O.AnnotationBorderStyleType.DASHED:Nt.style.borderStyle="dashed";break;case O.AnnotationBorderStyleType.BEVELED:(0,O.warn)("Unimplemented border style: beveled");break;case O.AnnotationBorderStyleType.INSET:(0,O.warn)("Unimplemented border style: inset");break;case O.AnnotationBorderStyleType.UNDERLINE:Nt.style.borderBottomStyle="solid";break}const Le=ft.borderColor||null;Le?(Kt(this,mt,!0),Nt.style.borderColor=O.Util.makeHexColor(Le[0]|0,Le[1]|0,Le[2]|0)):Nt.style.borderWidth=0}Nt.style.left=`${100*(ve[0]-oe)/Wt}%`,Nt.style.top=`${100*(ve[1]-me)/Jt}%`;const{rotation:Ae}=ft;return ft.hasOwnCanvas||Ae===0?(Nt.style.width=`${100*_e/Wt}%`,Nt.style.height=`${100*Ie/Jt}%`):this.setRotation(Ae,Nt),Nt}setRotation(Rt,ft=this.container){if(!this.data.rect)return;const{pageWidth:Ct,pageHeight:Ot}=this.parent.viewport.rawDims,{width:Nt,height:Wt}=J(this.data.rect);let Jt,oe;Rt%180===0?(Jt=100*Nt/Ct,oe=100*Wt/Ot):(Jt=100*Wt/Ct,oe=100*Nt/Ot),ft.style.width=`${Jt}%`,ft.style.height=`${oe}%`,ft.setAttribute("data-main-rotation",(360-Rt)%360)}get _commonActions(){const Rt=(ft,Ct,Ot)=>{const Nt=Ot.detail[ft],Wt=Nt[0],Jt=Nt.slice(1);Ot.target.style[Ct]=X.ColorConverters[`${Wt}_HTML`](Jt),this.annotationStorage.setValue(this.data.id,{[Ct]:X.ColorConverters[`${Wt}_rgb`](Jt)})};return(0,O.shadow)(this,"_commonActions",{display:ft=>{const{display:Ct}=ft.detail,Ot=Ct%2===1;this.container.style.visibility=Ot?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Ot,noPrint:Ct===1||Ct===2})},print:ft=>{this.annotationStorage.setValue(this.data.id,{noPrint:!ft.detail.print})},hidden:ft=>{const{hidden:Ct}=ft.detail;this.container.style.visibility=Ct?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Ct,noView:Ct})},focus:ft=>{setTimeout(()=>ft.target.focus({preventScroll:!1}),0)},userName:ft=>{ft.target.title=ft.detail.userName},readonly:ft=>{ft.target.disabled=ft.detail.readonly},required:ft=>{this._setRequired(ft.target,ft.detail.required)},bgColor:ft=>{Rt("bgColor","backgroundColor",ft)},fillColor:ft=>{Rt("fillColor","backgroundColor",ft)},fgColor:ft=>{Rt("fgColor","color",ft)},textColor:ft=>{Rt("textColor","color",ft)},borderColor:ft=>{Rt("borderColor","borderColor",ft)},strokeColor:ft=>{Rt("strokeColor","borderColor",ft)},rotation:ft=>{const Ct=ft.detail.rotation;this.setRotation(Ct),this.annotationStorage.setValue(this.data.id,{rotation:Ct})}})}_dispatchEventFromSandbox(Rt,ft){const Ct=this._commonActions;for(const Ot of Object.keys(ft.detail)){const Nt=Rt[Ot]||Ct[Ot];Nt==null||Nt(ft)}}_setDefaultPropertiesFromJS(Rt){if(!this.enableScripting)return;const ft=this.annotationStorage.getRawValue(this.data.id);if(!ft)return;const Ct=this._commonActions;for(const[Ot,Nt]of Object.entries(ft)){const Wt=Ct[Ot];if(Wt){const Jt={detail:{[Ot]:Nt},target:Rt};Wt(Jt),delete ft[Ot]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:Rt}=this.data;if(!Rt)return;const[ft,Ct,Ot,Nt]=this.data.rect;if(Rt.length===1){const[,{x:Be,y:Le},{x:$e,y:ze}]=Rt[0];if(Ot===Be&&Nt===Le&&ft===$e&&Ct===ze)return}const{style:Wt}=this.container;let Jt;if(lt(this,mt)){const{borderColor:Be,borderWidth:Le}=Wt;Wt.borderWidth=0,Jt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Be}" stroke-width="${Le}">`],this.container.classList.add("hasBorder")}const oe=Ot-ft,me=Nt-Ct,{svgFactory:_e}=this,Ie=_e.createElement("svg");Ie.classList.add("quadrilateralsContainer"),Ie.setAttribute("width",0),Ie.setAttribute("height",0);const ve=_e.createElement("defs");Ie.append(ve);const Ae=_e.createElement("clipPath"),De=`clippath_${this.data.id}`;Ae.setAttribute("id",De),Ae.setAttribute("clipPathUnits","objectBoundingBox"),ve.append(Ae);for(const[,{x:Be,y:Le},{x:$e,y:ze}]of Rt){const qe=_e.createElement("rect"),Ge=($e-ft)/oe,Ye=(Nt-Le)/me,Ke=(Be-$e)/oe,li=(Le-ze)/me;qe.setAttribute("x",Ge),qe.setAttribute("y",Ye),qe.setAttribute("width",Ke),qe.setAttribute("height",li),Ae.append(qe),Jt==null||Jt.push(`<rect vector-effect="non-scaling-stroke" x="${Ge}" y="${Ye}" width="${Ke}" height="${li}"/>`)}lt(this,mt)&&(Jt.push("</g></svg>')"),Wt.backgroundImage=Jt.join("")),this.container.append(Ie),this.container.style.clipPath=`url(#${De})`}_createPopup(){const{container:Rt,data:ft}=this;Rt.setAttribute("aria-haspopup","dialog");const Ct=new _t({data:{color:ft.color,titleObj:ft.titleObj,modificationDate:ft.modificationDate,contentsObj:ft.contentsObj,richText:ft.richText,parentRect:ft.rect,borderStyle:0,id:`popup_${ft.id}`,rotation:ft.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Ct.render())}render(){(0,O.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(Rt,ft=null){const Ct=[];if(this._fieldObjects){const Ot=this._fieldObjects[Rt];if(Ot)for(const{page:Nt,id:Wt,exportValues:Jt}of Ot){if(Nt===-1||Wt===ft)continue;const oe=typeof Jt=="string"?Jt:null,me=document.querySelector(`[data-element-id="${Wt}"]`);if(me&&!K.has(me)){(0,O.warn)(`_getElementsByName - element not allowed: ${Wt}`);continue}Ct.push({id:Wt,exportValue:oe,domElement:me})}return Ct}for(const Ot of document.getElementsByName(Rt)){const{exportValue:Nt}=Ot,Wt=Ot.getAttribute("data-element-id");Wt!==ft&&K.has(Ot)&&Ct.push({id:Wt,exportValue:Nt,domElement:Ot})}return Ct}show(){var Rt;this.container&&(this.container.hidden=!1),(Rt=this.popup)==null||Rt.maybeShow()}hide(){var Rt;this.container&&(this.container.hidden=!0),(Rt=this.popup)==null||Rt.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const Rt=this.getElementsToTriggerPopup();if(Array.isArray(Rt))for(const ft of Rt)ft.classList.add("highlightArea");else Rt.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:Rt,data:{id:ft}}=this;this.container.addEventListener("dblclick",()=>{var Ct;(Ct=this.linkService.eventBus)==null||Ct.dispatch("switchannotationeditormode",{source:this,mode:Rt,editId:ft})})}};mt=new WeakMap;let et=pt;class it extends et{constructor(ft,Ct=null){super(ft,{isRenderable:!0,ignoreBorder:!!(Ct!=null&&Ct.ignoreBorder),createQuadrilaterals:!0});It(this,Et);It(this,Tt);this.isTooltipOnly=ft.data.isTooltipOnly}render(){const{data:ft,linkService:Ct}=this,Ot=document.createElement("a");Ot.setAttribute("data-element-id",ft.id);let Nt=!1;return ft.url?(Ct.addLinkAttributes(Ot,ft.url,ft.newWindow),Nt=!0):ft.action?(this._bindNamedAction(Ot,ft.action),Nt=!0):ft.attachment?(this._bindAttachment(Ot,ft.attachment),Nt=!0):ft.setOCGState?($t(this,Tt,Ci).call(this,Ot,ft.setOCGState),Nt=!0):ft.dest?(this._bindLink(Ot,ft.dest),Nt=!0):(ft.actions&&(ft.actions.Action||ft.actions["Mouse Up"]||ft.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Ot,ft),Nt=!0),ft.resetForm?(this._bindResetFormAction(Ot,ft.resetForm),Nt=!0):this.isTooltipOnly&&!Nt&&(this._bindLink(Ot,""),Nt=!0)),this.container.classList.add("linkAnnotation"),Nt&&this.container.append(Ot),this.container}_bindLink(ft,Ct){ft.href=this.linkService.getDestinationHash(Ct),ft.onclick=()=>(Ct&&this.linkService.goToDestination(Ct),!1),(Ct||Ct==="")&&$t(this,Et,Ze).call(this)}_bindNamedAction(ft,Ct){ft.href=this.linkService.getAnchorUrl(""),ft.onclick=()=>(this.linkService.executeNamedAction(Ct),!1),$t(this,Et,Ze).call(this)}_bindAttachment(ft,Ct){ft.href=this.linkService.getAnchorUrl(""),ft.onclick=()=>{var Ot;return(Ot=this.downloadManager)==null||Ot.openOrDownloadData(this.container,Ct.content,Ct.filename),!1},$t(this,Et,Ze).call(this)}_bindJSAction(ft,Ct){ft.href=this.linkService.getAnchorUrl("");const Ot=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Nt of Object.keys(Ct.actions)){const Wt=Ot.get(Nt);Wt&&(ft[Wt]=()=>{var Jt;return(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Ct.id,name:Nt}}),!1})}ft.onclick||(ft.onclick=()=>!1),$t(this,Et,Ze).call(this)}_bindResetFormAction(ft,Ct){const Ot=ft.onclick;if(Ot||(ft.href=this.linkService.getAnchorUrl("")),$t(this,Et,Ze).call(this),!this._fieldObjects){(0,O.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Ot||(ft.onclick=()=>!1);return}ft.onclick=()=>{var Ie;Ot==null||Ot();const{fields:Nt,refs:Wt,include:Jt}=Ct,oe=[];if(Nt.length!==0||Wt.length!==0){const ve=new Set(Wt);for(const Ae of Nt){const De=this._fieldObjects[Ae]||[];for(const{id:Be}of De)ve.add(Be)}for(const Ae of Object.values(this._fieldObjects))for(const De of Ae)ve.has(De.id)===Jt&&oe.push(De)}else for(const ve of Object.values(this._fieldObjects))oe.push(...ve);const me=this.annotationStorage,_e=[];for(const ve of oe){const{id:Ae}=ve;switch(_e.push(Ae),ve.type){case"text":{const Be=ve.defaultValue||"";me.setValue(Ae,{value:Be});break}case"checkbox":case"radiobutton":{const Be=ve.defaultValue===ve.exportValues;me.setValue(Ae,{value:Be});break}case"combobox":case"listbox":{const Be=ve.defaultValue||"";me.setValue(Ae,{value:Be});break}default:continue}const De=document.querySelector(`[data-element-id="${Ae}"]`);if(De){if(!K.has(De)){(0,O.warn)(`_bindResetFormAction - element not allowed: ${Ae}`);continue}}else continue;De.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ie=this.linkService.eventBus)==null||Ie.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:_e,name:"ResetForm"}})),!1}}}Et=new WeakSet,Ze=function(){this.container.setAttribute("data-internal-link","")},Tt=new WeakSet,Ci=function(ft,Ct){ft.href=this.linkService.getAnchorUrl(""),ft.onclick=()=>(this.linkService.executeSetOCGState(Ct),!1),$t(this,Et,Ze).call(this)};class rt extends et{constructor(Rt){super(Rt,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const Rt=document.createElement("img");return Rt.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",Rt.alt="[{{type}} Annotation]",Rt.dataset.l10nId="text_annotation_type",Rt.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(Rt),this.container}}class st extends et{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(Rt){var ft;this.data.hasOwnCanvas&&(((ft=Rt.previousSibling)==null?void 0:ft.nodeName)==="CANVAS"&&(Rt.previousSibling.hidden=!0),Rt.hidden=!1)}_getKeyModifier(Rt){const{isWin:ft,isMac:Ct}=O.FeatureTest.platform;return ft&&Rt.ctrlKey||Ct&&Rt.metaKey}_setEventListener(Rt,ft,Ct,Ot,Nt){Ct.includes("mouse")?Rt.addEventListener(Ct,Wt=>{var Jt;(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ot,value:Nt(Wt),shift:Wt.shiftKey,modifier:this._getKeyModifier(Wt)}})}):Rt.addEventListener(Ct,Wt=>{var Jt;if(Ct==="blur"){if(!ft.focused||!Wt.relatedTarget)return;ft.focused=!1}else if(Ct==="focus"){if(ft.focused)return;ft.focused=!0}Nt&&((Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ot,value:Nt(Wt)}}))})}_setEventListeners(Rt,ft,Ct,Ot){var Nt,Wt,Jt;for(const[oe,me]of Ct)(me==="Action"||(Nt=this.data.actions)!=null&&Nt[me])&&((me==="Focus"||me==="Blur")&&(ft||(ft={focused:!1})),this._setEventListener(Rt,ft,oe,me,Ot),me==="Focus"&&!((Wt=this.data.actions)!=null&&Wt.Blur)?this._setEventListener(Rt,ft,"blur","Blur",null):me==="Blur"&&!((Jt=this.data.actions)!=null&&Jt.Focus)&&this._setEventListener(Rt,ft,"focus","Focus",null))}_setBackgroundColor(Rt){const ft=this.data.backgroundColor||null;Rt.style.backgroundColor=ft===null?"transparent":O.Util.makeHexColor(ft[0],ft[1],ft[2])}_setTextStyle(Rt){const ft=["left","center","right"],{fontColor:Ct}=this.data.defaultAppearanceData,Ot=this.data.defaultAppearanceData.fontSize||z,Nt=Rt.style;let Wt;const Jt=2,oe=me=>Math.round(10*me)/10;if(this.data.multiLine){const me=Math.abs(this.data.rect[3]-this.data.rect[1]-Jt),_e=Math.round(me/(O.LINE_FACTOR*Ot))||1,Ie=me/_e;Wt=Math.min(Ot,oe(Ie/O.LINE_FACTOR))}else{const me=Math.abs(this.data.rect[3]-this.data.rect[1]-Jt);Wt=Math.min(Ot,oe(me/O.LINE_FACTOR))}Nt.fontSize=`calc(${Wt}px * var(--scale-factor))`,Nt.color=O.Util.makeHexColor(Ct[0],Ct[1],Ct[2]),this.data.textAlignment!==null&&(Nt.textAlign=ft[this.data.textAlignment])}_setRequired(Rt,ft){ft?Rt.setAttribute("required",!0):Rt.removeAttribute("required"),Rt.setAttribute("aria-required",ft)}}class at extends st{constructor(Rt){const ft=Rt.renderForms||!Rt.data.hasAppearance&&!!Rt.data.fieldValue;super(Rt,{isRenderable:ft})}setPropertyOnSiblings(Rt,ft,Ct,Ot){const Nt=this.annotationStorage;for(const Wt of this._getElementsByName(Rt.name,Rt.id))Wt.domElement&&(Wt.domElement[ft]=Ct),Nt.setValue(Wt.id,{[Ot]:Ct})}render(){var Ot,Nt;const Rt=this.annotationStorage,ft=this.data.id;this.container.classList.add("textWidgetAnnotation");let Ct=null;if(this.renderForms){const Wt=Rt.getValue(ft,{value:this.data.fieldValue});let Jt=Wt.value||"";const oe=Rt.getValue(ft,{charLimit:this.data.maxLen}).charLimit;oe&&Jt.length>oe&&(Jt=Jt.slice(0,oe));let me=Wt.formattedValue||((Ot=this.data.textContent)==null?void 0:Ot.join(`
`))||null;me&&this.data.comb&&(me=me.replaceAll(/\s+/g,""));const _e={userValue:Jt,formattedValue:me,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Ct=document.createElement("textarea"),Ct.textContent=me??Jt,this.data.doNotScroll&&(Ct.style.overflowY="hidden")):(Ct=document.createElement("input"),Ct.type="text",Ct.setAttribute("value",me??Jt),this.data.doNotScroll&&(Ct.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Ct.hidden=!0),K.add(Ct),Ct.setAttribute("data-element-id",ft),Ct.disabled=this.data.readOnly,Ct.name=this.data.fieldName,Ct.tabIndex=W,this._setRequired(Ct,this.data.required),oe&&(Ct.maxLength=oe),Ct.addEventListener("input",ve=>{Rt.setValue(ft,{value:ve.target.value}),this.setPropertyOnSiblings(Ct,"value",ve.target.value,"value"),_e.formattedValue=null}),Ct.addEventListener("resetform",ve=>{const Ae=this.data.defaultFieldValue??"";Ct.value=_e.userValue=Ae,_e.formattedValue=null});let Ie=ve=>{const{formattedValue:Ae}=_e;Ae!=null&&(ve.target.value=Ae),ve.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Ct.addEventListener("focus",Ae=>{if(_e.focused)return;const{target:De}=Ae;_e.userValue&&(De.value=_e.userValue),_e.lastCommittedValue=De.value,_e.commitKey=1,_e.focused=!0}),Ct.addEventListener("updatefromsandbox",Ae=>{this.showElementAndHideCanvas(Ae.target);const De={value(Be){_e.userValue=Be.detail.value??"",Rt.setValue(ft,{value:_e.userValue.toString()}),Be.target.value=_e.userValue},formattedValue(Be){const{formattedValue:Le}=Be.detail;_e.formattedValue=Le,Le!=null&&Be.target!==document.activeElement&&(Be.target.value=Le),Rt.setValue(ft,{formattedValue:Le})},selRange(Be){Be.target.setSelectionRange(...Be.detail.selRange)},charLimit:Be=>{var qe;const{charLimit:Le}=Be.detail,{target:$e}=Be;if(Le===0){$e.removeAttribute("maxLength");return}$e.setAttribute("maxLength",Le);let ze=_e.userValue;!ze||ze.length<=Le||(ze=ze.slice(0,Le),$e.value=_e.userValue=ze,Rt.setValue(ft,{value:ze}),(qe=this.linkService.eventBus)==null||qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ft,name:"Keystroke",value:ze,willCommit:!0,commitKey:1,selStart:$e.selectionStart,selEnd:$e.selectionEnd}}))}};this._dispatchEventFromSandbox(De,Ae)}),Ct.addEventListener("keydown",Ae=>{var Le;_e.commitKey=1;let De=-1;if(Ae.key==="Escape"?De=0:Ae.key==="Enter"&&!this.data.multiLine?De=2:Ae.key==="Tab"&&(_e.commitKey=3),De===-1)return;const{value:Be}=Ae.target;_e.lastCommittedValue!==Be&&(_e.lastCommittedValue=Be,_e.userValue=Be,(Le=this.linkService.eventBus)==null||Le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ft,name:"Keystroke",value:Be,willCommit:!0,commitKey:De,selStart:Ae.target.selectionStart,selEnd:Ae.target.selectionEnd}}))});const ve=Ie;Ie=null,Ct.addEventListener("blur",Ae=>{var Be;if(!_e.focused||!Ae.relatedTarget)return;_e.focused=!1;const{value:De}=Ae.target;_e.userValue=De,_e.lastCommittedValue!==De&&((Be=this.linkService.eventBus)==null||Be.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ft,name:"Keystroke",value:De,willCommit:!0,commitKey:_e.commitKey,selStart:Ae.target.selectionStart,selEnd:Ae.target.selectionEnd}})),ve(Ae)}),(Nt=this.data.actions)!=null&&Nt.Keystroke&&Ct.addEventListener("beforeinput",Ae=>{var Ye;_e.lastCommittedValue=null;const{data:De,target:Be}=Ae,{value:Le,selectionStart:$e,selectionEnd:ze}=Be;let qe=$e,Ge=ze;switch(Ae.inputType){case"deleteWordBackward":{const Ke=Le.substring(0,$e).match(/\w*[^\w]*$/);Ke&&(qe-=Ke[0].length);break}case"deleteWordForward":{const Ke=Le.substring($e).match(/^[^\w]*\w*/);Ke&&(Ge+=Ke[0].length);break}case"deleteContentBackward":$e===ze&&(qe-=1);break;case"deleteContentForward":$e===ze&&(Ge+=1);break}Ae.preventDefault(),(Ye=this.linkService.eventBus)==null||Ye.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ft,name:"Keystroke",value:Le,change:De||"",willCommit:!1,selStart:qe,selEnd:Ge}})}),this._setEventListeners(Ct,_e,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ae=>Ae.target.value)}if(Ie&&Ct.addEventListener("blur",Ie),this.data.comb){const Ae=(this.data.rect[2]-this.data.rect[0])/oe;Ct.classList.add("comb"),Ct.style.letterSpacing=`calc(${Ae}px * var(--scale-factor) - 1ch)`}}else Ct=document.createElement("div"),Ct.textContent=this.data.fieldValue,Ct.style.verticalAlign="middle",Ct.style.display="table-cell";return this._setTextStyle(Ct),this._setBackgroundColor(Ct),this._setDefaultPropertiesFromJS(Ct),this.container.append(Ct),this.container}}class ct extends st{constructor(Rt){super(Rt,{isRenderable:!!Rt.data.hasOwnCanvas})}}class dt extends st{constructor(Rt){super(Rt,{isRenderable:Rt.renderForms})}render(){const Rt=this.annotationStorage,ft=this.data,Ct=ft.id;let Ot=Rt.getValue(Ct,{value:ft.exportValue===ft.fieldValue}).value;typeof Ot=="string"&&(Ot=Ot!=="Off",Rt.setValue(Ct,{value:Ot})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Nt=document.createElement("input");return K.add(Nt),Nt.setAttribute("data-element-id",Ct),Nt.disabled=ft.readOnly,this._setRequired(Nt,this.data.required),Nt.type="checkbox",Nt.name=ft.fieldName,Ot&&Nt.setAttribute("checked",!0),Nt.setAttribute("exportValue",ft.exportValue),Nt.tabIndex=W,Nt.addEventListener("change",Wt=>{const{name:Jt,checked:oe}=Wt.target;for(const me of this._getElementsByName(Jt,Ct)){const _e=oe&&me.exportValue===ft.exportValue;me.domElement&&(me.domElement.checked=_e),Rt.setValue(me.id,{value:_e})}Rt.setValue(Ct,{value:oe})}),Nt.addEventListener("resetform",Wt=>{const Jt=ft.defaultFieldValue||"Off";Wt.target.checked=Jt===ft.exportValue}),this.enableScripting&&this.hasJSActions&&(Nt.addEventListener("updatefromsandbox",Wt=>{const Jt={value(oe){oe.target.checked=oe.detail.value!=="Off",Rt.setValue(Ct,{value:oe.target.checked})}};this._dispatchEventFromSandbox(Jt,Wt)}),this._setEventListeners(Nt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Wt=>Wt.target.checked)),this._setBackgroundColor(Nt),this._setDefaultPropertiesFromJS(Nt),this.container.append(Nt),this.container}}class nt extends st{constructor(Rt){super(Rt,{isRenderable:Rt.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const Rt=this.annotationStorage,ft=this.data,Ct=ft.id;let Ot=Rt.getValue(Ct,{value:ft.fieldValue===ft.buttonValue}).value;typeof Ot=="string"&&(Ot=Ot!==ft.buttonValue,Rt.setValue(Ct,{value:Ot}));const Nt=document.createElement("input");if(K.add(Nt),Nt.setAttribute("data-element-id",Ct),Nt.disabled=ft.readOnly,this._setRequired(Nt,this.data.required),Nt.type="radio",Nt.name=ft.fieldName,Ot&&Nt.setAttribute("checked",!0),Nt.tabIndex=W,Nt.addEventListener("change",Wt=>{const{name:Jt,checked:oe}=Wt.target;for(const me of this._getElementsByName(Jt,Ct))Rt.setValue(me.id,{value:!1});Rt.setValue(Ct,{value:oe})}),Nt.addEventListener("resetform",Wt=>{const Jt=ft.defaultFieldValue;Wt.target.checked=Jt!=null&&Jt===ft.buttonValue}),this.enableScripting&&this.hasJSActions){const Wt=ft.buttonValue;Nt.addEventListener("updatefromsandbox",Jt=>{const oe={value:me=>{const _e=Wt===me.detail.value;for(const Ie of this._getElementsByName(me.target.name)){const ve=_e&&Ie.id===Ct;Ie.domElement&&(Ie.domElement.checked=ve),Rt.setValue(Ie.id,{value:ve})}}};this._dispatchEventFromSandbox(oe,Jt)}),this._setEventListeners(Nt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Jt=>Jt.target.checked)}return this._setBackgroundColor(Nt),this._setDefaultPropertiesFromJS(Nt),this.container.append(Nt),this.container}}class ht extends it{constructor(Rt){super(Rt,{ignoreBorder:Rt.data.hasAppearance})}render(){const Rt=super.render();Rt.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(Rt.title=this.data.alternativeText);const ft=Rt.lastChild;return this.enableScripting&&this.hasJSActions&&ft&&(this._setDefaultPropertiesFromJS(ft),ft.addEventListener("updatefromsandbox",Ct=>{this._dispatchEventFromSandbox({},Ct)})),Rt}}class vt extends st{constructor(Rt){super(Rt,{isRenderable:Rt.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const Rt=this.annotationStorage,ft=this.data.id,Ct=Rt.getValue(ft,{value:this.data.fieldValue}),Ot=document.createElement("select");K.add(Ot),Ot.setAttribute("data-element-id",ft),Ot.disabled=this.data.readOnly,this._setRequired(Ot,this.data.required),Ot.name=this.data.fieldName,Ot.tabIndex=W;let Nt=this.data.combo&&this.data.options.length>0;this.data.combo||(Ot.size=this.data.options.length,this.data.multiSelect&&(Ot.multiple=!0)),Ot.addEventListener("resetform",_e=>{const Ie=this.data.defaultFieldValue;for(const ve of Ot.options)ve.selected=ve.value===Ie});for(const _e of this.data.options){const Ie=document.createElement("option");Ie.textContent=_e.displayValue,Ie.value=_e.exportValue,Ct.value.includes(_e.exportValue)&&(Ie.setAttribute("selected",!0),Nt=!1),Ot.append(Ie)}let Wt=null;if(Nt){const _e=document.createElement("option");_e.value=" ",_e.setAttribute("hidden",!0),_e.setAttribute("selected",!0),Ot.prepend(_e),Wt=()=>{_e.remove(),Ot.removeEventListener("input",Wt),Wt=null},Ot.addEventListener("input",Wt)}const Jt=_e=>{const Ie=_e?"value":"textContent",{options:ve,multiple:Ae}=Ot;return Ae?Array.prototype.filter.call(ve,De=>De.selected).map(De=>De[Ie]):ve.selectedIndex===-1?null:ve[ve.selectedIndex][Ie]};let oe=Jt(!1);const me=_e=>{const Ie=_e.target.options;return Array.prototype.map.call(Ie,ve=>({displayValue:ve.textContent,exportValue:ve.value}))};return this.enableScripting&&this.hasJSActions?(Ot.addEventListener("updatefromsandbox",_e=>{const Ie={value(ve){Wt==null||Wt();const Ae=ve.detail.value,De=new Set(Array.isArray(Ae)?Ae:[Ae]);for(const Be of Ot.options)Be.selected=De.has(Be.value);Rt.setValue(ft,{value:Jt(!0)}),oe=Jt(!1)},multipleSelection(ve){Ot.multiple=!0},remove(ve){const Ae=Ot.options,De=ve.detail.remove;Ae[De].selected=!1,Ot.remove(De),Ae.length>0&&Array.prototype.findIndex.call(Ae,Le=>Le.selected)===-1&&(Ae[0].selected=!0),Rt.setValue(ft,{value:Jt(!0),items:me(ve)}),oe=Jt(!1)},clear(ve){for(;Ot.length!==0;)Ot.remove(0);Rt.setValue(ft,{value:null,items:[]}),oe=Jt(!1)},insert(ve){const{index:Ae,displayValue:De,exportValue:Be}=ve.detail.insert,Le=Ot.children[Ae],$e=document.createElement("option");$e.textContent=De,$e.value=Be,Le?Le.before($e):Ot.append($e),Rt.setValue(ft,{value:Jt(!0),items:me(ve)}),oe=Jt(!1)},items(ve){const{items:Ae}=ve.detail;for(;Ot.length!==0;)Ot.remove(0);for(const De of Ae){const{displayValue:Be,exportValue:Le}=De,$e=document.createElement("option");$e.textContent=Be,$e.value=Le,Ot.append($e)}Ot.options.length>0&&(Ot.options[0].selected=!0),Rt.setValue(ft,{value:Jt(!0),items:me(ve)}),oe=Jt(!1)},indices(ve){const Ae=new Set(ve.detail.indices);for(const De of ve.target.options)De.selected=Ae.has(De.index);Rt.setValue(ft,{value:Jt(!0)}),oe=Jt(!1)},editable(ve){ve.target.disabled=!ve.detail.editable}};this._dispatchEventFromSandbox(Ie,_e)}),Ot.addEventListener("input",_e=>{var ve;const Ie=Jt(!0);Rt.setValue(ft,{value:Ie}),_e.preventDefault(),(ve=this.linkService.eventBus)==null||ve.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ft,name:"Keystroke",value:oe,changeEx:Ie,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Ot,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],_e=>_e.target.value)):Ot.addEventListener("input",function(_e){Rt.setValue(ft,{value:Jt(!0)})}),this.data.combo&&this._setTextStyle(Ot),this._setBackgroundColor(Ot),this._setDefaultPropertiesFromJS(Ot),this.container.append(Ot),this.container}}class _t extends et{constructor(Rt){const{data:ft,elements:Ct}=Rt;super(Rt,{isRenderable:et._hasPopupData(ft)}),this.elements=Ct}render(){this.container.classList.add("popupAnnotation");const Rt=new ut({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),ft=[];for(const Ct of this.elements)Ct.popup=Rt,ft.push(Ct.data.id),Ct.addHighlightArea();return this.container.setAttribute("aria-controls",ft.map(Ct=>`${O.AnnotationPrefix}${Ct}`).join(",")),this.container}}class ut{constructor({container:Rt,color:ft,elements:Ct,titleObj:Ot,modificationDate:Nt,contentsObj:Wt,richText:Jt,parent:oe,rect:me,parentRect:_e,open:Ie}){It(this,Te);It(this,Pe);It(this,Oe);It(this,Me);It(this,Bt,null);It(this,Yt,$t(this,Te,Ti).bind(this));It(this,zt,$t(this,Me,Zr).bind(this));It(this,Zt,$t(this,Oe,Kr).bind(this));It(this,ee,$t(this,Pe,xr).bind(this));It(this,he,null);It(this,ne,null);It(this,be,null);It(this,Ce,null);It(this,de,null);It(this,xe,null);It(this,se,!1);It(this,Gt,null);It(this,Vt,null);It(this,ie,null);It(this,fe,null);It(this,pe,!1);var Ae;Kt(this,ne,Rt),Kt(this,fe,Ot),Kt(this,be,Wt),Kt(this,ie,Jt),Kt(this,de,oe),Kt(this,he,ft),Kt(this,Vt,me),Kt(this,xe,_e),Kt(this,Ce,Ct);const ve=U.PDFDateString.toDateObject(Nt);ve&&Kt(this,Bt,oe.l10n.get("annotation_date_string",{date:ve.toLocaleDateString(),time:ve.toLocaleTimeString()})),this.trigger=Ct.flatMap(De=>De.getElementsToTriggerPopup());for(const De of this.trigger)De.addEventListener("click",lt(this,ee)),De.addEventListener("mouseenter",lt(this,Zt)),De.addEventListener("mouseleave",lt(this,zt)),De.classList.add("popupTriggerArea");for(const De of Ct)(Ae=De.container)==null||Ae.addEventListener("keydown",lt(this,Yt));lt(this,ne).hidden=!0,Ie&&$t(this,Pe,xr).call(this)}render(){if(lt(this,Gt))return;const{page:{view:Rt},viewport:{rawDims:{pageWidth:ft,pageHeight:Ct,pageX:Ot,pageY:Nt}}}=lt(this,de),Wt=Kt(this,Gt,document.createElement("div"));if(Wt.className="popup",lt(this,he)){const qe=Wt.style.outlineColor=O.Util.makeHexColor(...lt(this,he));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Wt.style.backgroundColor=`color-mix(in srgb, ${qe} 30%, white)`:Wt.style.backgroundColor=O.Util.makeHexColor(...lt(this,he).map(Ye=>Math.floor(.7*(255-Ye)+Ye)))}const Jt=document.createElement("span");Jt.className="header";const oe=document.createElement("h1");if(Jt.append(oe),{dir:oe.dir,str:oe.textContent}=lt(this,fe),Wt.append(Jt),lt(this,Bt)){const qe=document.createElement("span");qe.classList.add("popupDate"),lt(this,Bt).then(Ge=>{qe.textContent=Ge}),Jt.append(qe)}const me=lt(this,be),_e=lt(this,ie);if(_e!=null&&_e.str&&(!(me!=null&&me.str)||me.str===_e.str))Y.XfaLayer.render({xfaHtml:_e.html,intent:"richText",div:Wt}),Wt.lastChild.classList.add("richText","popupContent");else{const qe=this._formatContents(me);Wt.append(qe)}let Ie=!!lt(this,xe),ve=Ie?lt(this,xe):lt(this,Vt);for(const qe of lt(this,Ce))if(!ve||O.Util.intersect(qe.data.rect,ve)!==null){ve=qe.data.rect,Ie=!0;break}const Ae=O.Util.normalizeRect([ve[0],Rt[3]-ve[1]+Rt[1],ve[2],Rt[3]-ve[3]+Rt[1]]),De=5,Be=Ie?ve[2]-ve[0]+De:0,Le=Ae[0]+Be,$e=Ae[1],{style:ze}=lt(this,ne);ze.left=`${100*(Le-Ot)/ft}%`,ze.top=`${100*($e-Nt)/Ct}%`,lt(this,ne).append(Wt)}_formatContents({str:Rt,dir:ft}){const Ct=document.createElement("p");Ct.classList.add("popupContent"),Ct.dir=ft;const Ot=Rt.split(/(?:\r\n?|\n)/);for(let Nt=0,Wt=Ot.length;Nt<Wt;++Nt){const Jt=Ot[Nt];Ct.append(document.createTextNode(Jt)),Nt<Wt-1&&Ct.append(document.createElement("br"))}return Ct}forceHide(){Kt(this,pe,this.isVisible),lt(this,pe)&&(lt(this,ne).hidden=!0)}maybeShow(){lt(this,pe)&&(Kt(this,pe,!1),lt(this,ne).hidden=!1)}get isVisible(){return lt(this,ne).hidden===!1}}Bt=new WeakMap,Yt=new WeakMap,zt=new WeakMap,Zt=new WeakMap,ee=new WeakMap,he=new WeakMap,ne=new WeakMap,be=new WeakMap,Ce=new WeakMap,de=new WeakMap,xe=new WeakMap,se=new WeakMap,Gt=new WeakMap,Vt=new WeakMap,ie=new WeakMap,fe=new WeakMap,pe=new WeakMap,Te=new WeakSet,Ti=function(Rt){Rt.altKey||Rt.shiftKey||Rt.ctrlKey||Rt.metaKey||(Rt.key==="Enter"||Rt.key==="Escape"&&lt(this,se))&&$t(this,Pe,xr).call(this)},Pe=new WeakSet,xr=function(){Kt(this,se,!lt(this,se)),lt(this,se)?($t(this,Oe,Kr).call(this),lt(this,ne).addEventListener("click",lt(this,ee)),lt(this,ne).addEventListener("keydown",lt(this,Yt))):($t(this,Me,Zr).call(this),lt(this,ne).removeEventListener("click",lt(this,ee)),lt(this,ne).removeEventListener("keydown",lt(this,Yt)))},Oe=new WeakSet,Kr=function(){lt(this,Gt)||this.render(),this.isVisible?lt(this,se)&&lt(this,ne).classList.add("focused"):(lt(this,ne).hidden=!1,lt(this,ne).style.zIndex=parseInt(lt(this,ne).style.zIndex)+1e3)},Me=new WeakSet,Zr=function(){lt(this,ne).classList.remove("focused"),!(lt(this,se)||!this.isVisible)&&(lt(this,ne).hidden=!0,lt(this,ne).style.zIndex=parseInt(lt(this,ne).style.zIndex)-1e3)};class bt extends et{constructor(Rt){super(Rt,{isRenderable:!0,ignoreBorder:!0}),this.textContent=Rt.data.textContent,this.textPosition=Rt.data.textPosition,this.annotationEditorType=O.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const Rt=document.createElement("div");Rt.classList.add("annotationTextContent"),Rt.setAttribute("role","comment");for(const ft of this.textContent){const Ct=document.createElement("span");Ct.textContent=ft,Rt.append(Ct)}this.container.append(Rt)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}D.FreeTextAnnotationElement=bt;class gt extends et{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0});It(this,Xt,null)}render(){this.container.classList.add("lineAnnotation");const ft=this.data,{width:Ct,height:Ot}=J(ft.rect),Nt=this.svgFactory.create(Ct,Ot,!0),Wt=Kt(this,Xt,this.svgFactory.createElement("svg:line"));return Wt.setAttribute("x1",ft.rect[2]-ft.lineCoordinates[0]),Wt.setAttribute("y1",ft.rect[3]-ft.lineCoordinates[1]),Wt.setAttribute("x2",ft.rect[2]-ft.lineCoordinates[2]),Wt.setAttribute("y2",ft.rect[3]-ft.lineCoordinates[3]),Wt.setAttribute("stroke-width",ft.borderStyle.width||1),Wt.setAttribute("stroke","transparent"),Wt.setAttribute("fill","transparent"),Nt.append(Wt),this.container.append(Nt),!ft.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return lt(this,Xt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xt=new WeakMap;class At extends et{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0});It(this,jt,null)}render(){this.container.classList.add("squareAnnotation");const ft=this.data,{width:Ct,height:Ot}=J(ft.rect),Nt=this.svgFactory.create(Ct,Ot,!0),Wt=ft.borderStyle.width,Jt=Kt(this,jt,this.svgFactory.createElement("svg:rect"));return Jt.setAttribute("x",Wt/2),Jt.setAttribute("y",Wt/2),Jt.setAttribute("width",Ct-Wt),Jt.setAttribute("height",Ot-Wt),Jt.setAttribute("stroke-width",Wt||1),Jt.setAttribute("stroke","transparent"),Jt.setAttribute("fill","transparent"),Nt.append(Jt),this.container.append(Nt),!ft.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return lt(this,jt)}addHighlightArea(){this.container.classList.add("highlightArea")}}jt=new WeakMap;class St extends et{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0});It(this,ae,null)}render(){this.container.classList.add("circleAnnotation");const ft=this.data,{width:Ct,height:Ot}=J(ft.rect),Nt=this.svgFactory.create(Ct,Ot,!0),Wt=ft.borderStyle.width,Jt=Kt(this,ae,this.svgFactory.createElement("svg:ellipse"));return Jt.setAttribute("cx",Ct/2),Jt.setAttribute("cy",Ot/2),Jt.setAttribute("rx",Ct/2-Wt/2),Jt.setAttribute("ry",Ot/2-Wt/2),Jt.setAttribute("stroke-width",Wt||1),Jt.setAttribute("stroke","transparent"),Jt.setAttribute("fill","transparent"),Nt.append(Jt),this.container.append(Nt),!ft.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return lt(this,ae)}addHighlightArea(){this.container.classList.add("highlightArea")}}ae=new WeakMap;class xt extends et{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0});It(this,ce,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const ft=this.data,{width:Ct,height:Ot}=J(ft.rect),Nt=this.svgFactory.create(Ct,Ot,!0);let Wt=[];for(const oe of ft.vertices){const me=oe.x-ft.rect[0],_e=ft.rect[3]-oe.y;Wt.push(me+","+_e)}Wt=Wt.join(" ");const Jt=Kt(this,ce,this.svgFactory.createElement(this.svgElementName));return Jt.setAttribute("points",Wt),Jt.setAttribute("stroke-width",ft.borderStyle.width||1),Jt.setAttribute("stroke","transparent"),Jt.setAttribute("fill","transparent"),Nt.append(Jt),this.container.append(Nt),!ft.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return lt(this,ce)}addHighlightArea(){this.container.classList.add("highlightArea")}}ce=new WeakMap;class Pt extends xt{constructor(Rt){super(Rt),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ft extends et{constructor(Rt){super(Rt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Mt extends et{constructor(ft){super(ft,{isRenderable:!0,ignoreBorder:!0});It(this,We,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=O.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const ft=this.data,{width:Ct,height:Ot}=J(ft.rect),Nt=this.svgFactory.create(Ct,Ot,!0);for(const Wt of ft.inkLists){let Jt=[];for(const me of Wt){const _e=me.x-ft.rect[0],Ie=ft.rect[3]-me.y;Jt.push(`${_e},${Ie}`)}Jt=Jt.join(" ");const oe=this.svgFactory.createElement(this.svgElementName);lt(this,We).push(oe),oe.setAttribute("points",Jt),oe.setAttribute("stroke-width",ft.borderStyle.width||1),oe.setAttribute("stroke","transparent"),oe.setAttribute("fill","transparent"),!ft.popupRef&&this.hasPopupData&&this._createPopup(),Nt.append(oe)}return this.container.append(Nt),this.container}getElementsToTriggerPopup(){return lt(this,We)}addHighlightArea(){this.container.classList.add("highlightArea")}}We=new WeakMap,D.InkAnnotationElement=Mt;class Dt extends et{constructor(Rt){super(Rt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Ut extends et{constructor(Rt){super(Rt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Qt extends et{constructor(Rt){super(Rt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Lt extends et{constructor(Rt){super(Rt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class qt extends et{constructor(Rt){super(Rt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}D.StampAnnotationElement=qt;class wt extends et{constructor(ft){var Nt;super(ft,{isRenderable:!0});It(this,Ht);It(this,je,null);const{filename:Ct,content:Ot}=this.data.file;this.filename=(0,U.getFilenameFromUrl)(Ct,!0),this.content=Ot,(Nt=this.linkService.eventBus)==null||Nt.dispatch("fileattachmentannotation",{source:this,filename:Ct,content:Ot})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:ft,data:Ct}=this;let Ot;Ct.hasAppearance||Ct.fillAlpha===0?Ot=document.createElement("div"):(Ot=document.createElement("img"),Ot.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Ct.name)?"paperclip":"pushpin"}.svg`,Ct.fillAlpha&&Ct.fillAlpha<1&&(Ot.style=`filter: opacity(${Math.round(Ct.fillAlpha*100)}%);`)),Ot.addEventListener("dblclick",$t(this,Ht,Jr).bind(this)),Kt(this,je,Ot);const{isMac:Nt}=O.FeatureTest.platform;return ft.addEventListener("keydown",Wt=>{Wt.key==="Enter"&&(Nt?Wt.metaKey:Wt.ctrlKey)&&$t(this,Ht,Jr).call(this)}),!Ct.popupRef&&this.hasPopupData?this._createPopup():Ot.classList.add("popupTriggerArea"),ft.append(Ot),ft}getElementsToTriggerPopup(){return lt(this,je)}addHighlightArea(){this.container.classList.add("highlightArea")}}je=new WeakMap,Ht=new WeakSet,Jr=function(){var ft;(ft=this.downloadManager)==null||ft.openOrDownloadData(this.container,this.content,this.filename)};class ot{constructor({div:Rt,accessibilityManager:ft,annotationCanvasMap:Ct,l10n:Ot,page:Nt,viewport:Wt}){It(this,we);It(this,le);It(this,Ee,null);It(this,ge,null);It(this,Se,new Map);this.div=Rt,Kt(this,Ee,ft),Kt(this,ge,Ct),this.l10n=Ot,this.page=Nt,this.viewport=Wt,this.zIndex=0,this.l10n||(this.l10n=tt.NullL10n)}async render(Rt){const{annotations:ft}=Rt,Ct=this.div;(0,U.setLayerDimensions)(Ct,this.viewport);const Ot=new Map,Nt={data:null,layer:Ct,linkService:Rt.linkService,downloadManager:Rt.downloadManager,imageResourcesPath:Rt.imageResourcesPath||"",renderForms:Rt.renderForms!==!1,svgFactory:new U.DOMSVGFactory,annotationStorage:Rt.annotationStorage||new G.AnnotationStorage,enableScripting:Rt.enableScripting===!0,hasJSActions:Rt.hasJSActions,fieldObjects:Rt.fieldObjects,parent:this,elements:null};for(const Wt of ft){if(Wt.noHTML)continue;const Jt=Wt.annotationType===O.AnnotationType.POPUP;if(Jt){const _e=Ot.get(Wt.id);if(!_e)continue;Nt.elements=_e}else{const{width:_e,height:Ie}=J(Wt.rect);if(_e<=0||Ie<=0)continue}Nt.data=Wt;const oe=Q.create(Nt);if(!oe.isRenderable)continue;if(!Jt&&Wt.popupRef){const _e=Ot.get(Wt.popupRef);_e?_e.push(oe):Ot.set(Wt.popupRef,[oe])}oe.annotationEditorType>0&&lt(this,Se).set(oe.data.id,oe);const me=oe.render();Wt.hidden&&(me.style.visibility="hidden"),$t(this,we,Pi).call(this,me,Wt.id)}$t(this,le,Qr).call(this),await this.l10n.translate(Ct)}update({viewport:Rt}){const ft=this.div;this.viewport=Rt,(0,U.setLayerDimensions)(ft,{rotation:Rt.rotation}),$t(this,le,Qr).call(this),ft.hidden=!1}getEditableAnnotations(){return Array.from(lt(this,Se).values())}getEditableAnnotation(Rt){return lt(this,Se).get(Rt)}}Ee=new WeakMap,ge=new WeakMap,Se=new WeakMap,we=new WeakSet,Pi=function(Rt,ft){var Ot;const Ct=Rt.firstChild||Rt;Ct.id=`${O.AnnotationPrefix}${ft}`,this.div.append(Rt),(Ot=lt(this,Ee))==null||Ot.moveElementInDOM(this.div,Rt,Ct,!1)},le=new WeakSet,Qr=function(){if(!lt(this,ge))return;const Rt=this.div;for(const[ft,Ct]of lt(this,ge)){const Ot=Rt.querySelector(`[data-annotation-id="${ft}"]`);if(!Ot)continue;const{firstChild:Nt}=Ot;Nt?Nt.nodeName==="CANVAS"?Nt.replaceWith(Ct):Nt.before(Ct):Ot.append(Ct)}lt(this,ge).clear()},D.AnnotationLayer=ot},(B,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.ColorConverters=void 0;function F(G){return Math.floor(Math.max(0,Math.min(1,G))*255).toString(16).padStart(2,"0")}function O(G){return Math.max(0,Math.min(255,255*G))}class U{static CMYK_G([X,tt,Y,W]){return["G",1-Math.min(1,.3*X+.59*Y+.11*tt+W)]}static G_CMYK([X]){return["CMYK",0,0,0,1-X]}static G_RGB([X]){return["RGB",X,X,X]}static G_rgb([X]){return X=O(X),[X,X,X]}static G_HTML([X]){const tt=F(X);return`#${tt}${tt}${tt}`}static RGB_G([X,tt,Y]){return["G",.3*X+.59*tt+.11*Y]}static RGB_rgb(X){return X.map(O)}static RGB_HTML(X){return`#${X.map(F).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([X,tt,Y,W]){return["RGB",1-Math.min(1,X+W),1-Math.min(1,Y+W),1-Math.min(1,tt+W)]}static CMYK_rgb([X,tt,Y,W]){return[O(1-Math.min(1,X+W)),O(1-Math.min(1,Y+W)),O(1-Math.min(1,tt+W))]}static CMYK_HTML(X){const tt=this.CMYK_RGB(X).slice(1);return this.RGB_HTML(tt)}static RGB_CMYK([X,tt,Y]){const W=1-X,z=1-tt,K=1-Y,J=Math.min(W,z,K);return["CMYK",W,z,K,J]}}D.ColorConverters=U},(B,D)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.NullL10n=void 0,D.getL10nFallback=O;const F={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};F.print_progress_percent="{{progress}}%";function O(X,tt){switch(X){case"find_match_count":X=`find_match_count[${tt.total===1?"one":"other"}]`;break;case"find_match_count_limit":X=`find_match_count_limit[${tt.limit===1?"one":"other"}]`;break}return F[X]||""}function U(X,tt){return tt?X.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(Y,W)=>W in tt?tt[W]:"{{"+W+"}}"):X}const G={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(X,tt=null,Y=O(X,tt)){return U(Y,tt)},async translate(X){}};D.NullL10n=G},(B,D,F)=>{Object.defineProperty(D,"__esModule",{value:!0}),D.XfaLayer=void 0;var O=F(25);class U{static setupStorage(X,tt,Y,W,z){const K=W.getValue(tt,{value:null});switch(Y.name){case"textarea":if(K.value!==null&&(X.textContent=K.value),z==="print")break;X.addEventListener("input",J=>{W.setValue(tt,{value:J.target.value})});break;case"input":if(Y.attributes.type==="radio"||Y.attributes.type==="checkbox"){if(K.value===Y.attributes.xfaOn?X.setAttribute("checked",!0):K.value===Y.attributes.xfaOff&&X.removeAttribute("checked"),z==="print")break;X.addEventListener("change",J=>{W.setValue(tt,{value:J.target.checked?J.target.getAttribute("xfaOn"):J.target.getAttribute("xfaOff")})})}else{if(K.value!==null&&X.setAttribute("value",K.value),z==="print")break;X.addEventListener("input",J=>{W.setValue(tt,{value:J.target.value})})}break;case"select":if(K.value!==null){X.setAttribute("value",K.value);for(const J of Y.children)J.attributes.value===K.value?J.attributes.selected=!0:J.attributes.hasOwnProperty("selected")&&delete J.attributes.selected}X.addEventListener("input",J=>{const Q=J.target.options,et=Q.selectedIndex===-1?"":Q[Q.selectedIndex].value;W.setValue(tt,{value:et})});break}}static setAttributes({html:X,element:tt,storage:Y=null,intent:W,linkService:z}){const{attributes:K}=tt,J=X instanceof HTMLAnchorElement;K.type==="radio"&&(K.name=`${K.name}-${W}`);for(const[Q,et]of Object.entries(K))if(et!=null)switch(Q){case"class":et.length&&X.setAttribute(Q,et.join(" "));break;case"dataId":break;case"id":X.setAttribute("data-element-id",et);break;case"style":Object.assign(X.style,et);break;case"textContent":X.textContent=et;break;default:(!J||Q!=="href"&&Q!=="newWindow")&&X.setAttribute(Q,et)}J&&z.addLinkAttributes(X,K.href,K.newWindow),Y&&K.dataId&&this.setupStorage(X,K.dataId,tt,Y)}static render(X){var it;const tt=X.annotationStorage,Y=X.linkService,W=X.xfaHtml,z=X.intent||"display",K=document.createElement(W.name);W.attributes&&this.setAttributes({html:K,element:W,intent:z,linkService:Y});const J=[[W,-1,K]],Q=X.div;if(Q.append(K),X.viewport){const rt=`matrix(${X.viewport.transform.join(",")})`;Q.style.transform=rt}z!=="richText"&&Q.setAttribute("class","xfaLayer xfaFont");const et=[];for(;J.length>0;){const[rt,st,at]=J.at(-1);if(st+1===rt.children.length){J.pop();continue}const ct=rt.children[++J.at(-1)[1]];if(ct===null)continue;const{name:dt}=ct;if(dt==="#text"){const ht=document.createTextNode(ct.value);et.push(ht),at.append(ht);continue}const nt=(it=ct==null?void 0:ct.attributes)!=null&&it.xmlns?document.createElementNS(ct.attributes.xmlns,dt):document.createElement(dt);if(at.append(nt),ct.attributes&&this.setAttributes({html:nt,element:ct,storage:tt,intent:z,linkService:Y}),ct.children&&ct.children.length>0)J.push([ct,-1,nt]);else if(ct.value){const ht=document.createTextNode(ct.value);O.XfaText.shouldBuildText(dt)&&et.push(ht),nt.append(ht)}}for(const rt of Q.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))rt.setAttribute("readOnly",!0);return{textDivs:et}}static update(X){const tt=`matrix(${X.viewport.transform.join(",")})`;X.div.style.transform=tt,X.div.hidden=!1}}D.XfaLayer=U},(B,D,F)=>{var W,z,K,J,Q,et,it,rt,st,at,ct,dt,nt,ht,vt,Di,ut,Ri,gt,ki,St,Fi,Pt,ti,Mt,Oi,Ut,ei,Lt,Ii,wt,Mi,mt,Bi,Et,Ui,Tt,Ni,Bt,Ve,zt,ri,ee,vr,ne,Ar,Ce,er,xe,ii,Gt,yr,ie,Li,pe,ni,ke,$i,Re,ji,Fe,si,te,Er,jt,rr;Object.defineProperty(D,"__esModule",{value:!0}),D.InkEditor=void 0;var O=F(1),U=F(4),G=F(29),X=F(6),tt=F(5);const ce=class ce extends U.AnnotationEditor{constructor(Ht){super({...Ht,name:"inkEditor"});It(this,vt);It(this,ut);It(this,gt);It(this,St);It(this,Pt);It(this,Mt);It(this,Ut);It(this,Lt);It(this,wt);It(this,mt);It(this,Et);It(this,Tt);It(this,Bt);It(this,zt);It(this,ee);It(this,ne);It(this,Ce);It(this,xe);It(this,Gt);It(this,Re);It(this,Fe);It(this,te);It(this,jt);It(this,W,0);It(this,z,0);It(this,K,this.canvasPointermove.bind(this));It(this,J,this.canvasPointerleave.bind(this));It(this,Q,this.canvasPointerup.bind(this));It(this,et,this.canvasPointerdown.bind(this));It(this,it,new Path2D);It(this,rt,!1);It(this,st,!1);It(this,at,!1);It(this,ct,null);It(this,dt,0);It(this,nt,0);It(this,ht,null);this.color=Ht.color||null,this.thickness=Ht.thickness||null,this.opacity=Ht.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Ht){U.AnnotationEditor.initialize(Ht,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Ht,ue){switch(Ht){case O.AnnotationEditorParamsType.INK_THICKNESS:ce._defaultThickness=ue;break;case O.AnnotationEditorParamsType.INK_COLOR:ce._defaultColor=ue;break;case O.AnnotationEditorParamsType.INK_OPACITY:ce._defaultOpacity=ue/100;break}}updateParams(Ht,ue){switch(Ht){case O.AnnotationEditorParamsType.INK_THICKNESS:$t(this,vt,Di).call(this,ue);break;case O.AnnotationEditorParamsType.INK_COLOR:$t(this,ut,Ri).call(this,ue);break;case O.AnnotationEditorParamsType.INK_OPACITY:$t(this,gt,ki).call(this,ue);break}}static get defaultPropertiesToUpdate(){return[[O.AnnotationEditorParamsType.INK_THICKNESS,ce._defaultThickness],[O.AnnotationEditorParamsType.INK_COLOR,ce._defaultColor||U.AnnotationEditor._defaultLineColor],[O.AnnotationEditorParamsType.INK_OPACITY,Math.round(ce._defaultOpacity*100)]]}get propertiesToUpdate(){return[[O.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ce._defaultThickness],[O.AnnotationEditorParamsType.INK_COLOR,this.color||ce._defaultColor||U.AnnotationEditor._defaultLineColor],[O.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ce._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||($t(this,ee,vr).call(this),$t(this,ne,Ar).call(this)),this.isAttachedToDOM||(this.parent.add(this),$t(this,Ce,er).call(this)),$t(this,jt,rr).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,lt(this,ct).disconnect(),Kt(this,ct,null),super.remove())}setParent(Ht){!this.parent&&Ht?this._uiManager.removeShouldRescale(this):this.parent&&Ht===null&&this._uiManager.addShouldRescale(this),super.setParent(Ht)}onScaleChanging(){const[Ht,ue]=this.parentDimensions,Ee=this.width*Ht,ge=this.height*ue;this.setDimensions(Ee,ge)}enableEditMode(){lt(this,rt)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",lt(this,et)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",lt(this,et)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){lt(this,rt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Kt(this,rt,!0),this.div.classList.add("disabled"),$t(this,jt,rr).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Ht){this._focusEventsAllowed&&(super.focusin(Ht),this.enableEditMode())}canvasPointerdown(Ht){Ht.button!==0||!this.isInEditMode()||lt(this,rt)||(this.setInForeground(),Ht.preventDefault(),Ht.type!=="mouse"&&this.div.focus(),$t(this,Mt,Oi).call(this,Ht.offsetX,Ht.offsetY))}canvasPointermove(Ht){Ht.preventDefault(),$t(this,Ut,ei).call(this,Ht.offsetX,Ht.offsetY)}canvasPointerup(Ht){Ht.preventDefault(),$t(this,zt,ri).call(this,Ht)}canvasPointerleave(Ht){$t(this,zt,ri).call(this,Ht)}get isResizable(){return!this.isEmpty()&&lt(this,rt)}render(){if(this.div)return this.div;let Ht,ue;this.width&&(Ht=this.x,ue=this.y),super.render(),U.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Ne=>{var le;return(le=this.div)==null?void 0:le.setAttribute("aria-label",Ne)});const[Ee,ge,Se,we]=$t(this,St,Fi).call(this);if(this.setAt(Ee,ge,0,0),this.setDims(Se,we),$t(this,ee,vr).call(this),this.width){const[Ne,le]=this.parentDimensions;this.setAspectRatio(this.width*Ne,this.height*le),this.setAt(Ht*Ne,ue*le,this.width*Ne,this.height*le),Kt(this,at,!0),$t(this,Ce,er).call(this),this.setDims(this.width*Ne,this.height*le),$t(this,Bt,Ve).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return $t(this,ne,Ar).call(this),this.div}setDimensions(Ht,ue){const Ee=Math.round(Ht),ge=Math.round(ue);if(lt(this,dt)===Ee&&lt(this,nt)===ge)return;Kt(this,dt,Ee),Kt(this,nt,ge),this.canvas.style.visibility="hidden";const[Se,we]=this.parentDimensions;this.width=Ht/Se,this.height=ue/we,this.fixAndSetPosition(),lt(this,rt)&&$t(this,xe,ii).call(this,Ht,ue),$t(this,Ce,er).call(this),$t(this,Bt,Ve).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Ht,ue,Ee){var Nt,Wt,Jt;if(Ht instanceof G.InkAnnotationElement)return null;const ge=super.deserialize(Ht,ue,Ee);ge.thickness=Ht.thickness,ge.color=O.Util.makeHexColor(...Ht.color),ge.opacity=Ht.opacity;const[Se,we]=ge.pageDimensions,Ne=ge.width*Se,le=ge.height*we,Ue=ge.parentScale,ye=Ht.thickness/2;Kt(ge,rt,!0),Kt(ge,dt,Math.round(Ne)),Kt(ge,nt,Math.round(le));const{paths:Rt,rect:ft,rotation:Ct}=Ht;for(let{bezier:oe}of Rt){oe=$t(Nt=ce,ke,$i).call(Nt,oe,ft,Ct);const me=[];ge.paths.push(me);let _e=Ue*(oe[0]-ye),Ie=Ue*(oe[1]-ye);for(let Ae=2,De=oe.length;Ae<De;Ae+=6){const Be=Ue*(oe[Ae]-ye),Le=Ue*(oe[Ae+1]-ye),$e=Ue*(oe[Ae+2]-ye),ze=Ue*(oe[Ae+3]-ye),qe=Ue*(oe[Ae+4]-ye),Ge=Ue*(oe[Ae+5]-ye);me.push([[_e,Ie],[Be,Le],[$e,ze],[qe,Ge]]),_e=qe,Ie=Ge}const ve=$t(this,ie,Li).call(this,me);ge.bezierPath2D.push(ve)}const Ot=$t(Wt=ge,Fe,si).call(Wt);return Kt(ge,z,Math.max(U.AnnotationEditor.MIN_SIZE,Ot[2]-Ot[0])),Kt(ge,W,Math.max(U.AnnotationEditor.MIN_SIZE,Ot[3]-Ot[1])),$t(Jt=ge,xe,ii).call(Jt,Ne,le),ge}serialize(){if(this.isEmpty())return null;const Ht=this.getRect(0,0),ue=U.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:O.AnnotationEditorType.INK,color:ue,thickness:this.thickness,opacity:this.opacity,paths:$t(this,Re,ji).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Ht),pageIndex:this.pageIndex,rect:Ht,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};W=new WeakMap,z=new WeakMap,K=new WeakMap,J=new WeakMap,Q=new WeakMap,et=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakMap,at=new WeakMap,ct=new WeakMap,dt=new WeakMap,nt=new WeakMap,ht=new WeakMap,vt=new WeakSet,Di=function(Ht){const ue=this.thickness;this.addCommands({cmd:()=>{this.thickness=Ht,$t(this,jt,rr).call(this)},undo:()=>{this.thickness=ue,$t(this,jt,rr).call(this)},mustExec:!0,type:O.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},ut=new WeakSet,Ri=function(Ht){const ue=this.color;this.addCommands({cmd:()=>{this.color=Ht,$t(this,Bt,Ve).call(this)},undo:()=>{this.color=ue,$t(this,Bt,Ve).call(this)},mustExec:!0,type:O.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},gt=new WeakSet,ki=function(Ht){Ht/=100;const ue=this.opacity;this.addCommands({cmd:()=>{this.opacity=Ht,$t(this,Bt,Ve).call(this)},undo:()=>{this.opacity=ue,$t(this,Bt,Ve).call(this)},mustExec:!0,type:O.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},St=new WeakSet,Fi=function(){const{parentRotation:Ht,parentDimensions:[ue,Ee]}=this;switch(Ht){case 90:return[0,Ee,Ee,ue];case 180:return[ue,Ee,ue,Ee];case 270:return[ue,0,Ee,ue];default:return[0,0,ue,Ee]}},Pt=new WeakSet,ti=function(){const{ctx:Ht,color:ue,opacity:Ee,thickness:ge,parentScale:Se,scaleFactor:we}=this;Ht.lineWidth=ge*Se/we,Ht.lineCap="round",Ht.lineJoin="round",Ht.miterLimit=10,Ht.strokeStyle=`${ue}${(0,tt.opacityToHex)(Ee)}`},Mt=new WeakSet,Oi=function(Ht,ue){this.canvas.addEventListener("contextmenu",X.noContextMenu),this.canvas.addEventListener("pointerleave",lt(this,J)),this.canvas.addEventListener("pointermove",lt(this,K)),this.canvas.addEventListener("pointerup",lt(this,Q)),this.canvas.removeEventListener("pointerdown",lt(this,et)),this.isEditing=!0,lt(this,at)||(Kt(this,at,!0),$t(this,Ce,er).call(this),this.thickness||(this.thickness=ce._defaultThickness),this.color||(this.color=ce._defaultColor||U.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=ce._defaultOpacity)),this.currentPath.push([Ht,ue]),Kt(this,st,!1),$t(this,Pt,ti).call(this),Kt(this,ht,()=>{$t(this,mt,Bi).call(this),lt(this,ht)&&window.requestAnimationFrame(lt(this,ht))}),window.requestAnimationFrame(lt(this,ht))},Ut=new WeakSet,ei=function(Ht,ue){const[Ee,ge]=this.currentPath.at(-1);if(this.currentPath.length>1&&Ht===Ee&&ue===ge)return;const Se=this.currentPath;let we=lt(this,it);if(Se.push([Ht,ue]),Kt(this,st,!0),Se.length<=2){we.moveTo(...Se[0]),we.lineTo(Ht,ue);return}Se.length===3&&(Kt(this,it,we=new Path2D),we.moveTo(...Se[0])),$t(this,Et,Ui).call(this,we,...Se.at(-3),...Se.at(-2),Ht,ue)},Lt=new WeakSet,Ii=function(){if(this.currentPath.length===0)return;const Ht=this.currentPath.at(-1);lt(this,it).lineTo(...Ht)},wt=new WeakSet,Mi=function(Ht,ue){Kt(this,ht,null),Ht=Math.min(Math.max(Ht,0),this.canvas.width),ue=Math.min(Math.max(ue,0),this.canvas.height),$t(this,Ut,ei).call(this,Ht,ue),$t(this,Lt,Ii).call(this);let Ee;if(this.currentPath.length!==1)Ee=$t(this,Tt,Ni).call(this);else{const le=[Ht,ue];Ee=[[le,le.slice(),le.slice(),le]]}const ge=lt(this,it),Se=this.currentPath;this.currentPath=[],Kt(this,it,new Path2D);const we=()=>{this.allRawPaths.push(Se),this.paths.push(Ee),this.bezierPath2D.push(ge),this.rebuild()},Ne=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||($t(this,ee,vr).call(this),$t(this,ne,Ar).call(this)),$t(this,jt,rr).call(this))};this.addCommands({cmd:we,undo:Ne,mustExec:!0})},mt=new WeakSet,Bi=function(){if(!lt(this,st))return;Kt(this,st,!1);const Ht=Math.ceil(this.thickness*this.parentScale),ue=this.currentPath.slice(-3),Ee=ue.map(we=>we[0]),ge=ue.map(we=>we[1]);Math.min(...Ee)-Ht,Math.max(...Ee)+Ht,Math.min(...ge)-Ht,Math.max(...ge)+Ht;const{ctx:Se}=this;Se.save(),Se.clearRect(0,0,this.canvas.width,this.canvas.height);for(const we of this.bezierPath2D)Se.stroke(we);Se.stroke(lt(this,it)),Se.restore()},Et=new WeakSet,Ui=function(Ht,ue,Ee,ge,Se,we,Ne){const le=(ue+ge)/2,Ue=(Ee+Se)/2,ye=(ge+we)/2,Rt=(Se+Ne)/2;Ht.bezierCurveTo(le+2*(ge-le)/3,Ue+2*(Se-Ue)/3,ye+2*(ge-ye)/3,Rt+2*(Se-Rt)/3,ye,Rt)},Tt=new WeakSet,Ni=function(){const Ht=this.currentPath;if(Ht.length<=2)return[[Ht[0],Ht[0],Ht.at(-1),Ht.at(-1)]];const ue=[];let Ee,[ge,Se]=Ht[0];for(Ee=1;Ee<Ht.length-2;Ee++){const[ft,Ct]=Ht[Ee],[Ot,Nt]=Ht[Ee+1],Wt=(ft+Ot)/2,Jt=(Ct+Nt)/2,oe=[ge+2*(ft-ge)/3,Se+2*(Ct-Se)/3],me=[Wt+2*(ft-Wt)/3,Jt+2*(Ct-Jt)/3];ue.push([[ge,Se],oe,me,[Wt,Jt]]),[ge,Se]=[Wt,Jt]}const[we,Ne]=Ht[Ee],[le,Ue]=Ht[Ee+1],ye=[ge+2*(we-ge)/3,Se+2*(Ne-Se)/3],Rt=[le+2*(we-le)/3,Ue+2*(Ne-Ue)/3];return ue.push([[ge,Se],ye,Rt,[le,Ue]]),ue},Bt=new WeakSet,Ve=function(){if(this.isEmpty()){$t(this,Gt,yr).call(this);return}$t(this,Pt,ti).call(this);const{canvas:Ht,ctx:ue}=this;ue.setTransform(1,0,0,1,0,0),ue.clearRect(0,0,Ht.width,Ht.height),$t(this,Gt,yr).call(this);for(const Ee of this.bezierPath2D)ue.stroke(Ee)},zt=new WeakSet,ri=function(Ht){this.canvas.removeEventListener("pointerleave",lt(this,J)),this.canvas.removeEventListener("pointermove",lt(this,K)),this.canvas.removeEventListener("pointerup",lt(this,Q)),this.canvas.addEventListener("pointerdown",lt(this,et)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",X.noContextMenu)},10),$t(this,wt,Mi).call(this,Ht.offsetX,Ht.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ee=new WeakSet,vr=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",U.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Ht=>{var ue;return(ue=this.canvas)==null?void 0:ue.setAttribute("aria-label",Ht)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},ne=new WeakSet,Ar=function(){Kt(this,ct,new ResizeObserver(Ht=>{const ue=Ht[0].contentRect;ue.width&&ue.height&&this.setDimensions(ue.width,ue.height)})),lt(this,ct).observe(this.div)},Ce=new WeakSet,er=function(){if(!lt(this,at))return;const[Ht,ue]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Ht),this.canvas.height=Math.ceil(this.height*ue),$t(this,Gt,yr).call(this)},xe=new WeakSet,ii=function(Ht,ue){const Ee=$t(this,te,Er).call(this),ge=(Ht-Ee)/lt(this,z),Se=(ue-Ee)/lt(this,W);this.scaleFactor=Math.min(ge,Se)},Gt=new WeakSet,yr=function(){const Ht=$t(this,te,Er).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Ht,this.translationY*this.scaleFactor+Ht)},ie=new WeakSet,Li=function(Ht){const ue=new Path2D;for(let Ee=0,ge=Ht.length;Ee<ge;Ee++){const[Se,we,Ne,le]=Ht[Ee];Ee===0&&ue.moveTo(...Se),ue.bezierCurveTo(we[0],we[1],Ne[0],Ne[1],le[0],le[1])}return ue},pe=new WeakSet,ni=function(Ht,ue,Ee){const[ge,Se,we,Ne]=ue;switch(Ee){case 0:for(let le=0,Ue=Ht.length;le<Ue;le+=2)Ht[le]+=ge,Ht[le+1]=Ne-Ht[le+1];break;case 90:for(let le=0,Ue=Ht.length;le<Ue;le+=2){const ye=Ht[le];Ht[le]=Ht[le+1]+ge,Ht[le+1]=ye+Se}break;case 180:for(let le=0,Ue=Ht.length;le<Ue;le+=2)Ht[le]=we-Ht[le],Ht[le+1]+=Se;break;case 270:for(let le=0,Ue=Ht.length;le<Ue;le+=2){const ye=Ht[le];Ht[le]=we-Ht[le+1],Ht[le+1]=Ne-ye}break;default:throw new Error("Invalid rotation")}return Ht},ke=new WeakSet,$i=function(Ht,ue,Ee){const[ge,Se,we,Ne]=ue;switch(Ee){case 0:for(let le=0,Ue=Ht.length;le<Ue;le+=2)Ht[le]-=ge,Ht[le+1]=Ne-Ht[le+1];break;case 90:for(let le=0,Ue=Ht.length;le<Ue;le+=2){const ye=Ht[le];Ht[le]=Ht[le+1]-Se,Ht[le+1]=ye-ge}break;case 180:for(let le=0,Ue=Ht.length;le<Ue;le+=2)Ht[le]=we-Ht[le],Ht[le+1]-=Se;break;case 270:for(let le=0,Ue=Ht.length;le<Ue;le+=2){const ye=Ht[le];Ht[le]=Ne-Ht[le+1],Ht[le+1]=we-ye}break;default:throw new Error("Invalid rotation")}return Ht},Re=new WeakSet,ji=function(Ht,ue,Ee,ge){var Ue,ye;const Se=[],we=this.thickness/2,Ne=Ht*ue+we,le=Ht*Ee+we;for(const Rt of this.paths){const ft=[],Ct=[];for(let Ot=0,Nt=Rt.length;Ot<Nt;Ot++){const[Wt,Jt,oe,me]=Rt[Ot],_e=Ht*Wt[0]+Ne,Ie=Ht*Wt[1]+le,ve=Ht*Jt[0]+Ne,Ae=Ht*Jt[1]+le,De=Ht*oe[0]+Ne,Be=Ht*oe[1]+le,Le=Ht*me[0]+Ne,$e=Ht*me[1]+le;Ot===0&&(ft.push(_e,Ie),Ct.push(_e,Ie)),ft.push(ve,Ae,De,Be,Le,$e),Ct.push(ve,Ae),Ot===Nt-1&&Ct.push(Le,$e)}Se.push({bezier:$t(Ue=ce,pe,ni).call(Ue,ft,ge,this.rotation),points:$t(ye=ce,pe,ni).call(ye,Ct,ge,this.rotation)})}return Se},Fe=new WeakSet,si=function(){let Ht=1/0,ue=-1/0,Ee=1/0,ge=-1/0;for(const Se of this.paths)for(const[we,Ne,le,Ue]of Se){const ye=O.Util.bezierBoundingBox(...we,...Ne,...le,...Ue);Ht=Math.min(Ht,ye[0]),Ee=Math.min(Ee,ye[1]),ue=Math.max(ue,ye[2]),ge=Math.max(ge,ye[3])}return[Ht,Ee,ue,ge]},te=new WeakSet,Er=function(){return lt(this,rt)?Math.ceil(this.thickness*this.parentScale):0},jt=new WeakSet,rr=function(Ht=!1){if(this.isEmpty())return;if(!lt(this,rt)){$t(this,Bt,Ve).call(this);return}const ue=$t(this,Fe,si).call(this),Ee=$t(this,te,Er).call(this);Kt(this,z,Math.max(U.AnnotationEditor.MIN_SIZE,ue[2]-ue[0])),Kt(this,W,Math.max(U.AnnotationEditor.MIN_SIZE,ue[3]-ue[1]));const ge=Math.ceil(Ee+lt(this,z)*this.scaleFactor),Se=Math.ceil(Ee+lt(this,W)*this.scaleFactor),[we,Ne]=this.parentDimensions;this.width=ge/we,this.height=Se/Ne,this.setAspectRatio(ge,Se);const le=this.translationX,Ue=this.translationY;this.translationX=-ue[0],this.translationY=-ue[1],$t(this,Ce,er).call(this),$t(this,Bt,Ve).call(this),Kt(this,dt,ge),Kt(this,nt,Se),this.setDims(ge,Se);const ye=Ht?Ee/this.scaleFactor/2:0;this.translate(le-this.translationX-ye,Ue-this.translationY-ye)},It(ce,ie),It(ce,pe),It(ce,ke),He(ce,"_defaultColor",null),He(ce,"_defaultOpacity",1),He(ce,"_defaultThickness",1),He(ce,"_type","ink");let Y=ce;D.InkEditor=Y},(B,D,F)=>{var Y,W,z,K,J,Q,et,it,rt,st,at,hr,dt,dr,ht,Sr,_t,ai,bt,Wi,At,Hi,xt,oi,Ft,wr,Dt,qi;Object.defineProperty(D,"__esModule",{value:!0}),D.StampEditor=void 0;var O=F(1),U=F(4),G=F(6),X=F(29);const Qt=class Qt extends U.AnnotationEditor{constructor(wt){super({...wt,name:"stampEditor"});It(this,at);It(this,dt);It(this,ht);It(this,_t);It(this,bt);It(this,At);It(this,xt);It(this,Ft);It(this,Dt);It(this,Y,null);It(this,W,null);It(this,z,null);It(this,K,null);It(this,J,null);It(this,Q,null);It(this,et,null);It(this,it,null);It(this,rt,!1);It(this,st,!1);Kt(this,K,wt.bitmapUrl),Kt(this,J,wt.bitmapFile)}static initialize(wt){U.AnnotationEditor.initialize(wt)}static get supportedTypes(){const wt=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,O.shadow)(this,"supportedTypes",wt.map(ot=>`image/${ot}`))}static get supportedTypesStr(){return(0,O.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(wt){return this.supportedTypes.includes(wt)}static paste(wt,ot){ot.pasteEditor(O.AnnotationEditorType.STAMP,{bitmapFile:wt.getAsFile()})}remove(){var wt,ot;lt(this,W)&&(Kt(this,Y,null),this._uiManager.imageManager.deleteId(lt(this,W)),(wt=lt(this,Q))==null||wt.remove(),Kt(this,Q,null),(ot=lt(this,et))==null||ot.disconnect(),Kt(this,et,null)),super.remove()}rebuild(){if(!this.parent){lt(this,W)&&$t(this,ht,Sr).call(this);return}super.rebuild(),this.div!==null&&(lt(this,W)&&$t(this,ht,Sr).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(lt(this,z)||lt(this,Y)||lt(this,K)||lt(this,J))}get isResizable(){return!0}render(){if(this.div)return this.div;let wt,ot;if(this.width&&(wt=this.x,ot=this.y),super.render(),this.div.hidden=!0,lt(this,Y)?$t(this,_t,ai).call(this):$t(this,ht,Sr).call(this),this.width){const[mt,pt]=this.parentDimensions;this.setAt(wt*mt,ot*pt,this.width*mt,this.height*pt)}return this.div}static deserialize(wt,ot,mt){if(wt instanceof X.StampAnnotationElement)return null;const pt=super.deserialize(wt,ot,mt),{rect:Et,bitmapUrl:yt,bitmapId:Tt,isSvg:kt,accessibilityData:Bt}=wt;Tt&&mt.imageManager.isValidId(Tt)?Kt(pt,W,Tt):Kt(pt,K,yt),Kt(pt,rt,kt);const[Yt,zt]=pt.pageDimensions;return pt.width=(Et[2]-Et[0])/Yt,pt.height=(Et[3]-Et[1])/zt,Bt&&(pt.altTextData=Bt),pt}serialize(wt=!1,ot=null){if(this.isEmpty())return null;const mt={annotationType:O.AnnotationEditorType.STAMP,bitmapId:lt(this,W),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:lt(this,rt),structTreeParentId:this._structTreeParentId};if(wt)return mt.bitmapUrl=$t(this,Ft,wr).call(this,!0),mt.accessibilityData=this.altTextData,mt;const{decorative:pt,altText:Et}=this.altTextData;if(!pt&&Et&&(mt.accessibilityData={type:"Figure",alt:Et}),ot===null)return mt;ot.stamps||(ot.stamps=new Map);const yt=lt(this,rt)?(mt.rect[2]-mt.rect[0])*(mt.rect[3]-mt.rect[1]):null;if(!ot.stamps.has(lt(this,W)))ot.stamps.set(lt(this,W),{area:yt,serialized:mt}),mt.bitmap=$t(this,Ft,wr).call(this,!1);else if(lt(this,rt)){const Tt=ot.stamps.get(lt(this,W));yt>Tt.area&&(Tt.area=yt,Tt.serialized.bitmap.close(),Tt.serialized.bitmap=$t(this,Ft,wr).call(this,!1))}return mt}};Y=new WeakMap,W=new WeakMap,z=new WeakMap,K=new WeakMap,J=new WeakMap,Q=new WeakMap,et=new WeakMap,it=new WeakMap,rt=new WeakMap,st=new WeakMap,at=new WeakSet,hr=function(wt,ot=!1){if(!wt){this.remove();return}Kt(this,Y,wt.bitmap),ot||(Kt(this,W,wt.id),Kt(this,rt,wt.isSvg)),$t(this,_t,ai).call(this)},dt=new WeakSet,dr=function(){Kt(this,z,null),this._uiManager.enableWaiting(!1),lt(this,Q)&&this.div.focus()},ht=new WeakSet,Sr=function(){if(lt(this,W)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(lt(this,W)).then(ot=>$t(this,at,hr).call(this,ot,!0)).finally(()=>$t(this,dt,dr).call(this));return}if(lt(this,K)){const ot=lt(this,K);Kt(this,K,null),this._uiManager.enableWaiting(!0),Kt(this,z,this._uiManager.imageManager.getFromUrl(ot).then(mt=>$t(this,at,hr).call(this,mt)).finally(()=>$t(this,dt,dr).call(this)));return}if(lt(this,J)){const ot=lt(this,J);Kt(this,J,null),this._uiManager.enableWaiting(!0),Kt(this,z,this._uiManager.imageManager.getFromFile(ot).then(mt=>$t(this,at,hr).call(this,mt)).finally(()=>$t(this,dt,dr).call(this)));return}const wt=document.createElement("input");wt.type="file",wt.accept=Qt.supportedTypesStr,Kt(this,z,new Promise(ot=>{wt.addEventListener("change",async()=>{if(!wt.files||wt.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const mt=await this._uiManager.imageManager.getFromFile(wt.files[0]);$t(this,at,hr).call(this,mt)}ot()}),wt.addEventListener("cancel",()=>{this.remove(),ot()})}).finally(()=>$t(this,dt,dr).call(this))),wt.click()},_t=new WeakSet,ai=function(){const{div:wt}=this;let{width:ot,height:mt}=lt(this,Y);const[pt,Et]=this.pageDimensions,yt=.75;if(this.width)ot=this.width*pt,mt=this.height*Et;else if(ot>yt*pt||mt>yt*Et){const Yt=Math.min(yt*pt/ot,yt*Et/mt);ot*=Yt,mt*=Yt}const[Tt,kt]=this.parentDimensions;this.setDims(ot*Tt/pt,mt*kt/Et),this._uiManager.enableWaiting(!1);const Bt=Kt(this,Q,document.createElement("canvas"));wt.append(Bt),wt.hidden=!1,$t(this,xt,oi).call(this,ot,mt),$t(this,Dt,qi).call(this),lt(this,st)||(this.parent.addUndoableEditor(this),Kt(this,st,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},bt=new WeakSet,Wi=function(wt,ot){var yt;const[mt,pt]=this.parentDimensions;this.width=wt/mt,this.height=ot/pt,this.setDims(wt,ot),(yt=this._initialOptions)!=null&&yt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,lt(this,it)!==null&&clearTimeout(lt(this,it)),Kt(this,it,setTimeout(()=>{Kt(this,it,null),$t(this,xt,oi).call(this,wt,ot)},200))},At=new WeakSet,Hi=function(wt,ot){const{width:mt,height:pt}=lt(this,Y);let Et=mt,yt=pt,Tt=lt(this,Y);for(;Et>2*wt||yt>2*ot;){const kt=Et,Bt=yt;Et>2*wt&&(Et=Et>=16384?Math.floor(Et/2)-1:Math.ceil(Et/2)),yt>2*ot&&(yt=yt>=16384?Math.floor(yt/2)-1:Math.ceil(yt/2));const Yt=new OffscreenCanvas(Et,yt);Yt.getContext("2d").drawImage(Tt,0,0,kt,Bt,0,0,Et,yt),Tt=Yt.transferToImageBitmap()}return Tt},xt=new WeakSet,oi=function(wt,ot){wt=Math.ceil(wt),ot=Math.ceil(ot);const mt=lt(this,Q);if(!mt||mt.width===wt&&mt.height===ot)return;mt.width=wt,mt.height=ot;const pt=lt(this,rt)?lt(this,Y):$t(this,At,Hi).call(this,wt,ot),Et=mt.getContext("2d");Et.filter=this._uiManager.hcmFilter,Et.drawImage(pt,0,0,pt.width,pt.height,0,0,wt,ot)},Ft=new WeakSet,wr=function(wt){if(wt){if(lt(this,rt)){const pt=this._uiManager.imageManager.getSvgUrl(lt(this,W));if(pt)return pt}const ot=document.createElement("canvas");return{width:ot.width,height:ot.height}=lt(this,Y),ot.getContext("2d").drawImage(lt(this,Y),0,0),ot.toDataURL()}if(lt(this,rt)){const[ot,mt]=this.pageDimensions,pt=Math.round(this.width*ot*G.PixelsPerInch.PDF_TO_CSS_UNITS),Et=Math.round(this.height*mt*G.PixelsPerInch.PDF_TO_CSS_UNITS),yt=new OffscreenCanvas(pt,Et);return yt.getContext("2d").drawImage(lt(this,Y),0,0,lt(this,Y).width,lt(this,Y).height,0,0,pt,Et),yt.transferToImageBitmap()}return structuredClone(lt(this,Y))},Dt=new WeakSet,qi=function(){Kt(this,et,new ResizeObserver(wt=>{const ot=wt[0].contentRect;ot.width&&ot.height&&$t(this,bt,Wi).call(this,ot.width,ot.height)})),lt(this,et).observe(this.div)},He(Qt,"_type","stamp");let tt=Qt;D.StampEditor=tt}],__webpack_module_cache__={};function __w_pdfjs_require__(B){var D=__webpack_module_cache__[B];if(D!==void 0)return D.exports;var F=__webpack_module_cache__[B]={exports:{}};return __webpack_modules__[B](F,F.exports,__w_pdfjs_require__),F.exports}var __webpack_exports__={};return(()=>{var B=__webpack_exports__;Object.defineProperty(B,"__esModule",{value:!0}),Object.defineProperty(B,"AbortException",{enumerable:!0,get:function(){return D.AbortException}}),Object.defineProperty(B,"AnnotationEditorLayer",{enumerable:!0,get:function(){return G.AnnotationEditorLayer}}),Object.defineProperty(B,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return D.AnnotationEditorParamsType}}),Object.defineProperty(B,"AnnotationEditorType",{enumerable:!0,get:function(){return D.AnnotationEditorType}}),Object.defineProperty(B,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return X.AnnotationEditorUIManager}}),Object.defineProperty(B,"AnnotationLayer",{enumerable:!0,get:function(){return tt.AnnotationLayer}}),Object.defineProperty(B,"AnnotationMode",{enumerable:!0,get:function(){return D.AnnotationMode}}),Object.defineProperty(B,"CMapCompressionType",{enumerable:!0,get:function(){return D.CMapCompressionType}}),Object.defineProperty(B,"DOMSVGFactory",{enumerable:!0,get:function(){return O.DOMSVGFactory}}),Object.defineProperty(B,"FeatureTest",{enumerable:!0,get:function(){return D.FeatureTest}}),Object.defineProperty(B,"GlobalWorkerOptions",{enumerable:!0,get:function(){return Y.GlobalWorkerOptions}}),Object.defineProperty(B,"ImageKind",{enumerable:!0,get:function(){return D.ImageKind}}),Object.defineProperty(B,"InvalidPDFException",{enumerable:!0,get:function(){return D.InvalidPDFException}}),Object.defineProperty(B,"MissingPDFException",{enumerable:!0,get:function(){return D.MissingPDFException}}),Object.defineProperty(B,"OPS",{enumerable:!0,get:function(){return D.OPS}}),Object.defineProperty(B,"PDFDataRangeTransport",{enumerable:!0,get:function(){return F.PDFDataRangeTransport}}),Object.defineProperty(B,"PDFDateString",{enumerable:!0,get:function(){return O.PDFDateString}}),Object.defineProperty(B,"PDFWorker",{enumerable:!0,get:function(){return F.PDFWorker}}),Object.defineProperty(B,"PasswordResponses",{enumerable:!0,get:function(){return D.PasswordResponses}}),Object.defineProperty(B,"PermissionFlag",{enumerable:!0,get:function(){return D.PermissionFlag}}),Object.defineProperty(B,"PixelsPerInch",{enumerable:!0,get:function(){return O.PixelsPerInch}}),Object.defineProperty(B,"PromiseCapability",{enumerable:!0,get:function(){return D.PromiseCapability}}),Object.defineProperty(B,"RenderingCancelledException",{enumerable:!0,get:function(){return O.RenderingCancelledException}}),Object.defineProperty(B,"SVGGraphics",{enumerable:!0,get:function(){return F.SVGGraphics}}),Object.defineProperty(B,"UnexpectedResponseException",{enumerable:!0,get:function(){return D.UnexpectedResponseException}}),Object.defineProperty(B,"Util",{enumerable:!0,get:function(){return D.Util}}),Object.defineProperty(B,"VerbosityLevel",{enumerable:!0,get:function(){return D.VerbosityLevel}}),Object.defineProperty(B,"XfaLayer",{enumerable:!0,get:function(){return W.XfaLayer}}),Object.defineProperty(B,"build",{enumerable:!0,get:function(){return F.build}}),Object.defineProperty(B,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return D.createValidAbsoluteUrl}}),Object.defineProperty(B,"getDocument",{enumerable:!0,get:function(){return F.getDocument}}),Object.defineProperty(B,"getFilenameFromUrl",{enumerable:!0,get:function(){return O.getFilenameFromUrl}}),Object.defineProperty(B,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return O.getPdfFilenameFromUrl}}),Object.defineProperty(B,"getXfaPageViewport",{enumerable:!0,get:function(){return O.getXfaPageViewport}}),Object.defineProperty(B,"isDataScheme",{enumerable:!0,get:function(){return O.isDataScheme}}),Object.defineProperty(B,"isPdfFile",{enumerable:!0,get:function(){return O.isPdfFile}}),Object.defineProperty(B,"loadScript",{enumerable:!0,get:function(){return O.loadScript}}),Object.defineProperty(B,"noContextMenu",{enumerable:!0,get:function(){return O.noContextMenu}}),Object.defineProperty(B,"normalizeUnicode",{enumerable:!0,get:function(){return D.normalizeUnicode}}),Object.defineProperty(B,"renderTextLayer",{enumerable:!0,get:function(){return U.renderTextLayer}}),Object.defineProperty(B,"setLayerDimensions",{enumerable:!0,get:function(){return O.setLayerDimensions}}),Object.defineProperty(B,"shadow",{enumerable:!0,get:function(){return D.shadow}}),Object.defineProperty(B,"updateTextLayer",{enumerable:!0,get:function(){return U.updateTextLayer}}),Object.defineProperty(B,"version",{enumerable:!0,get:function(){return F.version}});var D=__w_pdfjs_require__(1),F=__w_pdfjs_require__(2),O=__w_pdfjs_require__(6),U=__w_pdfjs_require__(26),G=__w_pdfjs_require__(27),X=__w_pdfjs_require__(5),tt=__w_pdfjs_require__(29),Y=__w_pdfjs_require__(14),W=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;function cssProperty(B){return(D,F)=>{const O=`__${String(F)}`;return{get(){return this[O]},set(U){const G=this[O];this[O]=U,G!==U&&(this.style.setProperty(B,U),this.requestUpdate(String(F),G))},configurable:!0,enumerable:!0}}}var lib={},parser$1={},util={};Object.defineProperty(util,"__esModule",{value:!0});util.Util=void 0;class Util{static extractVersion(D,F=0){let O=Util.locateSequence(Util.VERSION,D,F)+Util.VERSION.length,U=Util.locateSequence([Util.DOT],D,O),G=Util.extractNumber(D,O,U).result,X=Util.locateDelimiter(D,U),tt=Util.extractNumber(D,U+1,X).result;return{major:G,minor:tt}}static consumeComment(D,F){for(;D[F]!==13&&D[F]!=10&&F<D.length;)++F;return F=Util.skipSpaces(D,F),D[F]==37?Util.consumeComment(D,F):F}static readNextWord(D,F=0){if(F>=D.length)return{result:void 0,start_index:F,end_index:D.length-1};F=Util.skipSpaces(D,F),D[F]===37&&(F=Util.consumeComment(D,F));let O=F;for(F++;!Util.isDelimiter(D[F])&&F<D.length;)++F;return F<=D.length?{result:D.slice(O,F),start_index:O,end_index:F-1}:{result:void 0,start_index:O,end_index:F-1}}static skipDelimiter(D,F=0){for(;F<D.length&&this.isDelimiter(D[F]);)++F;return F}static skipSpaces(D,F=0){for(;F<D.length&&(D[F]===10||D[F]===9||D[F]===13||D[F]===32);)++F;return F}static skipSymbol(D,F,O=0){for(;O<D.length&&D[O]===F;)++O;return O}static skipSpacesReverse(D,F=0){for(;F>0&&(D[F]===10||D[F]===9||D[F]===13||D[F]===32);)--F;return F}static skipDelimiterReverse(D,F=0){for(;F>0&&this.isDelimiter(D[F]);)--F;return F}static convertStringToAscii(D){let F=[];for(let O=0;O<D.length;++O)F.push(+D.charCodeAt(O));return F}static isSpace(D){return D===Util.LF||D===Util.CR||D===Util.SPACE}static isDelimiter(D){return Util.isSpace(D)||D===47||D===37||D===60||D===62||D===91||D===93||D===40||D===41}static isNumber(D){return D>=48&&D<=57}static locateSequence(D,F,O=0,U=!1){let G=O;for(let X=0;G<F.length;++G)if(F[G]==D[X]){if(X==D.length-1){if(!U||F.length==G+1||this.isDelimiter(F[G+1]))return G-(D.length-1);X=-1}++X}else X=0;return-1}static locateSequenceReversed(D,F,O=F.length-1,U=!1){let G=O;for(let X=D.length-1;G>=0;--G)if(F[G]==D[X]){if(X==0){if(!U||G-1<0||this.isDelimiter(F[G-1]))return G;X=D.length}--X}else X=D.length-1;return-1}static locateDelimiter(D,F=0){for(;F<D.length&&!this.isDelimiter(D[F]);)++F;return F-1}static locateDelimiterReversed(D,F=D.length-1){for(;F>0&&!this.isDelimiter(D[F]);)--F;return F<=0?F:F-1}static extractObjectId(D,F){F=Util.skipDelimiter(D,F);let O=Util.locateDelimiter(D,F+1),U=Util.extractNumber(D,F,O).result,G=Util.skipDelimiter(D,O+1),X=Util.locateDelimiter(D,G+1),tt=Util.extractNumber(D,G,X).result;return{obj:U,generation:tt}}static extractReference(D,F){F=Util.skipDelimiter(D,F);let O=this.locateSequence(this.convertStringToAscii(" R"),D,F,!0);return D.slice(F,O)}static extractReferenceTyped(D,F){let O=this.extractReference(D,F),U=this.locateDelimiter(O,0),G=this.extractNumber(O,0,U).result,X=this.extractNumber(O,U+2).result;return{result:{obj:G,generation:X},start_index:F,end_index:F+O.length+1}}static extractHexString(D,F){let O=Util.locateSequence(Util.HEX_STRING_START,D,F),U=Util.locateSequence(Util.HEX_STRING_END,D,F);return D=D.slice(O+1,U),{result:new Uint8Array(Util.convertHexStringToByteArray(D)),start_index:O,end_index:U}}static extractString(D,F){let O=Util.locateSequence(Util.LITERAL_STRING_START,D,F),U=Util.locateSequence(Util.LITERAL_STRING_END,D,F);for(;D[U-1]===92;)U=Util.locateSequence(Util.LITERAL_STRING_END,D,U+1);return D=D.slice(O+1,U),{result:Util.unescapeString(D),start_index:O,end_index:U}}static extractOptionValue(D,F=0){if(D[F]!==47)throw Error("misplaced option value pointer");let O=Util.locateDelimiter(D,F+1);return{result:Util.convertAsciiToString(Array.from(D.slice(F+1,O+1))),start_index:F,end_index:O}}static extractNumber(D,F,O=-1){if(F=Util.skipDelimiter(D,F),O==-1&&(O=Util.locateDelimiter(D,F)),O<F)throw Error(`Could not identify number bounds: [${F},${O}]`);let U="";for(let G=F;G<=O;++G)U+=String.fromCharCode(D[G]);if(U==="")throw Error(`Could not parse number at position ${F}`);return{result:+U,start_index:F,end_index:O}}static convertDateToPDFDate(D){let F="D:";F+=D.getFullYear();let O=String(D.getMonth()+1);F+=(O.length==1?"0":"")+O;let U=String(D.getDate());F+=(U.length==1?"0":"")+U;let G=String(D.getHours());F+=(G.length==1?"0":"")+G;let X=String(D.getMinutes());F+=(X.length==1?"0":"")+X;let tt=String(D.getSeconds());return F+=(tt.length==1?"0":"")+tt,F}static convertUnicodeToString(D){return D instanceof Uint8Array&&(D=new Uint8Array(D)),D[0]===254&&D[1]===255?(D=D.slice(2,D.length),(X=>{let tt="";for(let Y=0;Y<X.length-1;Y+=2)tt+=String.fromCharCode(X[Y]<<8|X[Y+1]&255);return tt})(D)):(U=>{let G="",X=0;for(;X<U.length;){let tt=U[X++],Y;switch(tt>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:G+=String.fromCharCode(tt);break;case 12:case 13:Y=U[X++],G+=String.fromCharCode((tt&31)<<6|Y&63);break;case 14:Y=U[X++];let W=U[X++];G+=String.fromCharCode((tt&15)<<12|(Y&63)<<6|(W&63)<<0);break}}return G})(Array.from(D))}static convertAsciiToString(D){let F="";for(let O=0;O<D.length;++O)F+=String.fromCharCode(D[O]);return F}static convertNumberToCharArray(D){return Util.convertStringToAscii(String(D))}static convertHexStringToByteArray(D){let F=[];typeof D!="string"&&(D=Util.convertAsciiToString(D));for(let O=0;O<D.length-1;O+=2)F.push((parseInt(D.charAt(O),16)<<4)+parseInt(D.charAt(O+1),16));return D.length%2!==0&&F.push(parseInt(D.charAt(D.length-1),16)),F}static convertByteArrayToHexString(D){let F="",O="0123456789ABCDEF";for(let G=0;G<D.length;++G)F+=O.charAt(D[G]>>4),F+=O.charAt(D[G]&15);let U=0;for(;F.charAt(U)==="0"&&U<F.length;)++U;return F.slice(U,F.length)}static areArraysEqual(D,F){if(D.length!==F.length)return!1;for(let O=0;O<D.length;++O)if(D[O]!==F[O])return!1;return!0}static debug_printIndexed(D){let F="";for(let O=0;O<D.length;++O)O%10===0&&(F+=`
`+O+":"),Util.isSpace(D[O])?F+=" .":F+=" "+String.fromCharCode(D[O]);console.log(F)}static convertUint8ArrayToInt32Array(D){let F=new Int32Array(Math.ceil(D.length/4)),O=0,U=0;for(;O<D.length;){if(D[O]>255||D[O+1]>255||D[O+2]>>255||D[O+3]>255)throw Error("Invalid byte size");F[U++]=(D[O++]<<24)+(D[O++]<<16)+(D[O++]<<8)+(D[O++]<<0)}return F}static convertInt32ArrayToUint8Array(D){let F=new Uint8Array(D.length*4);for(let O=0;O<D.length;++O)for(let U=0;U<4;++U)F[O*4+U]=D[O]>>8*(4-U-1)&255;return F}static escapeString(D){let F=[];for(let O=0;O<D.length;++O)switch(D[O]){case Util.LITERAL_STRING_START[0]:case Util.LITERAL_STRING_END[0]:case 92:F.push(92),F.push(D[O]);break;case 9:F.push(92),F.push(116);break;case 10:F.push(92),F.push(110);break;case 13:F.push(92),F.push(114);break;case 8:F.push(92),F.push(98);break;case 12:F.push(92),F.push(102);break;default:F.push(D[O])}return new Uint8Array(F)}static unescapeString(D){let F=[],O=!1;for(let U=0;U<D.length;++U)if(O)switch(O=!1,D[U]){case 92:F.push(92);break;case Util.LITERAL_STRING_START[0]:F.push(Util.LITERAL_STRING_START[0]);break;case Util.LITERAL_STRING_END[0]:F.push(Util.LITERAL_STRING_END[0]);break;case 116:F.push(9);break;case 110:F.push(10);break;case 114:F.push(13);break;case 98:F.push(8);break;case 102:F.push(12);break;default:F.push(D[U])}else D[U]===92?O=!0:F.push(D[U]);return new Uint8Array(F)}static isReferencePointer(D){return"obj"in D&&"generation"in D&&Object.keys(D).length==2}static colorToRange255(D){return D.r<=1&&(D.r=Math.round(D.r*255)),D.g<=1&&(D.g=Math.round(D.g*255)),D.b<=1&&(D.b=Math.round(D.b*255)),D}static colorToRange01(D){return D.r>1&&(D.r=+(D.r/255).toFixed(3)),D.g>1&&(D.g=+(D.g/255).toFixed(3)),D.b>1&&(D.b=+(D.b/255).toFixed(3)),D}static colorToHex(D){(D.r<=1||D.g<=1||D.b<=1)&&(D=Util.colorToRange255(D));let F=D.r.toString(16);F=F.length===1?"0"+F:F;let O=D.g.toString(16);O=O.length===1?"0"+O:O;let U=D.b.toString(16);return U=U.length===1?"0"+U:U,`#${F.toUpperCase()}${O.toUpperCase()}${U.toUpperCase()}`}static convertStringToByteString(D){let F=[...Util.HEX_STRING_START],O=Util.convertByteArrayToHexString(Util.convertStringToAscii(D));return F=F.concat(Util.convertStringToAscii(O)),F=F.concat(Util.HEX_STRING_END),F}static convertStringToHexString(D){return Util.convertStringToByteString(D)}}util.Util=Util;Util.VERSION=[37,80,68,70,45];Util.COMMENT_START=[37];Util.NULL=[110,117,108,108];Util.DOT=46;Util.CR=13;Util.LF=10;Util.TYPE="/Type ";Util.SPACE=32;Util.OBJ=[111,98,106];Util.ENDOBJ=[101,110,100,111,98,106];Util.ARRAY_START=[91];Util.ARRAY_END=[93];Util.LITERAL_STRING_START=[40];Util.HEX_STRING_START=[60];Util.LITERAL_STRING_END=[41];Util.HEX_STRING_END=[62];Util.R=[82];Util.ANNOTS=[47,65,110,110,111,116,115];Util.DICT_START=[60,60];Util.DICT_END=[62,62];Util.PAGE=[47,80,97,103,101];Util.SIZE=[47,83,105,122,101];Util.ROOT=[47,82,111,111,116];Util.PREV=[47,80,114,101,118];Util.STARTXREF=[115,116,97,114,116,120,114,101,102];Util.XREF=[120,114,101,102];Util.STREAM=[115,116,114,101,97,109];Util.TRAILER=[116,114,97,105,108,101,114];var objectUtil={},arrayUtil={},hasRequiredArrayUtil;function requireArrayUtil(){if(hasRequiredArrayUtil)return arrayUtil;hasRequiredArrayUtil=1,Object.defineProperty(arrayUtil,"__esModule",{value:!0}),arrayUtil.ArrayUtil=void 0;const B=util,D=requireObjectUtil();class F{static extractArray(U,G){G=B.Util.skipSpaces(U,G);let X=G;if(U[G]!==B.Util.ARRAY_START[0])throw Error("Invalid array sequence -- does not start with '['");G+=1;let tt=B.Util.readNextWord(U,G),Y=tt.result;G=tt.start_index;let W=[];for(;Y;){if(Y[0]===B.Util.ARRAY_START[0]){let z=F.extractArray(U,G);G=z.end_index,W.push(z.result)}else if(B.Util.areArraysEqual(Y,B.Util.NULL))W.push("null"),G+=Y.length-1;else{if(Y[0]===B.Util.LITERAL_STRING_END[0])return{result:W,start_index:X,end_index:tt.end_index};if(Y[0]===B.Util.LITERAL_STRING_START[0]){let z=B.Util.extractString(U,G);W.push(z.result),G=z.end_index}else if(Y[0]===B.Util.DICT_START[0]){let z=B.Util.readNextWord(U,tt.end_index+1);if(z.result&&z.result[0]===B.Util.DICT_START[0]){let K={};G=D.ObjectUtil.extractDictValueRec(U,G,K),W.push(K)}else{let K=B.Util.extractHexString(U,G);W.push(K.result),G=K.end_index}}else if(Y[0]===47){let z=B.Util.extractOptionValue(U,G);W.push("/"+z.result),G=z.end_index}else if(Y[0]===B.Util.R[0]){let z=W[W.length-2],K=W[W.length-1];W=W.slice(0,W.length-2),W.push({obj:z,generation:K}),G=tt.end_index}else{if(Y[0]===B.Util.ARRAY_END[0])break;{let z=B.Util.extractNumber(U,G);W.push(z.result),G=z.end_index}}}++G,G=B.Util.skipSpaces(U,G),tt=B.Util.readNextWord(U,G),Y=tt.result,G=tt.start_index}return{result:W,start_index:X,end_index:tt.end_index}}}return arrayUtil.ArrayUtil=F,arrayUtil}var stream={},common={};(function(B){var D=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function F(G,X){return Object.prototype.hasOwnProperty.call(G,X)}B.assign=function(G){for(var X=Array.prototype.slice.call(arguments,1);X.length;){var tt=X.shift();if(tt){if(typeof tt!="object")throw new TypeError(tt+"must be non-object");for(var Y in tt)F(tt,Y)&&(G[Y]=tt[Y])}}return G},B.shrinkBuf=function(G,X){return G.length===X?G:G.subarray?G.subarray(0,X):(G.length=X,G)};var O={arraySet:function(G,X,tt,Y,W){if(X.subarray&&G.subarray){G.set(X.subarray(tt,tt+Y),W);return}for(var z=0;z<Y;z++)G[W+z]=X[tt+z]},flattenChunks:function(G){var X,tt,Y,W,z,K;for(Y=0,X=0,tt=G.length;X<tt;X++)Y+=G[X].length;for(K=new Uint8Array(Y),W=0,X=0,tt=G.length;X<tt;X++)z=G[X],K.set(z,W),W+=z.length;return K}},U={arraySet:function(G,X,tt,Y,W){for(var z=0;z<Y;z++)G[W+z]=X[tt+z]},flattenChunks:function(G){return[].concat.apply([],G)}};B.setTyped=function(G){G?(B.Buf8=Uint8Array,B.Buf16=Uint16Array,B.Buf32=Int32Array,B.assign(B,O)):(B.Buf8=Array,B.Buf16=Array,B.Buf32=Array,B.assign(B,U))},B.setTyped(D)})(common);var deflate$4={},deflate$3={},trees$1={},utils$6=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(B){for(var D=B.length;--D>=0;)B[D]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(B,D,F,O,U){this.static_tree=B,this.extra_bits=D,this.extra_base=F,this.elems=O,this.max_length=U,this.has_stree=B&&B.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(B,D){this.dyn_tree=B,this.max_code=0,this.stat_desc=D}function d_code(B){return B<256?_dist_code[B]:_dist_code[256+(B>>>7)]}function put_short(B,D){B.pending_buf[B.pending++]=D&255,B.pending_buf[B.pending++]=D>>>8&255}function send_bits(B,D,F){B.bi_valid>Buf_size-F?(B.bi_buf|=D<<B.bi_valid&65535,put_short(B,B.bi_buf),B.bi_buf=D>>Buf_size-B.bi_valid,B.bi_valid+=F-Buf_size):(B.bi_buf|=D<<B.bi_valid&65535,B.bi_valid+=F)}function send_code(B,D,F){send_bits(B,F[D*2],F[D*2+1])}function bi_reverse(B,D){var F=0;do F|=B&1,B>>>=1,F<<=1;while(--D>0);return F>>>1}function bi_flush(B){B.bi_valid===16?(put_short(B,B.bi_buf),B.bi_buf=0,B.bi_valid=0):B.bi_valid>=8&&(B.pending_buf[B.pending++]=B.bi_buf&255,B.bi_buf>>=8,B.bi_valid-=8)}function gen_bitlen(B,D){var F=D.dyn_tree,O=D.max_code,U=D.stat_desc.static_tree,G=D.stat_desc.has_stree,X=D.stat_desc.extra_bits,tt=D.stat_desc.extra_base,Y=D.stat_desc.max_length,W,z,K,J,Q,et,it=0;for(J=0;J<=MAX_BITS$1;J++)B.bl_count[J]=0;for(F[B.heap[B.heap_max]*2+1]=0,W=B.heap_max+1;W<HEAP_SIZE$1;W++)z=B.heap[W],J=F[F[z*2+1]*2+1]+1,J>Y&&(J=Y,it++),F[z*2+1]=J,!(z>O)&&(B.bl_count[J]++,Q=0,z>=tt&&(Q=X[z-tt]),et=F[z*2],B.opt_len+=et*(J+Q),G&&(B.static_len+=et*(U[z*2+1]+Q)));if(it!==0){do{for(J=Y-1;B.bl_count[J]===0;)J--;B.bl_count[J]--,B.bl_count[J+1]+=2,B.bl_count[Y]--,it-=2}while(it>0);for(J=Y;J!==0;J--)for(z=B.bl_count[J];z!==0;)K=B.heap[--W],!(K>O)&&(F[K*2+1]!==J&&(B.opt_len+=(J-F[K*2+1])*F[K*2],F[K*2+1]=J),z--)}}function gen_codes(B,D,F){var O=new Array(MAX_BITS$1+1),U=0,G,X;for(G=1;G<=MAX_BITS$1;G++)O[G]=U=U+F[G-1]<<1;for(X=0;X<=D;X++){var tt=B[X*2+1];tt!==0&&(B[X*2]=bi_reverse(O[tt]++,tt))}}function tr_static_init(){var B,D,F,O,U,G=new Array(MAX_BITS$1+1);for(F=0,O=0;O<LENGTH_CODES$1-1;O++)for(base_length[O]=F,B=0;B<1<<extra_lbits[O];B++)_length_code[F++]=O;for(_length_code[F-1]=O,U=0,O=0;O<16;O++)for(base_dist[O]=U,B=0;B<1<<extra_dbits[O];B++)_dist_code[U++]=O;for(U>>=7;O<D_CODES$1;O++)for(base_dist[O]=U<<7,B=0;B<1<<extra_dbits[O]-7;B++)_dist_code[256+U++]=O;for(D=0;D<=MAX_BITS$1;D++)G[D]=0;for(B=0;B<=143;)static_ltree[B*2+1]=8,B++,G[8]++;for(;B<=255;)static_ltree[B*2+1]=9,B++,G[9]++;for(;B<=279;)static_ltree[B*2+1]=7,B++,G[7]++;for(;B<=287;)static_ltree[B*2+1]=8,B++,G[8]++;for(gen_codes(static_ltree,L_CODES$1+1,G),B=0;B<D_CODES$1;B++)static_dtree[B*2+1]=5,static_dtree[B*2]=bi_reverse(B,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(B){var D;for(D=0;D<L_CODES$1;D++)B.dyn_ltree[D*2]=0;for(D=0;D<D_CODES$1;D++)B.dyn_dtree[D*2]=0;for(D=0;D<BL_CODES$1;D++)B.bl_tree[D*2]=0;B.dyn_ltree[END_BLOCK*2]=1,B.opt_len=B.static_len=0,B.last_lit=B.matches=0}function bi_windup(B){B.bi_valid>8?put_short(B,B.bi_buf):B.bi_valid>0&&(B.pending_buf[B.pending++]=B.bi_buf),B.bi_buf=0,B.bi_valid=0}function copy_block(B,D,F,O){bi_windup(B),O&&(put_short(B,F),put_short(B,~F)),utils$6.arraySet(B.pending_buf,B.window,D,F,B.pending),B.pending+=F}function smaller(B,D,F,O){var U=D*2,G=F*2;return B[U]<B[G]||B[U]===B[G]&&O[D]<=O[F]}function pqdownheap(B,D,F){for(var O=B.heap[F],U=F<<1;U<=B.heap_len&&(U<B.heap_len&&smaller(D,B.heap[U+1],B.heap[U],B.depth)&&U++,!smaller(D,O,B.heap[U],B.depth));)B.heap[F]=B.heap[U],F=U,U<<=1;B.heap[F]=O}function compress_block(B,D,F){var O,U,G=0,X,tt;if(B.last_lit!==0)do O=B.pending_buf[B.d_buf+G*2]<<8|B.pending_buf[B.d_buf+G*2+1],U=B.pending_buf[B.l_buf+G],G++,O===0?send_code(B,U,D):(X=_length_code[U],send_code(B,X+LITERALS$1+1,D),tt=extra_lbits[X],tt!==0&&(U-=base_length[X],send_bits(B,U,tt)),O--,X=d_code(O),send_code(B,X,F),tt=extra_dbits[X],tt!==0&&(O-=base_dist[X],send_bits(B,O,tt)));while(G<B.last_lit);send_code(B,END_BLOCK,D)}function build_tree(B,D){var F=D.dyn_tree,O=D.stat_desc.static_tree,U=D.stat_desc.has_stree,G=D.stat_desc.elems,X,tt,Y=-1,W;for(B.heap_len=0,B.heap_max=HEAP_SIZE$1,X=0;X<G;X++)F[X*2]!==0?(B.heap[++B.heap_len]=Y=X,B.depth[X]=0):F[X*2+1]=0;for(;B.heap_len<2;)W=B.heap[++B.heap_len]=Y<2?++Y:0,F[W*2]=1,B.depth[W]=0,B.opt_len--,U&&(B.static_len-=O[W*2+1]);for(D.max_code=Y,X=B.heap_len>>1;X>=1;X--)pqdownheap(B,F,X);W=G;do X=B.heap[1],B.heap[1]=B.heap[B.heap_len--],pqdownheap(B,F,1),tt=B.heap[1],B.heap[--B.heap_max]=X,B.heap[--B.heap_max]=tt,F[W*2]=F[X*2]+F[tt*2],B.depth[W]=(B.depth[X]>=B.depth[tt]?B.depth[X]:B.depth[tt])+1,F[X*2+1]=F[tt*2+1]=W,B.heap[1]=W++,pqdownheap(B,F,1);while(B.heap_len>=2);B.heap[--B.heap_max]=B.heap[1],gen_bitlen(B,D),gen_codes(F,Y,B.bl_count)}function scan_tree(B,D,F){var O,U=-1,G,X=D[0*2+1],tt=0,Y=7,W=4;for(X===0&&(Y=138,W=3),D[(F+1)*2+1]=65535,O=0;O<=F;O++)G=X,X=D[(O+1)*2+1],!(++tt<Y&&G===X)&&(tt<W?B.bl_tree[G*2]+=tt:G!==0?(G!==U&&B.bl_tree[G*2]++,B.bl_tree[REP_3_6*2]++):tt<=10?B.bl_tree[REPZ_3_10*2]++:B.bl_tree[REPZ_11_138*2]++,tt=0,U=G,X===0?(Y=138,W=3):G===X?(Y=6,W=3):(Y=7,W=4))}function send_tree(B,D,F){var O,U=-1,G,X=D[0*2+1],tt=0,Y=7,W=4;for(X===0&&(Y=138,W=3),O=0;O<=F;O++)if(G=X,X=D[(O+1)*2+1],!(++tt<Y&&G===X)){if(tt<W)do send_code(B,G,B.bl_tree);while(--tt!==0);else G!==0?(G!==U&&(send_code(B,G,B.bl_tree),tt--),send_code(B,REP_3_6,B.bl_tree),send_bits(B,tt-3,2)):tt<=10?(send_code(B,REPZ_3_10,B.bl_tree),send_bits(B,tt-3,3)):(send_code(B,REPZ_11_138,B.bl_tree),send_bits(B,tt-11,7));tt=0,U=G,X===0?(Y=138,W=3):G===X?(Y=6,W=3):(Y=7,W=4)}}function build_bl_tree(B){var D;for(scan_tree(B,B.dyn_ltree,B.l_desc.max_code),scan_tree(B,B.dyn_dtree,B.d_desc.max_code),build_tree(B,B.bl_desc),D=BL_CODES$1-1;D>=3&&B.bl_tree[bl_order[D]*2+1]===0;D--);return B.opt_len+=3*(D+1)+5+5+4,D}function send_all_trees(B,D,F,O){var U;for(send_bits(B,D-257,5),send_bits(B,F-1,5),send_bits(B,O-4,4),U=0;U<O;U++)send_bits(B,B.bl_tree[bl_order[U]*2+1],3);send_tree(B,B.dyn_ltree,D-1),send_tree(B,B.dyn_dtree,F-1)}function detect_data_type(B){var D=4093624447,F;for(F=0;F<=31;F++,D>>>=1)if(D&1&&B.dyn_ltree[F*2]!==0)return Z_BINARY;if(B.dyn_ltree[9*2]!==0||B.dyn_ltree[10*2]!==0||B.dyn_ltree[13*2]!==0)return Z_TEXT;for(F=32;F<LITERALS$1;F++)if(B.dyn_ltree[F*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(B){static_init_done||(tr_static_init(),static_init_done=!0),B.l_desc=new TreeDesc(B.dyn_ltree,static_l_desc),B.d_desc=new TreeDesc(B.dyn_dtree,static_d_desc),B.bl_desc=new TreeDesc(B.bl_tree,static_bl_desc),B.bi_buf=0,B.bi_valid=0,init_block(B)}function _tr_stored_block(B,D,F,O){send_bits(B,(STORED_BLOCK<<1)+(O?1:0),3),copy_block(B,D,F,!0)}function _tr_align(B){send_bits(B,STATIC_TREES<<1,3),send_code(B,END_BLOCK,static_ltree),bi_flush(B)}function _tr_flush_block(B,D,F,O){var U,G,X=0;B.level>0?(B.strm.data_type===Z_UNKNOWN$1&&(B.strm.data_type=detect_data_type(B)),build_tree(B,B.l_desc),build_tree(B,B.d_desc),X=build_bl_tree(B),U=B.opt_len+3+7>>>3,G=B.static_len+3+7>>>3,G<=U&&(U=G)):U=G=F+5,F+4<=U&&D!==-1?_tr_stored_block(B,D,F,O):B.strategy===Z_FIXED$1||G===U?(send_bits(B,(STATIC_TREES<<1)+(O?1:0),3),compress_block(B,static_ltree,static_dtree)):(send_bits(B,(DYN_TREES<<1)+(O?1:0),3),send_all_trees(B,B.l_desc.max_code+1,B.d_desc.max_code+1,X+1),compress_block(B,B.dyn_ltree,B.dyn_dtree)),init_block(B),O&&bi_windup(B)}function _tr_tally(B,D,F){return B.pending_buf[B.d_buf+B.last_lit*2]=D>>>8&255,B.pending_buf[B.d_buf+B.last_lit*2+1]=D&255,B.pending_buf[B.l_buf+B.last_lit]=F&255,B.last_lit++,D===0?B.dyn_ltree[F*2]++:(B.matches++,D--,B.dyn_ltree[(_length_code[F]+LITERALS$1+1)*2]++,B.dyn_dtree[d_code(D)*2]++),B.last_lit===B.lit_bufsize-1}trees$1._tr_init=_tr_init;trees$1._tr_stored_block=_tr_stored_block;trees$1._tr_flush_block=_tr_flush_block;trees$1._tr_tally=_tr_tally;trees$1._tr_align=_tr_align;function adler32$2(B,D,F,O){for(var U=B&65535|0,G=B>>>16&65535|0,X=0;F!==0;){X=F>2e3?2e3:F,F-=X;do U=U+D[O++]|0,G=G+U|0;while(--X);U%=65521,G%=65521}return U|G<<16|0}var adler32_1=adler32$2;function makeTable(){for(var B,D=[],F=0;F<256;F++){B=F;for(var O=0;O<8;O++)B=B&1?3988292384^B>>>1:B>>>1;D[F]=B}return D}var crcTable=makeTable();function crc32$2(B,D,F,O){var U=crcTable,G=O+F;B^=-1;for(var X=O;X<G;X++)B=B>>>8^U[(B^D[X])&255];return B^-1}var crc32_1=crc32$2,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$5=common,trees=trees$1,adler32$1=adler32_1,crc32$1=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(B,D){return B.msg=msg$2[D],D}function rank(B){return(B<<1)-(B>4?9:0)}function zero(B){for(var D=B.length;--D>=0;)B[D]=0}function flush_pending(B){var D=B.state,F=D.pending;F>B.avail_out&&(F=B.avail_out),F!==0&&(utils$5.arraySet(B.output,D.pending_buf,D.pending_out,F,B.next_out),B.next_out+=F,D.pending_out+=F,B.total_out+=F,B.avail_out-=F,D.pending-=F,D.pending===0&&(D.pending_out=0))}function flush_block_only(B,D){trees._tr_flush_block(B,B.block_start>=0?B.block_start:-1,B.strstart-B.block_start,D),B.block_start=B.strstart,flush_pending(B.strm)}function put_byte(B,D){B.pending_buf[B.pending++]=D}function putShortMSB(B,D){B.pending_buf[B.pending++]=D>>>8&255,B.pending_buf[B.pending++]=D&255}function read_buf(B,D,F,O){var U=B.avail_in;return U>O&&(U=O),U===0?0:(B.avail_in-=U,utils$5.arraySet(D,B.input,B.next_in,U,F),B.state.wrap===1?B.adler=adler32$1(B.adler,D,U,F):B.state.wrap===2&&(B.adler=crc32$1(B.adler,D,U,F)),B.next_in+=U,B.total_in+=U,U)}function longest_match(B,D){var F=B.max_chain_length,O=B.strstart,U,G,X=B.prev_length,tt=B.nice_match,Y=B.strstart>B.w_size-MIN_LOOKAHEAD?B.strstart-(B.w_size-MIN_LOOKAHEAD):0,W=B.window,z=B.w_mask,K=B.prev,J=B.strstart+MAX_MATCH,Q=W[O+X-1],et=W[O+X];B.prev_length>=B.good_match&&(F>>=2),tt>B.lookahead&&(tt=B.lookahead);do if(U=D,!(W[U+X]!==et||W[U+X-1]!==Q||W[U]!==W[O]||W[++U]!==W[O+1])){O+=2,U++;do;while(W[++O]===W[++U]&&W[++O]===W[++U]&&W[++O]===W[++U]&&W[++O]===W[++U]&&W[++O]===W[++U]&&W[++O]===W[++U]&&W[++O]===W[++U]&&W[++O]===W[++U]&&O<J);if(G=MAX_MATCH-(J-O),O=J-MAX_MATCH,G>X){if(B.match_start=D,X=G,G>=tt)break;Q=W[O+X-1],et=W[O+X]}}while((D=K[D&z])>Y&&--F!==0);return X<=B.lookahead?X:B.lookahead}function fill_window(B){var D=B.w_size,F,O,U,G,X;do{if(G=B.window_size-B.lookahead-B.strstart,B.strstart>=D+(D-MIN_LOOKAHEAD)){utils$5.arraySet(B.window,B.window,D,D,0),B.match_start-=D,B.strstart-=D,B.block_start-=D,O=B.hash_size,F=O;do U=B.head[--F],B.head[F]=U>=D?U-D:0;while(--O);O=D,F=O;do U=B.prev[--F],B.prev[F]=U>=D?U-D:0;while(--O);G+=D}if(B.strm.avail_in===0)break;if(O=read_buf(B.strm,B.window,B.strstart+B.lookahead,G),B.lookahead+=O,B.lookahead+B.insert>=MIN_MATCH)for(X=B.strstart-B.insert,B.ins_h=B.window[X],B.ins_h=(B.ins_h<<B.hash_shift^B.window[X+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[X+MIN_MATCH-1])&B.hash_mask,B.prev[X&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=X,X++,B.insert--,!(B.lookahead+B.insert<MIN_MATCH)););}while(B.lookahead<MIN_LOOKAHEAD&&B.strm.avail_in!==0)}function deflate_stored(B,D){var F=65535;for(F>B.pending_buf_size-5&&(F=B.pending_buf_size-5);;){if(B.lookahead<=1){if(fill_window(B),B.lookahead===0&&D===Z_NO_FLUSH$1)return BS_NEED_MORE;if(B.lookahead===0)break}B.strstart+=B.lookahead,B.lookahead=0;var O=B.block_start+F;if((B.strstart===0||B.strstart>=O)&&(B.lookahead=B.strstart-O,B.strstart=O,flush_block_only(B,!1),B.strm.avail_out===0)||B.strstart-B.block_start>=B.w_size-MIN_LOOKAHEAD&&(flush_block_only(B,!1),B.strm.avail_out===0))return BS_NEED_MORE}return B.insert=0,D===Z_FINISH$2?(flush_block_only(B,!0),B.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(B.strstart>B.block_start&&(flush_block_only(B,!1),B.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(B,D){for(var F,O;;){if(B.lookahead<MIN_LOOKAHEAD){if(fill_window(B),B.lookahead<MIN_LOOKAHEAD&&D===Z_NO_FLUSH$1)return BS_NEED_MORE;if(B.lookahead===0)break}if(F=0,B.lookahead>=MIN_MATCH&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+MIN_MATCH-1])&B.hash_mask,F=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),F!==0&&B.strstart-F<=B.w_size-MIN_LOOKAHEAD&&(B.match_length=longest_match(B,F)),B.match_length>=MIN_MATCH)if(O=trees._tr_tally(B,B.strstart-B.match_start,B.match_length-MIN_MATCH),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=MIN_MATCH){B.match_length--;do B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+MIN_MATCH-1])&B.hash_mask,F=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart;while(--B.match_length!==0);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+1])&B.hash_mask;else O=trees._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(O&&(flush_block_only(B,!1),B.strm.avail_out===0))return BS_NEED_MORE}return B.insert=B.strstart<MIN_MATCH-1?B.strstart:MIN_MATCH-1,D===Z_FINISH$2?(flush_block_only(B,!0),B.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):B.last_lit&&(flush_block_only(B,!1),B.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(B,D){for(var F,O,U;;){if(B.lookahead<MIN_LOOKAHEAD){if(fill_window(B),B.lookahead<MIN_LOOKAHEAD&&D===Z_NO_FLUSH$1)return BS_NEED_MORE;if(B.lookahead===0)break}if(F=0,B.lookahead>=MIN_MATCH&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+MIN_MATCH-1])&B.hash_mask,F=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=MIN_MATCH-1,F!==0&&B.prev_length<B.max_lazy_match&&B.strstart-F<=B.w_size-MIN_LOOKAHEAD&&(B.match_length=longest_match(B,F),B.match_length<=5&&(B.strategy===Z_FILTERED||B.match_length===MIN_MATCH&&B.strstart-B.match_start>4096)&&(B.match_length=MIN_MATCH-1)),B.prev_length>=MIN_MATCH&&B.match_length<=B.prev_length){U=B.strstart+B.lookahead-MIN_MATCH,O=trees._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-MIN_MATCH),B.lookahead-=B.prev_length-1,B.prev_length-=2;do++B.strstart<=U&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+MIN_MATCH-1])&B.hash_mask,F=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart);while(--B.prev_length!==0);if(B.match_available=0,B.match_length=MIN_MATCH-1,B.strstart++,O&&(flush_block_only(B,!1),B.strm.avail_out===0))return BS_NEED_MORE}else if(B.match_available){if(O=trees._tr_tally(B,0,B.window[B.strstart-1]),O&&flush_block_only(B,!1),B.strstart++,B.lookahead--,B.strm.avail_out===0)return BS_NEED_MORE}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(O=trees._tr_tally(B,0,B.window[B.strstart-1]),B.match_available=0),B.insert=B.strstart<MIN_MATCH-1?B.strstart:MIN_MATCH-1,D===Z_FINISH$2?(flush_block_only(B,!0),B.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):B.last_lit&&(flush_block_only(B,!1),B.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(B,D){for(var F,O,U,G,X=B.window;;){if(B.lookahead<=MAX_MATCH){if(fill_window(B),B.lookahead<=MAX_MATCH&&D===Z_NO_FLUSH$1)return BS_NEED_MORE;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=MIN_MATCH&&B.strstart>0&&(U=B.strstart-1,O=X[U],O===X[++U]&&O===X[++U]&&O===X[++U])){G=B.strstart+MAX_MATCH;do;while(O===X[++U]&&O===X[++U]&&O===X[++U]&&O===X[++U]&&O===X[++U]&&O===X[++U]&&O===X[++U]&&O===X[++U]&&U<G);B.match_length=MAX_MATCH-(G-U),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=MIN_MATCH?(F=trees._tr_tally(B,1,B.match_length-MIN_MATCH),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(F=trees._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),F&&(flush_block_only(B,!1),B.strm.avail_out===0))return BS_NEED_MORE}return B.insert=0,D===Z_FINISH$2?(flush_block_only(B,!0),B.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):B.last_lit&&(flush_block_only(B,!1),B.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(B,D){for(var F;;){if(B.lookahead===0&&(fill_window(B),B.lookahead===0)){if(D===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(B.match_length=0,F=trees._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,F&&(flush_block_only(B,!1),B.strm.avail_out===0))return BS_NEED_MORE}return B.insert=0,D===Z_FINISH$2?(flush_block_only(B,!0),B.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):B.last_lit&&(flush_block_only(B,!1),B.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(B,D,F,O,U){this.good_length=B,this.max_lazy=D,this.nice_length=F,this.max_chain=O,this.func=U}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(B){B.window_size=2*B.w_size,zero(B.head),B.max_lazy_match=configuration_table[B.level].max_lazy,B.good_match=configuration_table[B.level].good_length,B.nice_match=configuration_table[B.level].nice_length,B.max_chain_length=configuration_table[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=MIN_MATCH-1,B.match_available=0,B.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$5.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$5.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$5.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$5.Buf16(MAX_BITS+1),this.heap=new utils$5.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$5.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(B){var D;return!B||!B.state?err(B,Z_STREAM_ERROR$1):(B.total_in=B.total_out=0,B.data_type=Z_UNKNOWN,D=B.state,D.pending=0,D.pending_out=0,D.wrap<0&&(D.wrap=-D.wrap),D.status=D.wrap?INIT_STATE:BUSY_STATE,B.adler=D.wrap===2?0:1,D.last_flush=Z_NO_FLUSH$1,trees._tr_init(D),Z_OK$2)}function deflateReset(B){var D=deflateResetKeep(B);return D===Z_OK$2&&lm_init(B.state),D}function deflateSetHeader(B,D){return!B||!B.state||B.state.wrap!==2?Z_STREAM_ERROR$1:(B.state.gzhead=D,Z_OK$2)}function deflateInit2(B,D,F,O,U,G){if(!B)return Z_STREAM_ERROR$1;var X=1;if(D===Z_DEFAULT_COMPRESSION$1&&(D=6),O<0?(X=0,O=-O):O>15&&(X=2,O-=16),U<1||U>MAX_MEM_LEVEL||F!==Z_DEFLATED$2||O<8||O>15||D<0||D>9||G<0||G>Z_FIXED)return err(B,Z_STREAM_ERROR$1);O===8&&(O=9);var tt=new DeflateState;return B.state=tt,tt.strm=B,tt.wrap=X,tt.gzhead=null,tt.w_bits=O,tt.w_size=1<<tt.w_bits,tt.w_mask=tt.w_size-1,tt.hash_bits=U+7,tt.hash_size=1<<tt.hash_bits,tt.hash_mask=tt.hash_size-1,tt.hash_shift=~~((tt.hash_bits+MIN_MATCH-1)/MIN_MATCH),tt.window=new utils$5.Buf8(tt.w_size*2),tt.head=new utils$5.Buf16(tt.hash_size),tt.prev=new utils$5.Buf16(tt.w_size),tt.lit_bufsize=1<<U+6,tt.pending_buf_size=tt.lit_bufsize*4,tt.pending_buf=new utils$5.Buf8(tt.pending_buf_size),tt.d_buf=1*tt.lit_bufsize,tt.l_buf=(1+2)*tt.lit_bufsize,tt.level=D,tt.strategy=G,tt.method=F,deflateReset(B)}function deflateInit(B,D){return deflateInit2(B,D,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(B,D){var F,O,U,G;if(!B||!B.state||D>Z_BLOCK$1||D<0)return B?err(B,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(O=B.state,!B.output||!B.input&&B.avail_in!==0||O.status===FINISH_STATE&&D!==Z_FINISH$2)return err(B,B.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(O.strm=B,F=O.last_flush,O.last_flush=D,O.status===INIT_STATE)if(O.wrap===2)B.adler=0,put_byte(O,31),put_byte(O,139),put_byte(O,8),O.gzhead?(put_byte(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),put_byte(O,O.gzhead.time&255),put_byte(O,O.gzhead.time>>8&255),put_byte(O,O.gzhead.time>>16&255),put_byte(O,O.gzhead.time>>24&255),put_byte(O,O.level===9?2:O.strategy>=Z_HUFFMAN_ONLY||O.level<2?4:0),put_byte(O,O.gzhead.os&255),O.gzhead.extra&&O.gzhead.extra.length&&(put_byte(O,O.gzhead.extra.length&255),put_byte(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(B.adler=crc32$1(B.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=EXTRA_STATE):(put_byte(O,0),put_byte(O,0),put_byte(O,0),put_byte(O,0),put_byte(O,0),put_byte(O,O.level===9?2:O.strategy>=Z_HUFFMAN_ONLY||O.level<2?4:0),put_byte(O,OS_CODE),O.status=BUSY_STATE);else{var X=Z_DEFLATED$2+(O.w_bits-8<<4)<<8,tt=-1;O.strategy>=Z_HUFFMAN_ONLY||O.level<2?tt=0:O.level<6?tt=1:O.level===6?tt=2:tt=3,X|=tt<<6,O.strstart!==0&&(X|=PRESET_DICT),X+=31-X%31,O.status=BUSY_STATE,putShortMSB(O,X),O.strstart!==0&&(putShortMSB(O,B.adler>>>16),putShortMSB(O,B.adler&65535)),B.adler=1}if(O.status===EXTRA_STATE)if(O.gzhead.extra){for(U=O.pending;O.gzindex<(O.gzhead.extra.length&65535)&&!(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>U&&(B.adler=crc32$1(B.adler,O.pending_buf,O.pending-U,U)),flush_pending(B),U=O.pending,O.pending===O.pending_buf_size));)put_byte(O,O.gzhead.extra[O.gzindex]&255),O.gzindex++;O.gzhead.hcrc&&O.pending>U&&(B.adler=crc32$1(B.adler,O.pending_buf,O.pending-U,U)),O.gzindex===O.gzhead.extra.length&&(O.gzindex=0,O.status=NAME_STATE)}else O.status=NAME_STATE;if(O.status===NAME_STATE)if(O.gzhead.name){U=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>U&&(B.adler=crc32$1(B.adler,O.pending_buf,O.pending-U,U)),flush_pending(B),U=O.pending,O.pending===O.pending_buf_size)){G=1;break}O.gzindex<O.gzhead.name.length?G=O.gzhead.name.charCodeAt(O.gzindex++)&255:G=0,put_byte(O,G)}while(G!==0);O.gzhead.hcrc&&O.pending>U&&(B.adler=crc32$1(B.adler,O.pending_buf,O.pending-U,U)),G===0&&(O.gzindex=0,O.status=COMMENT_STATE)}else O.status=COMMENT_STATE;if(O.status===COMMENT_STATE)if(O.gzhead.comment){U=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>U&&(B.adler=crc32$1(B.adler,O.pending_buf,O.pending-U,U)),flush_pending(B),U=O.pending,O.pending===O.pending_buf_size)){G=1;break}O.gzindex<O.gzhead.comment.length?G=O.gzhead.comment.charCodeAt(O.gzindex++)&255:G=0,put_byte(O,G)}while(G!==0);O.gzhead.hcrc&&O.pending>U&&(B.adler=crc32$1(B.adler,O.pending_buf,O.pending-U,U)),G===0&&(O.status=HCRC_STATE)}else O.status=HCRC_STATE;if(O.status===HCRC_STATE&&(O.gzhead.hcrc?(O.pending+2>O.pending_buf_size&&flush_pending(B),O.pending+2<=O.pending_buf_size&&(put_byte(O,B.adler&255),put_byte(O,B.adler>>8&255),B.adler=0,O.status=BUSY_STATE)):O.status=BUSY_STATE),O.pending!==0){if(flush_pending(B),B.avail_out===0)return O.last_flush=-1,Z_OK$2}else if(B.avail_in===0&&rank(D)<=rank(F)&&D!==Z_FINISH$2)return err(B,Z_BUF_ERROR$1);if(O.status===FINISH_STATE&&B.avail_in!==0)return err(B,Z_BUF_ERROR$1);if(B.avail_in!==0||O.lookahead!==0||D!==Z_NO_FLUSH$1&&O.status!==FINISH_STATE){var Y=O.strategy===Z_HUFFMAN_ONLY?deflate_huff(O,D):O.strategy===Z_RLE?deflate_rle(O,D):configuration_table[O.level].func(O,D);if((Y===BS_FINISH_STARTED||Y===BS_FINISH_DONE)&&(O.status=FINISH_STATE),Y===BS_NEED_MORE||Y===BS_FINISH_STARTED)return B.avail_out===0&&(O.last_flush=-1),Z_OK$2;if(Y===BS_BLOCK_DONE&&(D===Z_PARTIAL_FLUSH?trees._tr_align(O):D!==Z_BLOCK$1&&(trees._tr_stored_block(O,0,0,!1),D===Z_FULL_FLUSH&&(zero(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),flush_pending(B),B.avail_out===0))return O.last_flush=-1,Z_OK$2}return D!==Z_FINISH$2?Z_OK$2:O.wrap<=0?Z_STREAM_END$2:(O.wrap===2?(put_byte(O,B.adler&255),put_byte(O,B.adler>>8&255),put_byte(O,B.adler>>16&255),put_byte(O,B.adler>>24&255),put_byte(O,B.total_in&255),put_byte(O,B.total_in>>8&255),put_byte(O,B.total_in>>16&255),put_byte(O,B.total_in>>24&255)):(putShortMSB(O,B.adler>>>16),putShortMSB(O,B.adler&65535)),flush_pending(B),O.wrap>0&&(O.wrap=-O.wrap),O.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(B){var D;return!B||!B.state?Z_STREAM_ERROR$1:(D=B.state.status,D!==INIT_STATE&&D!==EXTRA_STATE&&D!==NAME_STATE&&D!==COMMENT_STATE&&D!==HCRC_STATE&&D!==BUSY_STATE&&D!==FINISH_STATE?err(B,Z_STREAM_ERROR$1):(B.state=null,D===BUSY_STATE?err(B,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(B,D){var F=D.length,O,U,G,X,tt,Y,W,z;if(!B||!B.state||(O=B.state,X=O.wrap,X===2||X===1&&O.status!==INIT_STATE||O.lookahead))return Z_STREAM_ERROR$1;for(X===1&&(B.adler=adler32$1(B.adler,D,F,0)),O.wrap=0,F>=O.w_size&&(X===0&&(zero(O.head),O.strstart=0,O.block_start=0,O.insert=0),z=new utils$5.Buf8(O.w_size),utils$5.arraySet(z,D,F-O.w_size,O.w_size,0),D=z,F=O.w_size),tt=B.avail_in,Y=B.next_in,W=B.input,B.avail_in=F,B.next_in=0,B.input=D,fill_window(O);O.lookahead>=MIN_MATCH;){U=O.strstart,G=O.lookahead-(MIN_MATCH-1);do O.ins_h=(O.ins_h<<O.hash_shift^O.window[U+MIN_MATCH-1])&O.hash_mask,O.prev[U&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=U,U++;while(--G);O.strstart=U,O.lookahead=MIN_MATCH-1,fill_window(O)}return O.strstart+=O.lookahead,O.block_start=O.strstart,O.insert=O.lookahead,O.lookahead=0,O.match_length=O.prev_length=MIN_MATCH-1,O.match_available=0,B.next_in=Y,B.input=W,B.avail_in=tt,O.wrap=X,Z_OK$2}deflate$3.deflateInit=deflateInit;deflate$3.deflateInit2=deflateInit2;deflate$3.deflateReset=deflateReset;deflate$3.deflateResetKeep=deflateResetKeep;deflate$3.deflateSetHeader=deflateSetHeader;deflate$3.deflate=deflate$2;deflate$3.deflateEnd=deflateEnd;deflate$3.deflateSetDictionary=deflateSetDictionary;deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$4=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(B){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(B){STR_APPLY_UIA_OK=!1}var _utf8len=new utils$4.Buf8(256);for(var q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1;strings$2.string2buf=function(B){var D,F,O,U,G,X=B.length,tt=0;for(U=0;U<X;U++)F=B.charCodeAt(U),(F&64512)===55296&&U+1<X&&(O=B.charCodeAt(U+1),(O&64512)===56320&&(F=65536+(F-55296<<10)+(O-56320),U++)),tt+=F<128?1:F<2048?2:F<65536?3:4;for(D=new utils$4.Buf8(tt),G=0,U=0;G<tt;U++)F=B.charCodeAt(U),(F&64512)===55296&&U+1<X&&(O=B.charCodeAt(U+1),(O&64512)===56320&&(F=65536+(F-55296<<10)+(O-56320),U++)),F<128?D[G++]=F:F<2048?(D[G++]=192|F>>>6,D[G++]=128|F&63):F<65536?(D[G++]=224|F>>>12,D[G++]=128|F>>>6&63,D[G++]=128|F&63):(D[G++]=240|F>>>18,D[G++]=128|F>>>12&63,D[G++]=128|F>>>6&63,D[G++]=128|F&63);return D};function buf2binstring(B,D){if(D<65534&&(B.subarray&&STR_APPLY_UIA_OK||!B.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$4.shrinkBuf(B,D));for(var F="",O=0;O<D;O++)F+=String.fromCharCode(B[O]);return F}strings$2.buf2binstring=function(B){return buf2binstring(B,B.length)};strings$2.binstring2buf=function(B){for(var D=new utils$4.Buf8(B.length),F=0,O=D.length;F<O;F++)D[F]=B.charCodeAt(F);return D};strings$2.buf2string=function(B,D){var F,O,U,G,X=D||B.length,tt=new Array(X*2);for(O=0,F=0;F<X;){if(U=B[F++],U<128){tt[O++]=U;continue}if(G=_utf8len[U],G>4){tt[O++]=65533,F+=G-1;continue}for(U&=G===2?31:G===3?15:7;G>1&&F<X;)U=U<<6|B[F++]&63,G--;if(G>1){tt[O++]=65533;continue}U<65536?tt[O++]=U:(U-=65536,tt[O++]=55296|U>>10&1023,tt[O++]=56320|U&1023)}return buf2binstring(tt,O)};strings$2.utf8border=function(B,D){var F;for(D=D||B.length,D>B.length&&(D=B.length),F=D-1;F>=0&&(B[F]&192)===128;)F--;return F<0||F===0?D:F+_utf8len[B[F]]>D?F:D};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$3=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$2=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(B){if(!(this instanceof Deflate))return new Deflate(B);this.options=utils$3.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},B||{});var D=this.options;D.raw&&D.windowBits>0?D.windowBits=-D.windowBits:D.gzip&&D.windowBits>0&&D.windowBits<16&&(D.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var F=zlib_deflate.deflateInit2(this.strm,D.level,D.method,D.windowBits,D.memLevel,D.strategy);if(F!==Z_OK$1)throw new Error(msg$1[F]);if(D.header&&zlib_deflate.deflateSetHeader(this.strm,D.header),D.dictionary){var O;if(typeof D.dictionary=="string"?O=strings$1.string2buf(D.dictionary):toString$2.call(D.dictionary)==="[object ArrayBuffer]"?O=new Uint8Array(D.dictionary):O=D.dictionary,F=zlib_deflate.deflateSetDictionary(this.strm,O),F!==Z_OK$1)throw new Error(msg$1[F]);this._dict_set=!0}}Deflate.prototype.push=function(B,D){var F=this.strm,O=this.options.chunkSize,U,G;if(this.ended)return!1;G=D===~~D?D:D===!0?Z_FINISH$1:Z_NO_FLUSH,typeof B=="string"?F.input=strings$1.string2buf(B):toString$2.call(B)==="[object ArrayBuffer]"?F.input=new Uint8Array(B):F.input=B,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new utils$3.Buf8(O),F.next_out=0,F.avail_out=O),U=zlib_deflate.deflate(F,G),U!==Z_STREAM_END$1&&U!==Z_OK$1)return this.onEnd(U),this.ended=!0,!1;(F.avail_out===0||F.avail_in===0&&(G===Z_FINISH$1||G===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$3.shrinkBuf(F.output,F.next_out))):this.onData(utils$3.shrinkBuf(F.output,F.next_out)))}while((F.avail_in>0||F.avail_out===0)&&U!==Z_STREAM_END$1);return G===Z_FINISH$1?(U=zlib_deflate.deflateEnd(this.strm),this.onEnd(U),this.ended=!0,U===Z_OK$1):(G===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),F.avail_out=0),!0)};Deflate.prototype.onData=function(B){this.chunks.push(B)};Deflate.prototype.onEnd=function(B){B===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$3.flattenChunks(this.chunks)),this.chunks=[],this.err=B,this.msg=this.strm.msg};function deflate$1(B,D){var F=new Deflate(D);if(F.push(B,!0),F.err)throw F.msg||msg$1[F.err];return F.result}function deflateRaw(B,D){return D=D||{},D.raw=!0,deflate$1(B,D)}function gzip(B,D){return D=D||{},D.gzip=!0,deflate$1(B,D)}deflate$4.Deflate=Deflate;deflate$4.deflate=deflate$1;deflate$4.deflateRaw=deflateRaw;deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function B(D,F){var O,U,G,X,tt,Y,W,z,K,J,Q,et,it,rt,st,at,ct,dt,nt,ht,vt,_t,ut,bt,gt;O=D.state,U=D.next_in,bt=D.input,G=U+(D.avail_in-5),X=D.next_out,gt=D.output,tt=X-(F-D.avail_out),Y=X+(D.avail_out-257),W=O.dmax,z=O.wsize,K=O.whave,J=O.wnext,Q=O.window,et=O.hold,it=O.bits,rt=O.lencode,st=O.distcode,at=(1<<O.lenbits)-1,ct=(1<<O.distbits)-1;t:do{it<15&&(et+=bt[U++]<<it,it+=8,et+=bt[U++]<<it,it+=8),dt=rt[et&at];e:for(;;){if(nt=dt>>>24,et>>>=nt,it-=nt,nt=dt>>>16&255,nt===0)gt[X++]=dt&65535;else if(nt&16){ht=dt&65535,nt&=15,nt&&(it<nt&&(et+=bt[U++]<<it,it+=8),ht+=et&(1<<nt)-1,et>>>=nt,it-=nt),it<15&&(et+=bt[U++]<<it,it+=8,et+=bt[U++]<<it,it+=8),dt=st[et&ct];r:for(;;){if(nt=dt>>>24,et>>>=nt,it-=nt,nt=dt>>>16&255,nt&16){if(vt=dt&65535,nt&=15,it<nt&&(et+=bt[U++]<<it,it+=8,it<nt&&(et+=bt[U++]<<it,it+=8)),vt+=et&(1<<nt)-1,vt>W){D.msg="invalid distance too far back",O.mode=BAD$1;break t}if(et>>>=nt,it-=nt,nt=X-tt,vt>nt){if(nt=vt-nt,nt>K&&O.sane){D.msg="invalid distance too far back",O.mode=BAD$1;break t}if(_t=0,ut=Q,J===0){if(_t+=z-nt,nt<ht){ht-=nt;do gt[X++]=Q[_t++];while(--nt);_t=X-vt,ut=gt}}else if(J<nt){if(_t+=z+J-nt,nt-=J,nt<ht){ht-=nt;do gt[X++]=Q[_t++];while(--nt);if(_t=0,J<ht){nt=J,ht-=nt;do gt[X++]=Q[_t++];while(--nt);_t=X-vt,ut=gt}}}else if(_t+=J-nt,nt<ht){ht-=nt;do gt[X++]=Q[_t++];while(--nt);_t=X-vt,ut=gt}for(;ht>2;)gt[X++]=ut[_t++],gt[X++]=ut[_t++],gt[X++]=ut[_t++],ht-=3;ht&&(gt[X++]=ut[_t++],ht>1&&(gt[X++]=ut[_t++]))}else{_t=X-vt;do gt[X++]=gt[_t++],gt[X++]=gt[_t++],gt[X++]=gt[_t++],ht-=3;while(ht>2);ht&&(gt[X++]=gt[_t++],ht>1&&(gt[X++]=gt[_t++]))}}else if(nt&64){D.msg="invalid distance code",O.mode=BAD$1;break t}else{dt=st[(dt&65535)+(et&(1<<nt)-1)];continue r}break}}else if(nt&64)if(nt&32){O.mode=TYPE$1;break t}else{D.msg="invalid literal/length code",O.mode=BAD$1;break t}else{dt=rt[(dt&65535)+(et&(1<<nt)-1)];continue e}break}}while(U<G&&X<Y);ht=it>>3,U-=ht,it-=ht<<3,et&=(1<<it)-1,D.next_in=U,D.next_out=X,D.avail_in=U<G?5+(G-U):5-(U-G),D.avail_out=X<Y?257+(Y-X):257-(X-Y),O.hold=et,O.bits=it},utils$2=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function B(D,F,O,U,G,X,tt,Y){var W=Y.bits,z=0,K=0,J=0,Q=0,et=0,it=0,rt=0,st=0,at=0,ct=0,dt,nt,ht,vt,_t,ut=null,bt=0,gt,At=new utils$2.Buf16(MAXBITS+1),St=new utils$2.Buf16(MAXBITS+1),xt=null,Pt=0,Ft,Mt,Dt;for(z=0;z<=MAXBITS;z++)At[z]=0;for(K=0;K<U;K++)At[F[O+K]]++;for(et=W,Q=MAXBITS;Q>=1&&At[Q]===0;Q--);if(et>Q&&(et=Q),Q===0)return G[X++]=1<<24|64<<16|0,G[X++]=1<<24|64<<16|0,Y.bits=1,0;for(J=1;J<Q&&At[J]===0;J++);for(et<J&&(et=J),st=1,z=1;z<=MAXBITS;z++)if(st<<=1,st-=At[z],st<0)return-1;if(st>0&&(D===CODES$1||Q!==1))return-1;for(St[1]=0,z=1;z<MAXBITS;z++)St[z+1]=St[z]+At[z];for(K=0;K<U;K++)F[O+K]!==0&&(tt[St[F[O+K]]++]=K);if(D===CODES$1?(ut=xt=tt,gt=19):D===LENS$1?(ut=lbase,bt-=257,xt=lext,Pt-=257,gt=256):(ut=dbase,xt=dext,gt=-1),ct=0,K=0,z=J,_t=X,it=et,rt=0,ht=-1,at=1<<et,vt=at-1,D===LENS$1&&at>ENOUGH_LENS$1||D===DISTS$1&&at>ENOUGH_DISTS$1)return 1;for(;;){Ft=z-rt,tt[K]<gt?(Mt=0,Dt=tt[K]):tt[K]>gt?(Mt=xt[Pt+tt[K]],Dt=ut[bt+tt[K]]):(Mt=32+64,Dt=0),dt=1<<z-rt,nt=1<<it,J=nt;do nt-=dt,G[_t+(ct>>rt)+nt]=Ft<<24|Mt<<16|Dt|0;while(nt!==0);for(dt=1<<z-1;ct&dt;)dt>>=1;if(dt!==0?(ct&=dt-1,ct+=dt):ct=0,K++,--At[z]===0){if(z===Q)break;z=F[O+tt[K]]}if(z>et&&(ct&vt)!==ht){for(rt===0&&(rt=et),_t+=J,it=z-rt,st=1<<it;it+rt<Q&&(st-=At[it+rt],!(st<=0));)it++,st<<=1;if(at+=1<<it,D===LENS$1&&at>ENOUGH_LENS$1||D===DISTS$1&&at>ENOUGH_DISTS$1)return 1;ht=ct&vt,G[ht]=et<<24|it<<16|_t-X|0}}return ct!==0&&(G[_t+ct]=z-rt<<24|64<<16|0),Y.bits=et,0},utils$1=common,adler32=adler32_1,crc32=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(B){return(B>>>24&255)+(B>>>8&65280)+((B&65280)<<8)+((B&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$1.Buf16(320),this.work=new utils$1.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(B){var D;return!B||!B.state?Z_STREAM_ERROR:(D=B.state,B.total_in=B.total_out=D.total=0,B.msg="",D.wrap&&(B.adler=D.wrap&1),D.mode=HEAD,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new utils$1.Buf32(ENOUGH_LENS),D.distcode=D.distdyn=new utils$1.Buf32(ENOUGH_DISTS),D.sane=1,D.back=-1,Z_OK)}function inflateReset(B){var D;return!B||!B.state?Z_STREAM_ERROR:(D=B.state,D.wsize=0,D.whave=0,D.wnext=0,inflateResetKeep(B))}function inflateReset2(B,D){var F,O;return!B||!B.state||(O=B.state,D<0?(F=0,D=-D):(F=(D>>4)+1,D<48&&(D&=15)),D&&(D<8||D>15))?Z_STREAM_ERROR:(O.window!==null&&O.wbits!==D&&(O.window=null),O.wrap=F,O.wbits=D,inflateReset(B))}function inflateInit2(B,D){var F,O;return B?(O=new InflateState,B.state=O,O.window=null,F=inflateReset2(B,D),F!==Z_OK&&(B.state=null),F):Z_STREAM_ERROR}function inflateInit(B){return inflateInit2(B,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(B){if(virgin){var D;for(lenfix=new utils$1.Buf32(512),distfix=new utils$1.Buf32(32),D=0;D<144;)B.lens[D++]=8;for(;D<256;)B.lens[D++]=9;for(;D<280;)B.lens[D++]=7;for(;D<288;)B.lens[D++]=8;for(inflate_table(LENS,B.lens,0,288,lenfix,0,B.work,{bits:9}),D=0;D<32;)B.lens[D++]=5;inflate_table(DISTS,B.lens,0,32,distfix,0,B.work,{bits:5}),virgin=!1}B.lencode=lenfix,B.lenbits=9,B.distcode=distfix,B.distbits=5}function updatewindow(B,D,F,O){var U,G=B.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new utils$1.Buf8(G.wsize)),O>=G.wsize?(utils$1.arraySet(G.window,D,F-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(U=G.wsize-G.wnext,U>O&&(U=O),utils$1.arraySet(G.window,D,F-O,U,G.wnext),O-=U,O?(utils$1.arraySet(G.window,D,F-O,O,0),G.wnext=O,G.whave=G.wsize):(G.wnext+=U,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=U))),0}function inflate$2(B,D){var F,O,U,G,X,tt,Y,W,z,K,J,Q,et,it,rt=0,st,at,ct,dt,nt,ht,vt,_t,ut=new utils$1.Buf8(4),bt,gt,At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return Z_STREAM_ERROR;F=B.state,F.mode===TYPE&&(F.mode=TYPEDO),X=B.next_out,U=B.output,Y=B.avail_out,G=B.next_in,O=B.input,tt=B.avail_in,W=F.hold,z=F.bits,K=tt,J=Y,_t=Z_OK;t:for(;;)switch(F.mode){case HEAD:if(F.wrap===0){F.mode=TYPEDO;break}for(;z<16;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(F.wrap&2&&W===35615){F.check=0,ut[0]=W&255,ut[1]=W>>>8&255,F.check=crc32(F.check,ut,2,0),W=0,z=0,F.mode=FLAGS;break}if(F.flags=0,F.head&&(F.head.done=!1),!(F.wrap&1)||(((W&255)<<8)+(W>>8))%31){B.msg="incorrect header check",F.mode=BAD;break}if((W&15)!==Z_DEFLATED){B.msg="unknown compression method",F.mode=BAD;break}if(W>>>=4,z-=4,vt=(W&15)+8,F.wbits===0)F.wbits=vt;else if(vt>F.wbits){B.msg="invalid window size",F.mode=BAD;break}F.dmax=1<<vt,B.adler=F.check=1,F.mode=W&512?DICTID:TYPE,W=0,z=0;break;case FLAGS:for(;z<16;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(F.flags=W,(F.flags&255)!==Z_DEFLATED){B.msg="unknown compression method",F.mode=BAD;break}if(F.flags&57344){B.msg="unknown header flags set",F.mode=BAD;break}F.head&&(F.head.text=W>>8&1),F.flags&512&&(ut[0]=W&255,ut[1]=W>>>8&255,F.check=crc32(F.check,ut,2,0)),W=0,z=0,F.mode=TIME;case TIME:for(;z<32;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}F.head&&(F.head.time=W),F.flags&512&&(ut[0]=W&255,ut[1]=W>>>8&255,ut[2]=W>>>16&255,ut[3]=W>>>24&255,F.check=crc32(F.check,ut,4,0)),W=0,z=0,F.mode=OS;case OS:for(;z<16;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}F.head&&(F.head.xflags=W&255,F.head.os=W>>8),F.flags&512&&(ut[0]=W&255,ut[1]=W>>>8&255,F.check=crc32(F.check,ut,2,0)),W=0,z=0,F.mode=EXLEN;case EXLEN:if(F.flags&1024){for(;z<16;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}F.length=W,F.head&&(F.head.extra_len=W),F.flags&512&&(ut[0]=W&255,ut[1]=W>>>8&255,F.check=crc32(F.check,ut,2,0)),W=0,z=0}else F.head&&(F.head.extra=null);F.mode=EXTRA;case EXTRA:if(F.flags&1024&&(Q=F.length,Q>tt&&(Q=tt),Q&&(F.head&&(vt=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Array(F.head.extra_len)),utils$1.arraySet(F.head.extra,O,G,Q,vt)),F.flags&512&&(F.check=crc32(F.check,O,Q,G)),tt-=Q,G+=Q,F.length-=Q),F.length))break t;F.length=0,F.mode=NAME;case NAME:if(F.flags&2048){if(tt===0)break t;Q=0;do vt=O[G+Q++],F.head&&vt&&F.length<65536&&(F.head.name+=String.fromCharCode(vt));while(vt&&Q<tt);if(F.flags&512&&(F.check=crc32(F.check,O,Q,G)),tt-=Q,G+=Q,vt)break t}else F.head&&(F.head.name=null);F.length=0,F.mode=COMMENT;case COMMENT:if(F.flags&4096){if(tt===0)break t;Q=0;do vt=O[G+Q++],F.head&&vt&&F.length<65536&&(F.head.comment+=String.fromCharCode(vt));while(vt&&Q<tt);if(F.flags&512&&(F.check=crc32(F.check,O,Q,G)),tt-=Q,G+=Q,vt)break t}else F.head&&(F.head.comment=null);F.mode=HCRC;case HCRC:if(F.flags&512){for(;z<16;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(W!==(F.check&65535)){B.msg="header crc mismatch",F.mode=BAD;break}W=0,z=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),B.adler=F.check=0,F.mode=TYPE;break;case DICTID:for(;z<32;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}B.adler=F.check=zswap32(W),W=0,z=0,F.mode=DICT;case DICT:if(F.havedict===0)return B.next_out=X,B.avail_out=Y,B.next_in=G,B.avail_in=tt,F.hold=W,F.bits=z,Z_NEED_DICT;B.adler=F.check=1,F.mode=TYPE;case TYPE:if(D===Z_BLOCK||D===Z_TREES)break t;case TYPEDO:if(F.last){W>>>=z&7,z-=z&7,F.mode=CHECK;break}for(;z<3;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}switch(F.last=W&1,W>>>=1,z-=1,W&3){case 0:F.mode=STORED;break;case 1:if(fixedtables(F),F.mode=LEN_,D===Z_TREES){W>>>=2,z-=2;break t}break;case 2:F.mode=TABLE;break;case 3:B.msg="invalid block type",F.mode=BAD}W>>>=2,z-=2;break;case STORED:for(W>>>=z&7,z-=z&7;z<32;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if((W&65535)!==(W>>>16^65535)){B.msg="invalid stored block lengths",F.mode=BAD;break}if(F.length=W&65535,W=0,z=0,F.mode=COPY_,D===Z_TREES)break t;case COPY_:F.mode=COPY;case COPY:if(Q=F.length,Q){if(Q>tt&&(Q=tt),Q>Y&&(Q=Y),Q===0)break t;utils$1.arraySet(U,O,G,Q,X),tt-=Q,G+=Q,Y-=Q,X+=Q,F.length-=Q;break}F.mode=TYPE;break;case TABLE:for(;z<14;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(F.nlen=(W&31)+257,W>>>=5,z-=5,F.ndist=(W&31)+1,W>>>=5,z-=5,F.ncode=(W&15)+4,W>>>=4,z-=4,F.nlen>286||F.ndist>30){B.msg="too many length or distance symbols",F.mode=BAD;break}F.have=0,F.mode=LENLENS;case LENLENS:for(;F.have<F.ncode;){for(;z<3;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}F.lens[At[F.have++]]=W&7,W>>>=3,z-=3}for(;F.have<19;)F.lens[At[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,bt={bits:F.lenbits},_t=inflate_table(CODES,F.lens,0,19,F.lencode,0,F.work,bt),F.lenbits=bt.bits,_t){B.msg="invalid code lengths set",F.mode=BAD;break}F.have=0,F.mode=CODELENS;case CODELENS:for(;F.have<F.nlen+F.ndist;){for(;rt=F.lencode[W&(1<<F.lenbits)-1],st=rt>>>24,at=rt>>>16&255,ct=rt&65535,!(st<=z);){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(ct<16)W>>>=st,z-=st,F.lens[F.have++]=ct;else{if(ct===16){for(gt=st+2;z<gt;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(W>>>=st,z-=st,F.have===0){B.msg="invalid bit length repeat",F.mode=BAD;break}vt=F.lens[F.have-1],Q=3+(W&3),W>>>=2,z-=2}else if(ct===17){for(gt=st+3;z<gt;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}W>>>=st,z-=st,vt=0,Q=3+(W&7),W>>>=3,z-=3}else{for(gt=st+7;z<gt;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}W>>>=st,z-=st,vt=0,Q=11+(W&127),W>>>=7,z-=7}if(F.have+Q>F.nlen+F.ndist){B.msg="invalid bit length repeat",F.mode=BAD;break}for(;Q--;)F.lens[F.have++]=vt}}if(F.mode===BAD)break;if(F.lens[256]===0){B.msg="invalid code -- missing end-of-block",F.mode=BAD;break}if(F.lenbits=9,bt={bits:F.lenbits},_t=inflate_table(LENS,F.lens,0,F.nlen,F.lencode,0,F.work,bt),F.lenbits=bt.bits,_t){B.msg="invalid literal/lengths set",F.mode=BAD;break}if(F.distbits=6,F.distcode=F.distdyn,bt={bits:F.distbits},_t=inflate_table(DISTS,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,bt),F.distbits=bt.bits,_t){B.msg="invalid distances set",F.mode=BAD;break}if(F.mode=LEN_,D===Z_TREES)break t;case LEN_:F.mode=LEN;case LEN:if(tt>=6&&Y>=258){B.next_out=X,B.avail_out=Y,B.next_in=G,B.avail_in=tt,F.hold=W,F.bits=z,inflate_fast(B,J),X=B.next_out,U=B.output,Y=B.avail_out,G=B.next_in,O=B.input,tt=B.avail_in,W=F.hold,z=F.bits,F.mode===TYPE&&(F.back=-1);break}for(F.back=0;rt=F.lencode[W&(1<<F.lenbits)-1],st=rt>>>24,at=rt>>>16&255,ct=rt&65535,!(st<=z);){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(at&&!(at&240)){for(dt=st,nt=at,ht=ct;rt=F.lencode[ht+((W&(1<<dt+nt)-1)>>dt)],st=rt>>>24,at=rt>>>16&255,ct=rt&65535,!(dt+st<=z);){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}W>>>=dt,z-=dt,F.back+=dt}if(W>>>=st,z-=st,F.back+=st,F.length=ct,at===0){F.mode=LIT;break}if(at&32){F.back=-1,F.mode=TYPE;break}if(at&64){B.msg="invalid literal/length code",F.mode=BAD;break}F.extra=at&15,F.mode=LENEXT;case LENEXT:if(F.extra){for(gt=F.extra;z<gt;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}F.length+=W&(1<<F.extra)-1,W>>>=F.extra,z-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=DIST;case DIST:for(;rt=F.distcode[W&(1<<F.distbits)-1],st=rt>>>24,at=rt>>>16&255,ct=rt&65535,!(st<=z);){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(!(at&240)){for(dt=st,nt=at,ht=ct;rt=F.distcode[ht+((W&(1<<dt+nt)-1)>>dt)],st=rt>>>24,at=rt>>>16&255,ct=rt&65535,!(dt+st<=z);){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}W>>>=dt,z-=dt,F.back+=dt}if(W>>>=st,z-=st,F.back+=st,at&64){B.msg="invalid distance code",F.mode=BAD;break}F.offset=ct,F.extra=at&15,F.mode=DISTEXT;case DISTEXT:if(F.extra){for(gt=F.extra;z<gt;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}F.offset+=W&(1<<F.extra)-1,W>>>=F.extra,z-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){B.msg="invalid distance too far back",F.mode=BAD;break}F.mode=MATCH;case MATCH:if(Y===0)break t;if(Q=J-Y,F.offset>Q){if(Q=F.offset-Q,Q>F.whave&&F.sane){B.msg="invalid distance too far back",F.mode=BAD;break}Q>F.wnext?(Q-=F.wnext,et=F.wsize-Q):et=F.wnext-Q,Q>F.length&&(Q=F.length),it=F.window}else it=U,et=X-F.offset,Q=F.length;Q>Y&&(Q=Y),Y-=Q,F.length-=Q;do U[X++]=it[et++];while(--Q);F.length===0&&(F.mode=LEN);break;case LIT:if(Y===0)break t;U[X++]=F.length,Y--,F.mode=LEN;break;case CHECK:if(F.wrap){for(;z<32;){if(tt===0)break t;tt--,W|=O[G++]<<z,z+=8}if(J-=Y,B.total_out+=J,F.total+=J,J&&(B.adler=F.check=F.flags?crc32(F.check,U,J,X-J):adler32(F.check,U,J,X-J)),J=Y,(F.flags?W:zswap32(W))!==F.check){B.msg="incorrect data check",F.mode=BAD;break}W=0,z=0}F.mode=LENGTH;case LENGTH:if(F.wrap&&F.flags){for(;z<32;){if(tt===0)break t;tt--,W+=O[G++]<<z,z+=8}if(W!==(F.total&4294967295)){B.msg="incorrect length check",F.mode=BAD;break}W=0,z=0}F.mode=DONE;case DONE:_t=Z_STREAM_END;break t;case BAD:_t=Z_DATA_ERROR;break t;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return B.next_out=X,B.avail_out=Y,B.next_in=G,B.avail_in=tt,F.hold=W,F.bits=z,(F.wsize||J!==B.avail_out&&F.mode<BAD&&(F.mode<CHECK||D!==Z_FINISH))&&updatewindow(B,B.output,B.next_out,J-B.avail_out),K-=B.avail_in,J-=B.avail_out,B.total_in+=K,B.total_out+=J,F.total+=J,F.wrap&&J&&(B.adler=F.check=F.flags?crc32(F.check,U,J,B.next_out-J):adler32(F.check,U,J,B.next_out-J)),B.data_type=F.bits+(F.last?64:0)+(F.mode===TYPE?128:0)+(F.mode===LEN_||F.mode===COPY_?256:0),(K===0&&J===0||D===Z_FINISH)&&_t===Z_OK&&(_t=Z_BUF_ERROR),_t}function inflateEnd(B){if(!B||!B.state)return Z_STREAM_ERROR;var D=B.state;return D.window&&(D.window=null),B.state=null,Z_OK}function inflateGetHeader(B,D){var F;return!B||!B.state||(F=B.state,!(F.wrap&2))?Z_STREAM_ERROR:(F.head=D,D.done=!1,Z_OK)}function inflateSetDictionary(B,D){var F=D.length,O,U,G;return!B||!B.state||(O=B.state,O.wrap!==0&&O.mode!==DICT)?Z_STREAM_ERROR:O.mode===DICT&&(U=1,U=adler32(U,D,F,0),U!==O.check)?Z_DATA_ERROR:(G=updatewindow(B,D,F,F),G?(O.mode=MEM,Z_MEM_ERROR):(O.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset;inflate$3.inflateReset2=inflateReset2;inflate$3.inflateResetKeep=inflateResetKeep;inflate$3.inflateInit=inflateInit;inflate$3.inflateInit2=inflateInit2;inflate$3.inflate=inflate$2;inflate$3.inflateEnd=inflateEnd;inflate$3.inflateGetHeader=inflateGetHeader;inflate$3.inflateSetDictionary=inflateSetDictionary;inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils=common,strings=strings$2,c=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString$1=Object.prototype.toString;function Inflate(B){if(!(this instanceof Inflate))return new Inflate(B);this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},B||{});var D=this.options;D.raw&&D.windowBits>=0&&D.windowBits<16&&(D.windowBits=-D.windowBits,D.windowBits===0&&(D.windowBits=-15)),D.windowBits>=0&&D.windowBits<16&&!(B&&B.windowBits)&&(D.windowBits+=32),D.windowBits>15&&D.windowBits<48&&(D.windowBits&15||(D.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var F=zlib_inflate.inflateInit2(this.strm,D.windowBits);if(F!==c.Z_OK)throw new Error(msg[F]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),D.dictionary&&(typeof D.dictionary=="string"?D.dictionary=strings.string2buf(D.dictionary):toString$1.call(D.dictionary)==="[object ArrayBuffer]"&&(D.dictionary=new Uint8Array(D.dictionary)),D.raw&&(F=zlib_inflate.inflateSetDictionary(this.strm,D.dictionary),F!==c.Z_OK)))throw new Error(msg[F])}Inflate.prototype.push=function(B,D){var F=this.strm,O=this.options.chunkSize,U=this.options.dictionary,G,X,tt,Y,W,z=!1;if(this.ended)return!1;X=D===~~D?D:D===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof B=="string"?F.input=strings.binstring2buf(B):toString$1.call(B)==="[object ArrayBuffer]"?F.input=new Uint8Array(B):F.input=B,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new utils.Buf8(O),F.next_out=0,F.avail_out=O),G=zlib_inflate.inflate(F,c.Z_NO_FLUSH),G===c.Z_NEED_DICT&&U&&(G=zlib_inflate.inflateSetDictionary(this.strm,U)),G===c.Z_BUF_ERROR&&z===!0&&(G=c.Z_OK,z=!1),G!==c.Z_STREAM_END&&G!==c.Z_OK)return this.onEnd(G),this.ended=!0,!1;F.next_out&&(F.avail_out===0||G===c.Z_STREAM_END||F.avail_in===0&&(X===c.Z_FINISH||X===c.Z_SYNC_FLUSH))&&(this.options.to==="string"?(tt=strings.utf8border(F.output,F.next_out),Y=F.next_out-tt,W=strings.buf2string(F.output,tt),F.next_out=Y,F.avail_out=O-Y,Y&&utils.arraySet(F.output,F.output,tt,Y,0),this.onData(W)):this.onData(utils.shrinkBuf(F.output,F.next_out))),F.avail_in===0&&F.avail_out===0&&(z=!0)}while((F.avail_in>0||F.avail_out===0)&&G!==c.Z_STREAM_END);return G===c.Z_STREAM_END&&(X=c.Z_FINISH),X===c.Z_FINISH?(G=zlib_inflate.inflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===c.Z_OK):(X===c.Z_SYNC_FLUSH&&(this.onEnd(c.Z_OK),F.avail_out=0),!0)};Inflate.prototype.onData=function(B){this.chunks.push(B)};Inflate.prototype.onEnd=function(B){B===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=B,this.msg=this.strm.msg};function inflate$1(B,D){var F=new Inflate(D);if(F.push(B,!0),F.err)throw F.msg||msg[F.err];return F.result}function inflateRaw(B,D){return D=D||{},D.raw=!0,inflate$1(B,D)}inflate$4.Inflate=Inflate;inflate$4.inflate=inflate$1;inflate$4.inflateRaw=inflateRaw;inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako={};assign(pako,deflate,inflate,constants);var pako_1=pako;Object.defineProperty(stream,"__esModule",{value:!0});stream.FlateStream=stream.Stream=void 0;const util_1$7=util,Pako=pako_1;class Stream{constructor(D){this.data=D,this._ptr=0}getData(){return this.data}encode(){throw Error("abstract method")}getLength(){return this.data.length}peekNBytes(D=1,F=0){return this.data.slice(F,F+D)}peekNBytesAsNumber(D=1,F=0){let O=0;for(let U=0;U<D;++U)O+=this.data[U+F]<<8*(D-U-1);return O}getNBytesAsNumber(D=1){let F=this.peekNBytesAsNumber(D,this._ptr);return this._ptr+=D,F}getByte(){return this.data[this._ptr++]}getNumber(){let D=util_1$7.Util.extractNumber(this.data,this._ptr);return this._ptr=D.end_index+1,D.result}}stream.Stream=Stream;class FlateStream extends Stream{constructor(D,F=void 0,O=!1,U=void 0,G=void 0){super(D),this.data=D,this.decodeParameters=F,this.rawData=O,this.cryptoInterface=U,this.object_id=G,this.data.length>0&&!O&&(this.data=Pako.inflate(D)),F&&!O&&(this.data=this.applyDecoding(this.data,F))}encode(){if(!this.data||this.data.length===0)return new Uint8Array;let D=this.data;this.decodeParameters&&this.rawData&&(D=this.applyEncoding(D,this.decodeParameters));let F=Pako.deflate(D);return this.cryptoInterface&&this.object_id?this.cryptoInterface.encrypt(F,this.object_id):F}applyEncoding(D,F){if(F.predictor>=10)return this.encodePNGFilter(D,F);if(F.predictor===2)throw Error("Unsupported filter -- file feature request");return D}applyDecoding(D,F){if(F.predictor>=10)return this.decodePNGFilter(D,F);if(F.predictor===2)throw Error("Unsupported filter -- file feature request");return D}encodePNGFilter(D,F){if(D.length%F.columns!==0)throw Error("Invalid decode parameters");if(typeof F.encoding>"u"||F.encoding<0||F.encoding>4)throw Error("Invalid PNG filter encoding");let O=F.columns,U=[],G=0,X=0,tt=0,Y=0,W=0;for(let z=0;z<D.length;++z)switch(z%O===0&&U.push(F.encoding),F.encoding){case 0:U.push(D[z]);break;case 1:G=Math.floor(z/O)*O,U.push(z%O===0?D[z%O+G]:(D[z%O+G]-D[z%O+G-1])%256);break;case 2:X=z-O,tt=X<0?0:D[X],U.push((D[z]-tt)%256);break;case 3:X=z-O,tt=X<0?0:D[X],Y=z%O-1<0?0:D[z-1],U.push((D[z]-Math.floor((tt+Y)/2))%256);break;case 4:X=z-O,tt=X<0?0:D[X],Y=z%O-1<0?0:D[z-1],W=X-1<0?0:D[X-1],U.push((D[z]-this.paethPredictor(Y,tt,W))%256);break;default:throw Error("Invalid PNG filter encoding")}return new Uint8Array(U)}decodePNGFilter(D,F){if(D.length%(F.columns+1)!==0)throw Error("Invalid decode parameters");let O=F.columns+1,U=[],G=0;for(let X=0;X<D.length;++X){let tt=0,Y=0,W=0,z=0;if(X%O===0)G=D[X];else switch(G){case 0:U.push(D[X]);break;case 1:tt=X%O-2<0?0:U[(X-2)%F.columns+Math.floor(X/O)*(F.columns-1)],U.push((D[X]+tt)%256);break;case 2:W=X-(O+Math.floor(X/O)),Y=W<0?0:U[W],U.push((D[X]+Y)%256);break;case 3:W=X-(O+Math.floor(X/O)),Y=W<0?0:U[W],tt=X%O-2<0?0:U[(X-2)%F.columns+Math.floor(X/O)*(F.columns-1)],U.push((D[X]+Math.floor((Y+tt)/2))%256);break;case 4:W=X-(O+Math.floor(X/O)),Y=W<0?0:U[W],tt=X%O-2<0?0:U[(X-2)%F.columns+Math.floor(X/O)*(F.columns-1)],z=W-1<0?0:U[W-1],U.push((D[X]+this.paethPredictor(tt,Y,z))%256);break}}return new Uint8Array(U)}paethPredictor(D,F,O){let U=D+F-O,G=Math.abs(U-D),X=Math.abs(U-F),tt=Math.abs(U-O);return G<=X&&G<=tt?D:X<=tt?F:O}}stream.FlateStream=FlateStream;var hasRequiredObjectUtil;function requireObjectUtil(){if(hasRequiredObjectUtil)return objectUtil;hasRequiredObjectUtil=1,Object.defineProperty(objectUtil,"__esModule",{value:!0}),objectUtil.ObjectUtil=void 0;const B=util,D=requireArrayUtil(),F=stream;class O{static extractDictKeyRec(G,X,tt){let Y=B.Util.readNextWord(G,X),W=Y.result;if(!W)return X;if(B.Util.skipDelimiter(W,0),W[0]&&B.Util.DICT_END[0]===W[0]){let z=B.Util.readNextWord(G,Y.end_index+1);if(z.result&&B.Util.DICT_END[0]===z.result[0])return z.end_index}return O.extractDictValueRec(G,Y.end_index+1,tt,B.Util.convertAsciiToString(W))}static extractDictValueRec(G,X,tt,Y=void 0){let W=B.Util.readNextWord(G,X),z=W.result||new Uint8Array([]);if(X=W.end_index-z.length+1,z[0]===B.Util.ARRAY_START[0]){if(!Y)throw Error("Invalid anonymous array definition");let K=D.ArrayUtil.extractArray(G,X);return tt[Y]=K.result,O.extractDictKeyRec(G,K.end_index+1,tt)}else if(z[0]===B.Util.DICT_START[0]&&G[W.end_index+1]===B.Util.DICT_START[0])if(Y){let K={},J=O.extractDictKeyRec(G,W.end_index+2,K);return tt[Y]=K,O.extractDictKeyRec(G,J+1,tt)}else return O.extractDictKeyRec(G,W.end_index+2,tt);else if(z[0]===B.Util.HEX_STRING_START[0]){if(!Y)throw Error("Invalid anonymous string definition");let K=B.Util.extractHexString(G,X);return tt[Y]=K.result,O.extractDictKeyRec(G,K.end_index+1,tt)}else if(z[0]===B.Util.LITERAL_STRING_START[0]){if(!Y)throw Error("Invalid anonymous string definition");let K=B.Util.extractString(G,X);return tt[Y]=K.result,O.extractDictKeyRec(G,K.end_index+1,tt)}else if(z[0]===47){if(!Y)throw Error("Invalid anonymous property definition");let K=B.Util.extractOptionValue(G,X);return tt[Y]="/"+K.result,O.extractDictKeyRec(G,K.end_index+1,tt)}else{let J=B.Util.readNextWord(G,W.end_index+1).result||new Uint8Array([]);if(!Y)throw Error("Invalid anonymous reference/number definition");let Q=W.end_index+1;if(J[0]===47||J[0]===B.Util.DICT_END[0])tt[Y]=B.Util.extractNumber(G,X).result;else{let et=B.Util.extractReferenceTyped(G,X);tt[Y]=et.result,Q=et.end_index+1}return O.extractDictKeyRec(G,Q,tt)}}static locateObjectStart(G,X){let tt=B.Util.locateSequence(B.Util.OBJ,G,X),Y=B.Util.locateSequence(B.Util.ENDOBJ,G,X),W=z=>{let K=B.Util.skipSpacesReverse(G,z-1);for(;K>0&&!B.Util.isDelimiter(G[K]);)--K;for(K=B.Util.skipSpacesReverse(G,K-1);K>0&&!B.Util.isDelimiter(G[K]);)--K;return K};if(tt!==-1&&tt<Y)return W(tt);if(tt>Y||tt===-1&&Y>-1){let z=B.Util.locateSequenceReversed(B.Util.OBJ,G,X);return W(z)}else throw Error("Could not correct object start")}static extractObject(G,X,tt=void 0){if(typeof X!="number"&&X.compressed){if(!tt)throw Error("Provide ObjectLookupTable to extract stream object");return O.extractStreamObject(G,X.id,X.generation,tt[X.pointer])}let Y={},W=typeof X=="number"?X:X.pointer,z=B.Util.extractObjectId(G,W);if(isNaN(z.obj)||isNaN(z.generation))return O.extractObject(G,O.locateObjectStart(G,W),tt);if(Y.id=z,W=B.Util.locateSequence(B.Util.OBJ,G,W),W===-1)throw{message:"Object missing 'obj' sequence",name:"MissingObjSequenceError"};W+=B.Util.OBJ.length;let K=B.Util.locateSequence(B.Util.ENDOBJ,G,W);G=G.slice(W,K);let J=B.Util.readNextWord(G,0);if(J.result&&J.result[0]===B.Util.DICT_START[0]){let Q={};O.extractDictValueRec(G,0,Q),Y.value=Q}else if(J.result&&J.result[0]===B.Util.ARRAY_START[0]){let Q=D.ArrayUtil.extractArray(G,0);Y.value=Q.result}else throw Error(`Invalid object type - starting with: ${J.result}`);if(W=B.Util.locateSequence(B.Util.STREAM,G,0),W!==-1){let Q=W+B.Util.STREAM.length;Q=B.Util.skipDelimiter(G,Q);let et=Q+Y.value["/Length"];Y.stream=O.extractStreamData(G.slice(Q,et),Y.value["/Filter"],O.translateDecodeParams(Y))}return Y}static extractStreamObject(G,X,tt,Y){let W=Y.pointer;B.Util.extractObjectId(G,W),W=B.Util.locateSequence(B.Util.OBJ,G,W)+B.Util.OBJ.length;let z=B.Util.locateSequence(B.Util.ENDOBJ,G,W);G=G.slice(W,z);let K=B.Util.readNextWord(G,0);if(!K.result||K.result[0]!==B.Util.DICT_START[0])throw Error("Invalid stream object -- no dict");let J={};if(O.extractDictValueRec(G,0,J),J["/Filter"]&&Array.isArray(J["/Filter"])&&J["/Filter"].length>0&&(J["/Filter"]=J["/Filter"][0]),!J["/Filter"]||J["/Filter"]!=="/FlateDecode")throw Error(`Unsupported stream filter: ${J["/Filter"]} - Only supported filter is FlateDecode`);if(!J["/Type"]||J["/Type"]!=="/ObjStm")throw Error(`Invalid stream object type: ${J["/Type"]}`);let Q=J["/Length"],et=B.Util.locateSequence(B.Util.STREAM,G)+B.Util.STREAM.length;et=B.Util.skipDelimiter(G,et);let it=et+Q,rt=O.extractStreamData(G.slice(et,it),J["/Filter"],O.translateDecodeParams(J));if(!J["/N"])throw Error("Invalid stream object -- no number of objects specified");if(!J["/First"])throw Error("Invalid stream object -- no offset to the first objct specified");let st=O.extractStreamObjectTable(rt,J["/N"],J["/First"]);if(!st[X])throw Error(`Object ${X} not in stream object`);let at={id:{obj:X,generation:0}},ct=rt.getData();if(K=B.Util.readNextWord(ct,st[X]),K.result&&K.result[0]===B.Util.DICT_START[0]){let dt={};at.pointer_stream_end=O.extractDictValueRec(ct,st[X],dt),at.value=dt,at.stream=rt,at.pointer_stream_start=st[X]}else if(K.result&&K.result[0]===B.Util.ARRAY_START[0]){let dt=D.ArrayUtil.extractArray(ct,st[X]);at.value=dt.result,at.stream=rt,at.pointer_stream_start=st[X]}else throw Error(`Invalid stream object type - starting with: ${K.result}`);return at}static translateDecodeParams(G){if(G.value&&G.value["/DecodeParms"]&&G.value["/DecodeParms"]["/Columns"]&&G.value["/DecodeParms"]["/Predictor"])return{columns:G.value["/DecodeParms"]["/Columns"],predictor:G.value["/DecodeParms"]["/Predictor"]}}static extractStreamObjectTable(G,X,tt){let Y={};for(let W=0;W<X;++W){let z=G.getNumber(),K=G.getNumber()+tt;Y[z]=K}return Y}static extractStreamData(G,X,tt=void 0){let Y;if(X==="/FlateDecode")Y=new F.FlateStream(G,tt);else throw Error(`Unsupported stream filter: ${X} - Only supported filter is FlateDecode (right now)`);if(!Y)throw Error("Could not derive stream");return Y}}return objectUtil.ObjectUtil=O,O.i=0,objectUtil}var documentHistory={};Object.defineProperty(documentHistory,"__esModule",{value:!0});documentHistory.DocumentHistory=documentHistory.CrossReferenceTable=documentHistory.CrossReferenceStreamObject=void 0;const util_1$6=util,object_util_1$1=requireObjectUtil();var generateDefaultTrailer=()=>({size:-1,root:{obj:-1,generation:-1},is_encrypted:!1});class CrossReferenceStreamObject{constructor(D){this.data=D,this.refs=[],this.trailer=generateDefaultTrailer(),this.streamLength=-1,this.w=[],this.index=[],this.start_pointer=0}extractCrossReferenceSection(D,F,O){let U=D;for(let G=0;G<F;++G){let X=O.getNBytesAsNumber(this.w[0]),tt;switch(X){case 0:tt={id:U++,pointer:O.getNBytesAsNumber(this.w[1]),generation:this.w[2]===0?0:O.getNBytesAsNumber(this.w[2]),free:!0,update:!1};break;case 1:tt={id:U++,pointer:O.getNBytesAsNumber(this.w[1]),generation:this.w[2]===0?0:O.getNBytesAsNumber(this.w[2]),free:!1,update:!0};break;case 2:tt={id:U++,pointer:O.getNBytesAsNumber(this.w[1]),generation:this.w[2]===0?0:O.getNBytesAsNumber(this.w[2]),free:!0,update:!1,compressed:!0};break}if(tt)this.refs.push(tt);else throw Error(`Invalid cross-reference-stream type ${X}`)}}extractStream(D){let F=this.w.reduce((O,U)=>O+U,0);if(D.getLength()!==F*this.index.filter((O,U)=>U%2===1).reduce((O,U)=>O+U,0))throw Error(`Invalid stream length - is ${D.getLength()} but should be ${F*this.index.filter((O,U)=>U%2===1).reduce((O,U)=>O+U,0)}`);if(this.index.length%2===1)throw Error(`Invalid index flag ${this.index}`);for(let O=0;O<this.index.length;O+=2)this.extractCrossReferenceSection(this.index[O],this.index[O+1],D)}extract(D){let F=D.pointer;this.start_pointer=F;let O=object_util_1$1.ObjectUtil.extractObject(this.data,D),U=util_1$6.Util.locateSequence(util_1$6.Util.ENDOBJ,this.data,F);if(this.data=this.data.slice(F,U),O.value["/Type"]!=="/XRef")throw Error(`Invalid Cross-Reference-Stream-object type: ${O.value["/Type"]}`);if(!O.value["/Size"])throw Error(`Invalid size value ${O.value["/Size"]}`);if(this.trailer.size=O.value["/Size"],O.value["/Root"]&&(this.trailer.root=O.value["/Root"]),O.value["/Prev"]&&(this.trailer.prev=O.value["/Prev"]),this.w=O.value["/W"],!this.w||this.w.length===0)throw Error("Invalid /W parameter in Cross-Reference-Stream-Object");if(this.index=O.value["/Index"],(!this.index||this.index.length===0)&&(this.index=[0,O.value["/Size"]]),!O.stream)throw Error("Missing stream at cross reference stream object");let G=O.stream;if(!G)throw Error("Invalid stream object");this.streamLength=O.value["/Length"],this.extractStream(G),this.refs.push({id:O.id.obj,pointer:this.start_pointer,generation:O.id.generation,free:!1,update:!0})}getUpdateSection(){return{start_pointer:this.start_pointer,size:this.trailer.size,prev:this.trailer.prev,root:this.trailer.root,refs:this.refs,is_encrypted:this.trailer.is_encrypted,encrypt:this.trailer.encrypt,id:this.trailer.id}}}documentHistory.CrossReferenceStreamObject=CrossReferenceStreamObject;class CrossReferenceTable{constructor(D){this.data=D,this.refs=[],this.start_pointer=-1,this.trailer=generateDefaultTrailer()}getReference(D){for(let F of this.refs)if(F.id===D)return F}getUpdateSection(){return{start_pointer:this.start_pointer,size:this.trailer.size,refs:this.refs,prev:this.trailer.prev,root:this.trailer.root,is_encrypted:this.trailer.is_encrypted,encrypt:this.trailer.encrypt,id:this.trailer.id}}extractSubSectionHeader(D){let F=util_1$6.Util.locateDelimiter(this.data,D),O=util_1$6.Util.extractNumber(this.data,D,F).result;F=util_1$6.Util.skipDelimiter(this.data,F+1);let U=F;F=util_1$6.Util.locateDelimiter(this.data,F);let G=util_1$6.Util.extractNumber(this.data,U,F).result;return{id:O,count:G,end_ptr:F}}extractReferences(D,F,O){let U=[],G={result:null,start_index:-1,end_index:D};for(let X=0;F===-1||X<F;++X){G=util_1$6.Util.readNextWord(this.data,G.end_index+1);let tt=util_1$6.Util.extractNumber(G.result,0).result;G=util_1$6.Util.readNextWord(this.data,G.end_index+1);let Y=util_1$6.Util.extractNumber(G.result,0).result;G=util_1$6.Util.readNextWord(this.data,G.end_index+1);let z=G.result[0]===102;if(U.push({id:O+X,pointer:tt,generation:Y,free:z,update:!z}),this.data[util_1$6.Util.skipSpaces(this.data,G.end_index+1)]===116)break}return{refs:U,end_index:G.end_index}}extractTrailer(D){D=util_1$6.Util.locateSequence(util_1$6.Util.DICT_START,this.data,D)+2;let F={};return object_util_1$1.ObjectUtil.extractDictKeyRec(this.data,D,F),{size:F["/Size"],root:F["/Root"],prev:F["/Prev"]?F["/Prev"]:void 0,is_encrypted:!!F["/Encrypt"],encrypt:F["/Encrypt"]?F["/Encrypt"]:void 0,id:F["/ID"]?F["/ID"]:void 0}}extract(D,F=!1){this.start_pointer=D;let O=D;F||(O+=5),O=util_1$6.Util.skipDelimiter(this.data,O);let U=O;for(;U<this.data.length&&this.data[U]!==102&&this.data[U]!==13&&this.data[U]!==10;)U++;let G={id:0,count:-1,end_ptr:O-1};(this.data[U]===10||this.data[U]===13)&&(G=this.extractSubSectionHeader(O));let X=util_1$6.Util.skipDelimiter(this.data,G.end_ptr+1),tt=this.extractReferences(X,G.count,G.id);for(this.refs=this.refs.concat(tt.refs),O=util_1$6.Util.skipSpaces(this.data,tt.end_index+1);G.count>0&&this.data[O]!==116;){let Y=this.extractSubSectionHeader(O);X=util_1$6.Util.skipDelimiter(this.data,Y.end_ptr+1);let W=this.extractReferences(X,Y.count,Y.id);this.refs=this.refs.concat(W.refs),O=util_1$6.Util.skipSpaces(this.data,W.end_index+1)}this.trailer=this.extractTrailer(O)}}documentHistory.CrossReferenceTable=CrossReferenceTable;class DocumentHistory{constructor(D){this.data=D,this.updates=[],this.trailerSize=-1,this.already_reused_ids=[],this.data=new Uint8Array(D)}extractCrossReferenceTable(D,F=!1){let O=new CrossReferenceTable(this.data);return O.extract(D,F),O}extractCrossReferenceStreamObject(D){let F=new CrossReferenceStreamObject(this.data);return F.extract(D),F}extractDocumentEntry(){let D=this.data.length-1,F=util_1$6.Util.locateSequenceReversed(util_1$6.Util.STARTXREF,this.data,D,!0)+9,O="UNKNOWN",U=util_1$6.Util.skipSpacesReverse(this.data,F-10);util_1$6.Util.areArraysEqual(this.data.slice(U-5,U+1),util_1$6.Util.ENDOBJ)?O="stream":O="trailer";let G=()=>{let X=util_1$6.Util.locateSequenceReversed(util_1$6.Util.XREF,this.data,this.data.length);for(O="trailer";X>0&&this.data[X-1]===116;)X=util_1$6.Util.locateSequenceReversed(util_1$6.Util.XREF,this.data,X-1);if(X===-1&&(O="trailer_without_xref_start",X=util_1$6.Util.locateSequenceReversed(util_1$6.Util.TRAILER,this.data,this.data.length),X>0)){for(X--;X>0&&(util_1$6.Util.isSpace(this.data[X])||util_1$6.Util.isNumber(this.data[X])||this.data[X]===110||this.data[X]===102);)--X;X=util_1$6.Util.skipSpaces(this.data,X+1)}return{pointer:X,sectionType:O}};try{D=util_1$6.Util.extractNumber(this.data,F).result}catch{return G()}return D>this.data.length||O!=="stream"&&!(this.data[D]===util_1$6.Util.XREF[0]&&this.data[D+1]===util_1$6.Util.XREF[1]&&this.data[D+2]===util_1$6.Util.XREF[2]&&this.data[D+3]===util_1$6.Util.XREF[3])?G():{pointer:D,sectionType:O}}extractDocumentHistory(){let D=this.extractDocumentEntry(),F=D.pointer;if(F===-1)throw Error("Could not locate document entry");let O={id:-1,pointer:F,generation:0,free:!1,update:!0};this.extractCrossReferenceTables(D,O);let U=util_1$6.Util.locateSequence(util_1$6.Util.VERSION,this.data,0);if(U!==0&&U!==-1)for(let G of this.updates)for(let X of G.refs)X.pointer+=U}extractCrossReferenceTables(D,F){let O=D.pointer;if(D.sectionType==="trailer"){let U=this.extractCrossReferenceTable(O);this.updates.push(U.getUpdateSection());let G=this.updates[0];for(;G.prev;)U=this.extractCrossReferenceTable(G.prev),this.updates.push(U.getUpdateSection()),G=this.updates[this.updates.length-1]}else if(D.sectionType==="stream"){let U=this.extractCrossReferenceStreamObject(F);this.updates.push(U.getUpdateSection());let G=this.updates[0];for(;G.prev;){let X={id:-1,pointer:G.prev,generation:0,free:!1,update:!0};U=this.extractCrossReferenceStreamObject(X),this.updates.push(U.getUpdateSection()),G=this.updates[this.updates.length-1]}}else if(D.sectionType==="trailer_without_xref_start"){let U=this.extractCrossReferenceTable(O,!0);this.updates.push(U.getUpdateSection());let G=this.updates[0];for(;G.prev;)U=this.extractCrossReferenceTable(G.prev),this.updates.push(U.getUpdateSection()),G=this.updates[this.updates.length-1]}else throw Error("Could not part cross reference table");this.trailerSize=this.extractReferenceNumberCount()}extractReferenceNumberCount(){let D=[],F=0;for(let O of this.updates)for(let U of O.refs)D.includes(U.id)||(F++,D.push(U.id));return F}getRecentUpdate(){return this.updates[0]}isEncrypted(){return this.getRecentUpdate().is_encrypted}createObjectLookupTable(){let D={},F=this.getRecentUpdate(),O=1;for(;Object.keys(D).length<this.extractReferenceNumberCount();){let U=F.refs;for(let G of U)D.hasOwnProperty(G.id)||(D[G.id]=G);F=this.updates[O],++O}return D}getFreeObjectId(){let D=this.createObjectLookupTable(),F=D[0];if(!F)throw Error("Crosssite reference has no header for the linked list of free objects");if(F.pointer===0){if(this.trailerSize===-1)throw Error("Trailer size not set");return{obj:this.trailerSize++,generation:0,reused:!1}}let O=F.pointer,U=[];for(;O!==0;){if(U.push(F),F=D[O],!F.free)return{obj:this.trailerSize++,generation:0,reused:!1};O=F.pointer}let X=(tt=>{for(let Y of tt.reverse())if(Y.generation<65535&&this.already_reused_ids.indexOf(Y)===-1)return Y})(U);if(X)F=X,this.already_reused_ids.push(F);else return{obj:this.trailerSize++,generation:0,reused:!1};return{obj:F.pointer,generation:D[F.id].generation,reused:!0}}}documentHistory.DocumentHistory=DocumentHistory;var crypto$2={},cryptoUtil={},cryptoJs={exports:{}},core={exports:{}},hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,function(B,D){(function(F,O){B.exports=O()})(commonjsGlobal,function(){var F=F||function(O,U){var G;if(typeof window<"u"&&window.crypto&&(G=window.crypto),typeof self<"u"&&self.crypto&&(G=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(G=globalThis.crypto),!G&&typeof window<"u"&&window.msCrypto&&(G=window.msCrypto),!G&&typeof commonjsGlobal<"u"&&commonjsGlobal.crypto&&(G=commonjsGlobal.crypto),!G&&typeof commonjsRequire=="function")try{G=require("crypto")}catch{}var X=function(){if(G){if(typeof G.getRandomValues=="function")try{return G.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof G.randomBytes=="function")try{return G.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},tt=Object.create||function(){function at(){}return function(ct){var dt;return at.prototype=ct,dt=new at,at.prototype=null,dt}}(),Y={},W=Y.lib={},z=W.Base=function(){return{extend:function(at){var ct=tt(this);return at&&ct.mixIn(at),(!ct.hasOwnProperty("init")||this.init===ct.init)&&(ct.init=function(){ct.$super.init.apply(this,arguments)}),ct.init.prototype=ct,ct.$super=this,ct},create:function(){var at=this.extend();return at.init.apply(at,arguments),at},init:function(){},mixIn:function(at){for(var ct in at)at.hasOwnProperty(ct)&&(this[ct]=at[ct]);at.hasOwnProperty("toString")&&(this.toString=at.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),K=W.WordArray=z.extend({init:function(at,ct){at=this.words=at||[],ct!=U?this.sigBytes=ct:this.sigBytes=at.length*4},toString:function(at){return(at||Q).stringify(this)},concat:function(at){var ct=this.words,dt=at.words,nt=this.sigBytes,ht=at.sigBytes;if(this.clamp(),nt%4)for(var vt=0;vt<ht;vt++){var _t=dt[vt>>>2]>>>24-vt%4*8&255;ct[nt+vt>>>2]|=_t<<24-(nt+vt)%4*8}else for(var ut=0;ut<ht;ut+=4)ct[nt+ut>>>2]=dt[ut>>>2];return this.sigBytes+=ht,this},clamp:function(){var at=this.words,ct=this.sigBytes;at[ct>>>2]&=4294967295<<32-ct%4*8,at.length=O.ceil(ct/4)},clone:function(){var at=z.clone.call(this);return at.words=this.words.slice(0),at},random:function(at){for(var ct=[],dt=0;dt<at;dt+=4)ct.push(X());return new K.init(ct,at)}}),J=Y.enc={},Q=J.Hex={stringify:function(at){for(var ct=at.words,dt=at.sigBytes,nt=[],ht=0;ht<dt;ht++){var vt=ct[ht>>>2]>>>24-ht%4*8&255;nt.push((vt>>>4).toString(16)),nt.push((vt&15).toString(16))}return nt.join("")},parse:function(at){for(var ct=at.length,dt=[],nt=0;nt<ct;nt+=2)dt[nt>>>3]|=parseInt(at.substr(nt,2),16)<<24-nt%8*4;return new K.init(dt,ct/2)}},et=J.Latin1={stringify:function(at){for(var ct=at.words,dt=at.sigBytes,nt=[],ht=0;ht<dt;ht++){var vt=ct[ht>>>2]>>>24-ht%4*8&255;nt.push(String.fromCharCode(vt))}return nt.join("")},parse:function(at){for(var ct=at.length,dt=[],nt=0;nt<ct;nt++)dt[nt>>>2]|=(at.charCodeAt(nt)&255)<<24-nt%4*8;return new K.init(dt,ct)}},it=J.Utf8={stringify:function(at){try{return decodeURIComponent(escape(et.stringify(at)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(at){return et.parse(unescape(encodeURIComponent(at)))}},rt=W.BufferedBlockAlgorithm=z.extend({reset:function(){this._data=new K.init,this._nDataBytes=0},_append:function(at){typeof at=="string"&&(at=it.parse(at)),this._data.concat(at),this._nDataBytes+=at.sigBytes},_process:function(at){var ct,dt=this._data,nt=dt.words,ht=dt.sigBytes,vt=this.blockSize,_t=vt*4,ut=ht/_t;at?ut=O.ceil(ut):ut=O.max((ut|0)-this._minBufferSize,0);var bt=ut*vt,gt=O.min(bt*4,ht);if(bt){for(var At=0;At<bt;At+=vt)this._doProcessBlock(nt,At);ct=nt.splice(0,bt),dt.sigBytes-=gt}return new K.init(ct,gt)},clone:function(){var at=z.clone.call(this);return at._data=this._data.clone(),at},_minBufferSize:0});W.Hasher=rt.extend({cfg:z.extend(),init:function(at){this.cfg=this.cfg.extend(at),this.reset()},reset:function(){rt.reset.call(this),this._doReset()},update:function(at){return this._append(at),this._process(),this},finalize:function(at){at&&this._append(at);var ct=this._doFinalize();return ct},blockSize:16,_createHelper:function(at){return function(ct,dt){return new at.init(dt).finalize(ct)}},_createHmacHelper:function(at){return function(ct,dt){return new st.HMAC.init(at,dt).finalize(ct)}}});var st=Y.algo={};return Y}(Math);return F})}(core)),core.exports}var x64Core={exports:{}},hasRequiredX64Core;function requireX64Core(){return hasRequiredX64Core||(hasRequiredX64Core=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(O){var U=F,G=U.lib,X=G.Base,tt=G.WordArray,Y=U.x64={};Y.Word=X.extend({init:function(W,z){this.high=W,this.low=z}}),Y.WordArray=X.extend({init:function(W,z){W=this.words=W||[],z!=O?this.sigBytes=z:this.sigBytes=W.length*8},toX32:function(){for(var W=this.words,z=W.length,K=[],J=0;J<z;J++){var Q=W[J];K.push(Q.high),K.push(Q.low)}return tt.create(K,this.sigBytes)},clone:function(){for(var W=X.clone.call(this),z=W.words=this.words.slice(0),K=z.length,J=0;J<K;J++)z[J]=z[J].clone();return W}})}(),F})}(x64Core)),x64Core.exports}var libTypedarrays={exports:{}},hasRequiredLibTypedarrays;function requireLibTypedarrays(){return hasRequiredLibTypedarrays||(hasRequiredLibTypedarrays=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(){if(typeof ArrayBuffer=="function"){var O=F,U=O.lib,G=U.WordArray,X=G.init,tt=G.init=function(Y){if(Y instanceof ArrayBuffer&&(Y=new Uint8Array(Y)),(Y instanceof Int8Array||typeof Uint8ClampedArray<"u"&&Y instanceof Uint8ClampedArray||Y instanceof Int16Array||Y instanceof Uint16Array||Y instanceof Int32Array||Y instanceof Uint32Array||Y instanceof Float32Array||Y instanceof Float64Array)&&(Y=new Uint8Array(Y.buffer,Y.byteOffset,Y.byteLength)),Y instanceof Uint8Array){for(var W=Y.byteLength,z=[],K=0;K<W;K++)z[K>>>2]|=Y[K]<<24-K%4*8;X.call(this,z,W)}else X.apply(this,arguments)};tt.prototype=G}}(),F.lib.WordArray})}(libTypedarrays)),libTypedarrays.exports}var encUtf16={exports:{}},hasRequiredEncUtf16;function requireEncUtf16(){return hasRequiredEncUtf16||(hasRequiredEncUtf16=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.WordArray,X=O.enc;X.Utf16=X.Utf16BE={stringify:function(Y){for(var W=Y.words,z=Y.sigBytes,K=[],J=0;J<z;J+=2){var Q=W[J>>>2]>>>16-J%4*8&65535;K.push(String.fromCharCode(Q))}return K.join("")},parse:function(Y){for(var W=Y.length,z=[],K=0;K<W;K++)z[K>>>1]|=Y.charCodeAt(K)<<16-K%2*16;return G.create(z,W*2)}},X.Utf16LE={stringify:function(Y){for(var W=Y.words,z=Y.sigBytes,K=[],J=0;J<z;J+=2){var Q=tt(W[J>>>2]>>>16-J%4*8&65535);K.push(String.fromCharCode(Q))}return K.join("")},parse:function(Y){for(var W=Y.length,z=[],K=0;K<W;K++)z[K>>>1]|=tt(Y.charCodeAt(K)<<16-K%2*16);return G.create(z,W*2)}};function tt(Y){return Y<<8&4278255360|Y>>>8&16711935}}(),F.enc.Utf16})}(encUtf16)),encUtf16.exports}var encBase64={exports:{}},hasRequiredEncBase64;function requireEncBase64(){return hasRequiredEncBase64||(hasRequiredEncBase64=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.WordArray,X=O.enc;X.Base64={stringify:function(Y){var W=Y.words,z=Y.sigBytes,K=this._map;Y.clamp();for(var J=[],Q=0;Q<z;Q+=3)for(var et=W[Q>>>2]>>>24-Q%4*8&255,it=W[Q+1>>>2]>>>24-(Q+1)%4*8&255,rt=W[Q+2>>>2]>>>24-(Q+2)%4*8&255,st=et<<16|it<<8|rt,at=0;at<4&&Q+at*.75<z;at++)J.push(K.charAt(st>>>6*(3-at)&63));var ct=K.charAt(64);if(ct)for(;J.length%4;)J.push(ct);return J.join("")},parse:function(Y){var W=Y.length,z=this._map,K=this._reverseMap;if(!K){K=this._reverseMap=[];for(var J=0;J<z.length;J++)K[z.charCodeAt(J)]=J}var Q=z.charAt(64);if(Q){var et=Y.indexOf(Q);et!==-1&&(W=et)}return tt(Y,W,K)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function tt(Y,W,z){for(var K=[],J=0,Q=0;Q<W;Q++)if(Q%4){var et=z[Y.charCodeAt(Q-1)]<<Q%4*2,it=z[Y.charCodeAt(Q)]>>>6-Q%4*2,rt=et|it;K[J>>>2]|=rt<<24-J%4*8,J++}return G.create(K,J)}}(),F.enc.Base64})}(encBase64)),encBase64.exports}var encBase64url={exports:{}},hasRequiredEncBase64url;function requireEncBase64url(){return hasRequiredEncBase64url||(hasRequiredEncBase64url=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.WordArray,X=O.enc;X.Base64url={stringify:function(Y,W){W===void 0&&(W=!0);var z=Y.words,K=Y.sigBytes,J=W?this._safe_map:this._map;Y.clamp();for(var Q=[],et=0;et<K;et+=3)for(var it=z[et>>>2]>>>24-et%4*8&255,rt=z[et+1>>>2]>>>24-(et+1)%4*8&255,st=z[et+2>>>2]>>>24-(et+2)%4*8&255,at=it<<16|rt<<8|st,ct=0;ct<4&&et+ct*.75<K;ct++)Q.push(J.charAt(at>>>6*(3-ct)&63));var dt=J.charAt(64);if(dt)for(;Q.length%4;)Q.push(dt);return Q.join("")},parse:function(Y,W){W===void 0&&(W=!0);var z=Y.length,K=W?this._safe_map:this._map,J=this._reverseMap;if(!J){J=this._reverseMap=[];for(var Q=0;Q<K.length;Q++)J[K.charCodeAt(Q)]=Q}var et=K.charAt(64);if(et){var it=Y.indexOf(et);it!==-1&&(z=it)}return tt(Y,z,J)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function tt(Y,W,z){for(var K=[],J=0,Q=0;Q<W;Q++)if(Q%4){var et=z[Y.charCodeAt(Q-1)]<<Q%4*2,it=z[Y.charCodeAt(Q)]>>>6-Q%4*2,rt=et|it;K[J>>>2]|=rt<<24-J%4*8,J++}return G.create(K,J)}}(),F.enc.Base64url})}(encBase64url)),encBase64url.exports}var md5={exports:{}},hasRequiredMd5;function requireMd5(){return hasRequiredMd5||(hasRequiredMd5=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(O){var U=F,G=U.lib,X=G.WordArray,tt=G.Hasher,Y=U.algo,W=[];(function(){for(var it=0;it<64;it++)W[it]=O.abs(O.sin(it+1))*4294967296|0})();var z=Y.MD5=tt.extend({_doReset:function(){this._hash=new X.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(it,rt){for(var st=0;st<16;st++){var at=rt+st,ct=it[at];it[at]=(ct<<8|ct>>>24)&16711935|(ct<<24|ct>>>8)&4278255360}var dt=this._hash.words,nt=it[rt+0],ht=it[rt+1],vt=it[rt+2],_t=it[rt+3],ut=it[rt+4],bt=it[rt+5],gt=it[rt+6],At=it[rt+7],St=it[rt+8],xt=it[rt+9],Pt=it[rt+10],Ft=it[rt+11],Mt=it[rt+12],Dt=it[rt+13],Ut=it[rt+14],Qt=it[rt+15],Lt=dt[0],qt=dt[1],wt=dt[2],ot=dt[3];Lt=K(Lt,qt,wt,ot,nt,7,W[0]),ot=K(ot,Lt,qt,wt,ht,12,W[1]),wt=K(wt,ot,Lt,qt,vt,17,W[2]),qt=K(qt,wt,ot,Lt,_t,22,W[3]),Lt=K(Lt,qt,wt,ot,ut,7,W[4]),ot=K(ot,Lt,qt,wt,bt,12,W[5]),wt=K(wt,ot,Lt,qt,gt,17,W[6]),qt=K(qt,wt,ot,Lt,At,22,W[7]),Lt=K(Lt,qt,wt,ot,St,7,W[8]),ot=K(ot,Lt,qt,wt,xt,12,W[9]),wt=K(wt,ot,Lt,qt,Pt,17,W[10]),qt=K(qt,wt,ot,Lt,Ft,22,W[11]),Lt=K(Lt,qt,wt,ot,Mt,7,W[12]),ot=K(ot,Lt,qt,wt,Dt,12,W[13]),wt=K(wt,ot,Lt,qt,Ut,17,W[14]),qt=K(qt,wt,ot,Lt,Qt,22,W[15]),Lt=J(Lt,qt,wt,ot,ht,5,W[16]),ot=J(ot,Lt,qt,wt,gt,9,W[17]),wt=J(wt,ot,Lt,qt,Ft,14,W[18]),qt=J(qt,wt,ot,Lt,nt,20,W[19]),Lt=J(Lt,qt,wt,ot,bt,5,W[20]),ot=J(ot,Lt,qt,wt,Pt,9,W[21]),wt=J(wt,ot,Lt,qt,Qt,14,W[22]),qt=J(qt,wt,ot,Lt,ut,20,W[23]),Lt=J(Lt,qt,wt,ot,xt,5,W[24]),ot=J(ot,Lt,qt,wt,Ut,9,W[25]),wt=J(wt,ot,Lt,qt,_t,14,W[26]),qt=J(qt,wt,ot,Lt,St,20,W[27]),Lt=J(Lt,qt,wt,ot,Dt,5,W[28]),ot=J(ot,Lt,qt,wt,vt,9,W[29]),wt=J(wt,ot,Lt,qt,At,14,W[30]),qt=J(qt,wt,ot,Lt,Mt,20,W[31]),Lt=Q(Lt,qt,wt,ot,bt,4,W[32]),ot=Q(ot,Lt,qt,wt,St,11,W[33]),wt=Q(wt,ot,Lt,qt,Ft,16,W[34]),qt=Q(qt,wt,ot,Lt,Ut,23,W[35]),Lt=Q(Lt,qt,wt,ot,ht,4,W[36]),ot=Q(ot,Lt,qt,wt,ut,11,W[37]),wt=Q(wt,ot,Lt,qt,At,16,W[38]),qt=Q(qt,wt,ot,Lt,Pt,23,W[39]),Lt=Q(Lt,qt,wt,ot,Dt,4,W[40]),ot=Q(ot,Lt,qt,wt,nt,11,W[41]),wt=Q(wt,ot,Lt,qt,_t,16,W[42]),qt=Q(qt,wt,ot,Lt,gt,23,W[43]),Lt=Q(Lt,qt,wt,ot,xt,4,W[44]),ot=Q(ot,Lt,qt,wt,Mt,11,W[45]),wt=Q(wt,ot,Lt,qt,Qt,16,W[46]),qt=Q(qt,wt,ot,Lt,vt,23,W[47]),Lt=et(Lt,qt,wt,ot,nt,6,W[48]),ot=et(ot,Lt,qt,wt,At,10,W[49]),wt=et(wt,ot,Lt,qt,Ut,15,W[50]),qt=et(qt,wt,ot,Lt,bt,21,W[51]),Lt=et(Lt,qt,wt,ot,Mt,6,W[52]),ot=et(ot,Lt,qt,wt,_t,10,W[53]),wt=et(wt,ot,Lt,qt,Pt,15,W[54]),qt=et(qt,wt,ot,Lt,ht,21,W[55]),Lt=et(Lt,qt,wt,ot,St,6,W[56]),ot=et(ot,Lt,qt,wt,Qt,10,W[57]),wt=et(wt,ot,Lt,qt,gt,15,W[58]),qt=et(qt,wt,ot,Lt,Dt,21,W[59]),Lt=et(Lt,qt,wt,ot,ut,6,W[60]),ot=et(ot,Lt,qt,wt,Ft,10,W[61]),wt=et(wt,ot,Lt,qt,vt,15,W[62]),qt=et(qt,wt,ot,Lt,xt,21,W[63]),dt[0]=dt[0]+Lt|0,dt[1]=dt[1]+qt|0,dt[2]=dt[2]+wt|0,dt[3]=dt[3]+ot|0},_doFinalize:function(){var it=this._data,rt=it.words,st=this._nDataBytes*8,at=it.sigBytes*8;rt[at>>>5]|=128<<24-at%32;var ct=O.floor(st/4294967296),dt=st;rt[(at+64>>>9<<4)+15]=(ct<<8|ct>>>24)&16711935|(ct<<24|ct>>>8)&4278255360,rt[(at+64>>>9<<4)+14]=(dt<<8|dt>>>24)&16711935|(dt<<24|dt>>>8)&4278255360,it.sigBytes=(rt.length+1)*4,this._process();for(var nt=this._hash,ht=nt.words,vt=0;vt<4;vt++){var _t=ht[vt];ht[vt]=(_t<<8|_t>>>24)&16711935|(_t<<24|_t>>>8)&4278255360}return nt},clone:function(){var it=tt.clone.call(this);return it._hash=this._hash.clone(),it}});function K(it,rt,st,at,ct,dt,nt){var ht=it+(rt&st|~rt&at)+ct+nt;return(ht<<dt|ht>>>32-dt)+rt}function J(it,rt,st,at,ct,dt,nt){var ht=it+(rt&at|st&~at)+ct+nt;return(ht<<dt|ht>>>32-dt)+rt}function Q(it,rt,st,at,ct,dt,nt){var ht=it+(rt^st^at)+ct+nt;return(ht<<dt|ht>>>32-dt)+rt}function et(it,rt,st,at,ct,dt,nt){var ht=it+(st^(rt|~at))+ct+nt;return(ht<<dt|ht>>>32-dt)+rt}U.MD5=tt._createHelper(z),U.HmacMD5=tt._createHmacHelper(z)}(Math),F.MD5})}(md5)),md5.exports}var sha1={exports:{}},hasRequiredSha1;function requireSha1(){return hasRequiredSha1||(hasRequiredSha1=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.WordArray,X=U.Hasher,tt=O.algo,Y=[],W=tt.SHA1=X.extend({_doReset:function(){this._hash=new G.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(z,K){for(var J=this._hash.words,Q=J[0],et=J[1],it=J[2],rt=J[3],st=J[4],at=0;at<80;at++){if(at<16)Y[at]=z[K+at]|0;else{var ct=Y[at-3]^Y[at-8]^Y[at-14]^Y[at-16];Y[at]=ct<<1|ct>>>31}var dt=(Q<<5|Q>>>27)+st+Y[at];at<20?dt+=(et&it|~et&rt)+1518500249:at<40?dt+=(et^it^rt)+1859775393:at<60?dt+=(et&it|et&rt|it&rt)-1894007588:dt+=(et^it^rt)-899497514,st=rt,rt=it,it=et<<30|et>>>2,et=Q,Q=dt}J[0]=J[0]+Q|0,J[1]=J[1]+et|0,J[2]=J[2]+it|0,J[3]=J[3]+rt|0,J[4]=J[4]+st|0},_doFinalize:function(){var z=this._data,K=z.words,J=this._nDataBytes*8,Q=z.sigBytes*8;return K[Q>>>5]|=128<<24-Q%32,K[(Q+64>>>9<<4)+14]=Math.floor(J/4294967296),K[(Q+64>>>9<<4)+15]=J,z.sigBytes=K.length*4,this._process(),this._hash},clone:function(){var z=X.clone.call(this);return z._hash=this._hash.clone(),z}});O.SHA1=X._createHelper(W),O.HmacSHA1=X._createHmacHelper(W)}(),F.SHA1})}(sha1)),sha1.exports}var sha256={exports:{}},hasRequiredSha256;function requireSha256(){return hasRequiredSha256||(hasRequiredSha256=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){return function(O){var U=F,G=U.lib,X=G.WordArray,tt=G.Hasher,Y=U.algo,W=[],z=[];(function(){function Q(st){for(var at=O.sqrt(st),ct=2;ct<=at;ct++)if(!(st%ct))return!1;return!0}function et(st){return(st-(st|0))*4294967296|0}for(var it=2,rt=0;rt<64;)Q(it)&&(rt<8&&(W[rt]=et(O.pow(it,1/2))),z[rt]=et(O.pow(it,1/3)),rt++),it++})();var K=[],J=Y.SHA256=tt.extend({_doReset:function(){this._hash=new X.init(W.slice(0))},_doProcessBlock:function(Q,et){for(var it=this._hash.words,rt=it[0],st=it[1],at=it[2],ct=it[3],dt=it[4],nt=it[5],ht=it[6],vt=it[7],_t=0;_t<64;_t++){if(_t<16)K[_t]=Q[et+_t]|0;else{var ut=K[_t-15],bt=(ut<<25|ut>>>7)^(ut<<14|ut>>>18)^ut>>>3,gt=K[_t-2],At=(gt<<15|gt>>>17)^(gt<<13|gt>>>19)^gt>>>10;K[_t]=bt+K[_t-7]+At+K[_t-16]}var St=dt&nt^~dt&ht,xt=rt&st^rt&at^st&at,Pt=(rt<<30|rt>>>2)^(rt<<19|rt>>>13)^(rt<<10|rt>>>22),Ft=(dt<<26|dt>>>6)^(dt<<21|dt>>>11)^(dt<<7|dt>>>25),Mt=vt+Ft+St+z[_t]+K[_t],Dt=Pt+xt;vt=ht,ht=nt,nt=dt,dt=ct+Mt|0,ct=at,at=st,st=rt,rt=Mt+Dt|0}it[0]=it[0]+rt|0,it[1]=it[1]+st|0,it[2]=it[2]+at|0,it[3]=it[3]+ct|0,it[4]=it[4]+dt|0,it[5]=it[5]+nt|0,it[6]=it[6]+ht|0,it[7]=it[7]+vt|0},_doFinalize:function(){var Q=this._data,et=Q.words,it=this._nDataBytes*8,rt=Q.sigBytes*8;return et[rt>>>5]|=128<<24-rt%32,et[(rt+64>>>9<<4)+14]=O.floor(it/4294967296),et[(rt+64>>>9<<4)+15]=it,Q.sigBytes=et.length*4,this._process(),this._hash},clone:function(){var Q=tt.clone.call(this);return Q._hash=this._hash.clone(),Q}});U.SHA256=tt._createHelper(J),U.HmacSHA256=tt._createHmacHelper(J)}(Math),F.SHA256})}(sha256)),sha256.exports}var sha224={exports:{}},hasRequiredSha224;function requireSha224(){return hasRequiredSha224||(hasRequiredSha224=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireSha256())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.WordArray,X=O.algo,tt=X.SHA256,Y=X.SHA224=tt.extend({_doReset:function(){this._hash=new G.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var W=tt._doFinalize.call(this);return W.sigBytes-=4,W}});O.SHA224=tt._createHelper(Y),O.HmacSHA224=tt._createHmacHelper(Y)}(),F.SHA224})}(sha224)),sha224.exports}var sha512={exports:{}},hasRequiredSha512;function requireSha512(){return hasRequiredSha512||(hasRequiredSha512=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireX64Core())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.Hasher,X=O.x64,tt=X.Word,Y=X.WordArray,W=O.algo;function z(){return tt.create.apply(tt,arguments)}var K=[z(1116352408,3609767458),z(1899447441,602891725),z(3049323471,3964484399),z(3921009573,2173295548),z(961987163,4081628472),z(1508970993,3053834265),z(2453635748,2937671579),z(2870763221,3664609560),z(3624381080,2734883394),z(310598401,1164996542),z(607225278,1323610764),z(1426881987,3590304994),z(1925078388,4068182383),z(2162078206,991336113),z(2614888103,633803317),z(3248222580,3479774868),z(3835390401,2666613458),z(4022224774,944711139),z(264347078,2341262773),z(604807628,2007800933),z(770255983,1495990901),z(1249150122,1856431235),z(1555081692,3175218132),z(1996064986,2198950837),z(2554220882,3999719339),z(2821834349,766784016),z(2952996808,2566594879),z(3210313671,3203337956),z(3336571891,1034457026),z(3584528711,2466948901),z(113926993,3758326383),z(338241895,168717936),z(666307205,1188179964),z(773529912,1546045734),z(1294757372,1522805485),z(1396182291,2643833823),z(1695183700,2343527390),z(1986661051,1014477480),z(2177026350,1206759142),z(2456956037,344077627),z(2730485921,1290863460),z(2820302411,3158454273),z(3259730800,3505952657),z(3345764771,106217008),z(3516065817,3606008344),z(3600352804,1432725776),z(4094571909,1467031594),z(275423344,851169720),z(430227734,3100823752),z(506948616,1363258195),z(659060556,3750685593),z(883997877,3785050280),z(958139571,3318307427),z(1322822218,3812723403),z(1537002063,2003034995),z(1747873779,3602036899),z(1955562222,1575990012),z(2024104815,1125592928),z(2227730452,2716904306),z(2361852424,442776044),z(2428436474,593698344),z(2756734187,3733110249),z(3204031479,2999351573),z(3329325298,3815920427),z(3391569614,3928383900),z(3515267271,566280711),z(3940187606,3454069534),z(4118630271,4000239992),z(116418474,1914138554),z(174292421,2731055270),z(289380356,3203993006),z(460393269,320620315),z(685471733,587496836),z(852142971,1086792851),z(1017036298,365543100),z(1126000580,2618297676),z(1288033470,3409855158),z(1501505948,4234509866),z(1607167915,987167468),z(1816402316,1246189591)],J=[];(function(){for(var et=0;et<80;et++)J[et]=z()})();var Q=W.SHA512=G.extend({_doReset:function(){this._hash=new Y.init([new tt.init(1779033703,4089235720),new tt.init(3144134277,2227873595),new tt.init(1013904242,4271175723),new tt.init(2773480762,1595750129),new tt.init(1359893119,2917565137),new tt.init(2600822924,725511199),new tt.init(528734635,4215389547),new tt.init(1541459225,327033209)])},_doProcessBlock:function(et,it){for(var rt=this._hash.words,st=rt[0],at=rt[1],ct=rt[2],dt=rt[3],nt=rt[4],ht=rt[5],vt=rt[6],_t=rt[7],ut=st.high,bt=st.low,gt=at.high,At=at.low,St=ct.high,xt=ct.low,Pt=dt.high,Ft=dt.low,Mt=nt.high,Dt=nt.low,Ut=ht.high,Qt=ht.low,Lt=vt.high,qt=vt.low,wt=_t.high,ot=_t.low,mt=ut,pt=bt,Et=gt,yt=At,Tt=St,kt=xt,Bt=Pt,Yt=Ft,zt=Mt,Zt=Dt,ee=Ut,he=Qt,ne=Lt,be=qt,Ce=wt,de=ot,xe=0;xe<80;xe++){var se,Gt,Vt=J[xe];if(xe<16)Gt=Vt.high=et[it+xe*2]|0,se=Vt.low=et[it+xe*2+1]|0;else{var ie=J[xe-15],fe=ie.high,pe=ie.low,Te=(fe>>>1|pe<<31)^(fe>>>8|pe<<24)^fe>>>7,ke=(pe>>>1|fe<<31)^(pe>>>8|fe<<24)^(pe>>>7|fe<<25),Pe=J[xe-2],Re=Pe.high,Oe=Pe.low,Fe=(Re>>>19|Oe<<13)^(Re<<3|Oe>>>29)^Re>>>6,Me=(Oe>>>19|Re<<13)^(Oe<<3|Re>>>29)^(Oe>>>6|Re<<26),te=J[xe-7],Xt=te.high,jt=te.low,ae=J[xe-16],ce=ae.high,We=ae.low;se=ke+jt,Gt=Te+Xt+(se>>>0<ke>>>0?1:0),se=se+Me,Gt=Gt+Fe+(se>>>0<Me>>>0?1:0),se=se+We,Gt=Gt+ce+(se>>>0<We>>>0?1:0),Vt.high=Gt,Vt.low=se}var je=zt&ee^~zt&ne,Ht=Zt&he^~Zt&be,ue=mt&Et^mt&Tt^Et&Tt,Ee=pt&yt^pt&kt^yt&kt,ge=(mt>>>28|pt<<4)^(mt<<30|pt>>>2)^(mt<<25|pt>>>7),Se=(pt>>>28|mt<<4)^(pt<<30|mt>>>2)^(pt<<25|mt>>>7),we=(zt>>>14|Zt<<18)^(zt>>>18|Zt<<14)^(zt<<23|Zt>>>9),Ne=(Zt>>>14|zt<<18)^(Zt>>>18|zt<<14)^(Zt<<23|zt>>>9),le=K[xe],Ue=le.high,ye=le.low,Rt=de+Ne,ft=Ce+we+(Rt>>>0<de>>>0?1:0),Rt=Rt+Ht,ft=ft+je+(Rt>>>0<Ht>>>0?1:0),Rt=Rt+ye,ft=ft+Ue+(Rt>>>0<ye>>>0?1:0),Rt=Rt+se,ft=ft+Gt+(Rt>>>0<se>>>0?1:0),Ct=Se+Ee,Ot=ge+ue+(Ct>>>0<Se>>>0?1:0);Ce=ne,de=be,ne=ee,be=he,ee=zt,he=Zt,Zt=Yt+Rt|0,zt=Bt+ft+(Zt>>>0<Yt>>>0?1:0)|0,Bt=Tt,Yt=kt,Tt=Et,kt=yt,Et=mt,yt=pt,pt=Rt+Ct|0,mt=ft+Ot+(pt>>>0<Rt>>>0?1:0)|0}bt=st.low=bt+pt,st.high=ut+mt+(bt>>>0<pt>>>0?1:0),At=at.low=At+yt,at.high=gt+Et+(At>>>0<yt>>>0?1:0),xt=ct.low=xt+kt,ct.high=St+Tt+(xt>>>0<kt>>>0?1:0),Ft=dt.low=Ft+Yt,dt.high=Pt+Bt+(Ft>>>0<Yt>>>0?1:0),Dt=nt.low=Dt+Zt,nt.high=Mt+zt+(Dt>>>0<Zt>>>0?1:0),Qt=ht.low=Qt+he,ht.high=Ut+ee+(Qt>>>0<he>>>0?1:0),qt=vt.low=qt+be,vt.high=Lt+ne+(qt>>>0<be>>>0?1:0),ot=_t.low=ot+de,_t.high=wt+Ce+(ot>>>0<de>>>0?1:0)},_doFinalize:function(){var et=this._data,it=et.words,rt=this._nDataBytes*8,st=et.sigBytes*8;it[st>>>5]|=128<<24-st%32,it[(st+128>>>10<<5)+30]=Math.floor(rt/4294967296),it[(st+128>>>10<<5)+31]=rt,et.sigBytes=it.length*4,this._process();var at=this._hash.toX32();return at},clone:function(){var et=G.clone.call(this);return et._hash=this._hash.clone(),et},blockSize:1024/32});O.SHA512=G._createHelper(Q),O.HmacSHA512=G._createHmacHelper(Q)}(),F.SHA512})}(sha512)),sha512.exports}var sha384={exports:{}},hasRequiredSha384;function requireSha384(){return hasRequiredSha384||(hasRequiredSha384=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireX64Core(),requireSha512())})(commonjsGlobal,function(F){return function(){var O=F,U=O.x64,G=U.Word,X=U.WordArray,tt=O.algo,Y=tt.SHA512,W=tt.SHA384=Y.extend({_doReset:function(){this._hash=new X.init([new G.init(3418070365,3238371032),new G.init(1654270250,914150663),new G.init(2438529370,812702999),new G.init(355462360,4144912697),new G.init(1731405415,4290775857),new G.init(2394180231,1750603025),new G.init(3675008525,1694076839),new G.init(1203062813,3204075428)])},_doFinalize:function(){var z=Y._doFinalize.call(this);return z.sigBytes-=16,z}});O.SHA384=Y._createHelper(W),O.HmacSHA384=Y._createHmacHelper(W)}(),F.SHA384})}(sha384)),sha384.exports}var sha3={exports:{}},hasRequiredSha3;function requireSha3(){return hasRequiredSha3||(hasRequiredSha3=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireX64Core())})(commonjsGlobal,function(F){return function(O){var U=F,G=U.lib,X=G.WordArray,tt=G.Hasher,Y=U.x64,W=Y.Word,z=U.algo,K=[],J=[],Q=[];(function(){for(var rt=1,st=0,at=0;at<24;at++){K[rt+5*st]=(at+1)*(at+2)/2%64;var ct=st%5,dt=(2*rt+3*st)%5;rt=ct,st=dt}for(var rt=0;rt<5;rt++)for(var st=0;st<5;st++)J[rt+5*st]=st+(2*rt+3*st)%5*5;for(var nt=1,ht=0;ht<24;ht++){for(var vt=0,_t=0,ut=0;ut<7;ut++){if(nt&1){var bt=(1<<ut)-1;bt<32?_t^=1<<bt:vt^=1<<bt-32}nt&128?nt=nt<<1^113:nt<<=1}Q[ht]=W.create(vt,_t)}})();var et=[];(function(){for(var rt=0;rt<25;rt++)et[rt]=W.create()})();var it=z.SHA3=tt.extend({cfg:tt.cfg.extend({outputLength:512}),_doReset:function(){for(var rt=this._state=[],st=0;st<25;st++)rt[st]=new W.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(rt,st){for(var at=this._state,ct=this.blockSize/2,dt=0;dt<ct;dt++){var nt=rt[st+2*dt],ht=rt[st+2*dt+1];nt=(nt<<8|nt>>>24)&16711935|(nt<<24|nt>>>8)&4278255360,ht=(ht<<8|ht>>>24)&16711935|(ht<<24|ht>>>8)&4278255360;var vt=at[dt];vt.high^=ht,vt.low^=nt}for(var _t=0;_t<24;_t++){for(var ut=0;ut<5;ut++){for(var bt=0,gt=0,At=0;At<5;At++){var vt=at[ut+5*At];bt^=vt.high,gt^=vt.low}var St=et[ut];St.high=bt,St.low=gt}for(var ut=0;ut<5;ut++)for(var xt=et[(ut+4)%5],Pt=et[(ut+1)%5],Ft=Pt.high,Mt=Pt.low,bt=xt.high^(Ft<<1|Mt>>>31),gt=xt.low^(Mt<<1|Ft>>>31),At=0;At<5;At++){var vt=at[ut+5*At];vt.high^=bt,vt.low^=gt}for(var Dt=1;Dt<25;Dt++){var bt,gt,vt=at[Dt],Ut=vt.high,Qt=vt.low,Lt=K[Dt];Lt<32?(bt=Ut<<Lt|Qt>>>32-Lt,gt=Qt<<Lt|Ut>>>32-Lt):(bt=Qt<<Lt-32|Ut>>>64-Lt,gt=Ut<<Lt-32|Qt>>>64-Lt);var qt=et[J[Dt]];qt.high=bt,qt.low=gt}var wt=et[0],ot=at[0];wt.high=ot.high,wt.low=ot.low;for(var ut=0;ut<5;ut++)for(var At=0;At<5;At++){var Dt=ut+5*At,vt=at[Dt],mt=et[Dt],pt=et[(ut+1)%5+5*At],Et=et[(ut+2)%5+5*At];vt.high=mt.high^~pt.high&Et.high,vt.low=mt.low^~pt.low&Et.low}var vt=at[0],yt=Q[_t];vt.high^=yt.high,vt.low^=yt.low}},_doFinalize:function(){var rt=this._data,st=rt.words;this._nDataBytes*8;var at=rt.sigBytes*8,ct=this.blockSize*32;st[at>>>5]|=1<<24-at%32,st[(O.ceil((at+1)/ct)*ct>>>5)-1]|=128,rt.sigBytes=st.length*4,this._process();for(var dt=this._state,nt=this.cfg.outputLength/8,ht=nt/8,vt=[],_t=0;_t<ht;_t++){var ut=dt[_t],bt=ut.high,gt=ut.low;bt=(bt<<8|bt>>>24)&16711935|(bt<<24|bt>>>8)&4278255360,gt=(gt<<8|gt>>>24)&16711935|(gt<<24|gt>>>8)&4278255360,vt.push(gt),vt.push(bt)}return new X.init(vt,nt)},clone:function(){for(var rt=tt.clone.call(this),st=rt._state=this._state.slice(0),at=0;at<25;at++)st[at]=st[at].clone();return rt}});U.SHA3=tt._createHelper(it),U.HmacSHA3=tt._createHmacHelper(it)}(Math),F.SHA3})}(sha3)),sha3.exports}var ripemd160={exports:{}},hasRequiredRipemd160;function requireRipemd160(){return hasRequiredRipemd160||(hasRequiredRipemd160=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(O){var U=F,G=U.lib,X=G.WordArray,tt=G.Hasher,Y=U.algo,W=X.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),z=X.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),K=X.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),J=X.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),Q=X.create([0,1518500249,1859775393,2400959708,2840853838]),et=X.create([1352829926,1548603684,1836072691,2053994217,0]),it=Y.RIPEMD160=tt.extend({_doReset:function(){this._hash=X.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(ht,vt){for(var _t=0;_t<16;_t++){var ut=vt+_t,bt=ht[ut];ht[ut]=(bt<<8|bt>>>24)&16711935|(bt<<24|bt>>>8)&4278255360}var gt=this._hash.words,At=Q.words,St=et.words,xt=W.words,Pt=z.words,Ft=K.words,Mt=J.words,Dt,Ut,Qt,Lt,qt,wt,ot,mt,pt,Et;wt=Dt=gt[0],ot=Ut=gt[1],mt=Qt=gt[2],pt=Lt=gt[3],Et=qt=gt[4];for(var yt,_t=0;_t<80;_t+=1)yt=Dt+ht[vt+xt[_t]]|0,_t<16?yt+=rt(Ut,Qt,Lt)+At[0]:_t<32?yt+=st(Ut,Qt,Lt)+At[1]:_t<48?yt+=at(Ut,Qt,Lt)+At[2]:_t<64?yt+=ct(Ut,Qt,Lt)+At[3]:yt+=dt(Ut,Qt,Lt)+At[4],yt=yt|0,yt=nt(yt,Ft[_t]),yt=yt+qt|0,Dt=qt,qt=Lt,Lt=nt(Qt,10),Qt=Ut,Ut=yt,yt=wt+ht[vt+Pt[_t]]|0,_t<16?yt+=dt(ot,mt,pt)+St[0]:_t<32?yt+=ct(ot,mt,pt)+St[1]:_t<48?yt+=at(ot,mt,pt)+St[2]:_t<64?yt+=st(ot,mt,pt)+St[3]:yt+=rt(ot,mt,pt)+St[4],yt=yt|0,yt=nt(yt,Mt[_t]),yt=yt+Et|0,wt=Et,Et=pt,pt=nt(mt,10),mt=ot,ot=yt;yt=gt[1]+Qt+pt|0,gt[1]=gt[2]+Lt+Et|0,gt[2]=gt[3]+qt+wt|0,gt[3]=gt[4]+Dt+ot|0,gt[4]=gt[0]+Ut+mt|0,gt[0]=yt},_doFinalize:function(){var ht=this._data,vt=ht.words,_t=this._nDataBytes*8,ut=ht.sigBytes*8;vt[ut>>>5]|=128<<24-ut%32,vt[(ut+64>>>9<<4)+14]=(_t<<8|_t>>>24)&16711935|(_t<<24|_t>>>8)&4278255360,ht.sigBytes=(vt.length+1)*4,this._process();for(var bt=this._hash,gt=bt.words,At=0;At<5;At++){var St=gt[At];gt[At]=(St<<8|St>>>24)&16711935|(St<<24|St>>>8)&4278255360}return bt},clone:function(){var ht=tt.clone.call(this);return ht._hash=this._hash.clone(),ht}});function rt(ht,vt,_t){return ht^vt^_t}function st(ht,vt,_t){return ht&vt|~ht&_t}function at(ht,vt,_t){return(ht|~vt)^_t}function ct(ht,vt,_t){return ht&_t|vt&~_t}function dt(ht,vt,_t){return ht^(vt|~_t)}function nt(ht,vt){return ht<<vt|ht>>>32-vt}U.RIPEMD160=tt._createHelper(it),U.HmacRIPEMD160=tt._createHmacHelper(it)}(),F.RIPEMD160})}(ripemd160)),ripemd160.exports}var hmac={exports:{}},hasRequiredHmac;function requireHmac(){return hasRequiredHmac||(hasRequiredHmac=1,function(B,D){(function(F,O){B.exports=O(requireCore())})(commonjsGlobal,function(F){(function(){var O=F,U=O.lib,G=U.Base,X=O.enc,tt=X.Utf8,Y=O.algo;Y.HMAC=G.extend({init:function(W,z){W=this._hasher=new W.init,typeof z=="string"&&(z=tt.parse(z));var K=W.blockSize,J=K*4;z.sigBytes>J&&(z=W.finalize(z)),z.clamp();for(var Q=this._oKey=z.clone(),et=this._iKey=z.clone(),it=Q.words,rt=et.words,st=0;st<K;st++)it[st]^=1549556828,rt[st]^=909522486;Q.sigBytes=et.sigBytes=J,this.reset()},reset:function(){var W=this._hasher;W.reset(),W.update(this._iKey)},update:function(W){return this._hasher.update(W),this},finalize:function(W){var z=this._hasher,K=z.finalize(W);z.reset();var J=z.finalize(this._oKey.clone().concat(K));return J}})})()})}(hmac)),hmac.exports}var pbkdf2={exports:{}},hasRequiredPbkdf2;function requirePbkdf2(){return hasRequiredPbkdf2||(hasRequiredPbkdf2=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireSha256(),requireHmac())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.Base,X=U.WordArray,tt=O.algo,Y=tt.SHA256,W=tt.HMAC,z=tt.PBKDF2=G.extend({cfg:G.extend({keySize:128/32,hasher:Y,iterations:25e4}),init:function(K){this.cfg=this.cfg.extend(K)},compute:function(K,J){for(var Q=this.cfg,et=W.create(Q.hasher,K),it=X.create(),rt=X.create([1]),st=it.words,at=rt.words,ct=Q.keySize,dt=Q.iterations;st.length<ct;){var nt=et.update(J).finalize(rt);et.reset();for(var ht=nt.words,vt=ht.length,_t=nt,ut=1;ut<dt;ut++){_t=et.finalize(_t),et.reset();for(var bt=_t.words,gt=0;gt<vt;gt++)ht[gt]^=bt[gt]}it.concat(nt),at[0]++}return it.sigBytes=ct*4,it}});O.PBKDF2=function(K,J,Q){return z.create(Q).compute(K,J)}}(),F.PBKDF2})}(pbkdf2)),pbkdf2.exports}var evpkdf={exports:{}},hasRequiredEvpkdf;function requireEvpkdf(){return hasRequiredEvpkdf||(hasRequiredEvpkdf=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireSha1(),requireHmac())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.Base,X=U.WordArray,tt=O.algo,Y=tt.MD5,W=tt.EvpKDF=G.extend({cfg:G.extend({keySize:128/32,hasher:Y,iterations:1}),init:function(z){this.cfg=this.cfg.extend(z)},compute:function(z,K){for(var J,Q=this.cfg,et=Q.hasher.create(),it=X.create(),rt=it.words,st=Q.keySize,at=Q.iterations;rt.length<st;){J&&et.update(J),J=et.update(z).finalize(K),et.reset();for(var ct=1;ct<at;ct++)J=et.finalize(J),et.reset();it.concat(J)}return it.sigBytes=st*4,it}});O.EvpKDF=function(z,K,J){return W.create(J).compute(z,K)}}(),F.EvpKDF})}(evpkdf)),evpkdf.exports}var cipherCore={exports:{}},hasRequiredCipherCore;function requireCipherCore(){return hasRequiredCipherCore||(hasRequiredCipherCore=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireEvpkdf())})(commonjsGlobal,function(F){F.lib.Cipher||function(O){var U=F,G=U.lib,X=G.Base,tt=G.WordArray,Y=G.BufferedBlockAlgorithm,W=U.enc;W.Utf8;var z=W.Base64,K=U.algo,J=K.EvpKDF,Q=G.Cipher=Y.extend({cfg:X.extend(),createEncryptor:function(bt,gt){return this.create(this._ENC_XFORM_MODE,bt,gt)},createDecryptor:function(bt,gt){return this.create(this._DEC_XFORM_MODE,bt,gt)},init:function(bt,gt,At){this.cfg=this.cfg.extend(At),this._xformMode=bt,this._key=gt,this.reset()},reset:function(){Y.reset.call(this),this._doReset()},process:function(bt){return this._append(bt),this._process()},finalize:function(bt){bt&&this._append(bt);var gt=this._doFinalize();return gt},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function bt(gt){return typeof gt=="string"?ut:ht}return function(gt){return{encrypt:function(At,St,xt){return bt(St).encrypt(gt,At,St,xt)},decrypt:function(At,St,xt){return bt(St).decrypt(gt,At,St,xt)}}}}()});G.StreamCipher=Q.extend({_doFinalize:function(){var bt=this._process(!0);return bt},blockSize:1});var et=U.mode={},it=G.BlockCipherMode=X.extend({createEncryptor:function(bt,gt){return this.Encryptor.create(bt,gt)},createDecryptor:function(bt,gt){return this.Decryptor.create(bt,gt)},init:function(bt,gt){this._cipher=bt,this._iv=gt}}),rt=et.CBC=function(){var bt=it.extend();bt.Encryptor=bt.extend({processBlock:function(At,St){var xt=this._cipher,Pt=xt.blockSize;gt.call(this,At,St,Pt),xt.encryptBlock(At,St),this._prevBlock=At.slice(St,St+Pt)}}),bt.Decryptor=bt.extend({processBlock:function(At,St){var xt=this._cipher,Pt=xt.blockSize,Ft=At.slice(St,St+Pt);xt.decryptBlock(At,St),gt.call(this,At,St,Pt),this._prevBlock=Ft}});function gt(At,St,xt){var Pt,Ft=this._iv;Ft?(Pt=Ft,this._iv=O):Pt=this._prevBlock;for(var Mt=0;Mt<xt;Mt++)At[St+Mt]^=Pt[Mt]}return bt}(),st=U.pad={},at=st.Pkcs7={pad:function(bt,gt){for(var At=gt*4,St=At-bt.sigBytes%At,xt=St<<24|St<<16|St<<8|St,Pt=[],Ft=0;Ft<St;Ft+=4)Pt.push(xt);var Mt=tt.create(Pt,St);bt.concat(Mt)},unpad:function(bt){var gt=bt.words[bt.sigBytes-1>>>2]&255;bt.sigBytes-=gt}};G.BlockCipher=Q.extend({cfg:Q.cfg.extend({mode:rt,padding:at}),reset:function(){var bt;Q.reset.call(this);var gt=this.cfg,At=gt.iv,St=gt.mode;this._xformMode==this._ENC_XFORM_MODE?bt=St.createEncryptor:(bt=St.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==bt?this._mode.init(this,At&&At.words):(this._mode=bt.call(St,this,At&&At.words),this._mode.__creator=bt)},_doProcessBlock:function(bt,gt){this._mode.processBlock(bt,gt)},_doFinalize:function(){var bt,gt=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(gt.pad(this._data,this.blockSize),bt=this._process(!0)):(bt=this._process(!0),gt.unpad(bt)),bt},blockSize:128/32});var ct=G.CipherParams=X.extend({init:function(bt){this.mixIn(bt)},toString:function(bt){return(bt||this.formatter).stringify(this)}}),dt=U.format={},nt=dt.OpenSSL={stringify:function(bt){var gt,At=bt.ciphertext,St=bt.salt;return St?gt=tt.create([1398893684,1701076831]).concat(St).concat(At):gt=At,gt.toString(z)},parse:function(bt){var gt,At=z.parse(bt),St=At.words;return St[0]==1398893684&&St[1]==1701076831&&(gt=tt.create(St.slice(2,4)),St.splice(0,4),At.sigBytes-=16),ct.create({ciphertext:At,salt:gt})}},ht=G.SerializableCipher=X.extend({cfg:X.extend({format:nt}),encrypt:function(bt,gt,At,St){St=this.cfg.extend(St);var xt=bt.createEncryptor(At,St),Pt=xt.finalize(gt),Ft=xt.cfg;return ct.create({ciphertext:Pt,key:At,iv:Ft.iv,algorithm:bt,mode:Ft.mode,padding:Ft.padding,blockSize:bt.blockSize,formatter:St.format})},decrypt:function(bt,gt,At,St){St=this.cfg.extend(St),gt=this._parse(gt,St.format);var xt=bt.createDecryptor(At,St).finalize(gt.ciphertext);return xt},_parse:function(bt,gt){return typeof bt=="string"?gt.parse(bt,this):bt}}),vt=U.kdf={},_t=vt.OpenSSL={execute:function(bt,gt,At,St,xt){if(St||(St=tt.random(64/8)),xt)var Pt=J.create({keySize:gt+At,hasher:xt}).compute(bt,St);else var Pt=J.create({keySize:gt+At}).compute(bt,St);var Ft=tt.create(Pt.words.slice(gt),At*4);return Pt.sigBytes=gt*4,ct.create({key:Pt,iv:Ft,salt:St})}},ut=G.PasswordBasedCipher=ht.extend({cfg:ht.cfg.extend({kdf:_t}),encrypt:function(bt,gt,At,St){St=this.cfg.extend(St);var xt=St.kdf.execute(At,bt.keySize,bt.ivSize,St.salt,St.hasher);St.iv=xt.iv;var Pt=ht.encrypt.call(this,bt,gt,xt.key,St);return Pt.mixIn(xt),Pt},decrypt:function(bt,gt,At,St){St=this.cfg.extend(St),gt=this._parse(gt,St.format);var xt=St.kdf.execute(At,bt.keySize,bt.ivSize,gt.salt,St.hasher);St.iv=xt.iv;var Pt=ht.decrypt.call(this,bt,gt,xt.key,St);return Pt}})}()})}(cipherCore)),cipherCore.exports}var modeCfb={exports:{}},hasRequiredModeCfb;function requireModeCfb(){return hasRequiredModeCfb||(hasRequiredModeCfb=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.mode.CFB=function(){var O=F.lib.BlockCipherMode.extend();O.Encryptor=O.extend({processBlock:function(G,X){var tt=this._cipher,Y=tt.blockSize;U.call(this,G,X,Y,tt),this._prevBlock=G.slice(X,X+Y)}}),O.Decryptor=O.extend({processBlock:function(G,X){var tt=this._cipher,Y=tt.blockSize,W=G.slice(X,X+Y);U.call(this,G,X,Y,tt),this._prevBlock=W}});function U(G,X,tt,Y){var W,z=this._iv;z?(W=z.slice(0),this._iv=void 0):W=this._prevBlock,Y.encryptBlock(W,0);for(var K=0;K<tt;K++)G[X+K]^=W[K]}return O}(),F.mode.CFB})}(modeCfb)),modeCfb.exports}var modeCtr={exports:{}},hasRequiredModeCtr;function requireModeCtr(){return hasRequiredModeCtr||(hasRequiredModeCtr=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.mode.CTR=function(){var O=F.lib.BlockCipherMode.extend(),U=O.Encryptor=O.extend({processBlock:function(G,X){var tt=this._cipher,Y=tt.blockSize,W=this._iv,z=this._counter;W&&(z=this._counter=W.slice(0),this._iv=void 0);var K=z.slice(0);tt.encryptBlock(K,0),z[Y-1]=z[Y-1]+1|0;for(var J=0;J<Y;J++)G[X+J]^=K[J]}});return O.Decryptor=U,O}(),F.mode.CTR})}(modeCtr)),modeCtr.exports}var modeCtrGladman={exports:{}},hasRequiredModeCtrGladman;function requireModeCtrGladman(){return hasRequiredModeCtrGladman||(hasRequiredModeCtrGladman=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return F.mode.CTRGladman=function(){var O=F.lib.BlockCipherMode.extend();function U(tt){if((tt>>24&255)===255){var Y=tt>>16&255,W=tt>>8&255,z=tt&255;Y===255?(Y=0,W===255?(W=0,z===255?z=0:++z):++W):++Y,tt=0,tt+=Y<<16,tt+=W<<8,tt+=z}else tt+=1<<24;return tt}function G(tt){return(tt[0]=U(tt[0]))===0&&(tt[1]=U(tt[1])),tt}var X=O.Encryptor=O.extend({processBlock:function(tt,Y){var W=this._cipher,z=W.blockSize,K=this._iv,J=this._counter;K&&(J=this._counter=K.slice(0),this._iv=void 0),G(J);var Q=J.slice(0);W.encryptBlock(Q,0);for(var et=0;et<z;et++)tt[Y+et]^=Q[et]}});return O.Decryptor=X,O}(),F.mode.CTRGladman})}(modeCtrGladman)),modeCtrGladman.exports}var modeOfb={exports:{}},hasRequiredModeOfb;function requireModeOfb(){return hasRequiredModeOfb||(hasRequiredModeOfb=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.mode.OFB=function(){var O=F.lib.BlockCipherMode.extend(),U=O.Encryptor=O.extend({processBlock:function(G,X){var tt=this._cipher,Y=tt.blockSize,W=this._iv,z=this._keystream;W&&(z=this._keystream=W.slice(0),this._iv=void 0),tt.encryptBlock(z,0);for(var K=0;K<Y;K++)G[X+K]^=z[K]}});return O.Decryptor=U,O}(),F.mode.OFB})}(modeOfb)),modeOfb.exports}var modeEcb={exports:{}},hasRequiredModeEcb;function requireModeEcb(){return hasRequiredModeEcb||(hasRequiredModeEcb=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.mode.ECB=function(){var O=F.lib.BlockCipherMode.extend();return O.Encryptor=O.extend({processBlock:function(U,G){this._cipher.encryptBlock(U,G)}}),O.Decryptor=O.extend({processBlock:function(U,G){this._cipher.decryptBlock(U,G)}}),O}(),F.mode.ECB})}(modeEcb)),modeEcb.exports}var padAnsix923={exports:{}},hasRequiredPadAnsix923;function requirePadAnsix923(){return hasRequiredPadAnsix923||(hasRequiredPadAnsix923=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.pad.AnsiX923={pad:function(O,U){var G=O.sigBytes,X=U*4,tt=X-G%X,Y=G+tt-1;O.clamp(),O.words[Y>>>2]|=tt<<24-Y%4*8,O.sigBytes+=tt},unpad:function(O){var U=O.words[O.sigBytes-1>>>2]&255;O.sigBytes-=U}},F.pad.Ansix923})}(padAnsix923)),padAnsix923.exports}var padIso10126={exports:{}},hasRequiredPadIso10126;function requirePadIso10126(){return hasRequiredPadIso10126||(hasRequiredPadIso10126=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.pad.Iso10126={pad:function(O,U){var G=U*4,X=G-O.sigBytes%G;O.concat(F.lib.WordArray.random(X-1)).concat(F.lib.WordArray.create([X<<24],1))},unpad:function(O){var U=O.words[O.sigBytes-1>>>2]&255;O.sigBytes-=U}},F.pad.Iso10126})}(padIso10126)),padIso10126.exports}var padIso97971={exports:{}},hasRequiredPadIso97971;function requirePadIso97971(){return hasRequiredPadIso97971||(hasRequiredPadIso97971=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.pad.Iso97971={pad:function(O,U){O.concat(F.lib.WordArray.create([2147483648],1)),F.pad.ZeroPadding.pad(O,U)},unpad:function(O){F.pad.ZeroPadding.unpad(O),O.sigBytes--}},F.pad.Iso97971})}(padIso97971)),padIso97971.exports}var padZeropadding={exports:{}},hasRequiredPadZeropadding;function requirePadZeropadding(){return hasRequiredPadZeropadding||(hasRequiredPadZeropadding=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.pad.ZeroPadding={pad:function(O,U){var G=U*4;O.clamp(),O.sigBytes+=G-(O.sigBytes%G||G)},unpad:function(O){for(var U=O.words,G=O.sigBytes-1,G=O.sigBytes-1;G>=0;G--)if(U[G>>>2]>>>24-G%4*8&255){O.sigBytes=G+1;break}}},F.pad.ZeroPadding})}(padZeropadding)),padZeropadding.exports}var padNopadding={exports:{}},hasRequiredPadNopadding;function requirePadNopadding(){return hasRequiredPadNopadding||(hasRequiredPadNopadding=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return F.pad.NoPadding={pad:function(){},unpad:function(){}},F.pad.NoPadding})}(padNopadding)),padNopadding.exports}var formatHex={exports:{}},hasRequiredFormatHex;function requireFormatHex(){return hasRequiredFormatHex||(hasRequiredFormatHex=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireCipherCore())})(commonjsGlobal,function(F){return function(O){var U=F,G=U.lib,X=G.CipherParams,tt=U.enc,Y=tt.Hex,W=U.format;W.Hex={stringify:function(z){return z.ciphertext.toString(Y)},parse:function(z){var K=Y.parse(z);return X.create({ciphertext:K})}}}(),F.format.Hex})}(formatHex)),formatHex.exports}var aes={exports:{}},hasRequiredAes;function requireAes(){return hasRequiredAes||(hasRequiredAes=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.BlockCipher,X=O.algo,tt=[],Y=[],W=[],z=[],K=[],J=[],Q=[],et=[],it=[],rt=[];(function(){for(var ct=[],dt=0;dt<256;dt++)dt<128?ct[dt]=dt<<1:ct[dt]=dt<<1^283;for(var nt=0,ht=0,dt=0;dt<256;dt++){var vt=ht^ht<<1^ht<<2^ht<<3^ht<<4;vt=vt>>>8^vt&255^99,tt[nt]=vt,Y[vt]=nt;var _t=ct[nt],ut=ct[_t],bt=ct[ut],gt=ct[vt]*257^vt*16843008;W[nt]=gt<<24|gt>>>8,z[nt]=gt<<16|gt>>>16,K[nt]=gt<<8|gt>>>24,J[nt]=gt;var gt=bt*16843009^ut*65537^_t*257^nt*16843008;Q[vt]=gt<<24|gt>>>8,et[vt]=gt<<16|gt>>>16,it[vt]=gt<<8|gt>>>24,rt[vt]=gt,nt?(nt=_t^ct[ct[ct[bt^_t]]],ht^=ct[ct[ht]]):nt=ht=1}})();var st=[0,1,2,4,8,16,32,64,128,27,54],at=X.AES=G.extend({_doReset:function(){var ct;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var dt=this._keyPriorReset=this._key,nt=dt.words,ht=dt.sigBytes/4,vt=this._nRounds=ht+6,_t=(vt+1)*4,ut=this._keySchedule=[],bt=0;bt<_t;bt++)bt<ht?ut[bt]=nt[bt]:(ct=ut[bt-1],bt%ht?ht>6&&bt%ht==4&&(ct=tt[ct>>>24]<<24|tt[ct>>>16&255]<<16|tt[ct>>>8&255]<<8|tt[ct&255]):(ct=ct<<8|ct>>>24,ct=tt[ct>>>24]<<24|tt[ct>>>16&255]<<16|tt[ct>>>8&255]<<8|tt[ct&255],ct^=st[bt/ht|0]<<24),ut[bt]=ut[bt-ht]^ct);for(var gt=this._invKeySchedule=[],At=0;At<_t;At++){var bt=_t-At;if(At%4)var ct=ut[bt];else var ct=ut[bt-4];At<4||bt<=4?gt[At]=ct:gt[At]=Q[tt[ct>>>24]]^et[tt[ct>>>16&255]]^it[tt[ct>>>8&255]]^rt[tt[ct&255]]}}},encryptBlock:function(ct,dt){this._doCryptBlock(ct,dt,this._keySchedule,W,z,K,J,tt)},decryptBlock:function(ct,dt){var nt=ct[dt+1];ct[dt+1]=ct[dt+3],ct[dt+3]=nt,this._doCryptBlock(ct,dt,this._invKeySchedule,Q,et,it,rt,Y);var nt=ct[dt+1];ct[dt+1]=ct[dt+3],ct[dt+3]=nt},_doCryptBlock:function(ct,dt,nt,ht,vt,_t,ut,bt){for(var gt=this._nRounds,At=ct[dt]^nt[0],St=ct[dt+1]^nt[1],xt=ct[dt+2]^nt[2],Pt=ct[dt+3]^nt[3],Ft=4,Mt=1;Mt<gt;Mt++){var Dt=ht[At>>>24]^vt[St>>>16&255]^_t[xt>>>8&255]^ut[Pt&255]^nt[Ft++],Ut=ht[St>>>24]^vt[xt>>>16&255]^_t[Pt>>>8&255]^ut[At&255]^nt[Ft++],Qt=ht[xt>>>24]^vt[Pt>>>16&255]^_t[At>>>8&255]^ut[St&255]^nt[Ft++],Lt=ht[Pt>>>24]^vt[At>>>16&255]^_t[St>>>8&255]^ut[xt&255]^nt[Ft++];At=Dt,St=Ut,xt=Qt,Pt=Lt}var Dt=(bt[At>>>24]<<24|bt[St>>>16&255]<<16|bt[xt>>>8&255]<<8|bt[Pt&255])^nt[Ft++],Ut=(bt[St>>>24]<<24|bt[xt>>>16&255]<<16|bt[Pt>>>8&255]<<8|bt[At&255])^nt[Ft++],Qt=(bt[xt>>>24]<<24|bt[Pt>>>16&255]<<16|bt[At>>>8&255]<<8|bt[St&255])^nt[Ft++],Lt=(bt[Pt>>>24]<<24|bt[At>>>16&255]<<16|bt[St>>>8&255]<<8|bt[xt&255])^nt[Ft++];ct[dt]=Dt,ct[dt+1]=Ut,ct[dt+2]=Qt,ct[dt+3]=Lt},keySize:256/32});O.AES=G._createHelper(at)}(),F.AES})}(aes)),aes.exports}var tripledes={exports:{}},hasRequiredTripledes;function requireTripledes(){return hasRequiredTripledes||(hasRequiredTripledes=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.WordArray,X=U.BlockCipher,tt=O.algo,Y=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],W=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],z=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],K=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],J=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],Q=tt.DES=X.extend({_doReset:function(){for(var st=this._key,at=st.words,ct=[],dt=0;dt<56;dt++){var nt=Y[dt]-1;ct[dt]=at[nt>>>5]>>>31-nt%32&1}for(var ht=this._subKeys=[],vt=0;vt<16;vt++){for(var _t=ht[vt]=[],ut=z[vt],dt=0;dt<24;dt++)_t[dt/6|0]|=ct[(W[dt]-1+ut)%28]<<31-dt%6,_t[4+(dt/6|0)]|=ct[28+(W[dt+24]-1+ut)%28]<<31-dt%6;_t[0]=_t[0]<<1|_t[0]>>>31;for(var dt=1;dt<7;dt++)_t[dt]=_t[dt]>>>(dt-1)*4+3;_t[7]=_t[7]<<5|_t[7]>>>27}for(var bt=this._invSubKeys=[],dt=0;dt<16;dt++)bt[dt]=ht[15-dt]},encryptBlock:function(st,at){this._doCryptBlock(st,at,this._subKeys)},decryptBlock:function(st,at){this._doCryptBlock(st,at,this._invSubKeys)},_doCryptBlock:function(st,at,ct){this._lBlock=st[at],this._rBlock=st[at+1],et.call(this,4,252645135),et.call(this,16,65535),it.call(this,2,858993459),it.call(this,8,16711935),et.call(this,1,1431655765);for(var dt=0;dt<16;dt++){for(var nt=ct[dt],ht=this._lBlock,vt=this._rBlock,_t=0,ut=0;ut<8;ut++)_t|=K[ut][((vt^nt[ut])&J[ut])>>>0];this._lBlock=vt,this._rBlock=ht^_t}var bt=this._lBlock;this._lBlock=this._rBlock,this._rBlock=bt,et.call(this,1,1431655765),it.call(this,8,16711935),it.call(this,2,858993459),et.call(this,16,65535),et.call(this,4,252645135),st[at]=this._lBlock,st[at+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function et(st,at){var ct=(this._lBlock>>>st^this._rBlock)&at;this._rBlock^=ct,this._lBlock^=ct<<st}function it(st,at){var ct=(this._rBlock>>>st^this._lBlock)&at;this._lBlock^=ct,this._rBlock^=ct<<st}O.DES=X._createHelper(Q);var rt=tt.TripleDES=X.extend({_doReset:function(){var st=this._key,at=st.words;if(at.length!==2&&at.length!==4&&at.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var ct=at.slice(0,2),dt=at.length<4?at.slice(0,2):at.slice(2,4),nt=at.length<6?at.slice(0,2):at.slice(4,6);this._des1=Q.createEncryptor(G.create(ct)),this._des2=Q.createEncryptor(G.create(dt)),this._des3=Q.createEncryptor(G.create(nt))},encryptBlock:function(st,at){this._des1.encryptBlock(st,at),this._des2.decryptBlock(st,at),this._des3.encryptBlock(st,at)},decryptBlock:function(st,at){this._des3.decryptBlock(st,at),this._des2.encryptBlock(st,at),this._des1.decryptBlock(st,at)},keySize:192/32,ivSize:64/32,blockSize:64/32});O.TripleDES=X._createHelper(rt)}(),F.TripleDES})}(tripledes)),tripledes.exports}var rc4={exports:{}},hasRequiredRc4;function requireRc4(){return hasRequiredRc4||(hasRequiredRc4=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.StreamCipher,X=O.algo,tt=X.RC4=G.extend({_doReset:function(){for(var z=this._key,K=z.words,J=z.sigBytes,Q=this._S=[],et=0;et<256;et++)Q[et]=et;for(var et=0,it=0;et<256;et++){var rt=et%J,st=K[rt>>>2]>>>24-rt%4*8&255;it=(it+Q[et]+st)%256;var at=Q[et];Q[et]=Q[it],Q[it]=at}this._i=this._j=0},_doProcessBlock:function(z,K){z[K]^=Y.call(this)},keySize:256/32,ivSize:0});function Y(){for(var z=this._S,K=this._i,J=this._j,Q=0,et=0;et<4;et++){K=(K+1)%256,J=(J+z[K])%256;var it=z[K];z[K]=z[J],z[J]=it,Q|=z[(z[K]+z[J])%256]<<24-et*8}return this._i=K,this._j=J,Q}O.RC4=G._createHelper(tt);var W=X.RC4Drop=tt.extend({cfg:tt.cfg.extend({drop:192}),_doReset:function(){tt._doReset.call(this);for(var z=this.cfg.drop;z>0;z--)Y.call(this)}});O.RC4Drop=G._createHelper(W)}(),F.RC4})}(rc4)),rc4.exports}var rabbit={exports:{}},hasRequiredRabbit;function requireRabbit(){return hasRequiredRabbit||(hasRequiredRabbit=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.StreamCipher,X=O.algo,tt=[],Y=[],W=[],z=X.Rabbit=G.extend({_doReset:function(){for(var J=this._key.words,Q=this.cfg.iv,et=0;et<4;et++)J[et]=(J[et]<<8|J[et]>>>24)&16711935|(J[et]<<24|J[et]>>>8)&4278255360;var it=this._X=[J[0],J[3]<<16|J[2]>>>16,J[1],J[0]<<16|J[3]>>>16,J[2],J[1]<<16|J[0]>>>16,J[3],J[2]<<16|J[1]>>>16],rt=this._C=[J[2]<<16|J[2]>>>16,J[0]&4294901760|J[1]&65535,J[3]<<16|J[3]>>>16,J[1]&4294901760|J[2]&65535,J[0]<<16|J[0]>>>16,J[2]&4294901760|J[3]&65535,J[1]<<16|J[1]>>>16,J[3]&4294901760|J[0]&65535];this._b=0;for(var et=0;et<4;et++)K.call(this);for(var et=0;et<8;et++)rt[et]^=it[et+4&7];if(Q){var st=Q.words,at=st[0],ct=st[1],dt=(at<<8|at>>>24)&16711935|(at<<24|at>>>8)&4278255360,nt=(ct<<8|ct>>>24)&16711935|(ct<<24|ct>>>8)&4278255360,ht=dt>>>16|nt&4294901760,vt=nt<<16|dt&65535;rt[0]^=dt,rt[1]^=ht,rt[2]^=nt,rt[3]^=vt,rt[4]^=dt,rt[5]^=ht,rt[6]^=nt,rt[7]^=vt;for(var et=0;et<4;et++)K.call(this)}},_doProcessBlock:function(J,Q){var et=this._X;K.call(this),tt[0]=et[0]^et[5]>>>16^et[3]<<16,tt[1]=et[2]^et[7]>>>16^et[5]<<16,tt[2]=et[4]^et[1]>>>16^et[7]<<16,tt[3]=et[6]^et[3]>>>16^et[1]<<16;for(var it=0;it<4;it++)tt[it]=(tt[it]<<8|tt[it]>>>24)&16711935|(tt[it]<<24|tt[it]>>>8)&4278255360,J[Q+it]^=tt[it]},blockSize:128/32,ivSize:64/32});function K(){for(var J=this._X,Q=this._C,et=0;et<8;et++)Y[et]=Q[et];Q[0]=Q[0]+1295307597+this._b|0,Q[1]=Q[1]+3545052371+(Q[0]>>>0<Y[0]>>>0?1:0)|0,Q[2]=Q[2]+886263092+(Q[1]>>>0<Y[1]>>>0?1:0)|0,Q[3]=Q[3]+1295307597+(Q[2]>>>0<Y[2]>>>0?1:0)|0,Q[4]=Q[4]+3545052371+(Q[3]>>>0<Y[3]>>>0?1:0)|0,Q[5]=Q[5]+886263092+(Q[4]>>>0<Y[4]>>>0?1:0)|0,Q[6]=Q[6]+1295307597+(Q[5]>>>0<Y[5]>>>0?1:0)|0,Q[7]=Q[7]+3545052371+(Q[6]>>>0<Y[6]>>>0?1:0)|0,this._b=Q[7]>>>0<Y[7]>>>0?1:0;for(var et=0;et<8;et++){var it=J[et]+Q[et],rt=it&65535,st=it>>>16,at=((rt*rt>>>17)+rt*st>>>15)+st*st,ct=((it&4294901760)*it|0)+((it&65535)*it|0);W[et]=at^ct}J[0]=W[0]+(W[7]<<16|W[7]>>>16)+(W[6]<<16|W[6]>>>16)|0,J[1]=W[1]+(W[0]<<8|W[0]>>>24)+W[7]|0,J[2]=W[2]+(W[1]<<16|W[1]>>>16)+(W[0]<<16|W[0]>>>16)|0,J[3]=W[3]+(W[2]<<8|W[2]>>>24)+W[1]|0,J[4]=W[4]+(W[3]<<16|W[3]>>>16)+(W[2]<<16|W[2]>>>16)|0,J[5]=W[5]+(W[4]<<8|W[4]>>>24)+W[3]|0,J[6]=W[6]+(W[5]<<16|W[5]>>>16)+(W[4]<<16|W[4]>>>16)|0,J[7]=W[7]+(W[6]<<8|W[6]>>>24)+W[5]|0}O.Rabbit=G._createHelper(z)}(),F.Rabbit})}(rabbit)),rabbit.exports}var rabbitLegacy={exports:{}},hasRequiredRabbitLegacy;function requireRabbitLegacy(){return hasRequiredRabbitLegacy||(hasRequiredRabbitLegacy=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.StreamCipher,X=O.algo,tt=[],Y=[],W=[],z=X.RabbitLegacy=G.extend({_doReset:function(){var J=this._key.words,Q=this.cfg.iv,et=this._X=[J[0],J[3]<<16|J[2]>>>16,J[1],J[0]<<16|J[3]>>>16,J[2],J[1]<<16|J[0]>>>16,J[3],J[2]<<16|J[1]>>>16],it=this._C=[J[2]<<16|J[2]>>>16,J[0]&4294901760|J[1]&65535,J[3]<<16|J[3]>>>16,J[1]&4294901760|J[2]&65535,J[0]<<16|J[0]>>>16,J[2]&4294901760|J[3]&65535,J[1]<<16|J[1]>>>16,J[3]&4294901760|J[0]&65535];this._b=0;for(var rt=0;rt<4;rt++)K.call(this);for(var rt=0;rt<8;rt++)it[rt]^=et[rt+4&7];if(Q){var st=Q.words,at=st[0],ct=st[1],dt=(at<<8|at>>>24)&16711935|(at<<24|at>>>8)&4278255360,nt=(ct<<8|ct>>>24)&16711935|(ct<<24|ct>>>8)&4278255360,ht=dt>>>16|nt&4294901760,vt=nt<<16|dt&65535;it[0]^=dt,it[1]^=ht,it[2]^=nt,it[3]^=vt,it[4]^=dt,it[5]^=ht,it[6]^=nt,it[7]^=vt;for(var rt=0;rt<4;rt++)K.call(this)}},_doProcessBlock:function(J,Q){var et=this._X;K.call(this),tt[0]=et[0]^et[5]>>>16^et[3]<<16,tt[1]=et[2]^et[7]>>>16^et[5]<<16,tt[2]=et[4]^et[1]>>>16^et[7]<<16,tt[3]=et[6]^et[3]>>>16^et[1]<<16;for(var it=0;it<4;it++)tt[it]=(tt[it]<<8|tt[it]>>>24)&16711935|(tt[it]<<24|tt[it]>>>8)&4278255360,J[Q+it]^=tt[it]},blockSize:128/32,ivSize:64/32});function K(){for(var J=this._X,Q=this._C,et=0;et<8;et++)Y[et]=Q[et];Q[0]=Q[0]+1295307597+this._b|0,Q[1]=Q[1]+3545052371+(Q[0]>>>0<Y[0]>>>0?1:0)|0,Q[2]=Q[2]+886263092+(Q[1]>>>0<Y[1]>>>0?1:0)|0,Q[3]=Q[3]+1295307597+(Q[2]>>>0<Y[2]>>>0?1:0)|0,Q[4]=Q[4]+3545052371+(Q[3]>>>0<Y[3]>>>0?1:0)|0,Q[5]=Q[5]+886263092+(Q[4]>>>0<Y[4]>>>0?1:0)|0,Q[6]=Q[6]+1295307597+(Q[5]>>>0<Y[5]>>>0?1:0)|0,Q[7]=Q[7]+3545052371+(Q[6]>>>0<Y[6]>>>0?1:0)|0,this._b=Q[7]>>>0<Y[7]>>>0?1:0;for(var et=0;et<8;et++){var it=J[et]+Q[et],rt=it&65535,st=it>>>16,at=((rt*rt>>>17)+rt*st>>>15)+st*st,ct=((it&4294901760)*it|0)+((it&65535)*it|0);W[et]=at^ct}J[0]=W[0]+(W[7]<<16|W[7]>>>16)+(W[6]<<16|W[6]>>>16)|0,J[1]=W[1]+(W[0]<<8|W[0]>>>24)+W[7]|0,J[2]=W[2]+(W[1]<<16|W[1]>>>16)+(W[0]<<16|W[0]>>>16)|0,J[3]=W[3]+(W[2]<<8|W[2]>>>24)+W[1]|0,J[4]=W[4]+(W[3]<<16|W[3]>>>16)+(W[2]<<16|W[2]>>>16)|0,J[5]=W[5]+(W[4]<<8|W[4]>>>24)+W[3]|0,J[6]=W[6]+(W[5]<<16|W[5]>>>16)+(W[4]<<16|W[4]>>>16)|0,J[7]=W[7]+(W[6]<<8|W[6]>>>24)+W[5]|0}O.RabbitLegacy=G._createHelper(z)}(),F.RabbitLegacy})}(rabbitLegacy)),rabbitLegacy.exports}var blowfish={exports:{}},hasRequiredBlowfish;function requireBlowfish(){return hasRequiredBlowfish||(hasRequiredBlowfish=1,function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireEncBase64(),requireMd5(),requireEvpkdf(),requireCipherCore())})(commonjsGlobal,function(F){return function(){var O=F,U=O.lib,G=U.BlockCipher,X=O.algo;const tt=16,Y=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],W=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var z={pbox:[],sbox:[]};function K(rt,st){let at=st>>24&255,ct=st>>16&255,dt=st>>8&255,nt=st&255,ht=rt.sbox[0][at]+rt.sbox[1][ct];return ht=ht^rt.sbox[2][dt],ht=ht+rt.sbox[3][nt],ht}function J(rt,st,at){let ct=st,dt=at,nt;for(let ht=0;ht<tt;++ht)ct=ct^rt.pbox[ht],dt=K(rt,ct)^dt,nt=ct,ct=dt,dt=nt;return nt=ct,ct=dt,dt=nt,dt=dt^rt.pbox[tt],ct=ct^rt.pbox[tt+1],{left:ct,right:dt}}function Q(rt,st,at){let ct=st,dt=at,nt;for(let ht=tt+1;ht>1;--ht)ct=ct^rt.pbox[ht],dt=K(rt,ct)^dt,nt=ct,ct=dt,dt=nt;return nt=ct,ct=dt,dt=nt,dt=dt^rt.pbox[1],ct=ct^rt.pbox[0],{left:ct,right:dt}}function et(rt,st,at){for(let vt=0;vt<4;vt++){rt.sbox[vt]=[];for(let _t=0;_t<256;_t++)rt.sbox[vt][_t]=W[vt][_t]}let ct=0;for(let vt=0;vt<tt+2;vt++)rt.pbox[vt]=Y[vt]^st[ct],ct++,ct>=at&&(ct=0);let dt=0,nt=0,ht=0;for(let vt=0;vt<tt+2;vt+=2)ht=J(rt,dt,nt),dt=ht.left,nt=ht.right,rt.pbox[vt]=dt,rt.pbox[vt+1]=nt;for(let vt=0;vt<4;vt++)for(let _t=0;_t<256;_t+=2)ht=J(rt,dt,nt),dt=ht.left,nt=ht.right,rt.sbox[vt][_t]=dt,rt.sbox[vt][_t+1]=nt;return!0}var it=X.Blowfish=G.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var rt=this._keyPriorReset=this._key,st=rt.words,at=rt.sigBytes/4;et(z,st,at)}},encryptBlock:function(rt,st){var at=J(z,rt[st],rt[st+1]);rt[st]=at.left,rt[st+1]=at.right},decryptBlock:function(rt,st){var at=Q(z,rt[st],rt[st+1]);rt[st]=at.left,rt[st+1]=at.right},blockSize:64/32,keySize:128/32,ivSize:64/32});O.Blowfish=G._createHelper(it)}(),F.Blowfish})}(blowfish)),blowfish.exports}(function(B,D){(function(F,O,U){B.exports=O(requireCore(),requireX64Core(),requireLibTypedarrays(),requireEncUtf16(),requireEncBase64(),requireEncBase64url(),requireMd5(),requireSha1(),requireSha256(),requireSha224(),requireSha512(),requireSha384(),requireSha3(),requireRipemd160(),requireHmac(),requirePbkdf2(),requireEvpkdf(),requireCipherCore(),requireModeCfb(),requireModeCtr(),requireModeCtrGladman(),requireModeOfb(),requireModeEcb(),requirePadAnsix923(),requirePadIso10126(),requirePadIso97971(),requirePadZeropadding(),requirePadNopadding(),requireFormatHex(),requireAes(),requireTripledes(),requireRc4(),requireRabbit(),requireRabbitLegacy(),requireBlowfish())})(commonjsGlobal,function(F){return F})})(cryptoJs);var cryptoJsExports=cryptoJs.exports;Object.defineProperty(cryptoUtil,"__esModule",{value:!0});cryptoUtil.CryptoUtil=void 0;const util_1$5=util,crypto$1=cryptoJsExports;class CryptoUtil{static convertToWordArray(D){let F=util_1$5.Util.convertUint8ArrayToInt32Array(D);return crypto$1.lib.WordArray.create(Array.from(F),D.length)}static convertWordArrayToByteArray(D){return util_1$5.Util.convertInt32ArrayToUint8Array(D.words)}static convertNumberToLittleEndianByteArray(D){return util_1$5.Util.convertInt32ArrayToUint8Array(new Int32Array([D])).reverse()}static MD5(D){return D instanceof Uint8Array&&(D=CryptoUtil.convertToWordArray(D)),crypto$1.MD5(D)}static MD5AsByteArray(D){return D instanceof Uint8Array&&(D=CryptoUtil.convertToWordArray(D)),CryptoUtil.convertWordArrayToByteArray(crypto$1.MD5(D))}static MD5Hex(D){return CryptoUtil.MD5(D).toString(crypto$1.enc.Hex)}static RC4(D,F){return D instanceof Uint8Array&&(D=CryptoUtil.convertToWordArray(D)),F instanceof Uint8Array&&(F=CryptoUtil.convertToWordArray(F)),crypto$1.RC4.encrypt(D,F).ciphertext}static RC4Hex(D,F){return CryptoUtil.RC4(D,F).toString(crypto$1.enc.Hex)}static padPasswortString(D){typeof D=="string"&&(D=new Uint8Array(util_1$5.Util.convertStringToAscii(D)));let F=new Uint8Array(32);return F.set(D.slice(0,32)),D.length<32&&F.set(CryptoUtil.PADDING_STRING.slice(0,32-D.length),D.length),F}static xorBytes(D,F){let O=[];for(let U=0;U<D.length;++U)O.push(D[U]^F);return CryptoUtil.convertToWordArray(new Uint8Array(O))}}cryptoUtil.CryptoUtil=CryptoUtil;CryptoUtil.PADDING_STRING=[40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122];Object.defineProperty(crypto$2,"__esModule",{value:!0});crypto$2.RC4CryptoEngine=crypto$2.IdentityEngine=crypto$2.RC4_40_BIT=void 0;const util_1$4=util,crypto_util_1=cryptoUtil;crypto$2.RC4_40_BIT=!0;class IdentityEngine{encrypt(D,F){return D}decrypt(D,F){return D}isUserPasswordCorrect(){return!0}isOwnerPasswordCorrect(){return!0}}crypto$2.IdentityEngine=IdentityEngine;class RC4CryptoEngine{constructor(D,F,O=!1){this.cryptoConfiguration=D,this.file_id=F,this.rc4_40_bit=O,this.encryptionKey=void 0,this.computed_user_password=void 0,this.computed_owner_password=void 0}encrypt(D,F){if(!F)throw Error("Undefined reference pointer of encrypted object");let O=this.computeEncryptionKey(),U=new Uint8Array(O.length+5);U.set(O,0);let G=crypto_util_1.CryptoUtil.convertNumberToLittleEndianByteArray(F.obj);U.set(G.slice(0,3),O.length);let X=crypto_util_1.CryptoUtil.convertNumberToLittleEndianByteArray(F.generation);U.set(X.slice(0,2),O.length+3);let tt=crypto_util_1.CryptoUtil.MD5AsByteArray(U),Y=crypto_util_1.CryptoUtil.RC4(D,tt.slice(0,Math.min(O.length+5,16)));return crypto_util_1.CryptoUtil.convertWordArrayToByteArray(Y)}decrypt(D,F){return this.encrypt(D,F)}computeEncryptionKey(){if(this.encryptionKey)return this.encryptionKey;let D=crypto_util_1.CryptoUtil.padPasswortString(this.cryptoConfiguration.user_pwd);if(!this.cryptoConfiguration.owner_pwd_c)throw Error("Invalid /O value (owner password)");let F=this.cryptoConfiguration.owner_pwd_c;if(F.length!==32)throw Error(`Invalid length of owner value. Is ${F.length} but must be 32.`);if(!this.cryptoConfiguration.permissions)throw Error("Permissions not set");let O=crypto_util_1.CryptoUtil.convertNumberToLittleEndianByteArray(this.cryptoConfiguration.permissions);if(!this.file_id||this.file_id.length===0)throw Error("File ID not set");let U=40;this.cryptoConfiguration.length&&(U=this.cryptoConfiguration.length);let G=this.file_id[0],X=new Uint8Array(D.length+F.length+O.length+G.length);X.set(D,0),X.set(F,D.length),X.set(O,D.length+F.length),X.set(G,D.length+F.length+O.length);let tt=crypto_util_1.CryptoUtil.MD5AsByteArray(X);if(U=U>>3,this.cryptoConfiguration.revision&&this.cryptoConfiguration.revision>=3)for(let Y=0;Y<50;++Y)tt=crypto_util_1.CryptoUtil.MD5AsByteArray(tt.slice(0,U));return this.rc4_40_bit?this.encryptionKey=tt.slice(0,5):this.encryptionKey=tt,this.encryptionKey}computeUserPassword(){return this.computed_user_password?this.computed_user_password:this.cryptoConfiguration.revision&&this.cryptoConfiguration.revision>=3?this.computeUserPasswordRevision3OrGreater():this.cryptoConfiguration.revision===2?this.computeUserPasswordRevision2():new Uint8Array([])}computeUserPasswordRevision2(){let D=new Uint8Array(crypto_util_1.CryptoUtil.PADDING_STRING),F=this.computeEncryptionKey(),O=crypto_util_1.CryptoUtil.RC4(D,F);return this.computed_user_password=crypto_util_1.CryptoUtil.convertWordArrayToByteArray(O),this.computed_user_password}computeUserPasswordRevision3OrGreater(){if(!this.file_id)throw Error("No file id");let D=this.file_id[0],F=new Uint8Array(crypto_util_1.CryptoUtil.PADDING_STRING.length+D.length);F.set(crypto_util_1.CryptoUtil.PADDING_STRING,0),F.set(D,crypto_util_1.CryptoUtil.PADDING_STRING.length);let O=crypto_util_1.CryptoUtil.MD5(F),U=this.computeEncryptionKey();for(let G=0;G<20;++G)O=crypto_util_1.CryptoUtil.RC4(O,crypto_util_1.CryptoUtil.xorBytes(U,G));return this.computed_user_password=crypto_util_1.CryptoUtil.convertWordArrayToByteArray(O),this.computed_user_password}computeOwnerPassword(){if(this.computed_owner_password)return this.computed_owner_password;let D=this.cryptoConfiguration.owner_pwd;(!this.cryptoConfiguration.owner_pwd||this.cryptoConfiguration.owner_pwd==="")&&(D=this.cryptoConfiguration.user_pwd);let F=crypto_util_1.CryptoUtil.padPasswortString(D),O=crypto_util_1.CryptoUtil.MD5(F),U=1;if(this.cryptoConfiguration.revision&&this.cryptoConfiguration.revision>=3){U=20;for(let W=0;W<50;++W)O=crypto_util_1.CryptoUtil.MD5(O)}let G=128;this.cryptoConfiguration.length&&(G=this.cryptoConfiguration.length);let X=crypto_util_1.CryptoUtil.convertWordArrayToByteArray(O).slice(0,G/8),tt=crypto_util_1.CryptoUtil.padPasswortString(this.cryptoConfiguration.user_pwd),Y=crypto_util_1.CryptoUtil.convertToWordArray(tt);for(let W=0;W<U;++W)Y=crypto_util_1.CryptoUtil.RC4(Y,crypto_util_1.CryptoUtil.xorBytes(X,W));return this.computed_owner_password=crypto_util_1.CryptoUtil.convertWordArrayToByteArray(Y),this.computed_owner_password}isUserPasswordCorrect(){let D=this.computeUserPassword();if(!this.cryptoConfiguration.user_pwd_c)throw Error("Invalid /U value (user password)");return this.cryptoConfiguration.revision&&this.cryptoConfiguration.revision>=3?util_1$4.Util.areArraysEqual(D,this.cryptoConfiguration.user_pwd_c.slice(0,16)):util_1$4.Util.areArraysEqual(D,this.cryptoConfiguration.user_pwd_c)}isOwnerPasswordCorrect(){let D=this.computeOwnerPassword();if(!this.cryptoConfiguration.owner_pwd_c)throw Error("Invalid /O value (owner password)");return util_1$4.Util.areArraysEqual(D,this.cryptoConfiguration.owner_pwd_c)}}crypto$2.RC4CryptoEngine=RC4CryptoEngine;var annotation_types={},annotation_errors={};Object.defineProperty(annotation_errors,"__esModule",{value:!0});annotation_errors.InvalidFontError=annotation_errors.InvalidFontSizeError=annotation_errors.InvalidAppearanceStreamError=annotation_errors.InvalidAnnotationReference=annotation_errors.InvalidVerticesError=annotation_errors.InvalidQuadPointError=annotation_errors.InvalidStateError=annotation_errors.InvalidIDError=annotation_errors.InvalidRectError=annotation_errors.InvalidDateError=annotation_errors.InvalidReferencePointerError=annotation_errors.ColorOutOfRangeError=annotation_errors.InvalidColorError=annotation_errors.InvalidOpacityError=annotation_errors.InvalidAnnotationTypeError=void 0;class InvalidAnnotationTypeError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidAnnotationTypeError"}}annotation_errors.InvalidAnnotationTypeError=InvalidAnnotationTypeError;class InvalidOpacityError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidOpacityError"}}annotation_errors.InvalidOpacityError=InvalidOpacityError;class InvalidColorError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidColorError"}}annotation_errors.InvalidColorError=InvalidColorError;class ColorOutOfRangeError extends Error{constructor(D){super(D),this.message=D,this.name="ColorOutOfRangeError"}}annotation_errors.ColorOutOfRangeError=ColorOutOfRangeError;class InvalidReferencePointerError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidReferencePointerError"}}annotation_errors.InvalidReferencePointerError=InvalidReferencePointerError;class InvalidDateError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidDateError"}}annotation_errors.InvalidDateError=InvalidDateError;class InvalidRectError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidRectError"}}annotation_errors.InvalidRectError=InvalidRectError;class InvalidIDError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidIDError"}}annotation_errors.InvalidIDError=InvalidIDError;class InvalidStateError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidStateError"}}annotation_errors.InvalidStateError=InvalidStateError;class InvalidQuadPointError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidQuadPointError"}}annotation_errors.InvalidQuadPointError=InvalidQuadPointError;class InvalidVerticesError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidVerticesError"}}annotation_errors.InvalidVerticesError=InvalidVerticesError;class InvalidAnnotationReference extends Error{constructor(D){super(D),this.message=D,this.name="InvalidAnnotationError"}}annotation_errors.InvalidAnnotationReference=InvalidAnnotationReference;class InvalidAppearanceStreamError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidAppearanceStreamError"}}annotation_errors.InvalidAppearanceStreamError=InvalidAppearanceStreamError;class InvalidFontSizeError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidFontSizeError"}}annotation_errors.InvalidFontSizeError=InvalidFontSizeError;class InvalidFontError extends Error{constructor(D){super(D),this.message=D,this.name="InvalidFontError"}}annotation_errors.InvalidFontError=InvalidFontError;var writerUtil={};Object.defineProperty(writerUtil,"__esModule",{value:!0});writerUtil.WriterUtil=void 0;const util_1$3=util,stream_1=stream;class WriterUtil{static writeReferencePointer(D,F=!1){let O=util_1$3.Util.convertNumberToCharArray(D.obj);return O.push(util_1$3.Util.SPACE),O=O.concat(util_1$3.Util.convertNumberToCharArray(D.generation)),F&&(O.push(util_1$3.Util.SPACE),O.push(...util_1$3.Util.R)),O}static pad(D,F){F=String(F);let O=[];for(let U=0;U<D-F.length;++U)O.push(48);return O=O.concat(util_1$3.Util.convertNumberToCharArray(F)),O}static writeNestedNumberArray(D){let F=[...util_1$3.Util.ARRAY_START];for(let O of D)F=F.concat(WriterUtil.writeNumberArray(O)),F.push(util_1$3.Util.SPACE);return F.push(...util_1$3.Util.ARRAY_END),F}static writeNumberArray(D){let F=[...util_1$3.Util.ARRAY_START];for(let O of D)F=F.concat(util_1$3.Util.convertNumberToCharArray(O)),F.push(util_1$3.Util.SPACE);return F.push(...util_1$3.Util.ARRAY_END),F}static replaceAnnotsFieldInPageObject(D,F,O,U){let G=util_1$3.Util.locateSequence(util_1$3.Util.ENDOBJ,D,O,!0),X=D.slice(O,G+util_1$3.Util.ENDOBJ.length),tt=[];if(F.hasAnnotsField){let Y=util_1$3.Util.locateSequence(util_1$3.Util.ANNOTS,X,0,!0);tt=Array.from(X.slice(0,Y+util_1$3.Util.ANNOTS.length)),tt.push(util_1$3.Util.SPACE),tt=tt.concat(WriterUtil.writeReferencePointer(U,!0)),tt.push(util_1$3.Util.SPACE);let W=util_1$3.Util.locateSequence(util_1$3.Util.ARRAY_END,X,Y,!0)+util_1$3.Util.ARRAY_END.length;tt=tt.concat(Array.from(X.slice(W,X.length)))}else{let Y=util_1$3.Util.locateSequenceReversed(util_1$3.Util.DICT_END,X,X.length-1);if(Y===-1)throw Error("Could not identify dictionary end");tt=Array.from(X.slice(0,Y)),tt=tt.concat(util_1$3.Util.ANNOTS),tt.push(util_1$3.Util.SPACE),tt=tt.concat(WriterUtil.writeReferencePointer(U,!0)),tt.push(util_1$3.Util.SPACE),tt=tt.concat(Array.from(X.slice(Y,X.length)))}return tt.push(util_1$3.Util.CR),tt.push(util_1$3.Util.LF),tt}static writeStreamObject(D,F,O){let U=O,G=!1;O instanceof stream_1.Stream&&(U=Array.from(O.encode()),G=!0);let X=WriterUtil.writeReferencePointer(D);return X.push(WriterUtil.SPACE),X=X.concat(WriterUtil.OBJ),X.push(WriterUtil.CR),X.push(WriterUtil.LF),X=X.concat(WriterUtil.DICT_START),X.push(WriterUtil.SPACE),G&&(X=X.concat(WriterUtil.FILTER),X.push(WriterUtil.SPACE),X=X.concat(WriterUtil.FLATEDECODE),X.push(WriterUtil.SPACE)),X=X.concat(WriterUtil.LENGTH),X.push(WriterUtil.SPACE),X=X.concat(util_1$3.Util.convertNumberToCharArray(U.length)),X.push(WriterUtil.SPACE),X=X.concat(F),X=X.concat(WriterUtil.DICT_END),X=X.concat(WriterUtil.STREAM),X.push(WriterUtil.CR),X.push(WriterUtil.LF),X=X.concat(U),X.push(WriterUtil.CR),X.push(WriterUtil.LF),X=X.concat(WriterUtil.ENDSTREAM),X.push(WriterUtil.CR),X.push(WriterUtil.LF),X=X.concat(WriterUtil.ENDOBJ),X.push(WriterUtil.CR),X.push(WriterUtil.LF),X}}writerUtil.WriterUtil=WriterUtil;WriterUtil.N=110;WriterUtil.F=102;WriterUtil.q=113;WriterUtil.Q=81;WriterUtil.BT=[66,84];WriterUtil.ET=[69,84];WriterUtil.BMC=[66,77,67];WriterUtil.EMC=[69,77,67];WriterUtil.AP_N=[47,78];WriterUtil.AP_D=[47,68];WriterUtil.AP_R=[47,82];WriterUtil.SPACE=32;WriterUtil.CR=13;WriterUtil.LF=10;WriterUtil.AP=[47,65,80];WriterUtil.OBJ=[111,98,106];WriterUtil.ENDOBJ=[101,110,100,111,98,106];WriterUtil.ENCRYPT=[47,69,110,99,114,121,112,116];WriterUtil.ARRAY_START=91;WriterUtil.OPEN=[47,79,112,101,110];WriterUtil.ARRAY_END=93;WriterUtil.DICT_START=[60,60];WriterUtil.HEX_STRING_START=[60];WriterUtil.HEX_STRING_END=[62];WriterUtil.DICT_END=[62,62];WriterUtil.TYPE0=[47,84,121,112,101,48];WriterUtil.TYPE1=[47,84,121,112,101,49];WriterUtil.TYPE3=[47,84,121,112,101,51];WriterUtil.MMTYPE1=[47,77,77,84,121,112,101,49];WriterUtil.TRUETYPE=[47,84,114,117,101,84,121,112,101];WriterUtil.CIDFONTTYPE0=[47,67,73,68,70,111,110,116,84,121,112,101,48];WriterUtil.CIDFONTTYPE2=[47,67,73,68,70,111,110,116,84,121,112,101,50];WriterUtil.TYPE_ANNOT=[47,84,121,112,101,WriterUtil.SPACE,47,65,110,110,111,116];WriterUtil.TYPE_XOBJECT=[47,84,121,112,101,WriterUtil.SPACE,47,88,79,98,106,101,99,116];WriterUtil.TYPE_EXTGSTATE=[47,84,121,112,101,WriterUtil.SPACE,47,69,120,116,71,83,116,97,116,101];WriterUtil.TYPE_FONTDESCRIPTOR=[47,84,121,112,101,WriterUtil.SPACE,47,70,111,110,116,68,101,115,99,114,105,112,116,111,114];WriterUtil.TYPE_FONT=[47,84,121,112,101,WriterUtil.SPACE,47,70,111,110,116];WriterUtil.FONTNAME=[47,70,111,110,116,78,97,109,101];WriterUtil.FONTFAMILY=[47,70,111,110,116,70,97,109,105,108,121];WriterUtil.FONTSTRETCH=[47,70,111,110,116,83,116,114,101,116,99,104];WriterUtil.FLAGS=[47,70,108,97,103,115];WriterUtil.FONTBBOX=[47,70,111,110,116,66,66,111,120];WriterUtil.ITALICANGLE=[47,73,116,97,108,105,99,65,110,103,108,101];WriterUtil.ASCENT=[47,65,115,99,101,110,116];WriterUtil.DESCENT=[47,68,101,115,99,101,110,116];WriterUtil.LEADING=[47,76,101,97,100,105,110,103];WriterUtil.CAPHEIGHT=[47,67,97,112,72,101,105,103,104,116];WriterUtil.XHEIGHT=[47,88,72,101,105,103,104,116];WriterUtil.STEMV=[47,83,116,101,109,86];WriterUtil.ENCODING=[47,69,110,99,111,100,105,110,103];WriterUtil.STEMH=[47,83,116,101,109,2];WriterUtil.AVGWIDTH=[47,65,118,103,87,105,100,116,104];WriterUtil.MAXWIDTH=[47,77,97,120,87,105,100,116,104];WriterUtil.MISSINGWIDTH=[47,77,105,115,115,105,110,103,87,105,100,116,104];WriterUtil.FIRSTCHAR=[47,70,105,114,115,116,67,104,97,114];WriterUtil.LASTCHAR=[47,76,97,115,116,67,104,97,114];WriterUtil.BASEFONT=[47,66,97,115,101,70,111,110,116];WriterUtil.WIDTHS=[47,87,105,100,116,104,115];WriterUtil.FONTDESCRIPTOR=[47,70,111,110,116,68,101,115,99,114,105,112,116,111,114];WriterUtil.XOBJECT=[47,88,79,98,106,101,99,116];WriterUtil.EXTGSTATE=[47,69,120,116,71,83,116,97,116,101];WriterUtil.COLORSPACE=[47,67,111,108,111,114,83,112,97,99,101];WriterUtil.PATTERN=[47,80,97,116,116,101,114,110];WriterUtil.SHADING=[47,83,104,97,100,105,110,103];WriterUtil.FONT=[47,70,111,110,116];WriterUtil.PROCSET=[47,80,114,111,99,83,101,116];WriterUtil.PROPERTIES=[47,80,114,111,112,101,114,116,105,101,115];WriterUtil.RECT=[47,82,101,99,116];WriterUtil.RESOURCES=[47,82,101,115,111,117,114,99,101,115];WriterUtil.SUBTYPE=[47,83,117,98,116,121,112,101];WriterUtil.FORM=[47,70,111,114,109];WriterUtil.UPDATE_DATE=[47,77];WriterUtil.AUTHOR=[47,84];WriterUtil.CONTENTS=[47,67,111,110,116,101,110,116,115];WriterUtil.BRACKET_START=40;WriterUtil.BRACKET_END=41;WriterUtil.FLAG=[47,70];WriterUtil.ID=[47,78,77];WriterUtil.DOCUMENT_ID=[47,73,68];WriterUtil.COLOR=[47,67];WriterUtil.FILL=[47,73,67];WriterUtil.STATE=[47,83,116,97,116,101];WriterUtil.STATEMODEL=[47,83,116,97,116,101,77,111,100,101,108];WriterUtil.OPACITY=[47,67,65];WriterUtil._OPACITY=[47,99,97];WriterUtil.BORDER=[47,66,111,114,100,101,114];WriterUtil.PAGE_REFERENCE=[47,80];WriterUtil.DEFAULT_APPEARANCE=[47,68,65];WriterUtil.INKLIST=[47,73,110,107,76,105,115,116];WriterUtil.FILTER=[47,70,105,108,116,101,114];WriterUtil.FLATEDECODE=[47,70,108,97,116,101,68,101,99,111,100,101];WriterUtil.LENGTH=[47,76,101,110,103,116,104];WriterUtil.STREAM=[115,116,114,101,97,109];WriterUtil.ENDSTREAM=[101,110,100,115,116,114,101,97,109];WriterUtil.FORMTYPE=[47,70,111,114,109,84,121,112,101];WriterUtil.MATRIX=[47,77,97,116,114,105,120];WriterUtil.BBOX=[47,66,66,111,120];WriterUtil.RC=[47,82,67];WriterUtil.CREATION_DATE=[47,67,114,101,97,116,105,111,110,68,97,116,101];WriterUtil.SUBJ=[47,83,117,98,106];WriterUtil.TRAILER=[116,114,97,105,108,101,114];WriterUtil.SIZE=[47,83,105,122,101];WriterUtil.ROOT=[47,82,111,111,116];WriterUtil.PREV=[47,80,114,101,118];WriterUtil.STARTXREF=[115,116,97,114,116,120,114,101,102];WriterUtil.EOF=[37,37,69,79,70];WriterUtil.TRUE=[116,114,117,101];WriterUtil.XREF=[120,114,101,102];WriterUtil.TEXT_JUSTIFICATION=[47,81];WriterUtil.DEFAULT_STYLE_STRING=[47,68,83];WriterUtil.DIFFERENCE_RECTANGLE=[47,82,68];WriterUtil.IT=[47,73,84];WriterUtil.LINE_ENDING=[47,76,69];WriterUtil.CALLOUT_LINE=[47,67,76];WriterUtil.QUADPOINTS=[47,81,117,97,100,80,111,105,110,116,115];WriterUtil.VERTICES=[47,86,101,114,116,105,99,101,115];WriterUtil.NAME=[47,78,97,109,101];WriterUtil.DRAFT=[47,68,114,97,102,116];WriterUtil.SY=[47,83,121];WriterUtil.P=80;var hasRequiredAnnotation_types;function requireAnnotation_types(){return hasRequiredAnnotation_types||(hasRequiredAnnotation_types=1,function(B){Object.defineProperty(B,"__esModule",{value:!0}),B.MarkupAnnotationObj=B.ReplyTypes=B.RawAnnotationObj=B.BaseAnnotationObj=B.BorderStyles=B.LineEndingStyle=void 0;const D=requireParser(),F=util,O=annotation_errors,U=writerUtil;var G;(function(W){W[W.Square=0]="Square",W[W.Circle=1]="Circle",W[W.Diamond=2]="Diamond",W[W.OpenArrow=3]="OpenArrow",W[W.ClosedArrow=4]="ClosedArrow",W[W.Butt=5]="Butt",W[W.ROpenArrow=6]="ROpenArrow",W[W.RClosedArrow=7]="RClosedArrow",W[W.Slash=8]="Slash",W[W.None=9]="None"})(G=B.LineEndingStyle||(B.LineEndingStyle={})),function(W){W[W.Solid=0]="Solid",W[W.Dashed=1]="Dashed",W[W.Beveled=2]="Beveled",W[W.Inset=3]="Inset",W[W.Underline=4]="Underline"}(B.BorderStyles||(B.BorderStyles={}));class X{constructor(){this.object_id=void 0,this.is_deleted=!1,this.additional_objects_to_write=[],this.page=-1,this.pageReference=void 0,this.type="",this.type_encoded=[],this.rect=[],this.contents="",this.id="",this.updateDate="",this.takeAppearanceStreamFrom=void 0,this.factory=void 0}createDefaultAppearanceStream(){}writeAnnotationPreamble(){let z=U.WriterUtil.writeReferencePointer(this.object_id);return z.push(U.WriterUtil.SPACE),z=z.concat(U.WriterUtil.OBJ),z.push(U.WriterUtil.CR),z.push(U.WriterUtil.LF),z=z.concat(U.WriterUtil.DICT_START),z=z.concat(U.WriterUtil.TYPE_ANNOT),z.push(U.WriterUtil.SPACE),z}writeAnnotationObject(z){let K=[];if(K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.PAGE_REFERENCE),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.writeReferencePointer(this.pageReference.object_id,!0)),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.SUBTYPE),K.push(U.WriterUtil.SPACE),K=K.concat(this.type_encoded),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.RECT),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.writeNumberArray(this.rect)),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.CONTENTS),K.push(U.WriterUtil.SPACE),K.push(U.WriterUtil.BRACKET_START),K=K.concat(Array.from(F.Util.escapeString(z.encrypt(new Uint8Array(F.Util.convertStringToAscii(this.contents)),this.object_id)))),K.push(U.WriterUtil.BRACKET_END),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.ID),K.push(U.WriterUtil.SPACE),K.push(U.WriterUtil.BRACKET_START),K=K.concat(Array.from(F.Util.escapeString(z.encrypt(new Uint8Array(F.Util.convertStringToAscii(this.id)),this.object_id)))),K.push(U.WriterUtil.BRACKET_END),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.UPDATE_DATE),K.push(U.WriterUtil.SPACE),K.push(U.WriterUtil.BRACKET_START),K=K.concat(Array.from(F.Util.escapeString(z.encrypt(new Uint8Array(F.Util.convertStringToAscii(this.updateDate)),this.object_id)))),K.push(U.WriterUtil.BRACKET_END),K.push(U.WriterUtil.SPACE),this.appearanceStream&&(K=K.concat(U.WriterUtil.AP),K.push(U.WriterUtil.SPACE),K=K.concat(this.appearanceStream.writeAppearanceStream()),K.push(U.WriterUtil.SPACE)),this.annotationFlags){let J=this.encodeAnnotationFlags();K=K.concat(U.WriterUtil.FLAG),K.push(U.WriterUtil.SPACE),K=K.concat(F.Util.convertNumberToCharArray(J)),K.push(U.WriterUtil.SPACE)}if(this.border&&(K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.BORDER),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.writeNumberArray([this.border.horizontal_corner_radius||0,this.border.vertical_corner_radius||0,this.border.border_width||1])),K.push(U.WriterUtil.SPACE)),this.color&&(this.color=F.Util.colorToRange01(this.color),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.COLOR),K.push(U.WriterUtil.SPACE),K=K.concat(U.WriterUtil.writeNumberArray([this.color.r,this.color.g,this.color.b])),K.push(U.WriterUtil.SPACE)),this.raw_parameters&&this.raw_parameters.length>0)for(let J of this.raw_parameters)K.push(U.WriterUtil.SPACE),K=K.concat(J),K.push(U.WriterUtil.SPACE);return K}convertLineEndingStyle(z){switch(z){case G.Square:return F.Util.convertStringToAscii("/Square");case G.Circle:return F.Util.convertStringToAscii("/Circle");case G.Diamond:return F.Util.convertStringToAscii("/Diamond");case G.OpenArrow:return F.Util.convertStringToAscii("/OpenArrow");case G.ClosedArrow:return F.Util.convertStringToAscii("/ClosedArrow");case G.Butt:return F.Util.convertStringToAscii("/Butt");case G.ROpenArrow:return F.Util.convertStringToAscii("/ROpenArrow");case G.RClosedArrow:return F.Util.convertStringToAscii("/RClosedArrow");case G.Slash:return F.Util.convertStringToAscii("/Slash");default:return F.Util.convertStringToAscii("/None")}}writeAnnotationPostamble(){let z=[...U.WriterUtil.DICT_END];return z.push(U.WriterUtil.CR),z.push(U.WriterUtil.LF),z=z.concat(U.WriterUtil.ENDOBJ),z.push(U.WriterUtil.CR),z.push(U.WriterUtil.LF),z}encodeAnnotationFlags(){if(!this.annotationFlags)return 0;let z=0;return this.annotationFlags.invisible&&(z|=1),this.annotationFlags.hidden&&(z|=2),this.annotationFlags.print&&(z|=4),this.annotationFlags.noZoom&&(z|=8),this.annotationFlags.noRotate&&(z|=16),this.annotationFlags.noView&&(z|=32),this.annotationFlags.readOnly&&(z|=64),this.annotationFlags.locked&&(z|=128),this.annotationFlags.toggleNoView&&(z|=256),this.annotationFlags.lockedContents&&(z|=512),z}validate(z=!0){let K=this.checkRect(4,this.rect);K=K.concat(this.checkReferencePointer(this.object_id)),(!this.pageReference||typeof this.pageReference!="object")&&K.push(new O.InvalidReferencePointerError("Inalid page reference"));let J=this.checkDate(this.updateDate);if(J[1]&&(this.updateDate=J[1]),K=K.concat(J[0]),K=K.concat(this.checkColor(this.color)),(!this.id||this.id==="")&&K.push(new O.InvalidIDError("Invalid ID provided")),this.takeAppearanceStreamFrom)if(typeof this.takeAppearanceStreamFrom=="string"){let Q=[];this.factory._getAnnotations().forEach(et=>{Q=et.filter(it=>it.id===this.takeAppearanceStreamFrom)}),(Q.length===0||Q.length>1)&&K.push(new O.InvalidAnnotationReference("The provided string referencing the annotation to take the appearance stream from is not valid.")),Q[0].appearanceStream||K.push(new O.InvalidAppearanceStreamError("The referenced annotation has no specified appearance stream.")),this.appearanceStream=Q[0].appearanceStream}else this.takeAppearanceStreamFrom instanceof X&&(this.appearanceStream=this.takeAppearanceStreamFrom.appearanceStream);if(z)for(let Q of K)throw Q;return K}checkColor(z){let K=[];return z&&(z&&"r"in z&&"g"in z&&"b"in z||K.push(new O.InvalidColorError("Not {r: <r>, g: <g>, b: <b>}")),(z.r>255||z.r<0)&&K.push(new O.ColorOutOfRangeError("Red value out of range")),(z.g>255||z.g<0)&&K.push(new O.ColorOutOfRangeError("Green value out of range")),z.b>255&&z.b<0&&K.push(new O.ColorOutOfRangeError("Blue value out of range"))),K}checkReferencePointer(z){let K=[];return z&&"obj"in z&&z.obj>=0&&"generation"in z&&z.generation>=0||K.push(new O.InvalidReferencePointerError("Invalid reference pointer")),K}checkDate(z){if(typeof z=="string")return[[],z];let K=[],J;try{J=F.Util.convertDateToPDFDate(z)}catch{K.push(new O.InvalidDateError("Invalid update date provided"))}return[K,J]}checkRect(z,K){let J=[];return Array.isArray(K)||J.push(new O.InvalidRectError("invalid rect parameter")),K.length!==z&&J.push(new O.InvalidRectError("Rect has invalid number of entries: "+K+" has "+K.length+" entries, but should have "+z+" entries")),K.forEach(Q=>{typeof Q!="number"&&J.push(new O.InvalidRectError("Rect "+K+" has invalid entry: "+Q))}),J}extract(z,K,J){this.pageReference=K,this.type=z["/Subtype"],this.rect=z["/Rect"],z["/M"]&&(this.updateDate=F.Util.convertUnicodeToString(J.decrypt(z["/M"],this.object_id))),z["/Border"]&&(this.border=z["/Border"]),z["/C"]&&(this.color=z["/C"]),z["/NM"]&&(this.id=F.Util.convertUnicodeToString(J.decrypt(z["/NM"],this.object_id))),z["/Contents"]&&(this.contents=F.Util.convertUnicodeToString(J.decrypt(z["/Contents"],this.object_id))),z["/AP"]&&(this.appearanceStream=D.AppearanceStreamParser.parse(this,z["/AP"]))}}B.BaseAnnotationObj=X;class tt extends X{}B.RawAnnotationObj=tt,function(W){W[W.Reply=0]="Reply",W[W.Group=1]="Group"}(B.ReplyTypes||(B.ReplyTypes={}));class Y extends X{constructor(){super(),this.author="",this.opacity=1,this.subject=""}writeAnnotationObject(z){let K=super.writeAnnotationObject(z);return K=K.concat(U.WriterUtil.AUTHOR),K.push(U.WriterUtil.SPACE),K.push(U.WriterUtil.BRACKET_START),K=K.concat(Array.from(F.Util.escapeString(z.encrypt(new Uint8Array(F.Util.convertStringToAscii(this.author)),this.object_id)))),K.push(U.WriterUtil.BRACKET_END),K.push(U.WriterUtil.SPACE),this.opacity&&(K=K.concat(U.WriterUtil.OPACITY),K.push(U.WriterUtil.SPACE),K=K.concat(F.Util.convertNumberToCharArray(this.opacity)),K.push(U.WriterUtil.SPACE)),this.creationDate&&(K=K.concat(U.WriterUtil.CREATION_DATE),K.push(U.WriterUtil.SPACE),K.push(U.WriterUtil.BRACKET_START),K=K.concat(Array.from(F.Util.escapeString(z.encrypt(new Uint8Array(F.Util.convertStringToAscii(this.creationDate)),this.object_id)))),K.push(U.WriterUtil.BRACKET_END),K.push(U.WriterUtil.SPACE)),this.subject!==""&&(K=K.concat(U.WriterUtil.SUBJ),K.push(U.WriterUtil.SPACE),K.push(U.WriterUtil.BRACKET_START),K=K.concat(Array.from(F.Util.escapeString(z.encrypt(new Uint8Array(F.Util.convertStringToAscii(this.subject)),this.object_id)))),K.push(U.WriterUtil.BRACKET_END),K.push(U.WriterUtil.SPACE)),this.richtextString&&(K=K.concat(U.WriterUtil.RC),K.push(U.WriterUtil.SPACE),K.push(U.WriterUtil.BRACKET_START),K=K.concat(Array.from(F.Util.escapeString(z.encrypt(new Uint8Array(F.Util.convertStringToAscii(this.richtextString)),this.object_id)))),K.push(U.WriterUtil.BRACKET_END),K.push(U.WriterUtil.SPACE)),K}validate(z=!0){let K=super.validate(!1);if(this.opacity){try{this.opacity=+this.opacity}catch{K.push(new O.InvalidOpacityError("Opacity no numerical value"))}(this.opacity<0||this.opacity>255)&&K.push(new O.InvalidOpacityError("Opacity out of range"))}if(this.creationDate){let J=this.checkDate(this.creationDate);this.creationDate=J[1],K=K.concat(J[0])}if(z)for(let J of K)throw J;return K}extract(z,K,J){super.extract(z,K,J),z["/T"]&&(this.author=F.Util.convertUnicodeToString(J.decrypt(z["/T"],this.object_id)))}}B.MarkupAnnotationObj=Y}(annotation_types)),annotation_types}var text_annotation={},appearanceStream={},contentStream={},freetext_annotation={},resources={};Object.defineProperty(resources,"__esModule",{value:!0});resources.Resource=void 0;const writer_util_1$1=writerUtil,util_1$2=util;class Resource{constructor(){this.object_id=void 0,this.new_object=!1,this.associatedWith=void 0,this.extGState=[],this.colorSpace=[],this.pattern=[],this.shading=[],this.xObject=[],this.font=[],this.procSet=[],this.properties=[]}containsResourceDef(D,F){return F.filter(O=>O.name===D.name&&D.refPtr&&O.refPtr&&D.refPtr.obj===O.refPtr.obj&&D.refPtr.generation===O.refPtr.generation).length>0}addGStateDef(D){this.containsResourceDef(D,this.extGState)||this.extGState.push(D)}addColorSpaceDef(D){this.containsResourceDef(D,this.colorSpace)||this.colorSpace.push(D)}addPatternDef(D){this.containsResourceDef(D,this.pattern)||this.pattern.push(D)}addShadingDef(D){this.containsResourceDef(D,this.shading)||this.shading.push(D)}addXObjectDef(D){this.containsResourceDef(D,this.xObject)||this.xObject.push(D)}addFontDef(D){this.containsResourceDef(D,this.font)||this.font.push(D)}addProcSetDef(D){this.containsResourceDef(D,this.procSet)||this.procSet.push(D)}addProperty(D){this.containsResourceDef(D,this.properties)||this.properties.push(D)}writeDictAttribute(D){let F=[];F=F.concat(writer_util_1$1.WriterUtil.DICT_START),F.push(writer_util_1$1.WriterUtil.SPACE);for(let O of D){if(O.name=O.name.trim(),O.name.charAt(0)!=="/"&&(O.name=`/${O.name}`),F=F.concat(util_1$2.Util.convertStringToAscii(O.name)),F.push(writer_util_1$1.WriterUtil.SPACE),!O.refPtr)throw Error("Missing reference pointer in resource definition");F=F.concat(writer_util_1$1.WriterUtil.writeReferencePointer(O.refPtr,!0)),F.push(writer_util_1$1.WriterUtil.SPACE)}return F=F.concat(writer_util_1$1.WriterUtil.DICT_END),F}writeArrayAttribute(D){let F=[];F=F.concat(writer_util_1$1.WriterUtil.ARRAY_START);for(let O of D)O.name=O.name.trim(),O.name.charAt(0)!=="/"&&(O.name=`/${O.name}`),F=F.concat(util_1$2.Util.convertStringToAscii(O.name)),F.push(writer_util_1$1.WriterUtil.SPACE);return F=F.concat(writer_util_1$1.WriterUtil.ARRAY_END),F}writeResource(){let D=[];return D=D.concat(writer_util_1$1.WriterUtil.DICT_START),D.push(writer_util_1$1.WriterUtil.SPACE),this.extGState.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.EXTGSTATE),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeDictAttribute(this.extGState)),D.push(writer_util_1$1.WriterUtil.SPACE)),this.colorSpace.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.COLORSPACE),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeDictAttribute(this.colorSpace)),D.push(writer_util_1$1.WriterUtil.SPACE)),this.pattern.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.PATTERN),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeDictAttribute(this.pattern)),D.push(writer_util_1$1.WriterUtil.SPACE)),this.shading.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.SHADING),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeDictAttribute(this.shading)),D.push(writer_util_1$1.WriterUtil.SPACE)),this.xObject.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.XOBJECT),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeDictAttribute(this.xObject)),D.push(writer_util_1$1.WriterUtil.SPACE)),this.font.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.FONT),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeDictAttribute(this.font)),D.push(writer_util_1$1.WriterUtil.SPACE)),this.procSet.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.PROCSET),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeArrayAttribute(this.procSet)),D.push(writer_util_1$1.WriterUtil.SPACE)),this.properties.length>0&&(D=D.concat(writer_util_1$1.WriterUtil.PROPERTIES),D.push(writer_util_1$1.WriterUtil.SPACE),D=D.concat(this.writeDictAttribute(this.properties)),D.push(writer_util_1$1.WriterUtil.SPACE)),D=D.concat(writer_util_1$1.WriterUtil.DICT_END),D}extract(D){if(D["/ExtGState"])for(let F of Object.keys(D["/ExtGState"]))this.addGStateDef({name:F,refPtr:D["/ExtGState"][F]});if(D["/ColorSpace"])for(let F of Object.keys(D["/ColorSpace"]))this.addColorSpaceDef({name:F,refPtr:D["/ColorSpace"][F]});if(D["/Pattern"])for(let F of Object.keys(D["/Pattern"]))this.addPatternDef({name:F,refPtr:D["/Pattern"][F]});if(D["/Shading"])for(let F of Object.keys(D["/Shading"]))this.addShadingDef({name:F,refPtr:D["/Shading"][F]});if(D["/XObject"])for(let F of Object.keys(D["/XObject"]))this.addXObjectDef({name:F,refPtr:D["/XObject"][F]});if(D["/Font"])for(let F of Object.keys(D["/Font"]))this.addFontDef({name:F,refPtr:D["/Font"][F]});if(D["/ProcSet"])for(let F of Object.keys(D["/ProcSet"]))this.addProcSetDef({name:F,refPtr:D["/ProcSet"][F]});if(D["/Properties"])for(let F of Object.keys(D["/Properties"]))this.addProperty({name:F,refPtr:D["/Properties"][F]})}}resources.Resource=Resource;var fonts={},fontData={};Object.defineProperty(fontData,"__esModule",{value:!0});fontData.STANDARD_FONT_DATA=void 0;fontData.STANDARD_FONT_DATA={"Times-Roman":{widths:[250,333,408,500,500,833,778,333,333,333,500,564,250,333,250,278,500,500,500,500,500,500,500,500,500,500,278,278,564,564,564,444,921,722,667,667,722,611,556,722,722,333,389,722,611,889,722,722,556,722,667,556,611,722,722,944,722,722,611,333,278,333,469,500,333,444,500,444,500,444,333,500,500,278,278,500,278,778,500,500,500,500,333,389,278,500,500,722,500,500,444,480,200,480,541,333,500,500,167,500,500,500,500,180,444,500,333,333,556,556,500,500,500,250,453,350,333,444,444,500,1e3,1e3,444,333,333,333,333,333,333,333,333,333,333,333,333,333,1e3,889,276,611,722,889,310,667,278,278,500,722,500,333,444,444,500,444,722,564,722,722,444,722,500,389,444,722,722,444,722,500,611,722,250,760,611,444,444,722,278,444,611,667,444,611,389,389,278,471,667,722,500,444,722,333,444,611,556,722,667,556,588,722,500,300,722,722,722,564,500,611,476,500,722,278,611,444,444,444,500,500,722,333,564,200,760,722,333,600,611,333,500,611,611,549,722,667,278,326,444,722,722,722,444,444,278,722,500,444,389,278,722,722,612,500,300,722,500,278,500,611,500,750,556,344,722,611,980,444,333,333,611,750,549,500,500,722,611,444,500,750,556,556,722,400,500,667,500,453,722,333,722,500,667,611,722,722,722,722,444,611,333,500,564,333,500,278,564,500,500,549,500,500,444,500,300,278,500],firstChar:32,lastChar:251,familyName:"Times",fontWeight:"Roman",italicAngle:0,fontBBox:[-168,-218,1e3,898],capHeight:662,xHeight:450,ascent:683,descent:-217,stemH:28,stemV:84,flag:34,kernings:[[65,67,-40],[65,71,-40],[65,79,-55],[65,233,-55],[65,81,-55],[65,84,-111],[65,85,-55],[65,86,-135],[65,87,-90],[65,89,-105],[65,39,-111],[65,118,-74],[65,119,-92],[65,121,-92],[66,65,-35],[66,85,-10],[68,65,-40],[68,86,-40],[68,87,-30],[68,89,-55],[70,65,-74],[70,97,-15],[70,44,-80],[70,111,-15],[70,249,-15],[70,46,-80],[74,65,-60],[75,79,-30],[75,233,-30],[75,101,-25],[75,111,-35],[75,249,-35],[75,117,-15],[75,121,-25],[76,84,-92],[76,86,-100],[76,87,-74],[76,89,-100],[76,39,-92],[76,121,-55],[232,84,-92],[232,86,-100],[232,87,-74],[232,89,-100],[232,39,-92],[232,121,-55],[78,65,-35],[79,65,-35],[79,84,-40],[79,86,-50],[79,87,-35],[79,88,-40],[79,89,-50],[233,65,-35],[233,84,-40],[233,86,-50],[233,87,-35],[233,88,-40],[233,89,-50],[80,65,-92],[80,97,-15],[80,44,-111],[80,46,-111],[81,85,-10],[82,79,-40],[82,233,-40],[82,84,-60],[82,85,-40],[82,86,-80],[82,87,-55],[82,89,-65],[84,65,-93],[84,79,-18],[84,233,-18],[84,97,-80],[84,58,-50],[84,44,-74],[84,101,-70],[84,45,-92],[84,105,-35],[84,111,-80],[84,249,-80],[84,46,-74],[84,114,-35],[84,59,-55],[84,117,-45],[84,119,-80],[84,121,-80],[85,65,-40],[86,65,-135],[86,71,-15],[86,79,-40],[86,233,-40],[86,97,-111],[86,58,-74],[86,44,-129],[86,101,-111],[86,45,-100],[86,105,-60],[86,111,-129],[86,249,-129],[86,46,-129],[86,59,-74],[86,117,-75],[87,65,-120],[87,79,-10],[87,233,-10],[87,97,-80],[87,58,-37],[87,44,-92],[87,101,-80],[87,45,-65],[87,105,-40],[87,111,-80],[87,249,-80],[87,46,-92],[87,59,-37],[87,117,-50],[87,121,-73],[89,65,-120],[89,79,-30],[89,233,-30],[89,97,-100],[89,58,-92],[89,44,-129],[89,101,-100],[89,45,-111],[89,105,-55],[89,111,-110],[89,249,-110],[89,46,-129],[89,59,-92],[89,117,-111],[97,118,-20],[97,119,-15],[98,46,-40],[98,117,-20],[98,118,-15],[99,121,-15],[44,186,-70],[44,39,-70],[101,103,-15],[101,118,-25],[101,119,-25],[101,120,-15],[101,121,-15],[102,97,-10],[102,245,-50],[102,102,-25],[102,105,-20],[102,39,55],[103,97,-5],[104,121,-5],[105,118,-25],[107,101,-10],[107,111,-10],[107,249,-10],[107,121,-15],[108,119,-10],[248,119,-10],[110,118,-40],[110,121,-15],[111,118,-15],[111,119,-25],[111,121,-10],[249,118,-15],[249,119,-25],[249,121,-10],[112,121,-10],[46,186,-70],[46,39,-70],[170,65,-80],[96,65,-80],[96,96,-74],[39,100,-50],[39,108,-10],[39,248,-10],[39,39,-74],[39,114,-50],[39,115,-55],[39,32,-74],[39,116,-18],[39,118,-50],[114,44,-40],[114,103,-18],[114,45,-20],[114,46,-55],[32,65,-55],[32,84,-18],[32,86,-50],[32,87,-30],[32,89,-90],[118,97,-25],[118,44,-65],[118,101,-15],[118,111,-20],[118,249,-20],[118,46,-65],[119,97,-10],[119,44,-65],[119,111,-10],[119,249,-10],[119,46,-65],[120,101,-15],[121,44,-65],[121,46,-65]]},ZapfDingbats:{widths:[278,974,961,974,980,719,789,790,791,690,960,939,549,855,911,933,911,945,974,755,846,762,761,571,677,763,760,759,754,494,552,537,577,692,786,788,788,790,793,794,816,823,789,841,823,833,816,831,923,744,723,749,790,792,695,776,768,792,759,707,708,682,701,826,815,789,789,707,687,696,689,786,787,713,791,785,791,873,761,762,762,759,759,892,892,788,784,438,138,277,415,392,392,668,668,390,390,317,317,276,276,509,509,410,410,234,234,334,334,732,544,544,910,667,760,760,776,595,694,626,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,894,838,1016,458,748,924,748,918,927,928,928,834,873,828,924,924,917,930,931,463,883,836,836,867,867,696,696,874,874,760,946,771,865,771,888,967,888,831,873,927,970,918],firstChar:32,lastChar:254,familyName:"ZapfDingbats",fontWeight:"Medium",italicAngle:0,fontBBox:[-1,-143,981,820],stemH:28,stemV:90,flag:4,kernings:[]},Helvetica:{widths:[278,278,355,556,556,889,667,222,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,222,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,167,556,556,556,556,191,333,556,333,333,500,500,556,556,556,278,537,350,222,333,333,556,1e3,1e3,611,333,333,333,333,333,333,333,333,333,333,333,333,333,1e3,1e3,370,556,778,1e3,365,889,278,222,611,944,611,278,556,556,556,556,667,584,667,667,556,722,500,500,556,722,722,556,722,556,667,722,250,737,667,500,556,722,222,556,611,722,556,667,500,500,278,471,722,778,556,556,667,333,500,611,667,778,722,667,643,722,556,333,778,667,667,584,556,611,476,500,722,278,667,556,556,500,556,556,722,278,584,260,737,778,278,600,667,333,556,611,611,549,722,722,222,317,556,722,667,667,556,500,222,778,556,556,500,278,778,722,612,556,333,778,556,278,556,667,556,834,667,299,667,556,1e3,556,278,278,556,834,549,556,556,722,667,556,556,834,667,667,778,400,556,722,556,453,722,333,722,556,722,556,667,667,667,778,500,667,278,500,584,278,556,278,584,556,556,549,556,556,500,556,333,278,556],firstChar:32,lastChar:251,familyName:"Helvetica",fontWeight:"Medium",italicAngle:0,fontBBox:[-166,-225,1e3,931],capHeight:718,xHeight:523,ascent:718,descent:-207,stemH:76,stemV:88,flag:32,kernings:[[65,67,-30],[65,71,-30],[65,79,-30],[65,233,-30],[65,81,-30],[65,84,-120],[65,85,-50],[65,86,-70],[65,87,-50],[65,89,-100],[65,117,-30],[65,118,-40],[65,119,-40],[65,121,-40],[66,85,-10],[66,44,-20],[66,46,-20],[67,44,-30],[67,46,-30],[68,65,-40],[68,86,-70],[68,87,-40],[68,89,-90],[68,44,-70],[68,46,-70],[70,65,-80],[70,97,-50],[70,44,-150],[70,101,-30],[70,111,-30],[70,249,-30],[70,46,-150],[70,114,-45],[74,65,-20],[74,97,-20],[74,44,-30],[74,46,-30],[74,117,-20],[75,79,-50],[75,233,-50],[75,101,-40],[75,111,-40],[75,249,-40],[75,117,-30],[75,121,-50],[76,84,-110],[76,86,-110],[76,87,-70],[76,89,-140],[76,186,-140],[76,39,-160],[76,121,-30],[232,84,-110],[232,86,-110],[232,87,-70],[232,89,-140],[232,186,-140],[232,39,-160],[232,121,-30],[79,65,-20],[79,84,-40],[79,86,-50],[79,87,-30],[79,88,-60],[79,89,-70],[79,44,-40],[79,46,-40],[233,65,-20],[233,84,-40],[233,86,-50],[233,87,-30],[233,88,-60],[233,89,-70],[233,44,-40],[233,46,-40],[80,65,-120],[80,97,-40],[80,44,-180],[80,101,-50],[80,111,-50],[80,249,-50],[80,46,-180],[81,85,-10],[82,79,-20],[82,233,-20],[82,84,-30],[82,85,-40],[82,86,-50],[82,87,-30],[82,89,-50],[83,44,-20],[83,46,-20],[84,65,-120],[84,79,-40],[84,233,-40],[84,97,-120],[84,58,-20],[84,44,-120],[84,101,-120],[84,45,-140],[84,111,-120],[84,249,-120],[84,46,-120],[84,114,-120],[84,59,-20],[84,117,-120],[84,119,-120],[84,121,-120],[85,65,-40],[85,44,-40],[85,46,-40],[86,65,-80],[86,71,-40],[86,79,-40],[86,233,-40],[86,97,-70],[86,58,-40],[86,44,-125],[86,101,-80],[86,45,-80],[86,111,-80],[86,249,-80],[86,46,-125],[86,59,-40],[86,117,-70],[87,65,-50],[87,79,-20],[87,233,-20],[87,97,-40],[87,44,-80],[87,101,-30],[87,45,-40],[87,111,-30],[87,249,-30],[87,46,-80],[87,117,-30],[87,121,-20],[89,65,-110],[89,79,-85],[89,233,-85],[89,97,-140],[89,58,-60],[89,44,-140],[89,101,-140],[89,45,-140],[89,105,-20],[89,111,-140],[89,249,-140],[89,46,-140],[89,59,-60],[89,117,-110],[97,118,-20],[97,119,-20],[97,121,-30],[98,98,-10],[98,44,-40],[98,108,-20],[98,248,-20],[98,46,-40],[98,117,-20],[98,118,-20],[98,121,-20],[99,44,-15],[99,107,-20],[58,32,-50],[44,186,-100],[44,39,-100],[101,44,-15],[101,46,-15],[101,118,-30],[101,119,-20],[101,120,-30],[101,121,-20],[102,97,-30],[102,44,-30],[102,245,-28],[102,101,-30],[102,111,-30],[102,249,-30],[102,46,-30],[102,186,60],[102,39,50],[103,114,-10],[104,121,-30],[107,101,-20],[107,111,-20],[107,249,-20],[109,117,-10],[109,121,-15],[110,117,-10],[110,118,-20],[110,121,-15],[111,44,-40],[111,46,-40],[111,118,-15],[111,119,-15],[111,120,-30],[111,121,-30],[249,97,-55],[249,98,-55],[249,99,-55],[249,44,-95],[249,100,-55],[249,101,-55],[249,102,-55],[249,103,-55],[249,104,-55],[249,105,-55],[249,106,-55],[249,107,-55],[249,108,-55],[249,248,-55],[249,109,-55],[249,110,-55],[249,111,-55],[249,249,-55],[249,112,-55],[249,46,-95],[249,113,-55],[249,114,-55],[249,115,-55],[249,116,-55],[249,117,-55],[249,118,-70],[249,119,-70],[249,120,-85],[249,121,-70],[249,122,-55],[112,44,-35],[112,46,-35],[112,121,-30],[46,186,-100],[46,39,-100],[46,32,-60],[186,32,-40],[96,96,-57],[39,100,-50],[39,39,-57],[39,114,-50],[39,115,-50],[39,32,-70],[114,97,-10],[114,58,30],[114,44,-50],[114,105,15],[114,107,15],[114,108,15],[114,248,15],[114,109,25],[114,110,25],[114,112,30],[114,46,-50],[114,59,30],[114,116,40],[114,117,15],[114,118,30],[114,121,30],[115,44,-15],[115,46,-15],[115,119,-30],[59,32,-50],[32,84,-50],[32,86,-50],[32,87,-40],[32,89,-90],[32,170,-30],[32,96,-60],[118,97,-25],[118,44,-80],[118,101,-25],[118,111,-25],[118,249,-25],[118,46,-80],[119,97,-15],[119,44,-60],[119,101,-10],[119,111,-10],[119,249,-10],[119,46,-60],[120,101,-30],[121,97,-20],[121,44,-100],[121,101,-20],[121,111,-20],[121,249,-20],[121,46,-100],[122,101,-15],[122,111,-15],[122,249,-15]]},"Courier-Oblique":{widths:[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],firstChar:32,lastChar:251,familyName:"Courier",fontWeight:"Medium",italicAngle:-12,fontBBox:[-27,-250,849,805],capHeight:562,xHeight:426,ascent:629,descent:-157,stemH:51,stemV:51,flag:35,kernings:[]},"Times-BoldItalic":{widths:[250,389,555,500,500,833,778,333,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,832,667,667,667,722,667,667,722,778,389,500,667,611,889,722,722,611,722,667,556,611,722,667,889,667,611,611,333,278,333,570,500,333,500,500,444,500,444,333,500,556,278,278,500,278,778,556,500,500,500,389,389,278,556,444,667,500,444,389,348,220,348,570,389,500,500,167,500,500,500,500,278,500,500,333,333,556,556,500,500,500,250,500,350,333,500,500,500,1e3,1e3,500,333,333,333,333,333,333,333,333,333,333,333,333,333,1e3,944,266,611,722,944,300,722,278,278,500,722,500,389,444,500,556,444,611,570,611,667,500,722,444,389,444,722,722,500,722,556,667,722,250,747,667,444,500,722,278,500,611,667,500,667,389,389,278,494,667,722,556,500,667,389,444,611,611,722,667,556,608,722,556,300,722,667,667,570,556,611,494,444,722,278,667,500,444,444,556,556,722,389,570,220,747,722,389,600,667,389,500,611,611,549,722,667,278,366,444,722,667,667,444,389,278,722,500,500,389,278,722,722,612,500,300,722,576,278,500,667,500,750,556,382,667,611,1e3,444,389,389,611,750,549,500,556,722,667,444,500,750,556,556,722,400,500,667,556,549,722,389,722,500,667,611,667,667,667,722,389,667,389,500,606,389,556,278,606,500,556,549,500,500,389,556,300,278,500],firstChar:32,lastChar:251,familyName:"Times",fontWeight:"Bold",italicAngle:-15,fontBBox:[-200,-218,996,921],capHeight:669,xHeight:462,ascent:683,descent:-217,stemH:42,stemV:121,flag:34,kernings:[[65,67,-65],[65,71,-60],[65,79,-50],[65,233,-50],[65,81,-55],[65,84,-55],[65,85,-50],[65,86,-95],[65,87,-100],[65,89,-70],[65,39,-74],[65,117,-30],[65,118,-74],[65,119,-74],[65,121,-74],[66,65,-25],[66,85,-10],[68,65,-25],[68,86,-50],[68,87,-40],[68,89,-50],[70,65,-100],[70,97,-95],[70,44,-129],[70,101,-100],[70,105,-40],[70,111,-70],[70,249,-70],[70,46,-129],[70,114,-50],[74,65,-25],[74,97,-40],[74,44,-10],[74,101,-40],[74,111,-40],[74,249,-40],[74,46,-10],[74,117,-40],[75,79,-30],[75,233,-30],[75,101,-25],[75,111,-25],[75,249,-25],[75,117,-20],[75,121,-20],[76,84,-18],[76,86,-37],[76,87,-37],[76,89,-37],[76,39,-55],[76,121,-37],[232,84,-18],[232,86,-37],[232,87,-37],[232,89,-37],[232,39,-55],[232,121,-37],[78,65,-30],[79,65,-40],[79,84,-40],[79,86,-50],[79,87,-50],[79,88,-40],[79,89,-50],[233,65,-40],[233,84,-40],[233,86,-50],[233,87,-50],[233,88,-40],[233,89,-50],[80,65,-85],[80,97,-40],[80,44,-129],[80,101,-50],[80,111,-55],[80,249,-55],[80,46,-129],[81,85,-10],[82,79,-40],[82,233,-40],[82,84,-30],[82,85,-40],[82,86,-18],[82,87,-18],[82,89,-18],[84,65,-55],[84,79,-18],[84,233,-18],[84,97,-92],[84,58,-74],[84,44,-92],[84,101,-92],[84,45,-92],[84,105,-37],[84,111,-95],[84,249,-95],[84,46,-92],[84,114,-37],[84,59,-74],[84,117,-37],[84,119,-37],[84,121,-37],[85,65,-45],[86,65,-85],[86,71,-10],[86,79,-30],[86,233,-30],[86,97,-111],[86,58,-74],[86,44,-129],[86,101,-111],[86,45,-70],[86,105,-55],[86,111,-111],[86,249,-111],[86,46,-129],[86,59,-74],[86,117,-55],[87,65,-74],[87,79,-15],[87,233,-15],[87,97,-85],[87,58,-55],[87,44,-74],[87,101,-90],[87,45,-50],[87,105,-37],[87,111,-80],[87,249,-80],[87,46,-74],[87,59,-55],[87,117,-55],[87,121,-55],[89,65,-74],[89,79,-25],[89,233,-25],[89,97,-92],[89,58,-92],[89,44,-92],[89,101,-111],[89,45,-92],[89,105,-55],[89,111,-111],[89,249,-111],[89,46,-74],[89,59,-92],[89,117,-92],[98,98,-10],[98,46,-40],[98,117,-20],[99,104,-10],[99,107,-10],[44,186,-95],[44,39,-95],[101,98,-10],[102,44,-10],[102,245,-30],[102,101,-10],[102,102,-18],[102,111,-10],[102,249,-10],[102,46,-10],[102,39,55],[107,101,-30],[107,111,-10],[107,249,-10],[110,118,-40],[111,118,-15],[111,119,-25],[111,120,-10],[111,121,-10],[249,118,-15],[249,119,-25],[249,120,-10],[249,121,-10],[46,186,-95],[46,39,-95],[96,96,-74],[39,100,-15],[39,39,-74],[39,114,-15],[39,115,-74],[39,32,-74],[39,116,-37],[39,118,-15],[114,44,-65],[114,46,-65],[32,65,-37],[32,86,-70],[32,87,-70],[32,89,-70],[118,44,-37],[118,101,-15],[118,111,-15],[118,249,-15],[118,46,-37],[119,97,-10],[119,44,-37],[119,101,-10],[119,111,-15],[119,249,-15],[119,46,-37],[120,101,-10],[121,44,-37],[121,46,-37]]},"Courier-BoldOblique":{widths:[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],firstChar:32,lastChar:251,familyName:"Courier",fontWeight:"Bold",italicAngle:-12,fontBBox:[-57,-250,869,801],capHeight:562,xHeight:439,ascent:629,descent:-157,stemH:84,stemV:106,flag:35,kernings:[]},"Times-Bold":{widths:[250,333,555,500,500,1e3,833,333,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,930,722,667,722,722,667,611,778,778,389,500,778,667,944,722,778,611,778,722,556,667,722,722,1e3,722,722,667,333,278,333,581,500,333,500,556,444,556,444,333,500,556,278,333,556,278,833,556,500,556,556,444,389,333,556,500,722,500,500,444,394,220,394,520,333,500,500,167,500,500,500,500,278,500,500,333,333,556,556,500,500,500,250,540,350,333,500,500,500,1e3,1e3,500,333,333,333,333,333,333,333,333,333,333,333,333,333,1e3,1e3,300,667,778,1e3,330,722,278,278,500,722,556,389,444,500,556,444,722,570,722,722,500,722,500,389,444,722,722,500,722,556,667,722,250,747,667,444,500,722,278,500,667,722,500,667,389,389,278,494,722,778,556,500,722,444,444,667,611,778,722,556,672,722,556,300,778,722,722,570,556,667,494,500,722,278,667,500,444,444,556,556,722,389,570,220,747,778,389,600,667,444,500,667,667,549,722,722,278,416,444,722,722,722,444,444,278,778,500,500,389,278,778,722,612,556,300,778,556,278,500,667,556,750,556,394,778,667,1e3,444,389,389,667,750,549,500,556,722,667,444,500,750,556,556,778,400,500,722,556,549,722,444,722,500,722,667,722,722,722,778,444,667,389,556,570,389,556,333,570,500,556,549,500,500,444,556,300,278,500],firstChar:32,lastChar:251,familyName:"Times",fontWeight:"Bold",italicAngle:0,fontBBox:[-168,-218,1e3,935],capHeight:676,xHeight:461,ascent:683,descent:-217,stemH:44,stemV:139,flag:34,kernings:[[65,67,-55],[65,71,-55],[65,79,-45],[65,233,-45],[65,81,-45],[65,84,-95],[65,85,-50],[65,86,-145],[65,87,-130],[65,89,-100],[65,112,-25],[65,39,-74],[65,117,-50],[65,118,-100],[65,119,-90],[65,121,-74],[66,65,-30],[66,85,-10],[68,65,-35],[68,86,-40],[68,87,-40],[68,89,-40],[68,46,-20],[70,65,-90],[70,97,-25],[70,44,-92],[70,101,-25],[70,111,-25],[70,249,-25],[70,46,-110],[74,65,-30],[74,97,-15],[74,101,-15],[74,111,-15],[74,249,-15],[74,46,-20],[74,117,-15],[75,79,-30],[75,233,-30],[75,101,-25],[75,111,-25],[75,249,-25],[75,117,-15],[75,121,-45],[76,84,-92],[76,86,-92],[76,87,-92],[76,89,-92],[76,186,-20],[76,39,-110],[76,121,-55],[232,84,-92],[232,86,-92],[232,87,-92],[232,89,-92],[232,186,-20],[232,39,-110],[232,121,-55],[78,65,-20],[79,65,-40],[79,84,-40],[79,86,-50],[79,87,-50],[79,88,-40],[79,89,-50],[233,65,-40],[233,84,-40],[233,86,-50],[233,87,-50],[233,88,-40],[233,89,-50],[80,65,-74],[80,97,-10],[80,44,-92],[80,101,-20],[80,111,-20],[80,249,-20],[80,46,-110],[81,85,-10],[81,46,-20],[82,79,-30],[82,233,-30],[82,84,-40],[82,85,-30],[82,86,-55],[82,87,-35],[82,89,-35],[84,65,-90],[84,79,-18],[84,233,-18],[84,97,-92],[84,58,-74],[84,44,-74],[84,101,-92],[84,45,-92],[84,105,-18],[84,111,-92],[84,249,-92],[84,46,-90],[84,114,-74],[84,59,-74],[84,117,-92],[84,119,-74],[84,121,-34],[85,65,-60],[85,44,-50],[85,46,-50],[86,65,-135],[86,71,-30],[86,79,-45],[86,233,-45],[86,97,-92],[86,58,-92],[86,44,-129],[86,101,-100],[86,45,-74],[86,105,-37],[86,111,-100],[86,249,-100],[86,46,-145],[86,59,-92],[86,117,-92],[87,65,-120],[87,79,-10],[87,233,-10],[87,97,-65],[87,58,-55],[87,44,-92],[87,101,-65],[87,45,-37],[87,105,-18],[87,111,-75],[87,249,-75],[87,46,-92],[87,59,-55],[87,117,-50],[87,121,-60],[89,65,-110],[89,79,-35],[89,233,-35],[89,97,-85],[89,58,-92],[89,44,-92],[89,101,-111],[89,45,-92],[89,105,-37],[89,111,-111],[89,249,-111],[89,46,-92],[89,59,-92],[89,117,-92],[97,118,-25],[98,98,-10],[98,46,-40],[98,117,-20],[98,118,-15],[44,186,-45],[44,39,-55],[100,119,-15],[101,118,-15],[102,44,-15],[102,245,-35],[102,105,-25],[102,111,-25],[102,249,-25],[102,46,-15],[102,186,50],[102,39,55],[103,46,-15],[104,121,-15],[105,118,-10],[107,101,-10],[107,111,-15],[107,249,-15],[107,121,-15],[110,118,-40],[111,118,-10],[111,119,-10],[249,118,-10],[249,119,-10],[46,186,-55],[46,39,-55],[170,65,-10],[96,65,-10],[96,96,-63],[39,100,-20],[39,39,-63],[39,114,-20],[39,115,-37],[39,32,-74],[39,118,-20],[114,99,-18],[114,44,-92],[114,101,-18],[114,103,-10],[114,45,-37],[114,110,-15],[114,111,-18],[114,249,-18],[114,112,-10],[114,46,-100],[114,113,-18],[114,118,-10],[32,65,-55],[32,84,-30],[32,86,-45],[32,87,-30],[32,89,-55],[118,97,-10],[118,44,-55],[118,101,-10],[118,111,-10],[118,249,-10],[118,46,-70],[119,44,-55],[119,111,-10],[119,249,-10],[119,46,-70],[121,44,-55],[121,101,-10],[121,111,-25],[121,249,-25],[121,46,-70]]},Courier:{widths:[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],firstChar:32,lastChar:251,familyName:"Courier",fontWeight:"Medium",italicAngle:0,fontBBox:[-23,-250,715,805],capHeight:562,xHeight:426,ascent:629,descent:-157,stemH:51,stemV:51,flag:35,kernings:[]},"Helvetica-BoldOblique":{widths:[278,333,474,556,556,889,722,278,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,278,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,167,556,556,556,556,238,500,556,333,333,611,611,556,556,556,278,556,350,278,500,500,556,1e3,1e3,611,333,333,333,333,333,333,333,333,333,333,333,333,333,1e3,1e3,370,611,778,1e3,365,889,278,278,611,944,611,278,556,556,611,556,667,584,667,722,556,722,556,556,556,722,722,556,722,611,667,722,250,737,667,556,556,722,278,556,611,722,556,667,556,556,278,494,722,778,611,556,722,389,556,611,667,778,722,667,743,722,611,333,778,722,722,584,611,611,494,556,722,278,667,556,556,556,611,611,722,278,584,280,737,778,278,600,667,389,611,611,611,549,722,722,278,389,556,722,722,722,556,500,278,778,611,556,556,278,778,722,612,611,333,778,611,278,611,667,611,834,667,400,722,611,1e3,556,278,278,611,834,549,611,611,722,667,556,611,834,667,667,778,400,611,722,611,549,722,389,722,611,722,611,722,722,722,778,500,667,278,556,584,278,611,333,584,611,611,549,611,611,500,611,333,278,556],firstChar:32,lastChar:251,familyName:"Helvetica",fontWeight:"Bold",italicAngle:-12,fontBBox:[-174,-228,1114,962],capHeight:718,xHeight:532,ascent:718,descent:-207,stemH:118,stemV:140,flag:32,kernings:[[65,67,-40],[65,71,-50],[65,79,-40],[65,233,-40],[65,81,-40],[65,84,-90],[65,85,-50],[65,86,-80],[65,87,-60],[65,89,-110],[65,117,-30],[65,118,-40],[65,119,-30],[65,121,-30],[66,65,-30],[66,85,-10],[68,65,-40],[68,86,-40],[68,87,-40],[68,89,-70],[68,44,-30],[68,46,-30],[70,65,-80],[70,97,-20],[70,44,-100],[70,46,-100],[74,65,-20],[74,44,-20],[74,46,-20],[74,117,-20],[75,79,-30],[75,233,-30],[75,101,-15],[75,111,-35],[75,249,-35],[75,117,-30],[75,121,-40],[76,84,-90],[76,86,-110],[76,87,-80],[76,89,-120],[76,186,-140],[76,39,-140],[76,121,-30],[232,84,-90],[232,86,-110],[232,87,-80],[232,89,-120],[232,186,-140],[232,39,-140],[232,121,-30],[79,65,-50],[79,84,-40],[79,86,-50],[79,87,-50],[79,88,-50],[79,89,-70],[79,44,-40],[79,46,-40],[233,65,-50],[233,84,-40],[233,86,-50],[233,87,-50],[233,88,-50],[233,89,-70],[233,44,-40],[233,46,-40],[80,65,-100],[80,97,-30],[80,44,-120],[80,101,-30],[80,111,-40],[80,249,-40],[80,46,-120],[81,85,-10],[81,44,20],[81,46,20],[82,79,-20],[82,233,-20],[82,84,-20],[82,85,-20],[82,86,-50],[82,87,-40],[82,89,-50],[84,65,-90],[84,79,-40],[84,233,-40],[84,97,-80],[84,58,-40],[84,44,-80],[84,101,-60],[84,45,-120],[84,111,-80],[84,249,-80],[84,46,-80],[84,114,-80],[84,59,-40],[84,117,-90],[84,119,-60],[84,121,-60],[85,65,-50],[85,44,-30],[85,46,-30],[86,65,-80],[86,71,-50],[86,79,-50],[86,233,-50],[86,97,-60],[86,58,-40],[86,44,-120],[86,101,-50],[86,45,-80],[86,111,-90],[86,249,-90],[86,46,-120],[86,59,-40],[86,117,-60],[87,65,-60],[87,79,-20],[87,233,-20],[87,97,-40],[87,58,-10],[87,44,-80],[87,101,-35],[87,45,-40],[87,111,-60],[87,249,-60],[87,46,-80],[87,59,-10],[87,117,-45],[87,121,-20],[89,65,-110],[89,79,-70],[89,233,-70],[89,97,-90],[89,58,-50],[89,44,-100],[89,101,-80],[89,111,-100],[89,249,-100],[89,46,-100],[89,59,-50],[89,117,-100],[97,103,-10],[97,118,-15],[97,119,-15],[97,121,-20],[98,108,-10],[98,248,-10],[98,117,-20],[98,118,-20],[98,121,-20],[99,104,-10],[99,107,-20],[99,108,-20],[99,248,-20],[99,121,-10],[58,32,-40],[44,186,-120],[44,39,-120],[44,32,-40],[100,100,-10],[100,118,-15],[100,119,-15],[100,121,-15],[101,44,10],[101,46,20],[101,118,-15],[101,119,-15],[101,120,-15],[101,121,-15],[102,44,-10],[102,101,-10],[102,111,-20],[102,249,-20],[102,46,-10],[102,186,30],[102,39,30],[103,101,10],[103,103,-10],[104,121,-20],[107,111,-15],[107,249,-15],[108,119,-15],[108,121,-15],[248,119,-15],[248,121,-15],[109,117,-20],[109,121,-30],[110,117,-10],[110,118,-40],[110,121,-20],[111,118,-20],[111,119,-15],[111,120,-30],[111,121,-20],[249,118,-20],[249,119,-15],[249,120,-30],[249,121,-20],[112,121,-15],[46,186,-120],[46,39,-120],[46,32,-40],[186,32,-80],[96,96,-46],[39,100,-80],[39,108,-20],[39,248,-20],[39,39,-46],[39,114,-40],[39,115,-60],[39,32,-80],[39,118,-20],[114,99,-20],[114,44,-60],[114,100,-20],[114,103,-15],[114,45,-20],[114,111,-20],[114,249,-20],[114,46,-60],[114,113,-20],[114,115,-15],[114,116,20],[114,118,10],[114,121,10],[115,119,-15],[59,32,-40],[32,84,-100],[32,86,-80],[32,87,-80],[32,89,-120],[32,170,-80],[32,96,-60],[118,97,-20],[118,44,-80],[118,111,-30],[118,249,-30],[118,46,-80],[119,44,-40],[119,111,-20],[119,249,-20],[119,46,-40],[120,101,-10],[121,97,-30],[121,44,-80],[121,101,-10],[121,111,-25],[121,249,-25],[121,46,-80],[122,101,10]]},"Helvetica-Bold":{widths:[278,333,474,556,556,889,722,278,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,278,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,333,556,556,167,556,556,556,556,238,500,556,333,333,611,611,556,556,556,278,556,350,278,500,500,556,1e3,1e3,611,333,333,333,333,333,333,333,333,333,333,333,333,333,1e3,1e3,370,611,778,1e3,365,889,278,278,611,944,611,278,556,556,611,556,667,584,667,722,556,722,556,556,556,722,722,556,722,611,667,722,250,737,667,556,556,722,278,556,611,722,556,667,556,556,278,494,722,778,611,556,722,389,556,611,667,778,722,667,743,722,611,333,778,722,722,584,611,611,494,556,722,278,667,556,556,556,611,611,722,278,584,280,737,778,278,600,667,389,611,611,611,549,722,722,278,389,556,722,722,722,556,500,278,778,611,556,556,278,778,722,612,611,333,778,611,278,611,667,611,834,667,400,722,611,1e3,556,278,278,611,834,549,611,611,722,667,556,611,834,667,667,778,400,611,722,611,549,722,389,722,611,722,611,722,722,722,778,500,667,278,556,584,278,611,333,584,611,611,549,611,611,500,611,333,278,556],firstChar:32,lastChar:251,familyName:"Helvetica",fontWeight:"Bold",italicAngle:0,fontBBox:[-170,-228,1003,962],capHeight:718,xHeight:532,ascent:718,descent:-207,stemH:118,stemV:140,flag:32,kernings:[[65,67,-40],[65,71,-50],[65,79,-40],[65,233,-40],[65,81,-40],[65,84,-90],[65,85,-50],[65,86,-80],[65,87,-60],[65,89,-110],[65,117,-30],[65,118,-40],[65,119,-30],[65,121,-30],[66,65,-30],[66,85,-10],[68,65,-40],[68,86,-40],[68,87,-40],[68,89,-70],[68,44,-30],[68,46,-30],[70,65,-80],[70,97,-20],[70,44,-100],[70,46,-100],[74,65,-20],[74,44,-20],[74,46,-20],[74,117,-20],[75,79,-30],[75,233,-30],[75,101,-15],[75,111,-35],[75,249,-35],[75,117,-30],[75,121,-40],[76,84,-90],[76,86,-110],[76,87,-80],[76,89,-120],[76,186,-140],[76,39,-140],[76,121,-30],[232,84,-90],[232,86,-110],[232,87,-80],[232,89,-120],[232,186,-140],[232,39,-140],[232,121,-30],[79,65,-50],[79,84,-40],[79,86,-50],[79,87,-50],[79,88,-50],[79,89,-70],[79,44,-40],[79,46,-40],[233,65,-50],[233,84,-40],[233,86,-50],[233,87,-50],[233,88,-50],[233,89,-70],[233,44,-40],[233,46,-40],[80,65,-100],[80,97,-30],[80,44,-120],[80,101,-30],[80,111,-40],[80,249,-40],[80,46,-120],[81,85,-10],[81,44,20],[81,46,20],[82,79,-20],[82,233,-20],[82,84,-20],[82,85,-20],[82,86,-50],[82,87,-40],[82,89,-50],[84,65,-90],[84,79,-40],[84,233,-40],[84,97,-80],[84,58,-40],[84,44,-80],[84,101,-60],[84,45,-120],[84,111,-80],[84,249,-80],[84,46,-80],[84,114,-80],[84,59,-40],[84,117,-90],[84,119,-60],[84,121,-60],[85,65,-50],[85,44,-30],[85,46,-30],[86,65,-80],[86,71,-50],[86,79,-50],[86,233,-50],[86,97,-60],[86,58,-40],[86,44,-120],[86,101,-50],[86,45,-80],[86,111,-90],[86,249,-90],[86,46,-120],[86,59,-40],[86,117,-60],[87,65,-60],[87,79,-20],[87,233,-20],[87,97,-40],[87,58,-10],[87,44,-80],[87,101,-35],[87,45,-40],[87,111,-60],[87,249,-60],[87,46,-80],[87,59,-10],[87,117,-45],[87,121,-20],[89,65,-110],[89,79,-70],[89,233,-70],[89,97,-90],[89,58,-50],[89,44,-100],[89,101,-80],[89,111,-100],[89,249,-100],[89,46,-100],[89,59,-50],[89,117,-100],[97,103,-10],[97,118,-15],[97,119,-15],[97,121,-20],[98,108,-10],[98,248,-10],[98,117,-20],[98,118,-20],[98,121,-20],[99,104,-10],[99,107,-20],[99,108,-20],[99,248,-20],[99,121,-10],[58,32,-40],[44,186,-120],[44,39,-120],[44,32,-40],[100,100,-10],[100,118,-15],[100,119,-15],[100,121,-15],[101,44,10],[101,46,20],[101,118,-15],[101,119,-15],[101,120,-15],[101,121,-15],[102,44,-10],[102,101,-10],[102,111,-20],[102,249,-20],[102,46,-10],[102,186,30],[102,39,30],[103,101,10],[103,103,-10],[104,121,-20],[107,111,-15],[107,249,-15],[108,119,-15],[108,121,-15],[248,119,-15],[248,121,-15],[109,117,-20],[109,121,-30],[110,117,-10],[110,118,-40],[110,121,-20],[111,118,-20],[111,119,-15],[111,120,-30],[111,121,-20],[249,118,-20],[249,119,-15],[249,120,-30],[249,121,-20],[112,121,-15],[46,186,-120],[46,39,-120],[46,32,-40],[186,32,-80],[96,96,-46],[39,100,-80],[39,108,-20],[39,248,-20],[39,39,-46],[39,114,-40],[39,115,-60],[39,32,-80],[39,118,-20],[114,99,-20],[114,44,-60],[114,100,-20],[114,103,-15],[114,45,-20],[114,111,-20],[114,249,-20],[114,46,-60],[114,113,-20],[114,115,-15],[114,116,20],[114,118,10],[114,121,10],[115,119,-15],[59,32,-40],[32,84,-100],[32,86,-80],[32,87,-80],[32,89,-120],[32,170,-80],[32,96,-60],[118,97,-20],[118,44,-80],[118,111,-30],[118,249,-30],[118,46,-80],[119,44,-40],[119,111,-20],[119,249,-20],[119,46,-40],[120,101,-10],[121,97,-30],[121,44,-80],[121,101,-10],[121,111,-25],[121,249,-25],[121,46,-80],[122,101,10]]},"Times-Italic":{widths:[250,333,420,500,500,833,778,333,333,333,500,675,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,675,675,675,500,920,611,611,667,722,611,611,722,722,333,444,667,556,833,667,722,611,722,611,500,556,722,611,833,611,556,556,389,278,389,422,500,333,500,500,444,500,444,278,500,500,278,278,444,278,722,500,500,500,500,389,389,278,500,444,667,444,444,389,400,275,400,541,389,500,500,167,500,500,500,500,214,556,500,333,333,500,500,500,500,500,250,523,350,333,556,556,500,889,1e3,500,333,333,333,333,333,333,333,333,333,333,333,333,333,889,889,276,556,722,944,310,667,278,278,500,667,500,333,444,500,500,444,556,675,556,611,500,722,444,389,444,722,722,500,722,500,611,722,250,760,611,444,500,667,278,500,556,667,500,611,389,389,278,471,611,722,500,500,611,389,444,556,611,722,611,500,544,722,500,300,722,611,611,675,500,556,476,444,667,278,611,500,444,444,500,500,667,333,675,275,760,722,333,600,611,389,500,556,556,549,722,667,278,300,444,722,611,611,444,389,278,722,500,500,389,278,722,722,612,500,300,722,500,278,500,611,500,750,500,300,667,556,980,444,333,333,611,750,549,500,500,722,611,444,500,750,500,500,722,400,500,667,500,453,722,389,667,500,611,556,611,611,611,722,389,611,333,444,675,333,500,278,675,500,500,549,500,500,389,500,300,278,500],firstChar:32,lastChar:251,familyName:"Times",fontWeight:"Medium",italicAngle:-15.5,fontBBox:[-169,-217,1010,883],capHeight:653,xHeight:441,ascent:683,descent:-217,stemH:32,stemV:76,flag:34,kernings:[[65,67,-30],[65,71,-35],[65,79,-40],[65,233,-40],[65,81,-40],[65,84,-37],[65,85,-50],[65,86,-105],[65,87,-95],[65,89,-55],[65,39,-37],[65,117,-20],[65,118,-55],[65,119,-55],[65,121,-55],[66,65,-25],[66,85,-10],[68,65,-35],[68,86,-40],[68,87,-40],[68,89,-40],[70,65,-115],[70,97,-75],[70,44,-135],[70,101,-75],[70,105,-45],[70,111,-105],[70,249,-105],[70,46,-135],[70,114,-55],[74,65,-40],[74,97,-35],[74,44,-25],[74,101,-25],[74,111,-25],[74,249,-25],[74,46,-25],[74,117,-35],[75,79,-50],[75,233,-50],[75,101,-35],[75,111,-40],[75,249,-40],[75,117,-40],[75,121,-40],[76,84,-20],[76,86,-55],[76,87,-55],[76,89,-20],[76,39,-37],[76,121,-30],[232,84,-20],[232,86,-55],[232,87,-55],[232,89,-20],[232,39,-37],[232,121,-30],[78,65,-27],[79,65,-55],[79,84,-40],[79,86,-50],[79,87,-50],[79,88,-40],[79,89,-50],[233,65,-55],[233,84,-40],[233,86,-50],[233,87,-50],[233,88,-40],[233,89,-50],[80,65,-90],[80,97,-80],[80,44,-135],[80,101,-80],[80,111,-80],[80,249,-80],[80,46,-135],[81,85,-10],[82,79,-40],[82,233,-40],[82,85,-40],[82,86,-18],[82,87,-18],[82,89,-18],[84,65,-50],[84,79,-18],[84,233,-18],[84,97,-92],[84,58,-55],[84,44,-74],[84,101,-92],[84,45,-74],[84,105,-55],[84,111,-92],[84,249,-92],[84,46,-74],[84,114,-55],[84,59,-65],[84,117,-55],[84,119,-74],[84,121,-74],[85,65,-40],[85,44,-25],[85,46,-25],[86,65,-60],[86,79,-30],[86,233,-30],[86,97,-111],[86,58,-65],[86,44,-129],[86,101,-111],[86,45,-55],[86,105,-74],[86,111,-111],[86,249,-111],[86,46,-129],[86,59,-74],[86,117,-74],[87,65,-60],[87,79,-25],[87,233,-25],[87,97,-92],[87,58,-65],[87,44,-92],[87,101,-92],[87,45,-37],[87,105,-55],[87,111,-92],[87,249,-92],[87,46,-92],[87,59,-65],[87,117,-55],[87,121,-70],[89,65,-50],[89,79,-15],[89,233,-15],[89,97,-92],[89,58,-65],[89,44,-92],[89,101,-92],[89,45,-74],[89,105,-74],[89,111,-92],[89,249,-92],[89,46,-92],[89,59,-65],[89,117,-92],[97,103,-10],[98,46,-40],[98,117,-20],[99,104,-15],[99,107,-20],[44,186,-140],[44,39,-140],[101,44,-10],[101,103,-40],[101,46,-15],[101,118,-15],[101,119,-15],[101,120,-20],[101,121,-30],[102,44,-10],[102,245,-60],[102,102,-18],[102,105,-20],[102,46,-15],[102,39,92],[103,44,-10],[103,101,-10],[103,103,-10],[103,46,-15],[107,101,-10],[107,111,-10],[107,249,-10],[107,121,-10],[110,118,-40],[111,103,-10],[111,118,-10],[249,103,-10],[249,118,-10],[46,186,-140],[46,39,-140],[96,96,-111],[39,100,-25],[39,39,-111],[39,114,-25],[39,115,-40],[39,32,-111],[39,116,-30],[39,118,-10],[114,97,-15],[114,99,-37],[114,44,-111],[114,100,-37],[114,101,-37],[114,103,-37],[114,45,-20],[114,111,-45],[114,249,-45],[114,46,-111],[114,113,-37],[114,115,-10],[32,65,-18],[32,84,-18],[32,86,-35],[32,87,-40],[32,89,-75],[118,44,-74],[118,46,-74],[119,44,-74],[119,46,-74],[121,44,-55],[121,46,-55]]},Symbol:{widths:[250,333,713,500,549,833,778,439,333,333,500,549,250,549,250,278,500,500,500,500,500,500,500,500,500,500,278,278,549,549,549,444,549,722,667,722,612,611,763,603,722,333,631,722,686,889,722,722,768,741,556,592,611,690,439,768,645,795,611,333,863,333,658,500,500,631,549,549,494,439,521,411,603,329,603,549,549,576,521,549,549,521,549,603,439,576,713,686,493,686,494,480,200,480,549,750,620,247,549,167,713,500,753,753,753,753,1042,987,603,987,603,400,549,411,549,549,713,494,460,549,549,549,549,1e3,603,1e3,658,823,686,795,987,768,768,823,768,768,713,713,713,713,713,713,713,768,713,790,790,890,823,549,250,713,603,603,1042,987,603,987,603,494,329,790,790,786,713,384,384,384,384,384,384,494,494,494,494,329,274,686,686,686,384,384,384,384,384,384,494,494,494,790],firstChar:32,lastChar:254,familyName:"Symbol",fontWeight:"Medium",italicAngle:0,fontBBox:[-180,-293,1090,1010],stemH:92,stemV:85,flag:4,kernings:[]},"Courier-Bold":{widths:[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],firstChar:32,lastChar:251,familyName:"Courier",fontWeight:"Bold",italicAngle:0,fontBBox:[-113,-250,749,801],capHeight:562,xHeight:439,ascent:629,descent:-157,stemH:84,stemV:106,flag:35,kernings:[]},"Helvetica-Oblique":{widths:[278,278,355,556,556,889,667,222,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,222,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,333,556,556,167,556,556,556,556,191,333,556,333,333,500,500,556,556,556,278,537,350,222,333,333,556,1e3,1e3,611,333,333,333,333,333,333,333,333,333,333,333,333,333,1e3,1e3,370,556,778,1e3,365,889,278,222,611,944,611,278,556,556,556,556,667,584,667,667,556,722,500,500,556,722,722,556,722,556,667,722,250,737,667,500,556,722,222,556,611,722,556,667,500,500,278,471,722,778,556,556,667,333,500,611,667,778,722,667,643,722,556,333,778,667,667,584,556,611,476,500,722,278,667,556,556,500,556,556,722,278,584,260,737,778,278,600,667,333,556,611,611,549,722,722,222,317,556,722,667,667,556,500,222,778,556,556,500,278,778,722,612,556,333,778,556,278,556,667,556,834,667,299,667,556,1e3,556,278,278,556,834,549,556,556,722,667,556,556,834,667,667,778,400,556,722,556,453,722,333,722,556,722,556,667,667,667,778,500,667,278,500,584,278,556,278,584,556,556,549,556,556,500,556,333,278,556],firstChar:32,lastChar:251,familyName:"Helvetica",fontWeight:"Medium",italicAngle:-12,fontBBox:[-170,-225,1116,931],capHeight:718,xHeight:523,ascent:718,descent:-207,stemH:76,stemV:88,flag:32,kernings:[[65,67,-30],[65,71,-30],[65,79,-30],[65,233,-30],[65,81,-30],[65,84,-120],[65,85,-50],[65,86,-70],[65,87,-50],[65,89,-100],[65,117,-30],[65,118,-40],[65,119,-40],[65,121,-40],[66,85,-10],[66,44,-20],[66,46,-20],[67,44,-30],[67,46,-30],[68,65,-40],[68,86,-70],[68,87,-40],[68,89,-90],[68,44,-70],[68,46,-70],[70,65,-80],[70,97,-50],[70,44,-150],[70,101,-30],[70,111,-30],[70,249,-30],[70,46,-150],[70,114,-45],[74,65,-20],[74,97,-20],[74,44,-30],[74,46,-30],[74,117,-20],[75,79,-50],[75,233,-50],[75,101,-40],[75,111,-40],[75,249,-40],[75,117,-30],[75,121,-50],[76,84,-110],[76,86,-110],[76,87,-70],[76,89,-140],[76,186,-140],[76,39,-160],[76,121,-30],[232,84,-110],[232,86,-110],[232,87,-70],[232,89,-140],[232,186,-140],[232,39,-160],[232,121,-30],[79,65,-20],[79,84,-40],[79,86,-50],[79,87,-30],[79,88,-60],[79,89,-70],[79,44,-40],[79,46,-40],[233,65,-20],[233,84,-40],[233,86,-50],[233,87,-30],[233,88,-60],[233,89,-70],[233,44,-40],[233,46,-40],[80,65,-120],[80,97,-40],[80,44,-180],[80,101,-50],[80,111,-50],[80,249,-50],[80,46,-180],[81,85,-10],[82,79,-20],[82,233,-20],[82,84,-30],[82,85,-40],[82,86,-50],[82,87,-30],[82,89,-50],[83,44,-20],[83,46,-20],[84,65,-120],[84,79,-40],[84,233,-40],[84,97,-120],[84,58,-20],[84,44,-120],[84,101,-120],[84,45,-140],[84,111,-120],[84,249,-120],[84,46,-120],[84,114,-120],[84,59,-20],[84,117,-120],[84,119,-120],[84,121,-120],[85,65,-40],[85,44,-40],[85,46,-40],[86,65,-80],[86,71,-40],[86,79,-40],[86,233,-40],[86,97,-70],[86,58,-40],[86,44,-125],[86,101,-80],[86,45,-80],[86,111,-80],[86,249,-80],[86,46,-125],[86,59,-40],[86,117,-70],[87,65,-50],[87,79,-20],[87,233,-20],[87,97,-40],[87,44,-80],[87,101,-30],[87,45,-40],[87,111,-30],[87,249,-30],[87,46,-80],[87,117,-30],[87,121,-20],[89,65,-110],[89,79,-85],[89,233,-85],[89,97,-140],[89,58,-60],[89,44,-140],[89,101,-140],[89,45,-140],[89,105,-20],[89,111,-140],[89,249,-140],[89,46,-140],[89,59,-60],[89,117,-110],[97,118,-20],[97,119,-20],[97,121,-30],[98,98,-10],[98,44,-40],[98,108,-20],[98,248,-20],[98,46,-40],[98,117,-20],[98,118,-20],[98,121,-20],[99,44,-15],[99,107,-20],[58,32,-50],[44,186,-100],[44,39,-100],[101,44,-15],[101,46,-15],[101,118,-30],[101,119,-20],[101,120,-30],[101,121,-20],[102,97,-30],[102,44,-30],[102,245,-28],[102,101,-30],[102,111,-30],[102,249,-30],[102,46,-30],[102,186,60],[102,39,50],[103,114,-10],[104,121,-30],[107,101,-20],[107,111,-20],[107,249,-20],[109,117,-10],[109,121,-15],[110,117,-10],[110,118,-20],[110,121,-15],[111,44,-40],[111,46,-40],[111,118,-15],[111,119,-15],[111,120,-30],[111,121,-30],[249,97,-55],[249,98,-55],[249,99,-55],[249,44,-95],[249,100,-55],[249,101,-55],[249,102,-55],[249,103,-55],[249,104,-55],[249,105,-55],[249,106,-55],[249,107,-55],[249,108,-55],[249,248,-55],[249,109,-55],[249,110,-55],[249,111,-55],[249,249,-55],[249,112,-55],[249,46,-95],[249,113,-55],[249,114,-55],[249,115,-55],[249,116,-55],[249,117,-55],[249,118,-70],[249,119,-70],[249,120,-85],[249,121,-70],[249,122,-55],[112,44,-35],[112,46,-35],[112,121,-30],[46,186,-100],[46,39,-100],[46,32,-60],[186,32,-40],[96,96,-57],[39,100,-50],[39,39,-57],[39,114,-50],[39,115,-50],[39,32,-70],[114,97,-10],[114,58,30],[114,44,-50],[114,105,15],[114,107,15],[114,108,15],[114,248,15],[114,109,25],[114,110,25],[114,112,30],[114,46,-50],[114,59,30],[114,116,40],[114,117,15],[114,118,30],[114,121,30],[115,44,-15],[115,46,-15],[115,119,-30],[59,32,-50],[32,84,-50],[32,86,-50],[32,87,-40],[32,89,-90],[32,170,-30],[32,96,-60],[118,97,-25],[118,44,-80],[118,101,-25],[118,111,-25],[118,249,-25],[118,46,-80],[119,97,-15],[119,44,-60],[119,101,-10],[119,111,-10],[119,249,-10],[119,46,-60],[120,101,-30],[121,97,-20],[121,44,-100],[121,101,-20],[121,111,-20],[121,249,-20],[121,46,-100],[122,101,-15],[122,111,-15],[122,249,-15]]}};(function(B){Object.defineProperty(B,"__esModule",{value:!0}),B.FontManager=B.Font=B.FontType=void 0;const D=fontData,F=writerUtil,O=util;var U;(function(tt){tt[tt.Type0=0]="Type0",tt[tt.Type1=1]="Type1",tt[tt.Type3=2]="Type3",tt[tt.MMType1=3]="MMType1",tt[tt.TrueType=4]="TrueType",tt[tt.CIDFontType0=5]="CIDFontType0",tt[tt.CIDFontType2=6]="CIDFontType2"})(U=B.FontType||(B.FontType={}));class G{constructor(Y=void 0,W=void 0,z=void 0){if(this.object_id=void 0,this.is_new=!1,this.fontType=void 0,this.name=void 0,this.baseFont=void 0,this.firstChar=void 0,this.lastChar=void 0,this.widths=void 0,this.fontDescriptor=void 0,this.encoding=void 0,this.kernings=void 0,this.fontType=Y,this.name=W,this.baseFont=z,this.name&&!this.name.startsWith("/")&&(this.name=`/${this.name}`),this.baseFont&&!this.baseFont.startsWith("/")&&(this.baseFont=`/${this.baseFont}`),this.baseFont&&G.isStandardFont(this.baseFont)&&(this.populateStandardFontData(this.baseFont),!this.widths))throw Error(`No widths found for standard font "${this.baseFont}"`)}proposeLinebreaks(Y,W,z){if(!this.widths)return[];this.firstChar||(this.firstChar=0);let K=this.getTextWidthArray(Y,W),J=[],Q=0,et=-1,it=0;for(let rt=0;rt<K.length;++rt)Y.charAt(rt)===" "&&(et=rt),Q+K[rt]>z&&(et!==-1?(J.push({start:it,end:et-1,width:K.slice(it,et).reduce((st,at)=>st+at,0)}),rt=et+1,it=rt,et=-1):(J.push({start:it,end:rt-1,width:K.slice(it,rt).reduce((st,at)=>st+at,0)}),it=rt),Q=0),Q+=K[rt];return it!==K.length&&J.push({start:it,end:K.length-1,width:K.slice(it,K.length).reduce((rt,st)=>rt+st,0)}),J}calculateTextDimensions(Y,W){return[this.getTextWidthArray(Y,W).reduce((K,J)=>K+J,0),W]}calculateTextDimensionsInMM(Y,W){let z=this.calculateTextDimensions(Y,W);return[z[0]*25.4/72,z[1]]}getKerningValue(Y,W){if(!this.kernings)return 0;let z=this.kernings.get(Y);return z?(z=z.filter(K=>K[0]===W),z.length===1?z[0][1]:0):0}getTextWidthArray(Y,W){if(!this.widths)return[];this.firstChar||(this.firstChar=0);let z=O.Util.convertStringToAscii(Y),K=[],J=-1;for(let Q of z){let et=0;J!=-1&&this.kernings&&(et=this.getKerningValue(J,Q)),K.push((this.widths[Q-this.firstChar]+et)/1e3*W),J=Q}return K}populateStandardFontData(Y){Y.startsWith("/")&&(Y=Y.substring(1));let W=Object.keys(D.STANDARD_FONT_DATA).filter(K=>Y.localeCompare(K)===0);if(!W||W.length===0||W.length>1)throw Error(`No font widths for standard font ${Y}`);let z=D.STANDARD_FONT_DATA[W[0]];if(!z)throw Error(`No font data for standard font ${Y}`);if(this.widths=z.widths,this.firstChar=z.firstChar,this.lastChar=z.lastChar,this.fontDescriptor={fontName:this.baseFont,fontFamily:z.familyName,fontWeight:z.fontWeight,italicAngle:z.italicAngle,fontBBox:z.fontBBox,capHeight:z.capHeight,xHeight:z.xHeight,ascent:z.ascent,descent:z.descent,stemH:z.stemH,stemV:z.stemV,flags:z.flag},z.kernings){this.kernings=new Map;for(let K of z.kernings){let J=[];this.kernings.has(K[0])&&(J=this.kernings.get(K[0])),J.push(K.slice(1)),this.kernings.set(K[0],J)}}}static createStandardFont(Y,W,z){let K=new G(U.Type1,W,z);return K.object_id=Y,K}static isStandardFont(Y){switch(Y.startsWith("/")&&(Y=Y.substring(1)),Y){case"Times-Roman":return!0;case"Times-Bold":return!0;case"Times-Italic":return!0;case"Times-BoldItalic":return!0;case"Helvetica":return!0;case"Helvetica-Bold":return!0;case"Helvetica-Oblique":return!0;case"Helvetica-BoldOblique":return!0;case"Courier":return!0;case"Courier-Oblique":return!0;case"Courier-BoldOblique":return!0;case"Courier-Bold":return!0;case"Symbol":return!0;case"ZapfDingbats":return!0;default:return!1}}typeToNumberArray(Y){switch(Y){case U.Type0:return F.WriterUtil.TYPE0;case U.Type1:return F.WriterUtil.TYPE1;case U.Type3:return F.WriterUtil.TYPE3;case U.MMType1:return F.WriterUtil.MMTYPE1;case U.TrueType:return F.WriterUtil.TRUETYPE;case U.CIDFontType0:return F.WriterUtil.CIDFONTTYPE0;case U.CIDFontType2:return F.WriterUtil.CIDFONTTYPE2}return[]}writeFontDescriptor(){if(!this.fontDescriptor)return[];let Y=[];return Y=Y.concat(F.WriterUtil.DICT_START),Y.push(F.WriterUtil.SPACE),Y=Y.concat(F.WriterUtil.TYPE_FONTDESCRIPTOR),Y.push(F.WriterUtil.SPACE),this.baseFont&&(Y=Y.concat(F.WriterUtil.FONTNAME),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertStringToAscii(this.baseFont)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.fontFamily&&(Y=Y.concat(F.WriterUtil.FONTFAMILY),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertStringToByteString(this.fontDescriptor.fontFamily)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.fontStretch&&(Y=Y.concat(F.WriterUtil.FONTSTRETCH),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertStringToAscii(this.fontDescriptor.fontStretch)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.flags&&(Y=Y.concat(F.WriterUtil.FLAGS),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.flags)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.fontBBox&&(Y=Y.concat(F.WriterUtil.FONTBBOX),Y.push(F.WriterUtil.SPACE),Y=Y.concat(F.WriterUtil.writeNumberArray(this.fontDescriptor.fontBBox)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.italicAngle&&(Y=Y.concat(F.WriterUtil.ITALICANGLE),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.italicAngle)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.ascent&&(Y=Y.concat(F.WriterUtil.ASCENT),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.ascent)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.descent&&(Y=Y.concat(F.WriterUtil.DESCENT),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.descent)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.leading&&(Y=Y.concat(F.WriterUtil.LEADING),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.leading)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.capHeight&&(Y=Y.concat(F.WriterUtil.CAPHEIGHT),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.capHeight)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.xHeight&&(Y=Y.concat(F.WriterUtil.XHEIGHT),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.xHeight)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.stemV&&(Y=Y.concat(F.WriterUtil.STEMV),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.stemV)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.stemH&&(Y=Y.concat(F.WriterUtil.STEMH),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.stemH)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.avgWidth&&(Y=Y.concat(F.WriterUtil.AVGWIDTH),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.avgWidth)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.maxWidth&&(Y=Y.concat(F.WriterUtil.MAXWIDTH),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.maxWidth)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor.missingWidth&&(Y=Y.concat(F.WriterUtil.MISSINGWIDTH),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.fontDescriptor.missingWidth)),Y.push(F.WriterUtil.SPACE)),Y=Y.concat(F.WriterUtil.DICT_END),Y.push(F.WriterUtil.SPACE),Y}writeFont(){if(!this.object_id)throw Error("object_id of font not set");let Y=F.WriterUtil.writeReferencePointer(this.object_id);if(Y.push(F.WriterUtil.SPACE),Y=Y.concat(F.WriterUtil.OBJ),Y.push(F.WriterUtil.CR),Y.push(F.WriterUtil.LF),Y=Y.concat(F.WriterUtil.DICT_START),Y.push(F.WriterUtil.SPACE),Y=Y.concat(F.WriterUtil.TYPE_FONT),Y.push(F.WriterUtil.SPACE),!this.fontType)throw Error("Font Type not set");return Y=Y.concat(F.WriterUtil.SUBTYPE),Y.push(F.WriterUtil.SPACE),Y=Y.concat(this.typeToNumberArray(this.fontType)),Y.push(F.WriterUtil.SPACE),this.baseFont&&(Y=Y.concat(F.WriterUtil.BASEFONT),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertStringToAscii(this.baseFont)),Y.push(F.WriterUtil.SPACE)),this.firstChar&&(Y=Y.concat(F.WriterUtil.FIRSTCHAR),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.firstChar)),Y.push(F.WriterUtil.SPACE)),this.lastChar&&(Y=Y.concat(F.WriterUtil.LASTCHAR),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertNumberToCharArray(this.lastChar)),Y.push(F.WriterUtil.SPACE)),this.widths&&(Y=Y.concat(F.WriterUtil.WIDTHS),Y.push(F.WriterUtil.SPACE),Y=Y.concat(F.WriterUtil.writeNumberArray(this.widths)),Y.push(F.WriterUtil.SPACE)),this.fontDescriptor&&(Y=Y.concat(F.WriterUtil.FONTDESCRIPTOR),Y.push(F.WriterUtil.SPACE),Y=Y.concat(this.writeFontDescriptor()),Y.push(F.WriterUtil.SPACE)),this.encoding&&(Y=Y.concat(F.WriterUtil.ENCODING),Y.push(F.WriterUtil.SPACE),Y=Y.concat(O.Util.convertStringToAscii(this.encoding)),Y.push(F.WriterUtil.SPACE)),Y=Y.concat(F.WriterUtil.DICT_END),Y.push(F.WriterUtil.CR),Y.push(F.WriterUtil.LF),Y=Y.concat(F.WriterUtil.ENDOBJ),Y.push(F.WriterUtil.CR),Y.push(F.WriterUtil.LF),Y}}B.Font=G;class X{constructor(Y){this.parser=Y,this.fonts=[]}getFont(Y){for(let W of this.fonts)if(typeof Y=="string"){if(W.name===Y||W.baseFont===Y)return W}else if(Y instanceof G){if(Y.object_id&&W.object_id){if(W.object_id.obj===Y.object_id.obj&&W.object_id.generation===Y.object_id.generation)return W}else if(Y.name&&W.name){if(W.name===Y.name)return W}else if(Y.baseFont&&W.baseFont&&W.baseFont===Y.baseFont)return W}else if(W.object_id.obj===Y.obj&&W.object_id.generation===Y.generation)return W}addFont(Y){if(!this.hasFont(Y)){if(typeof Y=="string"&&G.isStandardFont(Y)&&(Y=G.createStandardFont(this.parser.getFreeObjectId(),this.getUnusedFontName(),Y),Y.is_new=!0),!(Y instanceof G))throw Error("Could not add font");return this.fonts.push(Y),Y}}getUnusedFontName(){let Y=`/F${this.fonts.length}`,W=1;for(;this.hasFont(Y);)Y=`/F${this.fonts.length+W++}`;return Y}hasFont(Y){if(Y instanceof G&&Y.object_id)Y=Y.object_id;else if(typeof Y=="string")return this.fonts.filter(W=>W.name===Y||W.baseFont===Y).length>0;return this.fonts.filter(W=>W.object_id&&W.object_id.obj===Y.obj&&W.object_id.generation===Y.generation).length>0}isRegisteredFont(Y){if(typeof Y=="string"){if(G.isStandardFont(Y))return!0;for(let W of this.fonts)if(W.name===Y)return!0}else if(Y instanceof G){for(let W of this.fonts)if(W.name===Y.name)return!0}return!1}getFontsToWrite(){return this.fonts.filter(Y=>Y.is_new)}}B.FontManager=X})(fonts);var hasRequiredFreetext_annotation;function requireFreetext_annotation(){return hasRequiredFreetext_annotation||(hasRequiredFreetext_annotation=1,function(B){Object.defineProperty(B,"__esModule",{value:!0}),B.FreeTextAnnotationObj=B.FreeTextType=B.TextJustification=void 0;const D=requireAnnotation_types(),F=annotation_errors,O=writerUtil,U=util,G=requireAppearanceStream(),X=resources,tt=requireContentStream(),Y=fonts;var W;(function(J){J[J.Left=0]="Left",J[J.Centered=1]="Centered",J[J.Right=2]="Right"})(W=B.TextJustification||(B.TextJustification={}));var z;(function(J){J[J.FreeText=0]="FreeText",J[J.FreeTextCallout=1]="FreeTextCallout",J[J.FreeTextTypeWriter=2]="FreeTextTypeWriter"})(z=B.FreeTextType||(B.FreeTextType={}));class K extends D.MarkupAnnotationObj{constructor(){super(),this.defaultAppearance=new tt.ContentStream,this.differenceRectangle=[],this.textJustification=W.Left,this.calloutLine=[],this.freeTextType=z.FreeText,this.lineEndingStyle=D.LineEndingStyle.None,this.font="/Helvetica",this.fontSize=18,this.resources=void 0,this.textColor=void 0,this.type="/FreeText",this.type_encoded=[47,70,114,101,101,84,101,120,116]}convertJustification(Q){switch(Q){case W.Left:return 0;case W.Centered:return 1;case W.Right:return 2;default:return 0}}convertFreeTextType(Q){switch(Q){case z.FreeText:return U.Util.convertStringToAscii("/FreeText");case z.FreeTextCallout:return U.Util.convertStringToAscii("/FreeTextCallout");case z.FreeTextTypeWriter:return U.Util.convertStringToAscii("/FreeTextTypeWriter");default:return U.Util.convertStringToAscii("/FreeText")}}writeAnnotationObject(Q){let et=super.writeAnnotationObject(Q),it=this.factory.parser.getFonts().getFont(this.font);if(it||(it=this.factory.parser.getFonts().addFont(this.font)),this.resources||(this.resources=new X.Resource),!it.name)throw Error("Selected font has no name");if(this.resources.addFontDef({name:it.name,refPtr:it.object_id}),this.defaultAppearance.isEmpty()&&(this.textColor&&this.defaultAppearance.addOperator("rg",[this.textColor.r,this.textColor.g,this.textColor.b]),this.defaultAppearance.addOperator("Tf",[it.name,this.fontSize])),!this.defaultStyleString||this.defaultStyleString==="")if(it.fontType===Y.FontType.Type1){if(!it.baseFont)throw Error("Type 1 font has no defined baseFont");let rt=it.baseFont.substring(1);this.defaultStyleString=`font:${this.fontSize}pt "${rt}";`,this.color&&(this.defaultStyleString+=`color:${U.Util.colorToHex(this.color)};`)}else this.defaultStyleString=void 0;return et.push(O.WriterUtil.SPACE),et=et.concat(O.WriterUtil.DEFAULT_APPEARANCE),et.push(O.WriterUtil.SPACE),et.push(O.WriterUtil.BRACKET_START),et=et.concat(this.defaultAppearance.writeContentStream(!0)),et.push(O.WriterUtil.BRACKET_END),et.push(O.WriterUtil.SPACE),et.push(O.WriterUtil.SPACE),et=et.concat(O.WriterUtil.TEXT_JUSTIFICATION),et.push(O.WriterUtil.SPACE),et=et.concat(U.Util.convertNumberToCharArray(this.convertJustification(this.textJustification))),et.push(O.WriterUtil.SPACE),et=et.concat(O.WriterUtil.IT),et.push(O.WriterUtil.SPACE),et=et.concat(this.convertFreeTextType(this.freeTextType)),et.push(O.WriterUtil.SPACE),this.calloutLine.length>0&&(et=et.concat(O.WriterUtil.CALLOUT_LINE),et.push(O.WriterUtil.SPACE),et=et.concat(O.WriterUtil.writeNumberArray(this.calloutLine)),et.push(O.WriterUtil.SPACE)),this.lineEndingStyle!==D.LineEndingStyle.None&&(et=et.concat(O.WriterUtil.LINE_ENDING),et.push(O.WriterUtil.SPACE),et=et.concat(this.convertLineEndingStyle(this.lineEndingStyle)),et.push(O.WriterUtil.SPACE)),this.defaultStyleString&&this.defaultStyleString!==""&&(et=et.concat(O.WriterUtil.DEFAULT_STYLE_STRING),et.push(O.WriterUtil.SPACE),et.push(O.WriterUtil.BRACKET_START),et=et.concat(U.Util.convertStringToAscii(this.defaultStyleString)),et.push(O.WriterUtil.BRACKET_END),et.push(O.WriterUtil.SPACE)),this.differenceRectangle&&this.differenceRectangle.length>0&&(et=et.concat(O.WriterUtil.DIFFERENCE_RECTANGLE),et.push(O.WriterUtil.SPACE),et=et.concat(O.WriterUtil.writeNumberArray(this.differenceRectangle)),et.push(O.WriterUtil.SPACE)),this.resources&&(et=et.concat(O.WriterUtil.RESOURCES),et.push(O.WriterUtil.SPACE),et=et.concat(this.resources.writeResource()),et.push(O.WriterUtil.SPACE)),et}validate(Q=!0){let et=super.validate(!1);if(this.type!=="/FreeText"&&et.push(new F.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),et=et.concat(this.checkColor(this.textColor)),this.calloutLine&&this.calloutLine.length>0&&this.freeTextType!==z.FreeTextCallout&&console.log("Warning: Callout line only relevant for free text type: 'Callout'"),this.fontSize<0&&et.push(new F.InvalidFontSizeError("A font size < 0 is not allowed")),typeof this.font=="string"||this.font instanceof Y.Font?(typeof this.font=="string"&&(this.font.startsWith("/")||(this.font=`/${this.font}`)),this.factory.parser.getFonts().isRegisteredFont(this.font)||et.push(new F.InvalidFontError("Only fonts registered in the PDF and standard fonts are allowed"))):et.push(new F.InvalidFontError("Only fonts registered in the PDF and standard fonts are allowed")),Q)for(let it of et)throw it;return et}createDefaultAppearanceStream(){let Q=this.factory.parser.getFonts().getFont(this.font);Q||(Q=this.factory.parser.getFonts().addFont(this.font)),Q.name||(Q.name=this.factory.parser.getFonts().getUnusedFontName()),this.appearanceStream=new G.AppStream(this),this.appearanceStream.new_object=!0;let et=new G.XObjectObj;et.object_id=this.factory.parser.getFreeObjectId(),et.new_object=!0,et.bBox=this.rect,et.matrix=[1,0,0,1,-this.rect[0],-this.rect[1]],et.resources||(et.resources=new X.Resource),et.resources.addFontDef({name:Q.name,refPtr:Q.object_id});let it=new tt.ContentStream;et.contentStream=it;let st=it.addMarkedContentObject(["/Tx"]).addGraphicObject();st.setFillColor(this.color),st.fillRect(this.rect[0],this.rect[1],this.rect[2],this.rect[3]);let at=st.addTextObject();at.setColor(this.textColor),at.setFont(Q.name,this.fontSize),at.formatText(this.contents,Q,this.fontSize,this.rect,this.textJustification),this.appearanceStream.N=et,this.additional_objects_to_write.push({obj:et,func:(ct,dt)=>ct.writeXObject(dt)})}}B.FreeTextAnnotationObj=K}(freetext_annotation)),freetext_annotation}var hasRequiredContentStream;function requireContentStream(){if(hasRequiredContentStream)return contentStream;hasRequiredContentStream=1,Object.defineProperty(contentStream,"__esModule",{value:!0}),contentStream.ContentStream=contentStream.TextObject=contentStream.GraphicsObject=contentStream.MarkedContent=contentStream.Operator=void 0;const B=util,D=writerUtil,F=requireFreetext_annotation();class O{constructor(W="",z=[]){this.name=W,this.parameters=z,this.operators=[]}toByteArray(W=!1){let z=[];for(let K of this.operators){for(let J of K.parameters)z=z.concat(B.Util.convertStringToAscii(`${J}`)),z.push(B.Util.SPACE);K instanceof U?(z=z.concat(D.WriterUtil.BMC),W?z.push(B.Util.SPACE):z.push(B.Util.LF),z=z.concat(K.toByteArray()),z=z.concat(D.WriterUtil.EMC)):K instanceof G?(z.push(D.WriterUtil.q),W?z.push(B.Util.SPACE):z.push(B.Util.LF),z=z.concat(K.toByteArray()),z.push(D.WriterUtil.Q)):K instanceof X?(z=z.concat(D.WriterUtil.BT),W?z.push(B.Util.SPACE):z.push(B.Util.LF),z=z.concat(K.toByteArray()),z=z.concat(D.WriterUtil.ET)):(z=z.concat(B.Util.convertStringToAscii(K.name)),W?z.push(B.Util.SPACE):z.push(B.Util.LF))}return z[z.length-1]!==B.Util.LF&&(W?z.push(B.Util.SPACE):z.push(B.Util.LF)),z}addOperator(W,z=[]){W instanceof O?this.operators.push(W):this.operators.push(new O(W,z))}addMarkedContentObject(W=[]){let z=new U(W);return this.operators.push(z),z}addGraphicObject(){let W=new G;return this.operators.push(W),W}addTextObject(){let W=new X;return this.operators.push(W),W}}contentStream.Operator=O;class U extends O{constructor(W=[]){super("BMC",W)}}contentStream.MarkedContent=U;class G extends O{drawFillRect(W,z,K,J,Q=void 0,et=2){if(this.addOperator("w",[et]),Q&&(2*Q>Math.abs(W-K)||2*Q>Math.abs(z-J)))throw Error("Invalid corner radius. Must be small than two times the linewidth");return Q?(this.addOperator("m",[W,z+Q]),this.addOperator("l",[W,J-Q]),this.addOperator("c",[W,J,W,J,W+Q,J]),this.addOperator("l",[K-Q,J]),this.addOperator("c",[K,J,K,J,K,J-Q]),this.addOperator("l",[K,z+Q]),this.addOperator("c",[K,z,K,z,K-Q,z]),this.addOperator("l",[W+Q,z]),this.addOperator("c",[W,z,W,z,W,z+Q])):(this.addOperator("m",[W,z]),this.addOperator("l",[K,z]),this.addOperator("l",[K,J]),this.addOperator("l",[W,J]),this.addOperator("l",[W,z])),this.addOperator("B"),this}fillRect(W,z,K,J,Q=void 0){if(Q&&(2*Q>Math.abs(W-K)||2*Q>Math.abs(z-J)))throw Error("Invalid corner radius. Must be small than two times the linewidth");return Q?(this.addOperator("m",[W,z+Q]),this.addOperator("l",[W,J-Q]),this.addOperator("c",[W,J,W,J,W+Q,J]),this.addOperator("l",[K-Q,J]),this.addOperator("c",[K,J,K,J,K,J-Q]),this.addOperator("l",[K,z+Q]),this.addOperator("c",[K,z,K,z,K-Q,z]),this.addOperator("l",[W+Q,z]),this.addOperator("c",[W,z,W,z,W,z+Q])):(this.addOperator("m",[W,z]),this.addOperator("l",[K,z]),this.addOperator("l",[K,J]),this.addOperator("l",[W,J]),this.addOperator("l",[W,z])),this.addOperator("f"),this}drawFillCircle(W,z,K,J,Q=2){W+=Q,z+=Q,K-=Q,J-=Q;let et=Math.abs(K-W),it=Math.abs(J-z);return this.addOperator("w",[Q]),this.addOperator("m",[W+et/2,z]),this.addOperator("c",[W+et/2,z,K,z,K,z+it/2]),this.addOperator("c",[K,z+it/2,K,J,W+et/2,J]),this.addOperator("c",[W+et/2,J,W,J,W,z+it/2]),this.addOperator("c",[W,z+it/2,W,z,W+et/2,z]),this.addOperator("B"),this}fillCircle(W,z,K,J){let Q=Math.abs(K-W),et=Math.abs(J-z);return this.addOperator("m",[W+Q/2,z]),this.addOperator("v",[K,z,K,z+et/2]),this.addOperator("v",[K,J,W+Q/2,J]),this.addOperator("v",[W,J,W,z+et/2]),this.addOperator("v",[W,z,W+Q/2,z]),this.addOperator("f"),this}drawCircle(W,z,K,J,Q=2){W+=Q,z+=Q,K-=Q,J-=Q;let et=Math.abs(K-W),it=Math.abs(J-z);return this.addOperator("w",[Q]),this.addOperator("m",[W+et/2,z]),this.addOperator("v",[K,z,K,z+it/2]),this.addOperator("v",[K,J,W+et/2,J]),this.addOperator("v",[W,J,W,z+it/2]),this.addOperator("v",[W,z,W+et/2,z]),this.addOperator("s"),this}drawRect(W,z,K,J,Q=void 0,et=2){if(this.addOperator("w",[et]),Q&&(2*Q>Math.abs(W-K)||2*Q>Math.abs(z-J)))throw Error("Invalid corner radius. Must be small than two times the linewidth");return Q?(this.addOperator("m",[W,z+Q]),this.addOperator("l",[W,J-Q]),this.addOperator("c",[W,J,W,J,W+Q,J]),this.addOperator("l",[K-Q,J]),this.addOperator("c",[K,J,K,J,K,J-Q]),this.addOperator("l",[K,z+Q]),this.addOperator("c",[K,z,K,z,K-Q,z]),this.addOperator("l",[W+Q,z]),this.addOperator("c",[W,z,W,z,W,z+Q])):(this.addOperator("m",[W,z]),this.addOperator("l",[K,z]),this.addOperator("l",[K,J]),this.addOperator("l",[W,J]),this.addOperator("l",[W,z])),this.addOperator("s"),this}drawFillPolygon(W,z=2){if(W.length<=2)return this;if(W.length%2!==0)throw Error("Number of points must be even");this.addOperator("w",[z]),this.addOperator("m",[W[0],W[1]]);for(let K=2;K<W.length;K+=2)this.addOperator("l",[W[K],W[K+1]]);return this.addOperator("B"),this}drawPolygon(W,z=2){if(W.length<=2)return this;if(W.length%2!==0)throw Error("Number of points must be even");this.addOperator("w",[z]),this.addOperator("m",[W[0],W[1]]);for(let K=2;K<W.length;K+=2)this.addOperator("l",[W[K],W[K+1]]);return this.addOperator("S"),this}fillPolygon(W){if(W.length<=2)return this;if(W.length%2!==0)throw Error("Number of points must be even");this.addOperator("m",[W[0],W[1]]);for(let z=2;z<W.length;z+=2)this.addOperator("l",[W[z],W[z+1]]);return this.addOperator("f"),this}drawLine(W,z,K,J,Q=2){return this.addOperator("w",[Q]),this.addOperator("m",[W,z]),this.addOperator("l",[K,J]),this.addOperator("S"),this}setLineColor(W=void 0){return W||(W={r:0,g:0,b:0}),W=B.Util.colorToRange01(W),this.addOperator("RG",[W.r,W.g,W.b]),this}setFillColor(W=void 0){return W||(W={r:0,g:0,b:0}),W=B.Util.colorToRange01(W),this.addOperator("rg",[W.r,W.g,W.b]),this}}contentStream.GraphicsObject=G;class X extends O{constructor(){super("BT")}setTextRelative(W,z=void 0,K=void 0){if(W==="")return this;if(z&&Array.isArray(z))K=z[1],z=z[0];else if(z&&typeof z=="number"&&(!K||typeof K=="number"))throw Error("Invalid number of positioning elements. Must be x and y coordinate");W=W.trim(),(W.charAt(0)!=="("||W.charAt(W.length-1)!==")")&&(W=`(${W})`),typeof z<"u"&&typeof K<"u"&&this.addOperator("Td",[z,K]),this.addOperator("Tj",[W])}setText(W,z=void 0,K=void 0){if(W==="")return this;if(z&&Array.isArray(z)&&z.length>=2)K=z[1],z=z[0];else if(z&&typeof z=="number"&&(!K||typeof K=="number"))throw Error("Invalid number of positioning elements. Must be x and y coordinate");return W=W.trim(),(W.charAt(0)!=="("||W.charAt(W.length-1)!==")")&&(W=`(${W})`),typeof z<"u"&&typeof K<"u"&&this.addOperator("Tm",[1,0,0,1,z,K]),this.addOperator("Tj",[W]),this}formatText(W,z,K,J,Q=void 0){let et=Math.abs(J[2]-J[0]),it=Math.abs(J[3]-J[1]),rt=st=>Q===F.TextJustification.Centered?et/2-st/2+J[0]:Q===F.TextJustification.Right?et+J[0]-st:J[0];if(et<X.SINGLE_CHAR_WIDTH)return console.warn(`Overfull hbox ${et} is below minimal threshold of ${X.SINGLE_CHAR_WIDTH}`),this.setText(W,[rt(z.calculateTextDimensions(W,K)[0]),it-K*1.2+J[1]]),this;{let st=z.proposeLinebreaks(W,K,et),at=rt(st[0].width);this.setText(W.substring(st[0].start,st[0].end+1),[at,it-K*1.2+J[1]]);for(let ct=1;ct<st.length;++ct){let dt=rt(st[ct].width);this.setTextRelative(W.substring(st[ct].start,st[ct].end+1),[dt-at,-K]),at=dt}}return this}setFont(W="/F1",z=14){return this.addOperator("Tf",[W,z]),this}setColor(W=void 0){return W||(W={r:0,g:0,b:0}),W=B.Util.colorToRange01(W),this.addOperator("rg",[W.r,W.g,W.b]),this}}contentStream.TextObject=X,X.SINGLE_CHAR_WIDTH=10;class tt extends O{isEmpty(){return this.operators.length===0}writeContentStream(W=!1){return this.toByteArray(W)}}return contentStream.ContentStream=tt,contentStream}var hasRequiredAppearanceStream;function requireAppearanceStream(){if(hasRequiredAppearanceStream)return appearanceStream;hasRequiredAppearanceStream=1,Object.defineProperty(appearanceStream,"__esModule",{value:!0}),appearanceStream.GraphicsStateParameter=appearanceStream.XObjectObj=appearanceStream.AppStream=void 0;const B=writerUtil,D=util,F=requireContentStream(),O=stream;class U{constructor(Y){this.object_id=void 0,this.new_object=!1,this.N=void 0,this.R=void 0,this.D=void 0,this.annot=Y}lookupNContentStream(){if(this.N)if(D.Util.isReferencePointer(this.N))this.N=this.annot.factory.parser.extractXObject(this.N);else{if(this.N instanceof G)return;throw Error("Could not lookup N content stream")}else{console.warn("call lookupNContentStream without set content stream value");return}}writeAppearanceStreamObj(Y){let W=[];if(D.Util.isReferencePointer(Y))W=W.concat(B.WriterUtil.writeReferencePointer(Y,!0));else if(Y instanceof G){if(!Y.object_id)throw Error("No object id specified in XObject");W=W.concat(B.WriterUtil.writeReferencePointer(Y.object_id,!0))}else throw Error("Invalid appearance stream object");return W}writeAppearanceStream(){let Y=[];return Y=Y.concat(B.WriterUtil.DICT_START),this.N&&(Y=Y.concat(B.WriterUtil.AP_N),Y.push(B.WriterUtil.SPACE),Y=Y.concat(this.writeAppearanceStreamObj(this.N)),Y.push(B.WriterUtil.SPACE)),this.R&&(Y=Y.concat(B.WriterUtil.AP_R),Y.push(B.WriterUtil.SPACE),Y=Y.concat(this.writeAppearanceStreamObj(this.R)),Y.push(B.WriterUtil.SPACE)),this.D&&(Y=Y.concat(B.WriterUtil.AP_D),Y.push(B.WriterUtil.SPACE),Y=Y.concat(this.writeAppearanceStreamObj(this.D)),Y.push(B.WriterUtil.SPACE)),Y=Y.concat(B.WriterUtil.DICT_END),Y}}appearanceStream.AppStream=U;class G{constructor(){this.object_id=void 0,this.new_object=!1,this.type="/Form",this.type_encoded=B.WriterUtil.SUBTYPE,this.bBox=[],this.name="/ARM",this.matrix=[1,0,0,1,0,0],this.formType=1,this.contentStream=void 0,this.resources=void 0}addOperator(Y,W=[]){this.contentStream||(this.contentStream=new F.ContentStream),this.contentStream.addOperator(Y,W)}writeXObject(Y){if(!this.object_id)throw Error("object_id of XObject not set");let W=[];W=W.concat(B.WriterUtil.TYPE_XOBJECT),W.push(B.WriterUtil.SPACE),W=W.concat(B.WriterUtil.SUBTYPE),W.push(B.WriterUtil.SPACE),W=W.concat(B.WriterUtil.FORM),W.push(B.WriterUtil.SPACE),W=W.concat(B.WriterUtil.FORMTYPE),W.push(B.WriterUtil.SPACE),W=W.concat(D.Util.convertNumberToCharArray(this.formType)),W.push(B.WriterUtil.SPACE),W=W.concat(B.WriterUtil.BBOX),W.push(B.WriterUtil.SPACE),W=W.concat(B.WriterUtil.writeNumberArray(this.bBox)),W.push(B.WriterUtil.SPACE),W=W.concat(B.WriterUtil.NAME),W.push(B.WriterUtil.SPACE),W=W.concat(D.Util.convertStringToAscii(this.name)),W.push(B.WriterUtil.SPACE),this.resources&&(W=W.concat(B.WriterUtil.RESOURCES),W.push(B.WriterUtil.SPACE),W=W.concat(this.resources.writeResource()),W.push(B.WriterUtil.SPACE)),W=W.concat(B.WriterUtil.MATRIX),W.push(B.WriterUtil.SPACE),W=W.concat(B.WriterUtil.writeNumberArray(this.matrix)),W.push(B.WriterUtil.SPACE);let z=this.contentStream?this.contentStream.writeContentStream():[];return B.WriterUtil.writeStreamObject(this.object_id,W,new O.FlateStream(new Uint8Array(z),void 0,!0,Y,this.object_id))}}appearanceStream.XObjectObj=G;class X{constructor(Y=void 0){this.object_id=void 0,this.new_object=!1,this.type="/ExtGState",this.type_encoded=B.WriterUtil.EXTGSTATE,this.CA=void 0,this.ca=void 0,this.object_id=Y}writeGStateParameter(){if(!this.object_id)throw Error("GStateParameter dictionary has no object id");let Y=B.WriterUtil.writeReferencePointer(this.object_id);return Y.push(B.WriterUtil.SPACE),Y=Y.concat(B.WriterUtil.OBJ),Y.push(B.WriterUtil.CR),Y.push(B.WriterUtil.LF),Y=Y.concat(B.WriterUtil.DICT_START),Y.push(B.WriterUtil.SPACE),Y=Y.concat(B.WriterUtil.TYPE_EXTGSTATE),Y.push(B.WriterUtil.SPACE),this.CA&&(Y=Y.concat(B.WriterUtil.OPACITY),Y.push(B.WriterUtil.SPACE),Y=Y.concat(D.Util.convertNumberToCharArray(this.CA)),Y.push(B.WriterUtil.SPACE)),this.ca&&(Y=Y.concat(B.WriterUtil._OPACITY),Y.push(B.WriterUtil.SPACE),Y=Y.concat(D.Util.convertNumberToCharArray(this.ca)),Y.push(B.WriterUtil.SPACE)),Y=Y.concat(B.WriterUtil.DICT_END),Y.push(B.WriterUtil.CR),Y.push(B.WriterUtil.LF),Y=Y.concat(B.WriterUtil.ENDOBJ),Y.push(B.WriterUtil.CR),Y.push(B.WriterUtil.LF),Y}}return appearanceStream.GraphicsStateParameter=X,appearanceStream}var hasRequiredText_annotation;function requireText_annotation(){return hasRequiredText_annotation||(hasRequiredText_annotation=1,function(B){Object.defineProperty(B,"__esModule",{value:!0}),B.TextAnnotationObj=B.AnnotationState=B.AnnotationStateModel=B.AnnotationIcon=void 0;const D=requireAnnotation_types(),F=annotation_errors,O=writerUtil,U=util,G=requireAppearanceStream(),X=resources,tt=requireContentStream();var Y;(function(J){J[J.Comment=0]="Comment",J[J.Key=1]="Key",J[J.Note=2]="Note",J[J.Help=3]="Help",J[J.NewParagraph=4]="NewParagraph",J[J.Paragraph=5]="Paragraph",J[J.Insert=6]="Insert"})(Y=B.AnnotationIcon||(B.AnnotationIcon={}));var W;(function(J){J[J.Marked=0]="Marked",J[J.Review=1]="Review"})(W=B.AnnotationStateModel||(B.AnnotationStateModel={}));var z;(function(J){J[J.Marked=0]="Marked",J[J.Unmarked=1]="Unmarked",J[J.Accepted=2]="Accepted",J[J.Rejected=3]="Rejected",J[J.Cancelled=4]="Cancelled",J[J.Completed=5]="Completed",J[J.None=6]="None"})(z=B.AnnotationState||(B.AnnotationState={}));class K extends D.MarkupAnnotationObj{constructor(){super(),this.open=!1,this.icon=Y.Note,this.state=void 0,this.type="/Text",this.type_encoded=[47,84,101,120,116],this.annotationFlags={noZoom:!0,noRotate:!0}}createDefaultAppearanceStream(){this.appearanceStream=new G.AppStream(this),this.appearanceStream.new_object=!0;let Q=new G.XObjectObj;Q.object_id=this.factory.parser.getFreeObjectId(),Q.new_object=!0,Q.bBox=[0,0,100,100],Q.matrix=[1,0,0,1,0,0];let et=new tt.ContentStream;Q.contentStream=et;let rt=et.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){rt.addOperator("gs",["/GParameters"]);let st=new G.GraphicsStateParameter(this.factory.parser.getFreeObjectId());st.CA=st.ca=this.opacity,this.additional_objects_to_write.push({obj:st,func:ct=>ct.writeGStateParameter()});let at=new X.Resource;at.addGStateDef({name:"/GParameters",refPtr:st.object_id}),Q.resources=at}switch(rt.setLineColor({r:0,g:0,b:0}).setFillColor(this.color).drawFillRect(0,0,100,100,25),this.icon){case Y.Help:rt.addTextObject().setColor().setFont("/F1",120).setText("?",[20,10]);break;case Y.Insert:throw Error("Not yet implemented. Pls. create ticket on Github with feature request.");case Y.Key:throw Error("Not yet implemented. Pls. create ticket on Github with feature request.");case Y.NewParagraph:throw Error("Not yet implemented. Pls. create ticket on Github with feature request.");case Y.Paragraph:throw Error("Not yet implemented. Pls. create ticket on Github with feature request.");default:rt.drawPolygon([10,10,10,90,80,90,80,80,90,80,90,10,10,10]).drawLine(80,90,90,80)}this.appearanceStream.N=Q,this.additional_objects_to_write.push({obj:Q,func:(st,at)=>st.writeXObject(at)})}convertAnnotationIcon(Q){switch(Q){case Y.Comment:return[47,67,111,109,109,101,110,116];case Y.Key:return[47,75,101,121];case Y.Note:return[47,78,111,116,101];case Y.Help:return[47,72,101,108,112];case Y.NewParagraph:return[47,78,101,119,80,97,114,97,103,114,97,112,104];case Y.Paragraph:return[47,80,97,114,97,103,114,97,112,104];case Y.Insert:return[47,73,110,115,101,114,116]}return[]}convertState(Q){switch(Q){case z.Marked:return U.Util.convertStringToAscii("/Marked");case z.Unmarked:return U.Util.convertStringToAscii("/Unmarked");case z.Accepted:return U.Util.convertStringToAscii("/Accepted");case z.Rejected:return U.Util.convertStringToAscii("/Rejected");case z.Cancelled:return U.Util.convertStringToAscii("/Cancelled");case z.Completed:return U.Util.convertStringToAscii("/Completed");case z.None:return U.Util.convertStringToAscii("/None")}return[]}convertStateModel(Q){switch(Q){case W.Marked:return U.Util.convertStringToAscii("/Marked");case W.Review:return U.Util.convertStringToAscii("/Review")}return[]}writeAnnotationObject(Q){let et=super.writeAnnotationObject(Q);return this.open&&(et=et.concat(O.WriterUtil.OPEN),et.push(O.WriterUtil.SPACE),et=et.concat(O.WriterUtil.TRUE),et.push(O.WriterUtil.SPACE)),this.icon&&(et=et.concat(O.WriterUtil.NAME),et.push(O.WriterUtil.SPACE),et=et.concat(this.convertAnnotationIcon(this.icon)),et.push(O.WriterUtil.SPACE)),this.state&&(et=et.concat(O.WriterUtil.STATE),et.push(O.WriterUtil.SPACE),et=et.concat(this.convertState(this.state)),et.push(O.WriterUtil.SPACE)),this.stateModel&&(et=et.concat(O.WriterUtil.STATEMODEL),et.push(O.WriterUtil.SPACE),et=et.concat(this.convertStateModel(this.stateModel)),et.push(O.WriterUtil.SPACE)),et}validate(Q=!0){let et=super.validate(!1);if(this.type!=="/Text"&&et.push(new F.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),this.state&&!this.stateModel&&et.push(new F.InvalidStateError("You need to specify a state model, when specifying a state")),this.stateModel&&!this.state&&(this.stateModel.valueOf()===W.Marked?this.state=z.Unmarked:this.stateModel.valueOf()===W.Review?this.state=z.None:et.push(new F.InvalidStateError("Invalid state model selected"))),this.state&&this.stateModel&&(this.stateModel.valueOf()===W.Marked?this.state.valueOf()!==z.Marked&&this.state.valueOf()!==z.Unmarked&&et.push(new F.InvalidStateError("Invalid annotation state for state model 'Marked' only 'Marked' and 'Unmarked' are legal values")):this.stateModel.valueOf()===W.Review?this.state.valueOf()!==z.Accepted&&this.state.valueOf()!==z.Rejected&&this.state.valueOf()!==z.Cancelled&&this.state.valueOf()!==z.Completed&&this.state.valueOf()!==z.None&&et.push(new F.InvalidStateError("Invalid annotation state for state model 'Review' only 'Accepted', 'Rejected', 'Cancelled', 'Completed' and 'None' are legal values")):et.push(new F.InvalidStateError("Invalid state model selected"))),Q)for(let it of et)throw it;return et}}B.TextAnnotationObj=K}(text_annotation)),text_annotation}var text_markup_annotation={},hasRequiredText_markup_annotation;function requireText_markup_annotation(){if(hasRequiredText_markup_annotation)return text_markup_annotation;hasRequiredText_markup_annotation=1,Object.defineProperty(text_markup_annotation,"__esModule",{value:!0}),text_markup_annotation.StrikeOutAnnotationObj=text_markup_annotation.SquigglyAnnotationObj=text_markup_annotation.UnderlineAnnotationObj=text_markup_annotation.HighlightAnnotationObj=text_markup_annotation.TextMarkupAnnotationObj=void 0;const B=requireAnnotation_types(),D=annotation_errors,F=writerUtil,O=requireAppearanceStream(),U=resources,G=requireContentStream();class X extends B.MarkupAnnotationObj{constructor(){super(...arguments),this.quadPoints=[]}writeAnnotationObject(J){let Q=super.writeAnnotationObject(J);return Q=Q.concat(F.WriterUtil.QUADPOINTS),Q.push(F.WriterUtil.SPACE),Q=Q.concat(F.WriterUtil.writeNumberArray(this.quadPoints)),Q.push(F.WriterUtil.SPACE),Q}validate(J=!0){let Q=super.validate(!1);if(Q.length===1&&Q[0]instanceof D.InvalidRectError&&this.quadPoints&&this.quadPoints.length>0&&(this.rect=this.extractRectFromQuadPoints(this.quadPoints),Q=this.checkRect(4,this.rect)),!this.quadPoints||this.quadPoints.length===0){let et=this.rect;this.quadPoints=[et[0],et[3],et[2],et[3],et[0],et[1],et[2],et[1]]}if(Q=Q.concat(this.checkQuadPoints(this.quadPoints)),J)for(let et of Q)throw et;return Q}extractRectFromQuadPoints(J){let Q=J.filter((it,rt)=>rt%2===0),et=J.filter((it,rt)=>rt%2!==0);return[Math.min(...Q),Math.min(...et),Math.max(...Q),Math.max(...et)]}checkQuadPoints(J){let Q=[];return J.length%8!==0&&Q.push(new D.InvalidQuadPointError(`Quadpoints array has length ${J.length} but must be a multiple of 8`)),J.forEach(et=>{typeof et!="number"&&Q.push(new D.InvalidQuadPointError("Quadpoint "+J+" has invalid entry: "+et))}),Q}}text_markup_annotation.TextMarkupAnnotationObj=X;class tt extends X{constructor(){super(),this.type="/Highlight",this.type_encoded=[47,72,105,103,104,108,105,103,104,116]}createDefaultAppearanceStream(){this.appearanceStream=new O.AppStream(this),this.appearanceStream.new_object=!0;let J=new O.XObjectObj;J.object_id=this.factory.parser.getFreeObjectId(),J.new_object=!0,J.bBox=[0,0,100,100],J.matrix=[1,0,0,1,0,0];let Q=new G.ContentStream;J.contentStream=Q;let it=Q.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){it.addOperator("gs",["/GParameters"]);let rt=new O.GraphicsStateParameter(this.factory.parser.getFreeObjectId());rt.CA=rt.ca=this.opacity,this.additional_objects_to_write.push({obj:rt,func:at=>at.writeGStateParameter()});let st=new U.Resource;st.addGStateDef({name:"/GParameters",refPtr:rt.object_id}),J.resources=st}if(this.quadPoints&&this.quadPoints.length>8){it.setLineColor({r:0,g:0,b:0}).setFillColor(this.color);for(let rt=0;rt<this.quadPoints.length;rt+=8){let st=[];this.quadPoints.slice(rt,rt+8).forEach((at,ct)=>ct%2===0?st.push(at-this.rect[0]):st.push(at-this.rect[1])),it.fillPolygon([st[0],st[1],st[2],st[3],st[6],st[7],st[4],st[5]])}}else it.setLineColor({r:0,g:0,b:0}).setFillColor(this.color).fillRect(0,0,100,100,25);this.appearanceStream.N=J,this.additional_objects_to_write.push({obj:J,func:(rt,st)=>rt.writeXObject(st)})}validate(J=!0){let Q=super.validate(!1);if(this.type!=="/Highlight"&&Q.push(new D.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),J)for(let et of Q)throw et;return Q}}text_markup_annotation.HighlightAnnotationObj=tt;class Y extends X{constructor(){super(),this.type="/Underline",this.type_encoded=[47,85,110,100,101,114,108,105,110,101]}validate(J=!0){let Q=super.validate(!1);if(this.type!=="/Underline"&&Q.push(new D.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),J)for(let et of Q)throw et;return Q}createDefaultAppearanceStream(){this.appearanceStream=new O.AppStream(this),this.appearanceStream.new_object=!0;let J=new O.XObjectObj;J.object_id=this.factory.parser.getFreeObjectId(),J.new_object=!0,J.bBox=[0,0,100,100],J.matrix=[1,0,0,1,0,0];let Q=new G.ContentStream;J.contentStream=Q;let it=Q.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){it.addOperator("gs",["/GParameters"]);let rt=new O.GraphicsStateParameter(this.factory.parser.getFreeObjectId());rt.CA=rt.ca=this.opacity,this.additional_objects_to_write.push({obj:rt,func:at=>at.writeGStateParameter()});let st=new U.Resource;st.addGStateDef({name:"/GParameters",refPtr:rt.object_id}),J.resources=st}if(this.quadPoints&&this.quadPoints.length>8){it.setLineColor(this.color);for(let rt=0;rt<this.quadPoints.length;rt+=8){let st=[];this.quadPoints.slice(rt,rt+8).forEach((at,ct)=>ct%2===0?st.push(at-this.rect[0]):st.push(at-this.rect[1])),it.drawLine(st[0],st[1],st[2],st[1])}}else it.setLineColor(this.color).drawLine(0,0,100,0);this.appearanceStream.N=J,this.additional_objects_to_write.push({obj:J,func:(rt,st)=>rt.writeXObject(st)})}}text_markup_annotation.UnderlineAnnotationObj=Y;class W extends X{constructor(){super(),this.type="/Squiggly",this.type_encoded=[47,83,113,117,105,103,103,108,121]}validate(J=!0){let Q=super.validate(!1);if(this.type!=="/Squiggly"&&Q.push(new D.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),J)for(let et of Q)throw et;return Q}drawSquigglyLine(J,Q,et,it){for(let rt=Q;rt<et;rt+=5)rt%2===0?J.drawLine(rt,it,rt+5,it+5):J.drawLine(rt,it+5,rt+5,it)}createDefaultAppearanceStream(){this.appearanceStream=new O.AppStream(this),this.appearanceStream.new_object=!0;let J=new O.XObjectObj;J.object_id=this.factory.parser.getFreeObjectId(),J.new_object=!0,J.bBox=[0,0,100,100],J.matrix=[1,0,0,1,0,0];let Q=new G.ContentStream;J.contentStream=Q;let it=Q.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){it.addOperator("gs",["/GParameters"]);let rt=new O.GraphicsStateParameter(this.factory.parser.getFreeObjectId());rt.CA=rt.ca=this.opacity,this.additional_objects_to_write.push({obj:rt,func:at=>at.writeGStateParameter()});let st=new U.Resource;st.addGStateDef({name:"/GParameters",refPtr:rt.object_id}),J.resources=st}if(this.quadPoints&&this.quadPoints.length>8){it.setLineColor(this.color);for(let rt=0;rt<this.quadPoints.length;rt+=8){let st=[];this.quadPoints.slice(rt,rt+8).forEach((at,ct)=>ct%2===0?st.push(at-this.rect[0]):st.push(at-this.rect[1])),this.drawSquigglyLine(it,st[0],st[2],st[1])}}else it.setLineColor(this.color),this.drawSquigglyLine(it,0,100,0);this.appearanceStream.N=J,this.additional_objects_to_write.push({obj:J,func:(rt,st)=>rt.writeXObject(st)})}}text_markup_annotation.SquigglyAnnotationObj=W;class z extends X{constructor(){super(),this.type="/StrikeOut",this.type_encoded=[47,83,116,114,105,107,101,79,117,116]}validate(J=!0){let Q=super.validate(!1);if(this.type!=="/StrikeOut"&&Q.push(new D.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),J)for(let et of Q)throw et;return Q}createDefaultAppearanceStream(){this.appearanceStream=new O.AppStream(this),this.appearanceStream.new_object=!0;let J=new O.XObjectObj;J.object_id=this.factory.parser.getFreeObjectId(),J.new_object=!0,J.bBox=[0,0,100,100],J.matrix=[1,0,0,1,0,0];let Q=new G.ContentStream;J.contentStream=Q;let it=Q.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){it.addOperator("gs",["/GParameters"]);let rt=new O.GraphicsStateParameter(this.factory.parser.getFreeObjectId());rt.CA=rt.ca=this.opacity,this.additional_objects_to_write.push({obj:rt,func:at=>at.writeGStateParameter()});let st=new U.Resource;st.addGStateDef({name:"/GParameters",refPtr:rt.object_id}),J.resources=st}if(this.quadPoints&&this.quadPoints.length>8){it.setLineColor(this.color);for(let rt=0;rt<this.quadPoints.length;rt+=8){let st=[];this.quadPoints.slice(rt,rt+8).forEach((ct,dt)=>dt%2===0?st.push(ct-this.rect[0]):st.push(ct-this.rect[1]));let at=(st[5]-st[1])/2+st[1];it.drawLine(st[0],at,st[2],at)}}else it.setLineColor(this.color).drawLine(0,50,100,50);this.appearanceStream.N=J,this.additional_objects_to_write.push({obj:J,func:(rt,st)=>rt.writeXObject(st)})}}return text_markup_annotation.StrikeOutAnnotationObj=z,text_markup_annotation}var circle_square_annotation={},hasRequiredCircle_square_annotation;function requireCircle_square_annotation(){if(hasRequiredCircle_square_annotation)return circle_square_annotation;hasRequiredCircle_square_annotation=1,Object.defineProperty(circle_square_annotation,"__esModule",{value:!0}),circle_square_annotation.SquareAnnotationObj=circle_square_annotation.CircleAnnotationObj=circle_square_annotation.CircleSquareAnnotationObj=void 0;const B=requireAnnotation_types(),D=annotation_errors,F=writerUtil,O=requireAppearanceStream(),U=resources,G=requireContentStream();class X extends B.MarkupAnnotationObj{constructor(){super(),this.differenceRectangle=[]}writeAnnotationObject(z){let K=super.writeAnnotationObject(z);if(this.fill){let J=this.fill;J.r>1&&(J.r/=255),J.g>1&&(J.g/=255),J.b>1&&(J.b/=255),K.push(F.WriterUtil.SPACE),K=K.concat(F.WriterUtil.FILL),K.push(F.WriterUtil.SPACE),K=K.concat(F.WriterUtil.writeNumberArray([J.r,J.g,J.b])),K.push(F.WriterUtil.SPACE)}return this.differenceRectangle&&this.differenceRectangle.length>0&&(K=K.concat(F.WriterUtil.DIFFERENCE_RECTANGLE),K.push(F.WriterUtil.SPACE),K=K.concat(F.WriterUtil.writeNumberArray(this.differenceRectangle)),K.push(F.WriterUtil.SPACE)),K}validate(z=!0){let K=super.validate(!1);if(this.fill&&(K=K.concat(this.checkColor(this.fill))),z)for(let J of K)throw J;return K}}circle_square_annotation.CircleSquareAnnotationObj=X;class tt extends X{constructor(){super(),this.type="/Circle",this.type_encoded=[47,67,105,114,99,108,101]}validate(z=!0){let K=super.validate(!1);if(this.type!=="/Circle"&&K.push(new D.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),z)for(let J of K)throw J;return K}createDefaultAppearanceStream(){this.appearanceStream=new O.AppStream(this),this.appearanceStream.new_object=!0;let z=new O.XObjectObj;z.object_id=this.factory.parser.getFreeObjectId(),z.new_object=!0,z.bBox=this.rect,z.matrix=[1,0,0,1,-this.rect[0],-this.rect[1]];let K=new G.ContentStream;z.contentStream=K;let Q=K.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){Q.addOperator("gs",["/GParameters"]);let et=new O.GraphicsStateParameter(this.factory.parser.getFreeObjectId());et.CA=et.ca=this.opacity,this.additional_objects_to_write.push({obj:et,func:rt=>rt.writeGStateParameter()});let it=new U.Resource;it.addGStateDef({name:"/GParameters",refPtr:et.object_id}),z.resources=it}Q.setLineColor({r:0,g:0,b:0}).setFillColor(this.color).drawFillCircle(this.rect[0],this.rect[1],this.rect[2],this.rect[3]),this.appearanceStream.N=z,this.additional_objects_to_write.push({obj:z,func:(et,it)=>et.writeXObject(it)})}}circle_square_annotation.CircleAnnotationObj=tt;class Y extends X{constructor(){super(),this.type="/Square",this.type_encoded=[47,83,113,117,97,114,101]}validate(z=!0){let K=super.validate(!1);if(this.type!=="/Square"&&K.push(new D.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),z)for(let J of K)throw J;return K}createDefaultAppearanceStream(){this.appearanceStream=new O.AppStream(this),this.appearanceStream.new_object=!0;let z=new O.XObjectObj;z.object_id=this.factory.parser.getFreeObjectId(),z.new_object=!0,z.bBox=this.rect,z.matrix=[1,0,0,1,-this.rect[0],-this.rect[1]];let K=new G.ContentStream;z.contentStream=K;let Q=K.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){Q.addOperator("gs",["/GParameters"]);let et=new O.GraphicsStateParameter(this.factory.parser.getFreeObjectId());et.CA=et.ca=this.opacity,this.additional_objects_to_write.push({obj:et,func:(rt,st)=>rt.writeGStateParameter(st)});let it=new U.Resource;it.addGStateDef({name:"/GParameters",refPtr:et.object_id}),z.resources=it}Q.setLineColor({r:0,g:0,b:0}).setFillColor(this.color).drawFillRect(this.rect[0],this.rect[1],this.rect[2],this.rect[3]),this.appearanceStream.N=z,this.additional_objects_to_write.push({obj:z,func:(et,it)=>et.writeXObject(it)})}}return circle_square_annotation.SquareAnnotationObj=Y,circle_square_annotation}var polygon_polyline_annotation={},hasRequiredPolygon_polyline_annotation;function requirePolygon_polyline_annotation(){return hasRequiredPolygon_polyline_annotation||(hasRequiredPolygon_polyline_annotation=1,function(B){Object.defineProperty(B,"__esModule",{value:!0}),B.PolygonAnnotationObj=B.PolyLineAnnotationObj=B.PolygonPolyLineAnnotationObj=B.PolygonPolyLineIntent=void 0;const D=requireAnnotation_types(),F=annotation_errors,O=writerUtil,U=requireAppearanceStream(),G=resources,X=requireContentStream();(function(z){z[z.PolygonCloud=0]="PolygonCloud",z[z.PolyLineDimension=1]="PolyLineDimension",z[z.PolygonDimension=2]="PolygonDimension"})(B.PolygonPolyLineIntent||(B.PolygonPolyLineIntent={}));class tt extends D.MarkupAnnotationObj{constructor(){super(),this.vertices=[]}writeAnnotationObject(K){let J=super.writeAnnotationObject(K);if(this.fill){let Q=this.fill;Q.r>1&&(Q.r/=255),Q.g>1&&(Q.g/=255),Q.b>1&&(Q.b/=255),J.push(O.WriterUtil.SPACE),J=J.concat(O.WriterUtil.FILL),J.push(O.WriterUtil.SPACE),J=J.concat(O.WriterUtil.writeNumberArray([Q.r,Q.g,Q.b])),J.push(O.WriterUtil.SPACE)}return J=J.concat(O.WriterUtil.VERTICES),J.push(O.WriterUtil.SPACE),J=J.concat(O.WriterUtil.writeNumberArray(this.vertices)),J.push(O.WriterUtil.SPACE),J}validate(K=!0){let J=super.validate(!1);if(this.fill&&(J=J.concat(this.checkColor(this.fill))),(!this.vertices||this.vertices.length==0)&&J.push(new F.InvalidVerticesError("No vertices provided")),this.vertices.length%2!==0&&J.push(new F.InvalidVerticesError("number of vertices must be an even number")),K)for(let Q of J)throw Q;return J}}B.PolygonPolyLineAnnotationObj=tt;class Y extends tt{constructor(){super(),this.lineEndingStyles=[],this.type="/PolyLine",this.type_encoded=[47,80,111,108,121,76,105,110,101]}writeAnnotationObject(K){let J=super.writeAnnotationObject(K);return this.lineEndingStyles&&this.lineEndingStyles.length>=2&&(J=J.concat(O.WriterUtil.LINE_ENDING),J.push(O.WriterUtil.SPACE),J.push(O.WriterUtil.ARRAY_START),J=J.concat(this.convertLineEndingStyle(this.lineEndingStyles[0])),J.push(O.WriterUtil.SPACE),J=J.concat(this.convertLineEndingStyle(this.lineEndingStyles[1])),J.push(O.WriterUtil.SPACE),J.push(O.WriterUtil.ARRAY_END),J.push(O.WriterUtil.SPACE)),J}validate(K=!0){let J=super.validate(!1);if(this.type!=="/PolyLine"&&J.push(new F.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),K)for(let Q of J)throw Q;return J}createDefaultAppearanceStream(){this.appearanceStream=new U.AppStream(this),this.appearanceStream.new_object=!0;let K=new U.XObjectObj;K.object_id=this.factory.parser.getFreeObjectId(),K.new_object=!0,K.bBox=this.rect,K.matrix=[1,0,0,1,-this.rect[0],-this.rect[1]];let J=new X.ContentStream;K.contentStream=J;let et=J.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){et.addOperator("gs",["/GParameters"]);let it=new U.GraphicsStateParameter(this.factory.parser.getFreeObjectId());it.CA=it.ca=this.opacity,this.additional_objects_to_write.push({obj:it,func:st=>st.writeGStateParameter()});let rt=new G.Resource;rt.addGStateDef({name:"/GParameters",refPtr:it.object_id}),K.resources=rt}et.setLineColor({r:0,g:0,b:0}).setFillColor(this.color).drawPolygon(this.vertices),this.appearanceStream.N=K,this.additional_objects_to_write.push({obj:K,func:(it,rt)=>it.writeXObject(rt)})}}B.PolyLineAnnotationObj=Y;class W extends tt{constructor(){super(),this.type="/Polygon",this.type_encoded=[47,80,111,108,121,103,111,110]}validate(K=!0){let J=super.validate(!1);if(this.type!=="/Polygon"&&J.push(new F.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),K)for(let Q of J)throw Q;return J}createDefaultAppearanceStream(){this.appearanceStream=new U.AppStream(this),this.appearanceStream.new_object=!0;let K=new U.XObjectObj;K.object_id=this.factory.parser.getFreeObjectId(),K.new_object=!0,K.bBox=this.rect,K.matrix=[1,0,0,1,-this.rect[0],-this.rect[1]];let J=new X.ContentStream;K.contentStream=J;let et=J.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){et.addOperator("gs",["/GParameters"]);let it=new U.GraphicsStateParameter(this.factory.parser.getFreeObjectId());it.CA=it.ca=this.opacity,this.additional_objects_to_write.push({obj:it,func:st=>st.writeGStateParameter()});let rt=new G.Resource;rt.addGStateDef({name:"/GParameters",refPtr:it.object_id}),K.resources=rt}et.setLineColor({r:0,g:0,b:0}).setFillColor(this.color).drawFillPolygon(this.vertices),this.appearanceStream.N=K,this.additional_objects_to_write.push({obj:K,func:(it,rt)=>it.writeXObject(rt)})}}B.PolygonAnnotationObj=W}(polygon_polyline_annotation)),polygon_polyline_annotation}var ink_annotation={},hasRequiredInk_annotation;function requireInk_annotation(){if(hasRequiredInk_annotation)return ink_annotation;hasRequiredInk_annotation=1,Object.defineProperty(ink_annotation,"__esModule",{value:!0}),ink_annotation.InkAnnotationObj=void 0;const B=requireAnnotation_types(),D=annotation_errors,F=writerUtil,O=requireAppearanceStream(),U=resources,G=requireContentStream();class X extends B.MarkupAnnotationObj{constructor(){super(),this.inkList=[],this.type="/Ink",this.type_encoded=[47,73,110,107]}writeAnnotationObject(Y){let W=super.writeAnnotationObject(Y);return this.inkList&&this.inkList.length>0&&(W=W.concat(F.WriterUtil.INKLIST),W.push(F.WriterUtil.SPACE),W=W.concat(F.WriterUtil.writeNestedNumberArray(this.inkList)),W.push(F.WriterUtil.SPACE)),W}validate(Y=!0){let W=super.validate(!1);if(this.type!=="/Ink"&&W.push(new D.InvalidAnnotationTypeError(`Invalid annotation type ${this.type}`)),typeof this.inkList[0]=="number"&&(this.inkList=[this.inkList]),Y)for(let z of W)throw z;return W}createDefaultAppearanceStream(){this.appearanceStream=new O.AppStream(this),this.appearanceStream.new_object=!0;let Y=new O.XObjectObj;Y.object_id=this.factory.parser.getFreeObjectId(),Y.new_object=!0,Y.bBox=this.rect,Y.matrix=[1,0,0,1,-this.rect[0],-this.rect[1]];let W=new G.ContentStream;Y.contentStream=W;let K=W.addMarkedContentObject(["/Tx"]).addGraphicObject();if(this.opacity!==1){K.addOperator("gs",["/GParameters"]);let J=new O.GraphicsStateParameter(this.factory.parser.getFreeObjectId());J.CA=J.ca=this.opacity,this.additional_objects_to_write.push({obj:J,func:et=>et.writeGStateParameter()});let Q=new U.Resource;Q.addGStateDef({name:"/GParameters",refPtr:J.object_id}),Y.resources=Q}K.setLineColor({r:0,g:0,b:0}).setFillColor(this.color);for(let J of this.inkList)K.drawPolygon(J);this.appearanceStream.N=Y,this.additional_objects_to_write.push({obj:Y,func:(J,Q)=>J.writeXObject(Q)})}}return ink_annotation.InkAnnotationObj=X,ink_annotation}var hasRequiredParser;function requireParser(){if(hasRequiredParser)return parser$1;hasRequiredParser=1,Object.defineProperty(parser$1,"__esModule",{value:!0}),parser$1.PDFDocumentParser=parser$1.CryptoInterface=parser$1.Page=parser$1.Pages=parser$1.PageTree=parser$1.CatalogObject=parser$1.AnnotationParser=parser$1.FontParser=parser$1.AppearanceStreamParser=parser$1.XObjectParser=parser$1.ContentStreamParser=void 0;const B=util,D=requireObjectUtil(),F=documentHistory,O=crypto$2,U=requireAnnotation_types(),G=requireText_annotation(),X=requireText_markup_annotation(),tt=requireFreetext_annotation(),Y=requireCircle_square_annotation(),W=requirePolygon_polyline_annotation(),z=requireInk_annotation(),K=requireContentStream(),J=requireAppearanceStream(),Q=fonts,et=resources;class it{static extract(At){let St=new K.ContentStream,xt=[St],Pt=0,Ft=[];for(;Pt<At.length;){let Mt=B.Util.readNextWord(At,Pt),Dt=B.Util.skipSymbol(At,B.Util.SPACE,Mt.end_index+1);if((At[Dt]===B.Util.LF||At[Dt]===B.Util.COMMENT_START[0])&&Mt.result!==""){let Ut=B.Util.convertUnicodeToString(Mt.result);if(Ut===it.TEXT_OBJECT_START)xt.push([Ft]);else if(Ut===it.TEXT_OBJECT_END){let Qt=xt.pop(),Lt=new K.TextObject;Lt.parameters=[...Qt[0]],Lt.operators=Qt.slice(1),Array.isArray(xt[xt.length-1])?xt[xt.length-1].push(Lt):xt[xt.length-1].addOperator(Lt)}else if(Ut===it.MARKED_CONTENT_START)xt.push([Ft]);else if(Ut===it.MARKED_CONTENT_END){let Qt=xt.pop(),Lt=new K.MarkedContent;Lt.parameters=[...Qt[0]],Lt.operators=Qt.slice(1),Array.isArray(xt[xt.length-1])?xt[xt.length-1].push(Lt):xt[xt.length-1].addOperator(Lt)}else xt[xt.length-1]instanceof K.ContentStream?xt[xt.length-1].addOperator(new K.Operator(Ut,[...Ft])):xt[xt.length-1].push(new K.Operator(Ut,[...Ft]));Ft=[],Pt=Mt.end_index+1}else if(!Mt.result)Pt=Mt.end_index+1;else if(Mt.result[0]===B.Util.LITERAL_STRING_START[0]){let Ut=B.Util.extractString(At,Mt.start_index);Ft.push(B.Util.convertUnicodeToString(Ut.result)),Pt=Ut.end_index+1}else if(Mt.result[0]===B.Util.HEX_STRING_START[0]){let Ut=B.Util.extractHexString(At,Mt.start_index);Ft.push(Ut.result),Pt=Ut.end_index+1}else if(Mt.result[0]===47){let Ut=B.Util.extractOptionValue(At,Mt.start_index);Ft.push("/"+Ut.result),Pt=Ut.end_index+1}else if(Mt.result[0]===B.Util.R[0]){let Ut={obj:Ft[Ft.length-2],generation:Ft[Ft.length-1]};Ft=Ft.slice(0,Ft.length-2),Ft.push(Ut),Pt=Mt.end_index+1}else{let Ut=B.Util.extractNumber(At,Mt.start_index);Ft.push(Ut.result),Pt=Ut.end_index+1}}return St}}parser$1.ContentStreamParser=it,it.TEXT_OBJECT_START="BT",it.TEXT_OBJECT_END="ET",it.MARKED_CONTENT_START="BMC",it.MARKED_CONTENT_END="EMC";class rt{static extract(At,St,xt,Pt){let Ft=D.ObjectUtil.extractObject(At,St,xt);if(Ft.value["/Type"]!=="/XObject"||Ft.value["/Subtype"]!=="/Form")throw Error("Xref {xref} is no valid XObject");let Mt=new J.XObjectObj;return Ft.value["/Name"]&&(Mt.name=Ft.value["/Name"]),Ft.value["/Matrix"]&&(Mt.matrix=Ft.value["/Matrix"]),Ft.value["/FormType"]&&(Mt.formType=Ft.value["/FormType"]),Ft.value["/BBox"]&&(Mt.bBox=Ft.value["/BBox"]),Ft.value["/Resources"]&&(Mt.resources=Ft.value["/Resources"]),Ft.stream&&Ft.stream.data&&Ft.stream.data.length>0&&(Mt.contentStream=it.extract(Ft.stream.data)),Mt}}parser$1.XObjectParser=rt;class st{static parseXObject(At){return new J.XObjectObj}static parseAppearanceStream(At,St){return B.Util.isReferencePointer(St[At])?St[At]:St[At]["/Off"]&&St[At]["/ON"]?B.Util.isReferencePointer(St[At]["/Off"])?St[At]["/Off"]:st.parseXObject(St[At]["/Off"]):st.parseXObject(St[At])}static parse(At,St){if(!St["/N"])throw Error("/N flag is required in appearance stream");let xt=new J.AppStream(At);return xt.N=st.parseAppearanceStream("/N",St),St["/R"]&&(xt.R=st.parseAppearanceStream("/R",St)),St["/D"]&&(xt.D=st.parseAppearanceStream("/D",St)),xt}}parser$1.AppearanceStreamParser=st;class at{static extract(At,St,xt,Pt){let Ft=D.ObjectUtil.extractObject(At,St,xt),Mt=Q.FontType.Type1;switch(Ft.value["/Subtype"]){case"/Type0":Mt=Q.FontType.Type0;break;case"/Type1":Mt=Q.FontType.Type1;break;case"/Type3":Mt=Q.FontType.Type3;break;case"/MMType1":Mt=Q.FontType.MMType1;break;case"/TrueType":Mt=Q.FontType.TrueType;break;case"/CIDFontType0":Mt=Q.FontType.CIDFontType0;break;case"/CIDFontType2":Mt=Q.FontType.CIDFontType2;break;default:Mt=void 0}return new Q.Font(Mt,Pt,Ft.value["/BaseFont"])}}parser$1.FontParser=at;class ct{static extract(At,St,xt,Pt,Ft,Mt){let Dt=D.ObjectUtil.extractObject(St,xt,Ft);Dt=Dt.value;let Ut;switch(Dt["/Subtype"]){case"/Circle":Ut=new Y.CircleAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/Square":Ut=new Y.SquareAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/FreeText":Ut=new tt.FreeTextAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/Ink":Ut=new z.InkAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/PolyLine":Ut=new W.PolyLineAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/Polygon":Ut=new W.PolygonAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/Text":Ut=new G.TextAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/Highlight":Ut=new X.HighlightAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/Underline":Ut=new X.UnderlineAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/Squiggly":Ut=new X.SquigglyAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;case"/StrikeOut":Ut=new X.StrikeOutAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt);break;default:Ut=new U.RawAnnotationObj,Ut.object_id={obj:xt.id,generation:xt.generation},Ut.extract(Dt,Pt,Mt)}return Ut.factory=At,Ut}}parser$1.AnnotationParser=ct;class dt{constructor(At,St,xt){this.data=At,this.xref=St,this.objectLookupTable=xt,this.pagesObjectId={obj:-1,generation:-1},this.data=At;let Pt=D.ObjectUtil.extractObject(this.data,St,xt).value;if(Pt["/Type"]!=="/Catalog")throw Error(`Invalid catalog object at position ${St.pointer}`);this.pagesObjectId=Pt["/Pages"]}getPagesObjectId(){return this.pagesObjectId}}parser$1.CatalogObject=dt;class nt{constructor(At,St){this.data=At,this.objectLookupTable=St,this.pageCount=-1,this.pageReferences=[],this.visitedPages=[],this.data=At}extractPageReferences(At){for(let St of At){if(this.visitedPages.some(Ft=>Ft.obj===St.obj&&Ft.generation===St.generation))continue;let xt=this.objectLookupTable[St.obj],Pt=D.ObjectUtil.extractObject(this.data,xt,this.objectLookupTable).value;if(Pt["/Type"]==="/Page")this.pageReferences.push(St);else if(Pt["/Type"]==="/Pages")this.visitedPages.push(St),this.extractPageReferences(Pt["/Kids"]);else throw Error(`Invalid object type ${Pt["/Type"]}`)}}extract(At,St){let xt=D.ObjectUtil.extractObject(this.data,At,St).value;if(!xt["/Kids"])throw Error("Could not find index of /Kids in /Pages object");let Pt=xt["/Kids"];this.pageReferences=[],this.extractPageReferences(Pt),this.pageCount=this.pageReferences.length}getPageCount(){return this.pageCount}getPageReferences(){return this.pageReferences}getPagesReferences(){return this.visitedPages}}parser$1.PageTree=nt;class ht{constructor(At,St){this.data=At,this.documentHistory=St,this.resources=void 0,this.data=At}extract(At,St){let xt=D.ObjectUtil.extractObject(this.data,At,St);this.object_id=xt.id;let Pt=xt.value["/Resources"];Pt&&(this.resources=new et.Resource,this.resources.associatedWith=this.object_id,this.resources.extract(Pt))}}parser$1.Pages=ht;class vt{constructor(At,St){this.data=At,this.documentHistory=St,this.resources=void 0,this.annots=[],this.hasAnnotsField=!1,this.data=At}extractAnnotationArray(){let At=this.documentHistory.createObjectLookupTable();if(!this.annotsPointer)throw Error("Annotations pointer not set");let St=At[this.annotsPointer.obj],xt=D.ObjectUtil.extractObject(this.data,St,At);this.annots=xt.value}extract(At,St){let xt=D.ObjectUtil.extractObject(this.data,At,St);this.object_id=xt.id;let Pt=xt.value["/Annots"];Pt&&(this.hasAnnotsField=!0,Array.isArray(Pt)?this.annots=Pt.filter(Mt=>Mt!=="null"):(this.annotsPointer=Pt,this.extractAnnotationArray()));let Ft=xt.value["/Resources"];Ft&&(this.resources=new et.Resource,this.resources.associatedWith=this.object_id,this.resources.extract(Ft))}}parser$1.Page=vt;class _t{constructor(At,St,xt,Pt,Ft){if(this.data=At,this.documentHistory=St,this.ref_ptr=xt,this.cryptoConfiguration={version:void 0,revision:void 0,filter:void 0,user_pwd:"",owner_pwd:"",length:void 0,permissions:void 0,owner_pwd_c:void 0,user_pwd_c:void 0},this.cryptoEngine=new O.IdentityEngine,this.data=At,this.documentHistory=St,this.cryptoConfiguration.user_pwd=Pt||"",this.cryptoConfiguration.owner_pwd=Ft||"",this.ref_ptr&&this.documentHistory)if(this.extractEncryptionDictionary(this.ref_ptr),this.cryptoConfiguration.version===1)this.cryptoEngine=new O.RC4CryptoEngine(this.cryptoConfiguration,this.documentHistory.getRecentUpdate().id,O.RC4_40_BIT);else if(this.cryptoConfiguration.version===2)this.cryptoEngine=new O.RC4CryptoEngine(this.cryptoConfiguration,this.documentHistory.getRecentUpdate().id);else if(this.cryptoConfiguration.version===4)console.log("Some fancy AES encryption");else throw Error(`Unsupported Encryption ${this.cryptoConfiguration.version}`)}getEncryptionDictReference(){if(this.ref_ptr)return{obj:this.ref_ptr.id,generation:this.ref_ptr.generation}}encrypt(At,St){return this.cryptoEngine.encrypt(At,St)}decrypt(At,St){return this.cryptoEngine.decrypt(At,St)}isUserPasswordCorrect(){if(!this.cryptoEngine)throw Error("Crypto engine not configured");return this.cryptoEngine.isUserPasswordCorrect()}isOwnerPasswordCorrect(){if(!this.cryptoEngine)throw Error("Crypto engine not configured");return this.cryptoEngine.isOwnerPasswordCorrect()}extractEncryptionDictionary(At){if(!this.documentHistory)throw Error("Documenthistory not configured");if(!this.data)throw Error("Data not configured");let St=this.documentHistory.createObjectLookupTable(),xt=D.ObjectUtil.extractObject(this.data,At,St);this.cryptoConfiguration.version=xt.value["/V"],this.cryptoConfiguration.revision=xt.value["/R"],this.cryptoConfiguration.filter=xt.value["/Filter"],this.cryptoConfiguration.user_pwd_c=xt.value["/U"],this.cryptoConfiguration.owner_pwd_c=xt.value["/O"],this.cryptoConfiguration.length=xt.value["/Length"],this.cryptoConfiguration.permissions=xt.value["/P"]}}parser$1.CryptoInterface=_t;class ut{constructor(){this.cache={}}set(At,St){this.cache[`${At.obj}_${At.generation}`]=St}get(At,St=void 0){return this.cache[`${At.obj}_${At.generation}`]||St}has(At){return typeof this.cache[`${At.obj}_${At.generation}`]<"u"}}class bt{constructor(At,St="",xt=""){if(this.data=At,this.version=void 0,this.documentHistory=new F.DocumentHistory(new Uint8Array([])),this.catalogObject=void 0,this.pageTree=void 0,this.objectCache=new ut,this.cryptoInterface=new _t,this.fontManager=void 0,this.data=new Uint8Array(At),this.documentHistory=new F.DocumentHistory(this.data),this.documentHistory.extractDocumentHistory(),this.documentHistory.isEncrypted()){let Pt=this.documentHistory.createObjectLookupTable(),Ft=this.documentHistory.getRecentUpdate().encrypt;if(!Ft)throw Error("Invalid encryption indication");let Mt=Pt[Ft.obj];if(this.cryptoInterface=new _t(this.data,this.documentHistory,Mt,St,xt),!this.cryptoInterface.isUserPasswordCorrect()&&!this.cryptoInterface.isOwnerPasswordCorrect())throw Error("No valid user credentials")}}getCryptoInterface(){return this.cryptoInterface}getPDFVersion(){return this.version?this.version:(this.version=B.Util.extractVersion(this.data,0),this.version)}getFreeObjectId(){return this.documentHistory.getFreeObjectId()}getCatalog(){let At=this.documentHistory.getRecentUpdate();if(At.root){let St=At.root,xt=this.documentHistory.createObjectLookupTable();return new dt(this.data,xt[St.obj],xt)}else{if(this.catalogObject)return this.catalogObject;throw Error("Does not work for compressed data")}}getPageTree(){if(this.pageTree)return this.pageTree;let At=this.documentHistory.createObjectLookupTable(),xt=this.getCatalog().getPagesObjectId(),Pt=At[xt.obj],Ft=new nt(this.data,At);return Ft.extract(Pt,At),this.pageTree=Ft,Ft}getPage(At){let St;if(typeof At=="number"?St=this.getPageTree().getPageReferences()[At]:B.Util.isReferencePointer(At)&&(St=At),!St)throw Error("Could not determine reference pointer from page number");if(this.objectCache.has(St)){let Mt=this.objectCache.get(St);if(!(Mt instanceof vt))throw Error("Invalid cached Page object");return Mt}let xt=this.documentHistory.createObjectLookupTable(),Pt=xt[St.obj],Ft=new vt(this.data,this.documentHistory);return Ft.extract(Pt,xt),this.objectCache.set(St,Ft),Ft}getPages(At){if(this.objectCache.has(At)){let Ft=this.objectCache.get(At);if(!(Ft instanceof ht))throw Error("Invalid cached Pages object");return Ft}let St=this.documentHistory.createObjectLookupTable(),xt=St[At.obj],Pt=new ht(this.data,this.documentHistory);return Pt.extract(xt,St),this.objectCache.set(At,Pt),Pt}extractAnnotations(At){let St=[],xt=this.getPageTree(),Pt=this.documentHistory.createObjectLookupTable(),Ft=xt.getPageCount();for(let Mt=0;Mt<Ft;++Mt){let Dt=this.getPage(Mt),Ut=Dt.annots,Qt=[];for(let Lt of Ut){let qt=ct.extract(At,this.data,Pt[Lt.obj],Dt,Pt,this.cryptoInterface);qt.page=Mt,Qt.push(qt)}St.push(Qt)}return St}extractFonts(){let At=this.getPageTree(),St=At.getPageReferences(),xt=this.documentHistory.createObjectLookupTable();if(!this.fontManager)throw Error("FontManager not set");for(let Ft of St){let Mt=this.getPage(Ft);if(Mt.resources)for(let Dt of Mt.resources.font){if(!Dt.refPtr)throw Error("Reference pointer not set in resource definition");if(!this.fontManager.hasFont(Dt.refPtr)){let Ut=at.extract(this.data,xt[Dt.refPtr.obj],xt,Dt.name);Ut.object_id=Dt.refPtr,this.fontManager.addFont(Ut)}}}let Pt=At.getPagesReferences();for(let Ft of Pt){let Mt=this.getPages(Ft);if(Mt.resources)for(let Dt of Mt.resources.font){if(!Dt.refPtr)throw Error("Reference pointer not set in resource definition");if(!this.fontManager.hasFont(Dt.refPtr)){let Ut=at.extract(this.data,xt[Dt.refPtr.obj],xt,Dt.name);Ut.object_id=Dt.refPtr,this.fontManager.addFont(Ut)}}}}getFonts(){return this.fontManager?this.fontManager:(this.fontManager=new Q.FontManager(this),this.extractFonts(),this.fontManager)}extractXObject(At){let St=this.documentHistory.createObjectLookupTable();return rt.extract(this.data,St[At.obj],St,this.cryptoInterface)}}return parser$1.PDFDocumentParser=bt,parser$1}var annotation={},writer={};Object.defineProperty(writer,"__esModule",{value:!0});writer.Writer=void 0;const util_1$1=util,object_util_1=requireObjectUtil(),writer_util_1=writerUtil;class Writer{constructor(D,F,O,U){this.data=D,this.annotations=F,this.toDelete=O,this.parser=U,this.xrefs=[],this.data=new Uint8Array(D),this.cryptoInterface=U.getCryptoInterface()}sortPageWise(D){let F={};for(let O of D)F[O.page]||(F[O.page]=[]),F[O.page].push(O);return F}adaptPageObject(D,F){if(!D.object_id)throw Error("Page without object id");let O=this.parser.documentHistory.createObjectLookupTable(),U=O[D.object_id.obj];if(U.compressed){let G=object_util_1.ObjectUtil.extractObject(this.data,U,O),X=G.stream.getData().slice(G.pointer_stream_start,G.pointer_stream_end+1),tt=writer_util_1.WriterUtil.writeReferencePointer(G.id,!1).concat(32),Y=new Uint8Array(tt.length+writer_util_1.WriterUtil.OBJ.length+X.length+writer_util_1.WriterUtil.ENDOBJ.length);return Y.set(tt),Y.set(writer_util_1.WriterUtil.OBJ,tt.length),Y.set(X,writer_util_1.WriterUtil.OBJ.length+tt.length),Y.set(writer_util_1.WriterUtil.ENDOBJ,writer_util_1.WriterUtil.OBJ.length+X.length+tt.length),writer_util_1.WriterUtil.replaceAnnotsFieldInPageObject(Y,D,0,F)}return writer_util_1.WriterUtil.replaceAnnotsFieldInPageObject(this.data,D,U.pointer,F)}writeAnnotArray(D,F){let O=D[0].pageReference;if(!O)throw Error("Missing page reference");if(!O.object_id)throw Error("Page without object id");let U=O.annots;U=U.concat(D.map(Y=>{if(!Y.object_id)throw Error("Annotation with object_id null");return Y.object_id})),U=U.filter(Y=>{let W=F.find(z=>z.object_id.obj===Y.obj&&z.object_id.generation===Y.generation);return W?(W.is_deleted=!0,!1):!0});let G=O.annotsPointer,X=[];G||(G=this.parser.getFreeObjectId(),X=this.adaptPageObject(O,G));let tt=writer_util_1.WriterUtil.writeReferencePointer(G);tt.push(writer_util_1.WriterUtil.SPACE),tt=tt.concat(writer_util_1.WriterUtil.OBJ),tt.push(writer_util_1.WriterUtil.CR),tt.push(writer_util_1.WriterUtil.LF),tt.push(writer_util_1.WriterUtil.ARRAY_START);for(let Y of U)tt=tt.concat(writer_util_1.WriterUtil.writeReferencePointer(Y,!0)),tt.push(writer_util_1.WriterUtil.SPACE);return tt.push(writer_util_1.WriterUtil.ARRAY_END),tt.push(writer_util_1.WriterUtil.CR),tt.push(writer_util_1.WriterUtil.LF),tt=tt.concat(writer_util_1.WriterUtil.ENDOBJ),tt.push(writer_util_1.WriterUtil.CR),tt.push(writer_util_1.WriterUtil.LF),{ptr:G,data:tt,pageReference:O.object_id,pageData:X}}writeAnnotationObject(D){let F=D.writeAnnotationPreamble();return F=F.concat(D.writeAnnotationObject(this.cryptoInterface)),F=F.concat(D.writeAnnotationPostamble()),{ptr:D.object_id,data:F}}computeXrefSequences(){let D=[],F=this.xrefs.sort((G,X)=>G.id<X.id?-1:G.id>X.id?1:0),O=[F[0]],U=F[0].id;D.push(O);for(let G=1;G<F.length;++G)F[G].id===U+1?O.push(F[G]):(O=[F[G]],D.push(O)),U=F[G].id;return D}applyObjectFreeing(D){let F=this.parser.documentHistory.createObjectLookupTable()[0],O=F.id,U=D.filter(X=>X.free);U=U.sort((X,tt)=>X.id<tt.id?-1:X.id>tt.id?1:0);let G;for(let X of U)G||(F.pointer=X.id),G&&(G.pointer=X.id),G=X;return U.length>0&&(U[U.length-1].pointer=O),D.push(F),D}writeCrossSiteReferenceTable(){let D=[...writer_util_1.WriterUtil.XREF];D.push(writer_util_1.WriterUtil.CR),D.push(writer_util_1.WriterUtil.LF),this.xrefs=this.applyObjectFreeing(this.xrefs);let F=this.computeXrefSequences();for(let O of F){let U=O[0];D=D.concat(util_1$1.Util.convertNumberToCharArray(U.id)),D.push(writer_util_1.WriterUtil.SPACE),D=D.concat(util_1$1.Util.convertNumberToCharArray(O.length)),D.push(writer_util_1.WriterUtil.CR),D.push(writer_util_1.WriterUtil.LF);for(let G=0;G<O.length;++G){let X=[];if(X=X.concat(writer_util_1.WriterUtil.pad(10,O[G].pointer)),X.push(writer_util_1.WriterUtil.SPACE),X=X.concat(writer_util_1.WriterUtil.pad(5,O[G].generation)),X.push(writer_util_1.WriterUtil.SPACE),O[G].free&&X.push(writer_util_1.WriterUtil.F),O[G].update&&X.push(writer_util_1.WriterUtil.N),X.push(writer_util_1.WriterUtil.CR),X.push(writer_util_1.WriterUtil.LF),X.length<20)throw Error("XRef entry < 20 bytes");D=D.concat(X)}}return D}writeTrailer(D){let F=[...writer_util_1.WriterUtil.TRAILER];if(F.push(writer_util_1.WriterUtil.CR),F.push(writer_util_1.WriterUtil.LF),F=F.concat(writer_util_1.WriterUtil.DICT_START),F=F.concat(writer_util_1.WriterUtil.SIZE),F.push(writer_util_1.WriterUtil.SPACE),F=F.concat(util_1$1.Util.convertNumberToCharArray(this.parser.documentHistory.trailerSize)),F.push(writer_util_1.WriterUtil.SPACE),this.parser.documentHistory.isEncrypted()){F=F.concat(writer_util_1.WriterUtil.ENCRYPT),F.push(writer_util_1.WriterUtil.SPACE);let U=this.parser.getCryptoInterface().getEncryptionDictReference();if(!U)throw Error("No reference pointer to encryption dictionary");F=F.concat(writer_util_1.WriterUtil.writeReferencePointer(U,!0)),F.push(writer_util_1.WriterUtil.SPACE)}let O=this.parser.documentHistory.getRecentUpdate();if(O.id){F=F.concat(writer_util_1.WriterUtil.DOCUMENT_ID),F.push(writer_util_1.WriterUtil.SPACE),F.push(writer_util_1.WriterUtil.ARRAY_START);for(let U of O.id)F.push(writer_util_1.WriterUtil.SPACE),F=F.concat(writer_util_1.WriterUtil.HEX_STRING_START),F=F.concat(util_1$1.Util.convertStringToAscii(util_1$1.Util.convertByteArrayToHexString(U))),F=F.concat(writer_util_1.WriterUtil.HEX_STRING_END),F.push(writer_util_1.WriterUtil.SPACE);F.push(writer_util_1.WriterUtil.ARRAY_END),F.push(writer_util_1.WriterUtil.SPACE)}if(F=F.concat(writer_util_1.WriterUtil.ROOT),F.push(writer_util_1.WriterUtil.SPACE),!O.root)throw Error("No root object in trailer, although this is an cross reference table document");return F=F.concat(writer_util_1.WriterUtil.writeReferencePointer(O.root,!0)),F.push(writer_util_1.WriterUtil.SPACE),F=F.concat(writer_util_1.WriterUtil.PREV),F.push(writer_util_1.WriterUtil.SPACE),F=F.concat(util_1$1.Util.convertNumberToCharArray(this.parser.documentHistory.getRecentUpdate().start_pointer)),F.push(writer_util_1.WriterUtil.SPACE),F=F.concat(writer_util_1.WriterUtil.DICT_END),F.push(writer_util_1.WriterUtil.CR),F.push(writer_util_1.WriterUtil.LF),F=F.concat(writer_util_1.WriterUtil.STARTXREF),F.push(writer_util_1.WriterUtil.CR),F.push(writer_util_1.WriterUtil.LF),F=F.concat(util_1$1.Util.convertNumberToCharArray(D)),F.push(writer_util_1.WriterUtil.CR),F.push(writer_util_1.WriterUtil.LF),F=F.concat(writer_util_1.WriterUtil.EOF),F.push(writer_util_1.WriterUtil.CR),F.push(writer_util_1.WriterUtil.LF),F}write(){let D=this.sortPageWise(this.annotations),F=this.data.length,O=[];this.data[F-1]===70&&(O.push(writer_util_1.WriterUtil.CR),O.push(writer_util_1.WriterUtil.LF),F+=2);for(let K in D){let J=D[K],Q=this.writeAnnotArray(J,this.toDelete);this.xrefs.push({id:Q.ptr.obj,pointer:F,generation:Q.ptr.generation,free:!1,update:!0}),O=O.concat(Q.data),F+=Q.data.length,Q.pageData.length>0&&(this.xrefs.push({id:Q.pageReference.obj,pointer:F,generation:Q.pageReference.generation,free:!1,update:!0}),O=O.concat(Q.pageData),F+=Q.pageData.length);for(let et of J){for(let rt of et.additional_objects_to_write){let st=rt.func(rt.obj,this.cryptoInterface);this.xrefs.push({id:rt.obj.object_id.obj,pointer:F,generation:rt.obj.object_id.generation,free:!1,update:!0}),O=O.concat(st),F+=st.length}let it=this.writeAnnotationObject(et);this.xrefs.push({id:it.ptr.obj,pointer:F,generation:it.ptr.generation,free:!1,update:!0}),O=O.concat(it.data),F+=it.data.length}}let U=this.toDelete.filter(K=>!K.is_deleted),G=this.sortPageWise(U);for(let K in G){let J=this.updatePageAnnotationReferenceArray(G[K]);this.xrefs.push({id:J.ptr.obj,pointer:F,generation:J.ptr.generation,free:!1,update:!0}),O=O.concat(J.data),F+=J.data.length}let X=this.parser.getFonts().getFontsToWrite();for(let K of X){if(!K.object_id)throw Error("Font has no object id");let J=K.writeFont();this.xrefs.push({id:K.object_id.obj,pointer:F,generation:K.object_id.generation,free:!1,update:!0}),O=O.concat(J),F+=J.length}for(let K of this.toDelete)K.object_id&&this.xrefs.push({id:K.object_id.obj,pointer:-1,generation:K.object_id.generation+1,free:!0,update:!1});let tt=this.writeCrossSiteReferenceTable();O=O.concat(tt);let Y=this.writeTrailer(F);O=O.concat(Y);let W=new Uint8Array(O),z=new Uint8Array(this.data.length+W.length);return z.set(this.data),z.set(O,this.data.length),z}updatePageAnnotationReferenceArray(D){let F=D[0].pageReference;if(!F)throw Error("Missing page reference");if(!F.object_id)throw Error("Page without object id");let O=F.annots;O=O.filter(X=>{let tt=D.find(Y=>Y.object_id.obj===X.obj&&Y.object_id.generation===X.generation);return tt?(tt.is_deleted=!0,!1):!0});let U=F.annotsPointer,G=writer_util_1.WriterUtil.writeReferencePointer(U);G.push(writer_util_1.WriterUtil.SPACE),G=G.concat(writer_util_1.WriterUtil.OBJ),G.push(writer_util_1.WriterUtil.CR),G.push(writer_util_1.WriterUtil.LF),G.push(writer_util_1.WriterUtil.ARRAY_START);for(let X of O)G=G.concat(writer_util_1.WriterUtil.writeReferencePointer(X,!0)),G.push(writer_util_1.WriterUtil.SPACE);return G.push(writer_util_1.WriterUtil.ARRAY_END),G.push(writer_util_1.WriterUtil.CR),G.push(writer_util_1.WriterUtil.LF),G=G.concat(writer_util_1.WriterUtil.ENDOBJ),G.push(writer_util_1.WriterUtil.CR),G.push(writer_util_1.WriterUtil.LF),{ptr:U,data:G}}}writer.Writer=Writer;Object.defineProperty(annotation,"__esModule",{value:!0});annotation.AnnotationFactory=annotation.ParameterParser=void 0;const parser_1=requireParser(),text_annotation_1=requireText_annotation(),text_markup_annotation_1=requireText_markup_annotation(),freetext_annotation_1=requireFreetext_annotation(),circle_square_annotation_1=requireCircle_square_annotation(),polygon_polyline_annotation_1=requirePolygon_polyline_annotation(),ink_annotation_1=requireInk_annotation(),util_1=util,writer_1=writer;class ParameterParser{static parseParameters(D){if(D.length===0)throw Error("No parameters provided");let F=0;if(typeof D[F]=="number"){let O={};if(O.page=D[F++],O.rect=D[F++],O.contents=D[F++],typeof O.contents!="string")throw Error("Invalid contents parameter");if(O.author=D[F++],typeof O.author!="string")throw Error("Invalid author parameter");if(F>=D.length)return O;if("r"in D[F]&&"g"in D[F]&&"b"in D[F])O.color=D[F++];else if(Array.isArray(D[F])&&D[F].length>0&&typeof D[F][0]=="number")O.vertices=D[F++];else if(Array.isArray(D[F])&&D[F].length>0&&Array.isArray(D[F][0]))O.inkList=D[F++];else throw Error("Invalid parameter provided - is neither color, nor quadpoints array or an inklist");if(F>=D.length)return O;if("r"in D[F]&&"g"in D[F]&&"b"in D[F])O.color?O.fill=D[F++]:O.color=D[F++];else if(Array.isArray(D[F])&&D[F].length>0&&typeof D[F][0]=="number")O.quadPoints=D[F++];else if(typeof D[F]=="object")O.config=!0,O=Object.assign(O,D[F++]);else throw Error("Invalid parameter provided");if(F>=D.length)return O;if(!O.config&&typeof D[F]=="object")O=Object.assign(O,D[F++]);else throw Error("Invalid configuration provided");return O}else{if(typeof D[F]=="object")return D[0];throw Error("Invalid configuration object")}}}annotation.ParameterParser=ParameterParser;class AnnotationFactory{constructor(D,F="",O=""){this.data=D,this.userPassword=F,this.ownerPassword=O,this.annotations=[],this.toDelete=[],this.data=D,this.parser=new parser_1.PDFDocumentParser(this.data,this.userPassword,this.ownerPassword)}getAnnotationCount(){return this.annotations.length}static loadFile(D,F="",O=""){return new Promise(U=>{if(typeof window<"u")fetch(D).then(G=>G.blob()).then(G=>{let X=new FileReader;X.onload=()=>{U(new AnnotationFactory(X.result,F,O))},X.readAsArrayBuffer(G)});else if(typeof process=="object"){let X=require("fs").readFileSync(D);U(new AnnotationFactory(X,F,O))}else throw Error("Unsupported environment")})}generateUniqueIdentifier(){return"pdfAnnotate-"+util_1.Util.convertDateToPDFDate(new Date).slice(3,17)+"-"+this.annotations.length}createDefaultBorder(){return{vertical_corner_radius:0,horizontal_corner_radius:0,border_width:1}}write(){return this.annotations.length===0&&this.toDelete.length===0?this.data:new writer_1.Writer(this.data,this.annotations,this.toDelete,this.parser).write()}checkRect(D,F){if(!Array.isArray(F))throw Error("invalid rect parameter");if(F.length!==D)throw Error("Rect has invalid number of entries: "+F+" has "+F.length+" entries, but should have "+D+" entries");F.forEach(O=>{if(typeof O!="number")throw Error("Rect "+F+" has invalid entry: "+O)})}createBaseAnnotation(D){if(D<0)throw Error(`Invalid page number: ${D}`);return{object_id:this.parser.getFreeObjectId(),id:this.generateUniqueIdentifier(),pageReference:this.parser.getPage(D),updateDate:util_1.Util.convertDateToPDFDate(new Date),border:this.createDefaultBorder(),page:D,rect:[],factory:this}}createTextAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new text_annotation_1.TextAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createHighlightAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new text_markup_annotation_1.HighlightAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createUnderlineAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new text_markup_annotation_1.UnderlineAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createSquigglyAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new text_markup_annotation_1.SquigglyAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createStrikeOutAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new text_markup_annotation_1.StrikeOutAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createFreeTextAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new freetext_annotation_1.FreeTextAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createLineAnnotation(){throw Error("No yet implemented")}createSquareAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new circle_square_annotation_1.SquareAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createCircleAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new circle_square_annotation_1.CircleAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createPolygonAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new polygon_polyline_annotation_1.PolygonAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createPolyLineAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new polygon_polyline_annotation_1.PolyLineAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createInkAnnotation(...D){let F=ParameterParser.parseParameters(D),O=new ink_annotation_1.InkAnnotationObj;return O=Object.assign(O,this.createBaseAnnotation(F.page)),O=Object.assign(O,F),O.validate(),this.annotations.push(O),O}createStampAnnotation(...D){let F=ParameterParser.parseParameters(D),O=Object.assign(this.createBaseAnnotation(F.page),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:F.color,stampType:F.stampType});O.type="/Stamp",this.annotations.push(O)}createCaretAnnotation(...D){let F=ParameterParser.parseParameters(D),O=Object.assign(this.createBaseAnnotation(F.page),{opacity:1,initiallyOpen:!1,annotation_flag:4,color:F.color,caretSymbol:F.caretSymbol});O.type="/Caret",this.annotations.push(O)}createPopupAnnotation(){throw Error("No yet implemented")}deleteAnnotation(D){return new Promise(F=>{for(let O=0;O<this.annotations.length;++O)if(typeof D=="string"&&this.annotations[O].id===D){this.annotations=this.annotations=[...this.annotations.slice(0,O),...this.annotations.slice(O+1)],F(this.toDelete);return}else if(D.obj&&this.annotations[O].object_id&&D.obj===this.annotations[O].object_id.obj&&D.generation&&D.generation===this.annotations[O].object_id.generation){this.annotations=this.annotations=[...this.annotations.slice(0,O),...this.annotations.slice(O+1)],F(this.toDelete);return}this.getAnnotations().then(O=>{for(let U of O)for(let G of U)if(typeof D=="string"&&G.id===D){this.toDelete.push(G),F(this.toDelete);return}else if(D.obj&&G.object_id&&D.obj===G.object_id.obj&&D.generation&&D.generation===G.object_id.generation){this.toDelete.push(G),F(this.toDelete);return}})})}_getAnnotations(){let D=this.parser.extractAnnotations(this);for(let F of this.annotations)D[F.page].push(F);return D}getAnnotations(){return new Promise(D=>{D(this._getAnnotations())})}getFonts(){return new Promise(D=>{D(this.parser.getFonts().fonts)})}download(D="output.pdf"){let F=document.createElement("a");document.body.appendChild(F),F.style="display: none";let O=this.write(),U=new Blob([O],{type:"application/pdf"}),G=window.URL.createObjectURL(U);F.href=G,F.download=D,F.click(),F.remove(),window.URL.revokeObjectURL(G)}save(D="output.pdf"){if(typeof window<"u")this.download(D);else if(typeof process=="object"){const F=require("fs");let O=this.write();F.writeFile(D,Buffer.from(new Uint8Array(O)),U=>{if(U)throw Error(U)})}else throw Error("Unsupported environment")}}annotation.AnnotationFactory=AnnotationFactory;(function(B){Object.defineProperty(B,"__esModule",{value:!0});var D=requireParser();Object.defineProperty(B,"PDFDocumentParser",{enumerable:!0,get:function(){return D.PDFDocumentParser}});var F=requireAnnotation_types();Object.defineProperty(B,"LineEndingStyle",{enumerable:!0,get:function(){return F.LineEndingStyle}});var O=requireText_annotation();Object.defineProperty(B,"AnnotationIcon",{enumerable:!0,get:function(){return O.AnnotationIcon}}),Object.defineProperty(B,"AnnotationState",{enumerable:!0,get:function(){return O.AnnotationState}}),Object.defineProperty(B,"AnnotationStateModel",{enumerable:!0,get:function(){return O.AnnotationStateModel}});var U=requireFreetext_annotation();Object.defineProperty(B,"TextJustification",{enumerable:!0,get:function(){return U.TextJustification}}),Object.defineProperty(B,"FreeTextType",{enumerable:!0,get:function(){return U.FreeTextType}});var G=util;Object.defineProperty(B,"Util",{enumerable:!0,get:function(){return G.Util}});var X=annotation;Object.defineProperty(B,"AnnotationFactory",{enumerable:!0,get:function(){return X.AnnotationFactory}})})(lib);class AnnotationMaker{constructor(D,F,O,U){this.measureMarks=D,this.pathMarks=F,this._viewports=O,this._cleanData=U}get cleanData(){return new Uint8Array(this._cleanData)}static async load(D){const F=new lib.AnnotationFactory(await D.getData()),O=[];for(let W=0;W<D.numPages;W++){const z=await D.getPage(W+1);O.push(z.getViewport({scale:1}))}const U=[],G=(await F.getAnnotations()).flat();for(const W of G)for(const z of[MeasureMark,PathMark])try{const K=z.read(W,O[W.page]);U.push(K),await F.deleteAnnotation(W.id)}catch{}const X=U.filter(W=>W instanceof MeasureMark);X.sort((W,z)=>W.measure-z.measure);const tt=U.filter(W=>W instanceof PathMark),Y=F.write();return new AnnotationMaker(X,tt,O,Y)}write(){const D=new lib.AnnotationFactory(this.cleanData);return this.measureMarks.forEach(F=>F.write(D,this._viewports[F.page])),this.pathMarks.forEach(F=>F.write(D,this._viewports[F.page])),D.write()}createMeasureMark(D,F,O){const U=new MeasureMark(D,F,O);return this.measureMarks.push(U),this.measureMarks.sort((G,X)=>G.measure-X.measure),U}deleteMeasureMark(D){var O;const F=this.measureMarks.indexOf(D);F!==-1&&this.measureMarks.splice(F,1),(O=D.element)==null||O.remove()}createPathMark(D,F,O){const U=new PathMark(D,F,O);return this.pathMarks.push(U),U}deletePathMark(D){var O;const F=this.pathMarks.indexOf(D);F!==-1&&this.pathMarks.splice(F,1),(O=D.element)==null||O.remove()}}class MeasureMark{constructor(D,F,O){this.measure=D,this.page=F,this.rect=O}static read(D,F){if(D.author!=="PageTurnerMark")throw new Error("Not a MeasureMark");return new MeasureMark(Number(D.contents),D.page,decodeRect(D.rect,F))}write(D,F){const O=encodeRect(this.rect,F);D.createFreeTextAnnotation({page:this.page,rect:O,contents:this.measure.toString(),author:"PageTurnerMark",fontSize:25})}}class PathMark{constructor(D,F,O={r:0,g:0,b:0}){this.vertices=D,this.page=F,this.color=O}static read(D){if(D.author!=="PageTurnerPath")throw new Error("Not a PathMark");return new PathMark(JSON.parse(D.contents),D.page,D.color)}write(D,F){D.createFreeTextAnnotation({page:this.page,rect:[0,0,0,0],contents:JSON.stringify(this.vertices),author:"PageTurnerPath"})}getSVG(){const D=document.createElementNS("http://www.w3.org/2000/svg","svg");D.setAttribute("preserveAspectRatio","none"),D.setAttribute("viewBox","0 0 1 1"),D.style.position="absolute",D.style.width="100%",D.style.height="100%",D.style.pointerEvents="none";const F=document.createElementNS("http://www.w3.org/2000/svg","path");return F.setAttribute("fill","none"),F.setAttribute("stroke",`rgb(${this.color.r}, ${this.color.g}, ${this.color.b})`),F.setAttribute("stroke-width","0.01"),F.setAttribute("stroke-linecap","round"),F.setAttribute("stroke-linejoin","round"),F.setAttribute("d",`M ${this.vertices.map(O=>O.join(" ")).join(" L ")}`),D.appendChild(F),D}checkCollision(D,F){const O=[];for(let U=1;U<this.vertices.length;U++)O.push([this.vertices[U-1],this.vertices[U]]);return O.some(([U,G])=>{const X=[...U,...G,...D,...F].map(tt=>tt);return!!linesIntersection(...X)})}}function encodePoint(B,D){return[Math.round(B[0]*D.width),Math.round((1-B[1])*D.height)]}function decodePoint(B,D){return[B[0]/D.width,1-B[1]/D.height]}function encodeRect(B,D){const[F,O,U,G]=B;return[...encodePoint([F,O],D),...encodePoint([U||F,G||O],D)]}function decodeRect(B,D){const[F,O,U,G]=B;return[...decodePoint([F,O],D),...decodePoint([U,G],D)]}var __defProp$5=Object.defineProperty,__getOwnPropDesc$5=Object.getOwnPropertyDescriptor,__decorateClass$5=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$5(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$5(D,F,U),U};pdfExports.GlobalWorkerOptions.workerSrc="pdf.worker.js";let PDFViewer=class extends s{constructor(){super(...arguments),this.loaded=!1,this.tabIndex=0,this.renderId=0,this.barSuggestion=1,this.__currentPage=-1,this.__currentMeasure=0,this.scale=1,this.mode="view",this._onkeydown=B=>{switch(B.key){case"ArrowRight":this.currentPage++,this.firePageSelectEvent();break;case"ArrowLeft":this.currentPage--,this.firePageSelectEvent();break;case"f":this.requestFullscreen()}},this._touchStart={x:0,y:0},this._onTouchStart=B=>{this.mode==="view"&&(this._touchStart={x:B.touches[0].clientX,y:B.touches[0].clientY})},this._onTouchEnd=B=>{if(this.mode!=="view")return;const D=B.changedTouches[0].clientX,F=B.changedTouches[0].clientY,O=50;if(!(distance(this._touchStart.y,F)>distance(this._touchStart.x,D))){if(this._touchStart.x-D>O){if(this.currentPage===void 0)return this.currentPage=0;this.currentPage++,this.firePageSelectEvent()}else if(D-this._touchStart.x>O){if(this.currentPage===void 0)return this.currentPage=0;this.currentPage--,this.firePageSelectEvent()}}}}toggleMode(B){if(this.mode===B){this.mode="view";return}this.mode=B}render(){return x`
      <div 
        id="scrollable"
        style=${this.mode==="draw"||this.mode==="erase"?"cursor: crosshair; overflow: hidden;":""}
      >
        <slot></slot>
      </div>
      <div id="tools" ?hidden=${!this.loaded} >

        <div id="markers">
          <button 
            title="Mark Measures"
            @click=${()=>{this.toggleMode("mark")}}
            class=${(this.mode==="mark"?"primary":"")+" borderless"}
          >
            
          </button>
  
          <button 
            title="Draw"
            @click=${()=>{this.toggleMode("draw")}}
            class=${(this.mode==="draw"?"primary":"")+" borderless"}
          >
            
          </button>

          <button 
            title="Erase"
            @click=${()=>{this.toggleMode("erase")}}
            class=${(this.mode==="erase"?"primary":"")+" borderless"}
          >
            
          </button>
        </div>

        <div>
          <button
            title="Zoom Out"
            class="borderless"
            @click=${()=>{this.scale=Math.max(.1,this.scale-.1)}}
          >
            
          </button>
  
          <span>
            ${Math.round(this.scale*100)}%
          </span>
  
          <button
            title="Zoom In"
            class="borderless"
            @click=${()=>{this.scale=Math.min(3,this.scale+.1)}}
          >
            
          </button>
        </div>


      </div>
      <div id="indicator">
        <div id="progress" style="width: ${(this.progress??0)*100}%"></div>
      </div>
    `}getPage(B){const D=this.scrollable.children[B];return{canvas:D.querySelector("canvas"),markingsContainer:D.querySelector(".markings"),container:D}}async load(B){this.renderId++;const D=this.renderId;this.progress=0,this.__currentPage=-1,this.__currentMeasure=0,this.factory=await AnnotationMaker.load(await pdfExports.getDocument(B).promise),this.pdf=await pdfExports.getDocument(this.factory.cleanData).promise,this.scrollable.innerHTML="";for(let F=0;F<this.pdf.numPages;F++){const O=document.createElement("div");O.classList.add("page");const U=document.createElement("canvas"),G=document.createElement("div");G.classList.add("markings"),O.append(U,G),this.scrollable.append(O)}for(let F=0;F<this.pdf.numPages;F++){if(D!==this.renderId)return;this.renderPage(F)}this.factory.measureMarks.forEach(F=>this.drawMeasureMark(F)),this.factory.pathMarks.forEach(F=>this.drawPathMark(F))}async renderPage(B){if(!this.pdf)return;const D=Math.max(window.devicePixelRatio||1,1),{container:F,canvas:O}=this.getPage(B),U=await this.pdf.getPage(B+1),G=U.getViewport({scale:1});O.height=G.height*D,O.width=G.width*D,F.style.aspectRatio=`${G.width/G.height}`;const X=O.getContext("2d");O.onclick=async Q=>{if(this.mode==="mark")try{const et=await popup(x`
              <h3>Mark Measure in PDF</h3>
            `,x`
              <label for="mark">Measure Number</label>
              <input type="number" id="mark" value=${this.barSuggestion} />
            `),it=Number(et.get("mark"));this.barSuggestion=it+1;const{x:rt,y:st}=relativeClickPosition(Q,O),at=this.factory.createMeasureMark(it,B,[rt,st]);this.drawMeasureMark(at),this.fireEditEvent()}catch{}this.mode==="view"&&(this.currentPage=B,this.firePageSelectEvent())};let tt,Y;const W=Q=>{if(this.mode==="draw"){const{x:et,y:it}=relativeClickPosition(Q,O);tt=this.factory.createPathMark([[et,it]],B),this.fireEditEvent()}if(this.mode==="erase"){const{x:et,y:it}=relativeClickPosition(Q,O);Y=[et,it]}},z=Q=>{if(this.mode==="draw"&&tt){const{x:et,y:it}=relativeClickPosition(Q,O);tt.vertices.push([et,it]),this.drawPathMark(tt),this.fireEditEvent()}if(this.mode==="erase"&&Y){const{x:et,y:it}=relativeClickPosition(Q,O);this.factory.pathMarks.filter(st=>st.page===B).forEach(st=>{st.checkCollision(Y,[et,it])&&(this.factory.deletePathMark(st),this.fireEditEvent())}),Y=[et,it]}},K=()=>{tt=void 0,Y=void 0};O.addEventListener("mousedown",W),O.addEventListener("mousemove",z),O.addEventListener("mouseup",K),O.addEventListener("mouseleave",K),O.addEventListener("touchstart",W),O.addEventListener("touchmove",z),O.addEventListener("touchend",K),O.addEventListener("touchcancel",K);const J=D!==1?[D,0,0,D,0,0]:void 0;await U.render({canvasContext:X,viewport:G,transform:J}).promise}drawMeasureMark(B){const{markingsContainer:D}=this.getPage(B.page),F=document.createElement("div");F.classList.add("mark");const[O,U]=B.rect;F.style.left=`${O*100}%`,F.style.top=`${U*100}%`,F.textContent=B.measure.toString(),F.onclick=()=>{this.currentMeasure=B.measure,this.fireMeasureSelectEvent()},F.ondblclick=()=>{this.factory.deleteMeasureMark(B),this.fireEditEvent()},B.element=F,D.append(F)}drawPathMark(B){var O;const{markingsContainer:D}=this.getPage(B.page);(O=B.element)==null||O.remove();const F=B.getSVG();B.element=F,D.append(F)}write(){var B;return(B=this.factory)==null?void 0:B.write()}set currentPage(B){if(B===this.__currentPage)return;const D=[...this.scrollable.children];B=clamp(B,0,D.length-1),this.__currentPage=B;const F=D[B];D.forEach(O=>O.removeAttribute("selected")),F.setAttribute("selected",""),F.scrollIntoView()}get currentPage(){return this.__currentPage}set currentMeasure(B){var F;if(!this.factory||B===this.__currentMeasure)return;this.__currentMeasure=B,this.factory.measureMarks.forEach(O=>{var U;return(U=O.element)==null?void 0:U.removeAttribute("selected")});const D=[...this.factory.measureMarks].reverse().find(O=>O.measure<=B);if(D){this.currentPage=D.page,(F=D.element)==null||F.setAttribute("selected","");const{container:O}=this.getPage(D.page),U=this.scrollable.scrollTop,G=this.scrollable.getBoundingClientRect(),X=O.getBoundingClientRect(),tt=D.element.getBoundingClientRect(),Y=X.top-G.top+U,W=Y+Math.max(0,X.height-G.height),z=tt.top-G.height*.3-G.top+U;this.scrollable.scrollTo({top:clamp(z,Y,W)})}}get currentMeasure(){return this.__currentMeasure}firePageSelectEvent(){var B;(B=window.ipcRenderer)==null||B.send("current-page",this.currentPage),this.dispatchEvent(new CustomEvent("pageSelect",{detail:this.currentPage}))}fireMeasureSelectEvent(){var B;(B=window.ipcRenderer)==null||B.send("current-measure",this.currentMeasure),this.dispatchEvent(new CustomEvent("measureSelect",{detail:this.currentMeasure}))}fireEditEvent(){this.dispatchEvent(new CustomEvent("edit"))}connectedCallback(){var B;super.connectedCallback(),this.addEventListener("keydown",this._onkeydown),this.addEventListener("touchstart",this._onTouchStart),this.addEventListener("touchend",this._onTouchEnd),(B=window.ipcRenderer)==null||B.on("page",(D,F)=>{this.currentPage=F})}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("keydown",this._onkeydown),this.removeEventListener("touchstart",this._onTouchStart),this.removeEventListener("touchend",this._onTouchEnd)}};PDFViewer.styles=[buttonStyle,i$3`
      :host {
        display: block;
        position: relative;
        outline: none;
        min-height: 0;
        box-sizing: border-box;
      }
      :host:fullscreen {
        background: black;
        color: white;
      }

      #scrollable {
        height: 100%;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        justify-content: center;
        align-items: center;
        overflow: auto;
        box-sizing: border-box;
      }

      .page {
        max-height: calc(100% * var(--scale, 1));
        overflow: hidden;
        display: grid;
        grid-template-rows: 1fr;
        grid-template-columns: 1fr;
        border-radius: 0.5rem;
        box-sizing: border-box;
        opacity: 0.9;
      }
      .page[selected] {
        opacity: 1;
        z-index: 1;
        box-shadow: 0 0 2em var(--color-blue);
      }
      .page > canvas {
        grid-row: 1;
        grid-column: 1;
        min-width: 0;
        min-height: 0;
        max-width: 100%;
        height: 100%;
      }
      .page > .markings {
        grid-row: 1;
        grid-column: 1;
        position: relative;
        pointer-events: none;
      }
      .page > .markings > .mark {
        position: absolute;
        transform: translate(-50%, -50%);
        background: var(--theme-color-background);
        border-radius: 50%;
        font-size: .6em;
        line-height: 1rem;
        height: 1rem;
        min-width: 1rem;
        text-align: center;
        user-select: none;
        pointer-events: auto;
        cursor: pointer;
      }
      .page > .markings > .mark[selected] {
        background: var(--color-green);
      }


      #indicator {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        overflow: hidden;
      }
      #indicator #progress {
        width: 0;
        height: 5px;
        background: var(--theme-color-primary);
        transition: width 0.5s;
      }

      #tools {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        margin: 1em;
        box-sizing: border-box;
        display: flex;
        justify-content: space-between;
        gap: .5em;
        z-index: 2;
        pointer-events: none;
      }

      #tools > div {
        background: #ffffffa8;
        color: var(--color-black);
        backdrop-filter: blur(.5em);
        border-radius: 2em;
        box-shadow: 0 .2em .5em var(--theme-color-shadow);
        padding: .2em;
        pointer-events: auto;
      }

      :host(:fullscreen) #tools > #markers {
        display: none;
      }

    `];__decorateClass$5([n({type:Boolean})],PDFViewer.prototype,"loaded",2);__decorateClass$5([n({type:Number}),cssProperty("--scale")],PDFViewer.prototype,"scale",2);__decorateClass$5([n({type:Number})],PDFViewer.prototype,"progress",2);__decorateClass$5([n({type:String})],PDFViewer.prototype,"mode",2);__decorateClass$5([e$1("#scrollable")],PDFViewer.prototype,"scrollable",2);PDFViewer=__decorateClass$5([t("pdf-viewer")],PDFViewer);var __defProp$4=Object.defineProperty,__getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__decorateClass$4=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$4(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$4(D,F,U),U};const storage=localStorage.getItem("recognitionOptions"),recognitionOptions=storage?JSON.parse(storage):{minDistance:7,maxDistance:42,seekStep:2.6,treshold:100},descriptions={minDistance:"Shortest seek distance from current frame.",maxDistance:"Longest seek distance from current frame.",seekStep:"How many frames to add to seek distance when recognizer predicts the same frame as before.",treshold:"How different can current microphone data be compared to a frame from recording to be considered a match. 0 means identical, 255 means completely different."};let RecognitionOptions=class extends s{constructor(){super(...arguments),this.minDistance=recognitionOptions.minDistance,this.maxDistance=recognitionOptions.maxDistance,this.seekStep=recognitionOptions.seekStep,this.treshold=recognitionOptions.treshold}render(){return x`
      <div>
        <label for="minDistance" title=${descriptions.minDistance}>Min Distance</label>
        <input 
          type="number" id="minDistance"
          min="1" max=${this.maxDistance-1}
          .value=${this.minDistance.toString()} 
          @change=${B=>{this.minDistance=Number(B.target.value),this.maxDistance=Math.max(this.minDistance+1,this.maxDistance)}} />
      </div>
      <div>
        <label for="maxDistance" title=${descriptions.maxDistance}>Max Distance</label>
        <input 
          type="number" id="maxDistance" 
          min=${this.minDistance+1}
          .value=${this.maxDistance.toString()}
          @change=${B=>{this.maxDistance=Number(B.target.value),this.minDistance=clamp(this.minDistance,1,this.maxDistance)}} />
      </div>
      <div>
        <label for="seekStep" title=${descriptions.seekStep}>Seek Step</label>
        <input 
          type="number" id="seekStep"
          step=".1" min="1"
          .value=${this.seekStep.toString()} 
          @change=${B=>this.seekStep=Number(B.target.value)} />
      </div>
      <div>
        <label for="treshold" title=${descriptions.treshold}>Treshold</label>
        <input 
          type="number" id="treshold" 
          min="0" max="255" 
          .value=${this.treshold.toString()} 
          @input=${B=>this.treshold=Number(B.target.value)} 
        />
      </div>
    `}updated(){localStorage.setItem("recognitionOptions",JSON.stringify({minDistance:this.minDistance,maxDistance:this.maxDistance,seekStep:this.seekStep,treshold:this.treshold}))}};RecognitionOptions.styles=i$3`
    :host {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 1em;
      justify-content: center;
      margin: 0 auto;
    }
    div {
      min-width: 120px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
    }
    input {
      margin: 0.5em 0;
      width: 6ch;
    }

  `;__decorateClass$4([n({type:Number})],RecognitionOptions.prototype,"minDistance",2);__decorateClass$4([n({type:Number})],RecognitionOptions.prototype,"maxDistance",2);__decorateClass$4([n({type:Number})],RecognitionOptions.prototype,"seekStep",2);__decorateClass$4([n({type:Number})],RecognitionOptions.prototype,"treshold",2);RecognitionOptions=__decorateClass$4([t("recognition-options")],RecognitionOptions);var __defProp$3=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$3(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$3(D,F,U),U};let MarkingsEditor=class extends s{constructor(){super(...arguments),this.markSuggestion=1,this.markTypeSuggestion="measure"}render(){return this.recording?x`
      <div class="container">
        ${this.recording.markings.map((B,D)=>{const[F,O,U]=B,G=U||"page";return x`
            <div 
              class="mark ${G}"
              style="left: ${F/this.recording.data.length*100}%" 
              @click=${()=>{this.dispatchEvent(new CustomEvent("select",{detail:{position:F,mark:O,type:G}}))}} 
              @dblclick=${()=>{this.recording.markings.splice(D,1),this.requestUpdate(),this.fireChangeEvent(),this.markSuggestion=O}} 
            >${O.toString()}</div>
          `})}
      </div>
    `:null}async add(B){const D=await popup(x`
        <h3>Create Mark</h3>
        <p>Double click on a mark to remove it</p>
      `,x`
        <label for="markNum">Number</label>
        <input id="markNum" type="number" value=${this.markSuggestion} min="1" max=${this.recording.data.length} >
        
        <label for="type">Mark Type</label>
        <input-options id="type" .options=${[{label:"Measure",value:"measure",selected:this.markTypeSuggestion==="measure"},{label:"Page",value:"page",selected:this.markTypeSuggestion==="page"}]}></input-options>
      `);if(!D)return;const F=parseInt(D.get("markNum")),O=D.get("type");this.markTypeSuggestion=O,!(!F||F<1)&&(this.markSuggestion=F+1,this.recording.markings.push([B,F,O]),this.recording.markings.sort((U,G)=>U[0]-G[0]),this.requestUpdate(),this.fireChangeEvent())}fireChangeEvent(){this.dispatchEvent(new CustomEvent("change"))}};MarkingsEditor.styles=[buttonStyle,i$3`
      :host {
        display: block;
        text-align: center;
      }
      .container {
        position: relative;
        height: 1rem;
        margin-bottom: .5rem;
      }
      .mark {
        --color: var(--color-blue);
        position: absolute;
        transform: translateX(-50%);
        border-radius: 50%;
        background: var(--color);
        width: 1rem;
        height: 1rem;
        font-size: .7rem;
        line-height: 1rem;
        text-align: center;
        cursor: pointer;
        user-select: none;
      }
      .mark::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        transform: translate(-50%, -20%) rotate(45deg);
        width: .5rem;
        height: .5rem;
        background: var(--color);
        z-index: -1;
      }
      .mark.measure {
        --color: var(--color-green);
      }
    `];__decorateClass$3([n({type:Object})],MarkingsEditor.prototype,"recording",2);MarkingsEditor=__decorateClass$3([t("markings-editor")],MarkingsEditor);class ElectronFile{constructor(D,F){this.name=D,this.path=F}async arrayBuffer(){return await window.ipcRenderer.invoke("file-read",this.path)}async text(){return await window.ipcRenderer.invoke("file-read-text",this.path)}get handle(){return{name:this.name,path:this.path}}}class ElectronDirectory{constructor(D,F){this.name=D,this.path=F}get handle(){return{name:this.name,path:this.path}}async getFile(D){const F=await window.ipcRenderer.invoke("file-create",this.path,D);return new ElectronFile(F.name,F.path)}async getDirectory(D){const F=await window.ipcRenderer.invoke("directory-create",this.path,D);return new ElectronDirectory(F.name,F.path)}async getEntries(){return(await window.ipcRenderer.invoke("directory-read",this.path)).map(F=>F.isDirectory?new ElectronDirectory(F.name,F.path):new ElectronFile(F.name,F.path))}}const supported$3=!!window.ipcRenderer,platform$3="electron";async function fileOpen$3(B){if(B!=null&&B.name&&(B!=null&&B.path))return new ElectronFile(B.name,B.path);const D=await window.ipcRenderer.invoke("file-open",B);return new ElectronFile(D.name,D.path)}async function fileSave$3(B,D,F){const O=await B.arrayBuffer();return await window.ipcRenderer.invoke("file-save",O,D,F)}async function directoryOpen$3(B){const D=await window.ipcRenderer.invoke("directory-open",B);return new ElectronDirectory(D.name,D.path)}async function getRecent(){return[]}const fsElectron=Object.defineProperty({__proto__:null,directoryOpen:directoryOpen$3,fileOpen:fileOpen$3,fileSave:fileSave$3,getRecent,platform:platform$3,supported:supported$3},Symbol.toStringTag,{value:"Module"}),supported$2=window.showOpenFilePicker&&window.showSaveFilePicker&&window.showDirectoryPicker,platform$2="browser";class BrowserDirectory{constructor(D,F){this.handle=D}get name(){return this.handle.name}async getFile(D){const F=await this.handle.getFileHandle(D,{create:!0});return await fileOpen$2(F)}async getDirectory(D){const F=await this.handle.getDirectoryHandle(D,{create:!0});return new BrowserDirectory(F)}async getEntries(){const D=[];for await(const F of this.handle.values())F.kind==="file"&&D.push(await fileOpen$2(F)),F.kind==="directory"&&D.push(await directoryOpen$2(F));return D}}async function fileOpen$2(B){const D=B instanceof FileSystemFileHandle?B:(await window.showOpenFilePicker(transformOpenOptions(B)))[0];if(!D)throw new Error("File not provided");if(!await verifyPermission(D))throw new Error("Permission denied");const F=await D.getFile();return Object.assign(F,{handle:D})}async function fileSave$2(B,D,F){const O=F||await window.showSaveFilePicker(transformSaveOptions(D));if(!O)throw new Error("File not provided");if(!await verifyPermission(O,!0))throw new Error("Permission denied");const U=await O.createWritable();return await U.write(B),await U.close(),O}async function directoryOpen$2(B){const D=B instanceof FileSystemDirectoryHandle?B:await window.showDirectoryPicker(transformOpenOptions(B));if(!D)throw new Error("Directory not provided");if(!await verifyPermission(D))throw new Error("Permission denied");return new BrowserDirectory(D)}async function verifyPermission(B,D=!1){const F=D?{mode:"readwrite"}:{};return await B.queryPermission(F)==="granted"||await B.requestPermission(F)==="granted"}function transformOpenOptions(B){return{id:B==null?void 0:B.id,multiple:!1,excludeAcceptAllOption:!0,types:[{description:B==null?void 0:B.description,accept:B==null?void 0:B.accept}]}}function transformSaveOptions(B){return{id:B==null?void 0:B.id,suggestedName:B==null?void 0:B.fileName,types:[{description:B==null?void 0:B.description,accept:B==null?void 0:B.accept}]}}const fsBrowser=Object.defineProperty({__proto__:null,directoryOpen:directoryOpen$2,fileOpen:fileOpen$2,fileSave:fileSave$2,platform:platform$2,supported:supported$2},Symbol.toStringTag,{value:"Module"}),supported$1=!0,platform$1="legacy";async function fileOpen$1(B){const D=document.createElement("input");D.type="file";const F=Object.values(B.accept||{}).flat();D.accept=F.join(",");const O=await new Promise(U=>{D.onchange=()=>{var X;const G=(X=D.files)==null?void 0:X[0];U(G)},D.click()});if(!O)throw new Error("File not provided");return O}async function fileSave$1(B,D){const F=document.createElement("a");F.href=URL.createObjectURL(B),F.download=D.fileName,F.click()}async function directoryOpen$1(){throw new Error("Not supported")}const fsLegacy=Object.defineProperty({__proto__:null,directoryOpen:directoryOpen$1,fileOpen:fileOpen$1,fileSave:fileSave$1,platform:platform$1,supported:supported$1},Symbol.toStringTag,{value:"Module"}),fs=supported$3?fsElectron:supported$2?fsBrowser:fsLegacy,{fileOpen,fileSave,directoryOpen,supported,platform}=fs;function promisifyRequest(B){return new Promise((D,F)=>{B.oncomplete=B.onsuccess=()=>D(B.result),B.onabort=B.onerror=()=>F(B.error)})}function createStore(B,D){const F=indexedDB.open(B);F.onupgradeneeded=()=>F.result.createObjectStore(D);const O=promisifyRequest(F);return(U,G)=>O.then(X=>G(X.transaction(D,U).objectStore(D)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get(B,D=defaultGetStore()){return D("readonly",F=>promisifyRequest(F.get(B)))}function set(B,D,F=defaultGetStore()){return F("readwrite",O=>(O.put(D,B),promisifyRequest(O.transaction)))}const defaultProjectInfo={piece:{title:"Untitled",composer:"Unknown"}},_Project=class Cr{constructor(D,F,O,U){this.dir=D,this.info=F,this.parts=O,this.recordings=U}static async open(D){const F=await directoryOpen(D),U=(await(await F.getDirectory("parts")).getEntries()).filter(K=>K.name.endsWith(".pdf")),X=(await(await F.getDirectory("recordings")).getEntries()).filter(K=>K.name.endsWith(".json")),tt=await F.getFile("info.json"),Y=await tt.text();let W=defaultProjectInfo;Y?W=Object.assign({},defaultProjectInfo,JSON.parse(Y)):(W=defaultProjectInfo,await fileSave(new Blob([JSON.stringify(W,null,2)],{type:"application/json"}),{},tt.handle));const z=new Cr(F,W,U,X);return window.ipcRenderer&&platform==="electron"&&window.ipcRenderer.send("project-open",z.dir.handle),await Cr.saveRecent(z),z}static async getRecent(){const D=await get("recent-projects");return(D==null?void 0:D.filter(F=>F&&F.name))||[]}static async saveRecent(D){const F=D.dir.handle,O=(await Cr.getRecent()).filter(U=>U).filter(U=>U.name!==F.name);return O.unshift(F),O.length>10&&O.pop(),await set("recent-projects",O),O}async createRecording(D,F){const U=await(await this.dir.getDirectory("recordings")).getFile(D+".json"),G=await fileSave(F,{},U.handle);return this.recordings.push(U),G}async createPart(D,F){const U=await(await this.dir.getDirectory("parts")).getFile(D+".pdf"),G=await fileSave(F,{},U.handle);return this.parts.push(U),G}};_Project.supported=platform!=="legacy";let Project=_Project;var __defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$2(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$2(D,F,U),U};let ProjectManager=class extends s{connectedCallback(){super.connectedCallback(),Project.getRecent().then(B=>{this.recent=B,B.length&&platform==="electron"&&Project.open(B[0]).then(D=>this.emit(D))})}render(){var B;return x`
      <button 
        @click=${async()=>{this.data=await Project.open(),this.emit(this.data)}}
      >
        Open Project
      </button>

      ${(B=this.recent)==null?void 0:B.map(D=>x`
          <button 
            @click=${async()=>this.emit(await Project.open(D))}
          >
            ${D==null?void 0:D.name}
          </button>
        `)}
    `}emit(B){this.dispatchEvent(new CustomEvent("open",{detail:B}))}};ProjectManager.styles=[buttonStyle,i$3`
      :host {
        display: flex;
        flex-wrap: wrap;
        gap: .5rem;
      }

    `];__decorateClass$2([n({type:Array})],ProjectManager.prototype,"recent",2);ProjectManager=__decorateClass$2([t("project-manager")],ProjectManager);const inputStyle=i$3`
  input {
    background: var(--theme-color-background-light);
    border: none;
    outline: none;
    display: block;
    /* box-sizing: border-box; */
  }

  input[type="range"] {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    margin: .4em 0;
    border-radius: .1em;
    cursor: pointer;
  }
  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    width: .2em;
    height: .2em;
    border-radius: .1em;
    background: var(--theme-color-primary);
    transform: scale(5);
  }
  input[type="range"]:focus::-webkit-slider-thumb {
    transform: scale(6);
  }

`;function stringify(B){return[[numString(B.getFullYear(),4),numString(B.getMonth()+1,2),numString(B.getDate(),2)].join("-"),[numString(B.getHours(),2),numString(B.getMinutes(),2),numString(B.getSeconds(),2)].join("-")].join(" ")}function numString(B,D){return B.toString().padStart(D,"0")}var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc$1(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp$1(D,F,U),U};let App=class extends s{constructor(){super(...arguments),this.pdfIsSaved=!0,this.recordingIsSaved=!0,this.position=0,this.serverCreated=!1,this.serverStatus=""}renderHeader(){if(platform!=="legacy")return x`
      <header>

        <project-manager
          ?hidden=${!Project.supported}
          @open=${async B=>{const D=B.detail;if(this.project=D,this.PDFHandle=void 0,this.pdfIsSaved=!0,this.recordingHandle=void 0,this.recording=void 0,this.recordingIsSaved=!0,this.position=0,D.parts.length){const F=D.parts[0];this.PDFHandle=F.handle;const O=await F.arrayBuffer();await this.viewer.load(O)}D.recordings.length&&(this.recordingHandle=D.recordings[0].handle,this.recording=await Recording.import(JSON.parse(await D.recordings[0].text())))}}
        ></project-manager>

      </header>
    `}async loadPDF(B){const D=await B.arrayBuffer();this.viewer.load(D)}renderViewer(){var B;return x`
      <app-container id="viewer" .title=${"Sheet Music"}>

        <button 
          slot="header" 
          title="Open PDF" 
          @click=${async()=>{const D=await fileOpen({id:"pdf",accept:{"application/pdf":[".pdf"]}});this.PDFHandle=D.handle;const F=await D.arrayBuffer();if(console.log(F),this.project)try{const O=document.createElement("input");O.type="hidden",O.id="deleteOriginal";const U=await popup(x`<h3>Add part to project?</h3>`,x`
                    <label for="name">Part Name</label>
                    <input id="name" type="text" value=${D.name.replace(/\.pdf$/,"")} >

                    ${O}
                    <input id="proxyInput" type="checkbox" @change=${Y=>{const W=Y.target.checked;O.value=W?"true":""}}>
                    <label for="proxyInput">Delete original file</label>
                  `),G=U.get("name").replace(/[\\/:*?"<>|]/g,""),X=new Blob([F],{type:"application/pdf"});console.log(F);const tt=await this.project.createPart(G,X);this.PDFHandle=tt,console.log("deleteOriginal",!!U.get("deleteOriginal"))}catch{}this.viewer.load(F),this.pdfIsSaved=!0}} 
        >
           Open
        </button>

        <button 
          slot="header" 
          title="Save PDF" 
          class="primary" 
          ?hidden=${this.pdfIsSaved}
          @click=${async()=>{const D=this.viewer.write();if(!D)return;const F=new Blob([D],{type:"application/pdf"});await fileSave(F,{id:"pdf",fileName:"Sheet Music.pdf"},this.PDFHandle),this.pdfIsSaved=!0}}
        >
          
        </button>

        <button 
          slot="header" 
          title="Fullscreen"
          @click=${()=>{this.viewer.requestFullscreen(),this.viewer.focus(),this.viewer.mode="view"}}
        >
          
        </button>

        <input-options
          .options=${((B=this.project)==null?void 0:B.parts.map((D,F)=>({value:D,label:D.name.replace(/\.pdf$/,""),selected:F===0})))||[]}
          @change=${D=>{D.detail.value&&(this.loadPDF(D.detail.value),this.PDFHandle=D.detail.value.handle)}}
        ></input-options>

        <pdf-viewer
          @pageSelect=${D=>{const F=D.detail;if(!this.recording)return;const O=this.recording.markings.filter(G=>G[1]===F+1&&(G[2]===void 0||G[2]==="page"));if(O.length===0)return;const U=O.reduce((G,X)=>Math.abs(X[0]-this.position)<Math.abs(G[0]-this.position)?X:G);this.position=U[0]}}
          @measureSelect=${D=>{const F=D.detail;if(!this.recording)return;const O=this.recording.markings.find(U=>U[1]===F&&U[2]==="measure");O&&(this.position=O[0])}}
          @edit=${()=>{this.pdfIsSaved=!1}}
        >
          <div>
            <h1>Get your sheet together!</h1>
            <br>
            Open a PDF file or project folder to get started
            <br>
            or try <a href="#" @click=${()=>this.viewer.load("martin.pdf")}>Bratec Martin</a> example
          </div>
        </pdf-viewer>
      </app-container>
    `}async loadRecording(B){const D=await B.text();this.recordingElement.setAttribute("open",""),this.recording=Recording.import(JSON.parse(D)),this.recordingIsSaved=!0,this.position=0,this.recordingHandle=B.handle}async importMIDI(B){const D=await B.arrayBuffer(),F=new Uint8Array(D),O=await popup(x`<h3>Import MIDI</h3>`,x`
        <input-boolean id="ignoreVelocity" value>Ignore Velocity</input-boolean>
        <input-boolean id="importMeasures" value>Import Measures</input-boolean>
      `),U=O.get("ignoreVelocity"),G=O.get("importMeasures"),X=Recording.fromMIDI(F,{ignoreVelocity:U,importMeasures:G});this.recording=X,this.recordingHandle=void 0,this.recordingIsSaved=!1,this.position=0}renderRecording(){var B,D,F;return x`
      <app-container
        collapsable
        id="recording"
        .title=${"Recording"} 
        .description=${((B=this.recordingHandle)==null?void 0:B.name.replace(/\.json$/,""))||""}
      >
        <input-recorder 
          id="recorder" 
          title="Record" 
          slot="header" 
          @data=${O=>{this.recording.data.push(O.detail)}} 
          @start=${O=>{const U=O.detail;this.recognizer.stop(),this.recordingHandle=void 0,this.recording=new Recording,this.recording.source=U}} 
          @stop=${()=>{this.spectrogram.requestUpdate(),this.markings.requestUpdate(),this.recordingIsSaved=!1,this.recordingElement.setAttribute("open",""),this.position=0}} 
        >
           New
        </input-recorder>

        <button
          title="Open Recording"
          slot="header"
          @click=${async()=>{const O=await fileOpen({id:"recording",accept:{"application/json":[".json"]}});this.loadRecording(O)}}
        >
          
        </button>

        <button
          title="Import MIDI"
          slot="header"
          @click=${async()=>{const O=await fileOpen({id:"midi",accept:{"audio/midi":[".mid",".midi"]}});this.importMIDI(O)}}
        >
          
        </button>

        <button 
          title="Save Recording" 
          class="primary" 
          slot="header" 
          ?hidden=${this.recordingIsSaved} 
          @click=${async()=>{if(!this.recording)return;const O=JSON.stringify(this.recording.export()),U=new Blob([O],{type:"application/json"}),G=this.recordingHandle;if(!G&&this.project)try{const Y="Recording "+stringify(new Date),z=(await popup(x`<h3>Add recording to project?</h3>`,x`
                    <label for="name">Name</label>
                    <input id="name" type="text" value=${Y} >
                  `)).get("name"),K=await this.project.createRecording(z,U);if(K){this.recordingHandle=K,this.recordingIsSaved=!0;return}}catch{}const X=await fileSave(U,{id:"recording",fileName:"Recording.json",accept:{"application/json":[".json"]}},G);this.recordingIsSaved=!0,X&&(this.recordingHandle=X)}} 
        >
          
        </button>

        <input-options
          .options=${((D=this.project)==null?void 0:D.recordings.map(O=>({value:O,label:O.name.replace(/\.json$/,"")})))||[]}
          @change=${O=>{O.detail.value&&this.loadRecording(O.detail.value)}}
        ></input-options>

        ${this.recording?x`
              <div class="container">
                <div
                  id="scrollable" 
                  @mousewheel=${O=>{this.recording&&(O.preventDefault(),this.position=clamp(this.position+O.deltaX+O.deltaY,0,this.recording.data.length))}} 
                >
                  <graph-2d
                    id="spectrogram"
                    .data=${((F=this.recording)==null?void 0:F.data)||[]}
                    @select=${O=>{if(!this.recording)return;const{column:U,row:G}=O.detail;console.log(`Frame: ${U}, Row: ${G}, Value: ${this.recording.data[U][G]}`),this.position=U}}
                  ></graph-2d>

                  <graph-1d id="similarity"></graph-1d>
                </div>

                <div id="recordingTools">

                  <button
                    @click=${()=>{this.markings.add(this.position)}}
                  >Add Mark</button> 

                  <button 
                    @click=${async()=>{try{if(!this.recording)return;const O=await popup(x`<h3>Remove Silence</h3>`,x`
                            <label for="treshold">Silence Treshold (0-255)</label>
                            <input id="treshold" type="number" value="128" min="0" max="255">
                          `);if(!O)return;const U=parseInt(O.get("treshold"));if(isNaN(U))return;this.recording.removeSilence(U),this.spectrogram.requestUpdate(),this.markings.requestUpdate(),this.recordingIsSaved=!1}catch{return}}}
                  >Remove Silence</button>

                </div>

                <input-slider
                  id="position"
                  .max=${this.recording.data.length}
                  .value=${this.position}
                  @change=${O=>{this.recording&&(this.position=O.detail)}}
                ></input-slider>

                
                <markings-editor 
                  .recording=${this.recording}
                  @select=${O=>{const{position:U}=O.detail;this.position=U}} 
                  @change=${()=>{this.recording&&(this.recordingIsSaved=!1)}} 
                ></markings-editor>

              </div>
            `:x`
              <p>Make a recording to use the automatic page turner feature.</p>
            `}

      </app-container>
    `}renderRecognizer(){var B;return x`
      <app-container collapsable .title=${"Recognizer"} ?hidden=${!this.recording}>

        <input-recorder
          id="recognizer"
          title="Recognize"
          slot="header"
          .previousSource=${(B=this.recording)==null?void 0:B.source}
          @data=${D=>{var W,z;if(!this.follower||!this.recording)return;const{position:F,measure:O,page:U,pagePct:G,differences:X,over:tt}=this.follower.guess(D.detail,this.recognitionOptions);if(tt)return;this.position=F||0;const Y=new Uint8Array(this.recording.data.length);X==null||X.forEach((K,J)=>Y[J+this.position]=K),this.similarity.data=Y,U&&(this.viewer.currentPage=U-1,(W=window.ipcRenderer)==null||W.send("current-page",U-1)),O&&(this.viewer.currentMeasure=O,(z=window.ipcRenderer)==null||z.send("current-measure",O)),this.viewer.progress=G}}
          @start=${()=>{this.recording&&(this.recorder.stop(),this.follower=this.recording.createFollower(),this.position>=this.recording.data.length-100&&(this.position=0))}}
          @stop=${()=>{this.similarity.data=new Uint8Array(this.recording.data.length),this.follower=void 0,this.viewer.progress=0}}
        >
           Recognize
        </input-recorder>

        <recognition-options></recognition-options>

      </app-container>
    `}renderServer(){return x`
      <app-container .title=${"Server"} .description=${this.serverStatus} ?hidden=${!window.ipcRenderer}>

        <button 
          slot="header" 
          ?hidden=${this.serverCreated}
          @click=${async()=>{var D;const B=await((D=window.ipcRenderer)==null?void 0:D.invoke("server-start"));B&&(this.serverCreated=!0,this.serverStatus="Running on "+B.ip+":"+B.port)}}
        >
          Start
        </button>

        <button 
          slot="header" 
          ?hidden=${!this.serverCreated}
          @click=${async()=>{var B;await((B=window.ipcRenderer)==null?void 0:B.invoke("server-destroy")),this.serverCreated=!1,this.serverStatus=""}}
        >
          Stop
        </button>

      </app-container>
    `}render(){return[this.renderHeader(),this.renderViewer(),this.renderRecording(),this.renderRecognizer(),this.renderServer()]}updated(B){if(B.has("position")){if(this.follower&&(this.follower.position=this.position),!this.scrollable)return;const D=this.scrollable.scrollWidth-this.scrollable.clientWidth,F=this.position/this.recording.data.length;this.scrollable.scrollTo({left:F*D,behavior:"auto"})}}connectedCallback(){var B,D;super.connectedCallback(),(B=window.ipcRenderer)==null||B.on("current-page",(F,O)=>{this.viewer.currentPage=O}),(D=window.ipcRenderer)==null||D.on("current-measure",(F,O)=>{this.viewer.currentMeasure=O})}};App.stylesHeader=i$3`
    header {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.5em;
      margin: 10px;
    }
  `;App.stylesViewer=i$3`
    #viewer {
      height: 0;
      min-height: 40vh;
      min-height: 40dvh;
      flex: 1;
    }

    #viewer input-options {
      padding: 0 1em;
    }

    #viewer pdf-viewer {
      flex: 1;
    }
  `;App.stylesRecording=i$3`
    #position {
      width: 100%;
    }
    #scrollable {
      overflow-y: hidden;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      border: 1px solid grey;
      background: var(--color-black);
    }
    #scrollable::-webkit-scrollbar {
      display: none;
    }
    #recordingTools {
      display: flex;
      gap: 0.5em;
      justify-content: center;
    }
    .container {
      width: min-content;
      max-width: 100%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: .5em;
    }
  `;App.styles=[inputStyle,buttonStyle,App.stylesHeader,App.stylesViewer,App.stylesRecording,i$3`
      :host {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100%;
      }
    `];__decorateClass$1([n({type:Object})],App.prototype,"project",2);__decorateClass$1([e$1("pdf-viewer")],App.prototype,"viewer",2);__decorateClass$1([n({type:Boolean})],App.prototype,"pdfIsSaved",2);__decorateClass$1([e$1("#recording")],App.prototype,"recordingElement",2);__decorateClass$1([e$1("#recorder")],App.prototype,"recorder",2);__decorateClass$1([e$1("#scrollable")],App.prototype,"scrollable",2);__decorateClass$1([e$1("#spectrogram")],App.prototype,"spectrogram",2);__decorateClass$1([e$1("#similarity")],App.prototype,"similarity",2);__decorateClass$1([e$1("#position")],App.prototype,"positionSlider",2);__decorateClass$1([e$1("markings-editor")],App.prototype,"markings",2);__decorateClass$1([n({type:Object})],App.prototype,"recordingHandle",2);__decorateClass$1([n({type:Object})],App.prototype,"recording",2);__decorateClass$1([n({type:Boolean})],App.prototype,"recordingIsSaved",2);__decorateClass$1([n({type:Number})],App.prototype,"position",2);__decorateClass$1([e$1("#recognizer")],App.prototype,"recognizer",2);__decorateClass$1([e$1("recognition-options")],App.prototype,"recognitionOptions",2);__decorateClass$1([n({type:Boolean})],App.prototype,"serverCreated",2);__decorateClass$1([n({type:String})],App.prototype,"serverStatus",2);App=__decorateClass$1([t("app-main")],App);const PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(B=>{PACKET_TYPES_REVERSE[PACKET_TYPES[B]]=B});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=B=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(B):B&&B.buffer instanceof ArrayBuffer,encodePacket=({type:B,data:D},F,O)=>withNativeBlob$1&&D instanceof Blob?F?O(D):encodeBlobAsBase64(D,O):withNativeArrayBuffer$2&&(D instanceof ArrayBuffer||isView$1(D))?F?O(D):encodeBlobAsBase64(new Blob([D]),O):O(PACKET_TYPES[B]+(D||"")),encodeBlobAsBase64=(B,D)=>{const F=new FileReader;return F.onload=function(){const O=F.result.split(",")[1];D("b"+(O||""))},F.readAsDataURL(B)};function toArray(B){return B instanceof Uint8Array?B:B instanceof ArrayBuffer?new Uint8Array(B):new Uint8Array(B.buffer,B.byteOffset,B.byteLength)}let TEXT_ENCODER;function encodePacketToBinary(B,D){if(withNativeBlob$1&&B.data instanceof Blob)return B.data.arrayBuffer().then(toArray).then(D);if(withNativeArrayBuffer$2&&(B.data instanceof ArrayBuffer||isView$1(B.data)))return D(toArray(B.data));encodePacket(B,!1,F=>{TEXT_ENCODER||(TEXT_ENCODER=new TextEncoder),D(TEXT_ENCODER.encode(F))})}const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let B=0;B<chars.length;B++)lookup$1[chars.charCodeAt(B)]=B;const decode$1=B=>{let D=B.length*.75,F=B.length,O,U=0,G,X,tt,Y;B[B.length-1]==="="&&(D--,B[B.length-2]==="="&&D--);const W=new ArrayBuffer(D),z=new Uint8Array(W);for(O=0;O<F;O+=4)G=lookup$1[B.charCodeAt(O)],X=lookup$1[B.charCodeAt(O+1)],tt=lookup$1[B.charCodeAt(O+2)],Y=lookup$1[B.charCodeAt(O+3)],z[U++]=G<<2|X>>4,z[U++]=(X&15)<<4|tt>>2,z[U++]=(tt&3)<<6|Y&63;return W},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(B,D)=>{if(typeof B!="string")return{type:"message",data:mapBinary(B,D)};const F=B.charAt(0);return F==="b"?{type:"message",data:decodeBase64Packet(B.substring(1),D)}:PACKET_TYPES_REVERSE[F]?B.length>1?{type:PACKET_TYPES_REVERSE[F],data:B.substring(1)}:{type:PACKET_TYPES_REVERSE[F]}:ERROR_PACKET},decodeBase64Packet=(B,D)=>{if(withNativeArrayBuffer$1){const F=decode$1(B);return mapBinary(F,D)}else return{base64:!0,data:B}},mapBinary=(B,D)=>{switch(D){case"blob":return B instanceof Blob?B:new Blob([B]);case"arraybuffer":default:return B instanceof ArrayBuffer?B:B.buffer}},SEPARATOR=String.fromCharCode(30),encodePayload=(B,D)=>{const F=B.length,O=new Array(F);let U=0;B.forEach((G,X)=>{encodePacket(G,!1,tt=>{O[X]=tt,++U===F&&D(O.join(SEPARATOR))})})},decodePayload=(B,D)=>{const F=B.split(SEPARATOR),O=[];for(let U=0;U<F.length;U++){const G=decodePacket(F[U],D);if(O.push(G),G.type==="error")break}return O};function createPacketEncoderStream(){return new TransformStream({transform(B,D){encodePacketToBinary(B,F=>{const O=F.length;let U;if(O<126)U=new Uint8Array(1),new DataView(U.buffer).setUint8(0,O);else if(O<65536){U=new Uint8Array(3);const G=new DataView(U.buffer);G.setUint8(0,126),G.setUint16(1,O)}else{U=new Uint8Array(9);const G=new DataView(U.buffer);G.setUint8(0,127),G.setBigUint64(1,BigInt(O))}B.data&&typeof B.data!="string"&&(U[0]|=128),D.enqueue(U),D.enqueue(F)})}})}let TEXT_DECODER;function totalLength(B){return B.reduce((D,F)=>D+F.length,0)}function concatChunks(B,D){if(B[0].length===D)return B.shift();const F=new Uint8Array(D);let O=0;for(let U=0;U<D;U++)F[U]=B[0][O++],O===B[0].length&&(B.shift(),O=0);return B.length&&O<B[0].length&&(B[0]=B[0].slice(O)),F}function createPacketDecoderStream(B,D){TEXT_DECODER||(TEXT_DECODER=new TextDecoder);const F=[];let O=0,U=-1,G=!1;return new TransformStream({transform(X,tt){for(F.push(X);;){if(O===0){if(totalLength(F)<1)break;const Y=concatChunks(F,1);G=(Y[0]&128)===128,U=Y[0]&127,U<126?O=3:U===126?O=1:O=2}else if(O===1){if(totalLength(F)<2)break;const Y=concatChunks(F,2);U=new DataView(Y.buffer,Y.byteOffset,Y.length).getUint16(0),O=3}else if(O===2){if(totalLength(F)<8)break;const Y=concatChunks(F,8),W=new DataView(Y.buffer,Y.byteOffset,Y.length),z=W.getUint32(0);if(z>Math.pow(2,53-32)-1){tt.enqueue(ERROR_PACKET);break}U=z*Math.pow(2,32)+W.getUint32(4),O=3}else{if(totalLength(F)<U)break;const Y=concatChunks(F,U);tt.enqueue(decodePacket(G?Y:TEXT_DECODER.decode(Y),D)),O=0}if(U===0||U>B){tt.enqueue(ERROR_PACKET);break}}}})}const protocol$1=4;function Emitter(B){if(B)return mixin(B)}function mixin(B){for(var D in Emitter.prototype)B[D]=Emitter.prototype[D];return B}Emitter.prototype.on=Emitter.prototype.addEventListener=function(B,D){return this._callbacks=this._callbacks||{},(this._callbacks["$"+B]=this._callbacks["$"+B]||[]).push(D),this};Emitter.prototype.once=function(B,D){function F(){this.off(B,F),D.apply(this,arguments)}return F.fn=D,this.on(B,F),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(B,D){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var F=this._callbacks["$"+B];if(!F)return this;if(arguments.length==1)return delete this._callbacks["$"+B],this;for(var O,U=0;U<F.length;U++)if(O=F[U],O===D||O.fn===D){F.splice(U,1);break}return F.length===0&&delete this._callbacks["$"+B],this};Emitter.prototype.emit=function(B){this._callbacks=this._callbacks||{};for(var D=new Array(arguments.length-1),F=this._callbacks["$"+B],O=1;O<arguments.length;O++)D[O-1]=arguments[O];if(F){F=F.slice(0);for(var O=0,U=F.length;O<U;++O)F[O].apply(this,D)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(B){return this._callbacks=this._callbacks||{},this._callbacks["$"+B]||[]};Emitter.prototype.hasListeners=function(B){return!!this.listeners(B).length};const globalThisShim=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function pick(B,...D){return D.reduce((F,O)=>(B.hasOwnProperty(O)&&(F[O]=B[O]),F),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(B,D){D.useNativeTimers?(B.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),B.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(B.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),B.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(B){return typeof B=="string"?utf8Length(B):Math.ceil((B.byteLength||B.size)*BASE64_OVERHEAD)}function utf8Length(B){let D=0,F=0;for(let O=0,U=B.length;O<U;O++)D=B.charCodeAt(O),D<128?F+=1:D<2048?F+=2:D<55296||D>=57344?F+=3:(O++,F+=4);return F}function encode$1(B){let D="";for(let F in B)B.hasOwnProperty(F)&&(D.length&&(D+="&"),D+=encodeURIComponent(F)+"="+encodeURIComponent(B[F]));return D}function decode(B){let D={},F=B.split("&");for(let O=0,U=F.length;O<U;O++){let G=F[O].split("=");D[decodeURIComponent(G[0])]=decodeURIComponent(G[1])}return D}class TransportError extends Error{constructor(D,F,O){super(D),this.description=F,this.context=O,this.type="TransportError"}}class Transport extends Emitter{constructor(D){super(),this.writable=!1,installTimerFunctions(this,D),this.opts=D,this.query=D.query,this.socket=D.socket}onError(D,F,O){return super.emitReserved("error",new TransportError(D,F,O)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(D){this.readyState==="open"&&this.write(D)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(D){const F=decodePacket(D,this.socket.binaryType);this.onPacket(F)}onPacket(D){super.emitReserved("packet",D)}onClose(D){this.readyState="closed",super.emitReserved("close",D)}pause(D){}createUri(D,F={}){return D+"://"+this._hostname()+this._port()+this.opts.path+this._query(F)}_hostname(){const D=this.opts.hostname;return D.indexOf(":")===-1?D:"["+D+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(D){const F=encode$1(D);return F.length?"?"+F:""}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={};let seed=0,i=0,prev;function encode(B){let D="";do D=alphabet[B%length]+D,B=Math.floor(B/length);while(B>0);return D}function yeast(){const B=encode(+new Date);return B!==prev?(seed=0,prev=B):B+"."+encode(seed++)}for(;i<length;i++)map[alphabet[i]]=i;let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch(B){}const hasCORS=value;function XHR(B){const D=B.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!D||hasCORS))return new XMLHttpRequest}catch{}if(!D)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function createCookieJar(){}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(D){if(super(D),this.polling=!1,typeof location<"u"){const O=location.protocol==="https:";let U=location.port;U||(U=O?"443":"80"),this.xd=typeof location<"u"&&D.hostname!==location.hostname||U!==D.port}const F=D&&D.forceBase64;this.supportsBinary=hasXHR2&&!F,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(D){this.readyState="pausing";const F=()=>{this.readyState="paused",D()};if(this.polling||!this.writable){let O=0;this.polling&&(O++,this.once("pollComplete",function(){--O||F()})),this.writable||(O++,this.once("drain",function(){--O||F()}))}else F()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(D){const F=O=>{if(this.readyState==="opening"&&O.type==="open"&&this.onOpen(),O.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(O)};decodePayload(D,this.socket.binaryType).forEach(F),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const D=()=>{this.write([{type:"close"}])};this.readyState==="open"?D():this.once("open",D)}write(D){this.writable=!1,encodePayload(D,F=>{this.doWrite(F,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const D=this.opts.secure?"https":"http",F=this.query||{};return this.opts.timestampRequests!==!1&&(F[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!F.sid&&(F.b64=1),this.createUri(D,F)}request(D={}){return Object.assign(D,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Request(this.uri(),D)}doWrite(D,F){const O=this.request({method:"POST",data:D});O.on("success",F),O.on("error",(U,G)=>{this.onError("xhr post error",U,G)})}doPoll(){const D=this.request();D.on("data",this.onData.bind(this)),D.on("error",(F,O)=>{this.onError("xhr poll error",F,O)}),this.pollXhr=D}}class Request extends Emitter{constructor(D,F){super(),installTimerFunctions(this,F),this.opts=F,this.method=F.method||"GET",this.uri=D,this.data=F.data!==void 0?F.data:null,this.create()}create(){var D;const F=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");F.xdomain=!!this.opts.xd;const O=this.xhr=new XHR(F);try{O.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){O.setDisableHeaderCheck&&O.setDisableHeaderCheck(!0);for(let U in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(U)&&O.setRequestHeader(U,this.opts.extraHeaders[U])}}catch{}if(this.method==="POST")try{O.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{O.setRequestHeader("Accept","*/*")}catch{}(D=this.opts.cookieJar)===null||D===void 0||D.addCookies(O),"withCredentials"in O&&(O.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(O.timeout=this.opts.requestTimeout),O.onreadystatechange=()=>{var U;O.readyState===3&&((U=this.opts.cookieJar)===null||U===void 0||U.parseCookies(O)),O.readyState===4&&(O.status===200||O.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof O.status=="number"?O.status:0)},0))},O.send(this.data)}catch(U){this.setTimeoutFn(()=>{this.onError(U)},0);return}typeof document<"u"&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(D){this.emitReserved("error",D,this.xhr),this.cleanup(!0)}cleanup(D){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,D)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Request.requests[this.index],this.xhr=null}}onLoad(){const D=this.xhr.responseText;D!==null&&(this.emitReserved("data",D),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Request.requestsCount=0;Request.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const B="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(B,unloadHandler,!1)}}function unloadHandler(){for(let B in Request.requests)Request.requests.hasOwnProperty(B)&&Request.requests[B].abort()}const nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?D=>Promise.resolve().then(D):(D,F)=>F(D,0))(),WebSocket=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class WS extends Transport{constructor(D){super(D),this.supportsBinary=!D.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const D=this.uri(),F=this.opts.protocols,O=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(O.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?F?new WebSocket(D,F):new WebSocket(D):new WebSocket(D,F,O)}catch(U){return this.emitReserved("error",U)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=D=>this.onClose({description:"websocket connection closed",context:D}),this.ws.onmessage=D=>this.onData(D.data),this.ws.onerror=D=>this.onError("websocket error",D)}write(D){this.writable=!1;for(let F=0;F<D.length;F++){const O=D[F],U=F===D.length-1;encodePacket(O,this.supportsBinary,G=>{const X={};try{usingBrowserWebSocket&&this.ws.send(G)}catch{}U&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const D=this.opts.secure?"wss":"ws",F=this.query||{};return this.opts.timestampRequests&&(F[this.opts.timestampParam]=yeast()),this.supportsBinary||(F.b64=1),this.createUri(D,F)}check(){return!!WebSocket}}class WT extends Transport{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(D=>{this.onError("webtransport error",D)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(D=>{const F=createPacketDecoderStream(Number.MAX_SAFE_INTEGER,this.socket.binaryType),O=D.readable.pipeThrough(F).getReader(),U=createPacketEncoderStream();U.readable.pipeTo(D.writable),this.writer=U.writable.getWriter();const G=()=>{O.read().then(({done:tt,value:Y})=>{tt||(this.onPacket(Y),G())}).catch(tt=>{})};G();const X={type:"open"};this.query.sid&&(X.data=`{"sid":"${this.query.sid}"}`),this.writer.write(X).then(()=>this.onOpen())})}))}write(D){this.writable=!1;for(let F=0;F<D.length;F++){const O=D[F],U=F===D.length-1;this.writer.write(O).then(()=>{U&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var D;(D=this.transport)===null||D===void 0||D.close()}}const transports={websocket:WS,webtransport:WT,polling:Polling},re=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(B){if(B.length>2e3)throw"URI too long";const D=B,F=B.indexOf("["),O=B.indexOf("]");F!=-1&&O!=-1&&(B=B.substring(0,F)+B.substring(F,O).replace(/:/g,";")+B.substring(O,B.length));let U=re.exec(B||""),G={},X=14;for(;X--;)G[parts[X]]=U[X]||"";return F!=-1&&O!=-1&&(G.source=D,G.host=G.host.substring(1,G.host.length-1).replace(/;/g,":"),G.authority=G.authority.replace("[","").replace("]","").replace(/;/g,":"),G.ipv6uri=!0),G.pathNames=pathNames(G,G.path),G.queryKey=queryKey(G,G.query),G}function pathNames(B,D){const F=/\/{2,9}/g,O=D.replace(F,"/").split("/");return(D.slice(0,1)=="/"||D.length===0)&&O.splice(0,1),D.slice(-1)=="/"&&O.splice(O.length-1,1),O}function queryKey(B,D){const F={};return D.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(O,U,G){U&&(F[U]=G)}),F}let Socket$1=class ir extends Emitter{constructor(D,F={}){super(),this.binaryType=defaultBinaryType,this.writeBuffer=[],D&&typeof D=="object"&&(F=D,D=null),D?(D=parse(D),F.hostname=D.host,F.secure=D.protocol==="https"||D.protocol==="wss",F.port=D.port,D.query&&(F.query=D.query)):F.host&&(F.hostname=parse(F.host).host),installTimerFunctions(this,F),this.secure=F.secure!=null?F.secure:typeof location<"u"&&location.protocol==="https:",F.hostname&&!F.port&&(F.port=this.secure?"443":"80"),this.hostname=F.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=F.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=F.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},F),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(D){const F=Object.assign({},this.opts.query);F.EIO=protocol$1,F.transport=D,this.id&&(F.sid=this.id);const O=Object.assign({},this.opts,{query:F,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[D]);return new transports[D](O)}open(){let D;if(this.opts.rememberUpgrade&&ir.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)D="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else D=this.transports[0];this.readyState="opening";try{D=this.createTransport(D)}catch{this.transports.shift(),this.open();return}D.open(),this.setTransport(D)}setTransport(D){this.transport&&this.transport.removeAllListeners(),this.transport=D,D.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",F=>this.onClose("transport close",F))}probe(D){let F=this.createTransport(D),O=!1;ir.priorWebsocketSuccess=!1;const U=()=>{O||(F.send([{type:"ping",data:"probe"}]),F.once("packet",K=>{if(!O)if(K.type==="pong"&&K.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",F),!F)return;ir.priorWebsocketSuccess=F.name==="websocket",this.transport.pause(()=>{O||this.readyState!=="closed"&&(z(),this.setTransport(F),F.send([{type:"upgrade"}]),this.emitReserved("upgrade",F),F=null,this.upgrading=!1,this.flush())})}else{const J=new Error("probe error");J.transport=F.name,this.emitReserved("upgradeError",J)}}))};function G(){O||(O=!0,z(),F.close(),F=null)}const X=K=>{const J=new Error("probe error: "+K);J.transport=F.name,G(),this.emitReserved("upgradeError",J)};function tt(){X("transport closed")}function Y(){X("socket closed")}function W(K){F&&K.name!==F.name&&G()}const z=()=>{F.removeListener("open",U),F.removeListener("error",X),F.removeListener("close",tt),this.off("close",Y),this.off("upgrading",W)};F.once("open",U),F.once("error",X),F.once("close",tt),this.once("close",Y),this.once("upgrading",W),this.upgrades.indexOf("webtransport")!==-1&&D!=="webtransport"?this.setTimeoutFn(()=>{O||F.open()},200):F.open()}onOpen(){if(this.readyState="open",ir.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let D=0;const F=this.upgrades.length;for(;D<F;D++)this.probe(this.upgrades[D])}}onPacket(D){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",D),this.emitReserved("heartbeat"),this.resetPingTimeout(),D.type){case"open":this.onHandshake(JSON.parse(D.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const F=new Error("server error");F.code=D.data,this.onError(F);break;case"message":this.emitReserved("data",D.data),this.emitReserved("message",D.data);break}}onHandshake(D){this.emitReserved("handshake",D),this.id=D.sid,this.transport.query.sid=D.sid,this.upgrades=this.filterUpgrades(D.upgrades),this.pingInterval=D.pingInterval,this.pingTimeout=D.pingTimeout,this.maxPayload=D.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const D=this.getWritablePackets();this.transport.send(D),this.prevBufferLen=D.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let F=1;for(let O=0;O<this.writeBuffer.length;O++){const U=this.writeBuffer[O].data;if(U&&(F+=byteLength(U)),O>0&&F>this.maxPayload)return this.writeBuffer.slice(0,O);F+=2}return this.writeBuffer}write(D,F,O){return this.sendPacket("message",D,F,O),this}send(D,F,O){return this.sendPacket("message",D,F,O),this}sendPacket(D,F,O,U){if(typeof F=="function"&&(U=F,F=void 0),typeof O=="function"&&(U=O,O=null),this.readyState==="closing"||this.readyState==="closed")return;O=O||{},O.compress=O.compress!==!1;const G={type:D,data:F,options:O};this.emitReserved("packetCreate",G),this.writeBuffer.push(G),U&&this.once("flush",U),this.flush()}close(){const D=()=>{this.onClose("forced close"),this.transport.close()},F=()=>{this.off("upgrade",F),this.off("upgradeError",F),D()},O=()=>{this.once("upgrade",F),this.once("upgradeError",F)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?O():D()}):this.upgrading?O():D()),this}onError(D){ir.priorWebsocketSuccess=!1,this.emitReserved("error",D),this.onClose("transport error",D)}onClose(D,F){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",D,F),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(D){const F=[];let O=0;const U=D.length;for(;O<U;O++)~this.transports.indexOf(D[O])&&F.push(D[O]);return F}};Socket$1.protocol=protocol$1;function url(B,D="",F){let O=B;F=F||typeof location<"u"&&location,B==null&&(B=F.protocol+"//"+F.host),typeof B=="string"&&(B.charAt(0)==="/"&&(B.charAt(1)==="/"?B=F.protocol+B:B=F.host+B),/^(https?|wss?):\/\//.test(B)||(typeof F<"u"?B=F.protocol+"//"+B:B="https://"+B),O=parse(B)),O.port||(/^(http|ws)$/.test(O.protocol)?O.port="80":/^(http|ws)s$/.test(O.protocol)&&(O.port="443")),O.path=O.path||"/";const G=O.host.indexOf(":")!==-1?"["+O.host+"]":O.host;return O.id=O.protocol+"://"+G+":"+O.port+D,O.href=O.protocol+"://"+G+(F&&F.port===O.port?"":":"+O.port),O}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=B=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(B):B.buffer instanceof ArrayBuffer,toString=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString.call(File)==="[object FileConstructor]";function isBinary(B){return withNativeArrayBuffer&&(B instanceof ArrayBuffer||isView(B))||withNativeBlob&&B instanceof Blob||withNativeFile&&B instanceof File}function hasBinary(B,D){if(!B||typeof B!="object")return!1;if(Array.isArray(B)){for(let F=0,O=B.length;F<O;F++)if(hasBinary(B[F]))return!0;return!1}if(isBinary(B))return!0;if(B.toJSON&&typeof B.toJSON=="function"&&arguments.length===1)return hasBinary(B.toJSON(),!0);for(const F in B)if(Object.prototype.hasOwnProperty.call(B,F)&&hasBinary(B[F]))return!0;return!1}function deconstructPacket(B){const D=[],F=B.data,O=B;return O.data=_deconstructPacket(F,D),O.attachments=D.length,{packet:O,buffers:D}}function _deconstructPacket(B,D){if(!B)return B;if(isBinary(B)){const F={_placeholder:!0,num:D.length};return D.push(B),F}else if(Array.isArray(B)){const F=new Array(B.length);for(let O=0;O<B.length;O++)F[O]=_deconstructPacket(B[O],D);return F}else if(typeof B=="object"&&!(B instanceof Date)){const F={};for(const O in B)Object.prototype.hasOwnProperty.call(B,O)&&(F[O]=_deconstructPacket(B[O],D));return F}return B}function reconstructPacket(B,D){return B.data=_reconstructPacket(B.data,D),delete B.attachments,B}function _reconstructPacket(B,D){if(!B)return B;if(B&&B._placeholder===!0){if(typeof B.num=="number"&&B.num>=0&&B.num<D.length)return D[B.num];throw new Error("illegal attachments")}else if(Array.isArray(B))for(let F=0;F<B.length;F++)B[F]=_reconstructPacket(B[F],D);else if(typeof B=="object")for(const F in B)Object.prototype.hasOwnProperty.call(B,F)&&(B[F]=_reconstructPacket(B[F],D));return B}const RESERVED_EVENTS$1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],protocol=5;var PacketType;(function(B){B[B.CONNECT=0]="CONNECT",B[B.DISCONNECT=1]="DISCONNECT",B[B.EVENT=2]="EVENT",B[B.ACK=3]="ACK",B[B.CONNECT_ERROR=4]="CONNECT_ERROR",B[B.BINARY_EVENT=5]="BINARY_EVENT",B[B.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder{constructor(D){this.replacer=D}encode(D){return(D.type===PacketType.EVENT||D.type===PacketType.ACK)&&hasBinary(D)?this.encodeAsBinary({type:D.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:D.nsp,data:D.data,id:D.id}):[this.encodeAsString(D)]}encodeAsString(D){let F=""+D.type;return(D.type===PacketType.BINARY_EVENT||D.type===PacketType.BINARY_ACK)&&(F+=D.attachments+"-"),D.nsp&&D.nsp!=="/"&&(F+=D.nsp+","),D.id!=null&&(F+=D.id),D.data!=null&&(F+=JSON.stringify(D.data,this.replacer)),F}encodeAsBinary(D){const F=deconstructPacket(D),O=this.encodeAsString(F.packet),U=F.buffers;return U.unshift(O),U}}function isObject(B){return Object.prototype.toString.call(B)==="[object Object]"}class Decoder extends Emitter{constructor(D){super(),this.reviver=D}add(D){let F;if(typeof D=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");F=this.decodeString(D);const O=F.type===PacketType.BINARY_EVENT;O||F.type===PacketType.BINARY_ACK?(F.type=O?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor(F),F.attachments===0&&super.emitReserved("decoded",F)):super.emitReserved("decoded",F)}else if(isBinary(D)||D.base64)if(this.reconstructor)F=this.reconstructor.takeBinaryData(D),F&&(this.reconstructor=null,super.emitReserved("decoded",F));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+D)}decodeString(D){let F=0;const O={type:Number(D.charAt(0))};if(PacketType[O.type]===void 0)throw new Error("unknown packet type "+O.type);if(O.type===PacketType.BINARY_EVENT||O.type===PacketType.BINARY_ACK){const G=F+1;for(;D.charAt(++F)!=="-"&&F!=D.length;);const X=D.substring(G,F);if(X!=Number(X)||D.charAt(F)!=="-")throw new Error("Illegal attachments");O.attachments=Number(X)}if(D.charAt(F+1)==="/"){const G=F+1;for(;++F&&!(D.charAt(F)===","||F===D.length););O.nsp=D.substring(G,F)}else O.nsp="/";const U=D.charAt(F+1);if(U!==""&&Number(U)==U){const G=F+1;for(;++F;){const X=D.charAt(F);if(X==null||Number(X)!=X){--F;break}if(F===D.length)break}O.id=Number(D.substring(G,F+1))}if(D.charAt(++F)){const G=this.tryParse(D.substr(F));if(Decoder.isPayloadValid(O.type,G))O.data=G;else throw new Error("invalid payload")}return O}tryParse(D){try{return JSON.parse(D,this.reviver)}catch{return!1}}static isPayloadValid(D,F){switch(D){case PacketType.CONNECT:return isObject(F);case PacketType.DISCONNECT:return F===void 0;case PacketType.CONNECT_ERROR:return typeof F=="string"||isObject(F);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray(F)&&(typeof F[0]=="number"||typeof F[0]=="string"&&RESERVED_EVENTS$1.indexOf(F[0])===-1);case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray(F)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(D){this.packet=D,this.buffers=[],this.reconPack=D}takeBinaryData(D){if(this.buffers.push(D),this.buffers.length===this.reconPack.attachments){const F=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),F}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.defineProperty({__proto__:null,Decoder,Encoder,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"});function on(B,D,F){return B.on(D,F),function(){B.off(D,F)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(D,F,O){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=D,this.nsp=F,O&&O.auth&&(this.auth=O.auth),this._opts=Object.assign({},O),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const D=this.io;this.subs=[on(D,"open",this.onopen.bind(this)),on(D,"packet",this.onpacket.bind(this)),on(D,"error",this.onerror.bind(this)),on(D,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...D){return D.unshift("message"),this.emit.apply(this,D),this}emit(D,...F){if(RESERVED_EVENTS.hasOwnProperty(D))throw new Error('"'+D.toString()+'" is a reserved event name');if(F.unshift(D),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(F),this;const O={type:PacketType.EVENT,data:F};if(O.options={},O.options.compress=this.flags.compress!==!1,typeof F[F.length-1]=="function"){const X=this.ids++,tt=F.pop();this._registerAckCallback(X,tt),O.id=X}const U=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!U||!this.connected)||(this.connected?(this.notifyOutgoingListeners(O),this.packet(O)):this.sendBuffer.push(O)),this.flags={},this}_registerAckCallback(D,F){var O;const U=(O=this.flags.timeout)!==null&&O!==void 0?O:this._opts.ackTimeout;if(U===void 0){this.acks[D]=F;return}const G=this.io.setTimeoutFn(()=>{delete this.acks[D];for(let tt=0;tt<this.sendBuffer.length;tt++)this.sendBuffer[tt].id===D&&this.sendBuffer.splice(tt,1);F.call(this,new Error("operation has timed out"))},U),X=(...tt)=>{this.io.clearTimeoutFn(G),F.apply(this,tt)};X.withError=!0,this.acks[D]=X}emitWithAck(D,...F){return new Promise((O,U)=>{const G=(X,tt)=>X?U(X):O(tt);G.withError=!0,F.push(G),this.emit(D,...F)})}_addToQueue(D){let F;typeof D[D.length-1]=="function"&&(F=D.pop());const O={id:this._queueSeq++,tryCount:0,pending:!1,args:D,flags:Object.assign({fromQueue:!0},this.flags)};D.push((U,...G)=>O!==this._queue[0]?void 0:(U!==null?O.tryCount>this._opts.retries&&(this._queue.shift(),F&&F(U)):(this._queue.shift(),F&&F(null,...G)),O.pending=!1,this._drainQueue())),this._queue.push(O),this._drainQueue()}_drainQueue(D=!1){if(!this.connected||this._queue.length===0)return;const F=this._queue[0];F.pending&&!D||(F.pending=!0,F.tryCount++,this.flags=F.flags,this.emit.apply(this,F.args))}packet(D){D.nsp=this.nsp,this.io._packet(D)}onopen(){typeof this.auth=="function"?this.auth(D=>{this._sendConnectPacket(D)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(D){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},D):D})}onerror(D){this.connected||this.emitReserved("connect_error",D)}onclose(D,F){this.connected=!1,delete this.id,this.emitReserved("disconnect",D,F),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(D=>{if(!this.sendBuffer.some(O=>String(O.id)===D)){const O=this.acks[D];delete this.acks[D],O.withError&&O.call(this,new Error("socket has been disconnected"))}})}onpacket(D){if(D.nsp===this.nsp)switch(D.type){case PacketType.CONNECT:D.data&&D.data.sid?this.onconnect(D.data.sid,D.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(D);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(D);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const O=new Error(D.data.message);O.data=D.data.data,this.emitReserved("connect_error",O);break}}onevent(D){const F=D.data||[];D.id!=null&&F.push(this.ack(D.id)),this.connected?this.emitEvent(F):this.receiveBuffer.push(Object.freeze(F))}emitEvent(D){if(this._anyListeners&&this._anyListeners.length){const F=this._anyListeners.slice();for(const O of F)O.apply(this,D)}super.emit.apply(this,D),this._pid&&D.length&&typeof D[D.length-1]=="string"&&(this._lastOffset=D[D.length-1])}ack(D){const F=this;let O=!1;return function(...U){O||(O=!0,F.packet({type:PacketType.ACK,id:D,data:U}))}}onack(D){const F=this.acks[D.id];typeof F=="function"&&(delete this.acks[D.id],F.withError&&D.data.unshift(null),F.apply(this,D.data))}onconnect(D,F){this.id=D,this.recovered=F&&this._pid===F,this._pid=F,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(D=>this.emitEvent(D)),this.receiveBuffer=[],this.sendBuffer.forEach(D=>{this.notifyOutgoingListeners(D),this.packet(D)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(D=>D()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(D){return this.flags.compress=D,this}get volatile(){return this.flags.volatile=!0,this}timeout(D){return this.flags.timeout=D,this}onAny(D){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(D),this}prependAny(D){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(D),this}offAny(D){if(!this._anyListeners)return this;if(D){const F=this._anyListeners;for(let O=0;O<F.length;O++)if(D===F[O])return F.splice(O,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(D){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(D),this}prependAnyOutgoing(D){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(D),this}offAnyOutgoing(D){if(!this._anyOutgoingListeners)return this;if(D){const F=this._anyOutgoingListeners;for(let O=0;O<F.length;O++)if(D===F[O])return F.splice(O,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(D){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const F=this._anyOutgoingListeners.slice();for(const O of F)O.apply(this,D.data)}}}function Backoff(B){B=B||{},this.ms=B.min||100,this.max=B.max||1e4,this.factor=B.factor||2,this.jitter=B.jitter>0&&B.jitter<=1?B.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var B=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var D=Math.random(),F=Math.floor(D*this.jitter*B);B=Math.floor(D*10)&1?B+F:B-F}return Math.min(B,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(B){this.ms=B};Backoff.prototype.setMax=function(B){this.max=B};Backoff.prototype.setJitter=function(B){this.jitter=B};class Manager extends Emitter{constructor(D,F){var O;super(),this.nsps={},this.subs=[],D&&typeof D=="object"&&(F=D,D=void 0),F=F||{},F.path=F.path||"/socket.io",this.opts=F,installTimerFunctions(this,F),this.reconnection(F.reconnection!==!1),this.reconnectionAttempts(F.reconnectionAttempts||1/0),this.reconnectionDelay(F.reconnectionDelay||1e3),this.reconnectionDelayMax(F.reconnectionDelayMax||5e3),this.randomizationFactor((O=F.randomizationFactor)!==null&&O!==void 0?O:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(F.timeout==null?2e4:F.timeout),this._readyState="closed",this.uri=D;const U=F.parser||parser;this.encoder=new U.Encoder,this.decoder=new U.Decoder,this._autoConnect=F.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(D){return arguments.length?(this._reconnection=!!D,this):this._reconnection}reconnectionAttempts(D){return D===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=D,this)}reconnectionDelay(D){var F;return D===void 0?this._reconnectionDelay:(this._reconnectionDelay=D,(F=this.backoff)===null||F===void 0||F.setMin(D),this)}randomizationFactor(D){var F;return D===void 0?this._randomizationFactor:(this._randomizationFactor=D,(F=this.backoff)===null||F===void 0||F.setJitter(D),this)}reconnectionDelayMax(D){var F;return D===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=D,(F=this.backoff)===null||F===void 0||F.setMax(D),this)}timeout(D){return arguments.length?(this._timeout=D,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(D){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const F=this.engine,O=this;this._readyState="opening",this.skipReconnect=!1;const U=on(F,"open",function(){O.onopen(),D&&D()}),G=tt=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",tt),D?D(tt):this.maybeReconnectOnOpen()},X=on(F,"error",G);if(this._timeout!==!1){const tt=this._timeout,Y=this.setTimeoutFn(()=>{U(),G(new Error("timeout")),F.close()},tt);this.opts.autoUnref&&Y.unref(),this.subs.push(()=>{this.clearTimeoutFn(Y)})}return this.subs.push(U),this.subs.push(X),this}connect(D){return this.open(D)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const D=this.engine;this.subs.push(on(D,"ping",this.onping.bind(this)),on(D,"data",this.ondata.bind(this)),on(D,"error",this.onerror.bind(this)),on(D,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(D){try{this.decoder.add(D)}catch(F){this.onclose("parse error",F)}}ondecoded(D){nextTick(()=>{this.emitReserved("packet",D)},this.setTimeoutFn)}onerror(D){this.emitReserved("error",D)}socket(D,F){let O=this.nsps[D];return O?this._autoConnect&&!O.active&&O.connect():(O=new Socket(this,D,F),this.nsps[D]=O),O}_destroy(D){const F=Object.keys(this.nsps);for(const O of F)if(this.nsps[O].active)return;this._close()}_packet(D){const F=this.encoder.encode(D);for(let O=0;O<F.length;O++)this.engine.write(F[O],D.options)}cleanup(){this.subs.forEach(D=>D()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(D,F){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",D,F),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const D=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const F=this.backoff.duration();this._reconnecting=!0;const O=this.setTimeoutFn(()=>{D.skipReconnect||(this.emitReserved("reconnect_attempt",D.backoff.attempts),!D.skipReconnect&&D.open(U=>{U?(D._reconnecting=!1,D.reconnect(),this.emitReserved("reconnect_error",U)):D.onreconnect()}))},F);this.opts.autoUnref&&O.unref(),this.subs.push(()=>{this.clearTimeoutFn(O)})}}onreconnect(){const D=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",D)}}const cache={};function lookup(B,D){typeof B=="object"&&(D=B,B=void 0),D=D||{};const F=url(B,D.path||"/socket.io"),O=F.source,U=F.id,G=F.path,X=cache[U]&&G in cache[U].nsps,tt=D.forceNew||D["force new connection"]||D.multiplex===!1||X;let Y;return tt?Y=new Manager(O,D):(cache[U]||(cache[U]=new Manager(O,D)),Y=cache[U]),F.query&&!D.query&&(D.query=F.queryKey),Y.socket(F.path,D)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(B,D,F,O)=>{for(var U=O>1?void 0:O?__getOwnPropDesc(D,F):D,G=B.length-1,X;G>=0;G--)(X=B[G])&&(U=(O?X(D,F,U):X(U))||U);return O&&U&&__defProp(D,F,U),U};let AppSocket=class extends s{constructor(){super(...arguments),this.parts=[]}async findParts(){const B=await fetch("/parts");this.parts=await B.json()}async loadPDF(B){const D=`/parts/${B}`;this.viewer.load(D)}connectedCallback(){super.connectedCallback(),this.findParts(),this.socket=lookup(),this.socket.on("disconnect",()=>{popup(x`<h3>Conection lost</h3>`)}),this.socket.on("page",B=>{this.viewer.currentPage=B}),this.socket.on("measure",B=>{this.viewer.currentMeasure=B}),this.socket.on("project-open",()=>{this.findParts(),this.viewer.innerHTML=""})}render(){return x`
      <app-container id="viewer" .title=${"Sheet Music"}>

        <input-slider
          slot="header"
          id="pdfScale"
          .min=${.25}
          .max=${3}
          .step=${.01}
          .value=${1}
          @change=${B=>{this.viewer.scale=B.detail}}
        ></input-slider>

        <button 
          slot="header" 
          title="Fullscreen"
          @click=${()=>{this.viewer.requestFullscreen(),this.viewer.focus()}}
        >
          
        </button>

        <input-options
          .options=${this.parts.map((B,D)=>({value:B,label:B}))||[]}
          @change=${B=>{B.detail.value&&this.loadPDF(B.detail.value)}}
        ></input-options>

        <pdf-viewer
          @pageSelect=${B=>{const D=B.detail;this.socket.emit("page",D)}}
          @measureSelect=${B=>{const D=B.detail;this.socket.emit("measure",D)}}
        >
          <p>
            Host is getting sheet together...
          </p>
        </pdf-viewer>

      </app-container>
    `}};AppSocket.styles=[inputStyle,buttonStyle,i$3`
      :host {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100%;
      }

      #viewer {
        height: 0;
        min-height: 15em;
        flex: 1;
      }

      #viewer input-options {
        padding: 0 1em;
      }

      #viewer pdf-viewer {
        height: 100%;
      }

      #pdfScale {
        width: 15vmin;
        margin: .5em 0;
      }
    `];__decorateClass([e$1("pdf-viewer")],AppSocket.prototype,"viewer",2);__decorateClass([n({type:Array})],AppSocket.prototype,"parts",2);AppSocket=__decorateClass([t("app-socket")],AppSocket);

var qs=Object.defineProperty;var zs=(B,F,O)=>F in B?qs(B,F,{enumerable:!0,configurable:!0,writable:!0,value:O}):B[F]=O;var He=(B,F,O)=>(zs(B,typeof F!="symbol"?F+"":F,O),O),Ti=(B,F,O)=>{if(!F.has(B))throw TypeError("Cannot "+O)};var W=(B,F,O)=>(Ti(B,F,"read from private field"),O?O.call(B):F.get(B)),Pt=(B,F,O)=>{if(F.has(B))throw TypeError("Cannot add the same private member more than once");F instanceof WeakSet?F.add(B):F.set(B,O)},Wt=(B,F,O,D)=>(Ti(B,F,"write to private field"),D?D.call(B,O):F.set(B,O),O);var si=(B,F,O,D)=>({set _(U){Wt(B,F,U,O)},get _(){return W(B,F,D)}}),Dt=(B,F,O)=>(Ti(B,F,"access private method"),O);(function(){const F=document.createElement("link").relList;if(F&&F.supports&&F.supports("modulepreload"))return;for(const U of document.querySelectorAll('link[rel="modulepreload"]'))D(U);new MutationObserver(U=>{for(const tt of U)if(tt.type==="childList")for(const Q of tt.addedNodes)Q.tagName==="LINK"&&Q.rel==="modulepreload"&&D(Q)}).observe(document,{childList:!0,subtree:!0});function O(U){const tt={};return U.integrity&&(tt.integrity=U.integrity),U.referrerPolicy&&(tt.referrerPolicy=U.referrerPolicy),U.crossOrigin==="use-credentials"?tt.credentials="include":U.crossOrigin==="anonymous"?tt.credentials="omit":tt.credentials="same-origin",tt}function D(U){if(U.ep)return;U.ep=!0;const tt=O(U);fetch(U.href,tt)}})();const index="";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$2=globalThis,e$5=t$2.ShadowRoot&&(t$2.ShadyCSS===void 0||t$2.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$2=Symbol(),o$3=new WeakMap;let n$3=class{constructor(F,O,D){if(this._$cssResult$=!0,D!==s$2)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=F,this.t=O}get styleSheet(){let F=this.o;const O=this.t;if(e$5&&F===void 0){const D=O!==void 0&&O.length===1;D&&(F=o$3.get(O)),F===void 0&&((this.o=F=new CSSStyleSheet).replaceSync(this.cssText),D&&o$3.set(O,F))}return F}toString(){return this.cssText}};const r$5=B=>new n$3(typeof B=="string"?B:B+"",void 0,s$2),i$3=(B,...F)=>{const O=B.length===1?B[0]:F.reduce((D,U,tt)=>D+(Q=>{if(Q._$cssResult$===!0)return Q.cssText;if(typeof Q=="number")return Q;throw Error("Value passed to 'css' function must be a 'css' function result: "+Q+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(U)+B[tt+1],B[0]);return new n$3(O,B,s$2)},S$1=(B,F)=>{if(e$5)B.adoptedStyleSheets=F.map(O=>O instanceof CSSStyleSheet?O:O.styleSheet);else for(const O of F){const D=document.createElement("style"),U=t$2.litNonce;U!==void 0&&D.setAttribute("nonce",U),D.textContent=O.cssText,B.appendChild(D)}},c$2=e$5?B=>B:B=>B instanceof CSSStyleSheet?(F=>{let O="";for(const D of F.cssRules)O+=D.cssText;return r$5(O)})(B):B;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:i$2,defineProperty:e$4,getOwnPropertyDescriptor:r$4,getOwnPropertyNames:h$1,getOwnPropertySymbols:o$2,getPrototypeOf:n$2}=Object,a$1=globalThis,c$1=a$1.trustedTypes,l$1=c$1?c$1.emptyScript:"",p$1=a$1.reactiveElementPolyfillSupport,d$1=(B,F)=>B,u$1={toAttribute(B,F){switch(F){case Boolean:B=B?l$1:null;break;case Object:case Array:B=B==null?B:JSON.stringify(B)}return B},fromAttribute(B,F){let O=B;switch(F){case Boolean:O=B!==null;break;case Number:O=B===null?null:Number(B);break;case Object:case Array:try{O=JSON.parse(B)}catch{O=null}}return O}},f$1=(B,F)=>!i$2(B,F),y$1={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$1};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),a$1.litPropertyMetadata??(a$1.litPropertyMetadata=new WeakMap);class b extends HTMLElement{static addInitializer(F){this._$Ei(),(this.l??(this.l=[])).push(F)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(F,O=y$1){if(O.state&&(O.attribute=!1),this._$Ei(),this.elementProperties.set(F,O),!O.noAccessor){const D=Symbol(),U=this.getPropertyDescriptor(F,D,O);U!==void 0&&e$4(this.prototype,F,U)}}static getPropertyDescriptor(F,O,D){const{get:U,set:tt}=r$4(this.prototype,F)??{get(){return this[O]},set(Q){this[O]=Q}};return{get(){return U==null?void 0:U.call(this)},set(Q){const Ft=U==null?void 0:U.call(this);tt.call(this,Q),this.requestUpdate(F,Ft,D)},configurable:!0,enumerable:!0}}static getPropertyOptions(F){return this.elementProperties.get(F)??y$1}static _$Ei(){if(this.hasOwnProperty(d$1("elementProperties")))return;const F=n$2(this);F.finalize(),F.l!==void 0&&(this.l=[...F.l]),this.elementProperties=new Map(F.elementProperties)}static finalize(){if(this.hasOwnProperty(d$1("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d$1("properties"))){const O=this.properties,D=[...h$1(O),...o$2(O)];for(const U of D)this.createProperty(U,O[U])}const F=this[Symbol.metadata];if(F!==null){const O=litPropertyMetadata.get(F);if(O!==void 0)for(const[D,U]of O)this.elementProperties.set(D,U)}this._$Eh=new Map;for(const[O,D]of this.elementProperties){const U=this._$Eu(O,D);U!==void 0&&this._$Eh.set(U,O)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(F){const O=[];if(Array.isArray(F)){const D=new Set(F.flat(1/0).reverse());for(const U of D)O.unshift(c$2(U))}else F!==void 0&&O.push(c$2(F));return O}static _$Eu(F,O){const D=O.attribute;return D===!1?void 0:typeof D=="string"?D:typeof F=="string"?F.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var F;this._$ES=new Promise(O=>this.enableUpdating=O),this._$AL=new Map,this._$E_(),this.requestUpdate(),(F=this.constructor.l)==null||F.forEach(O=>O(this))}addController(F){var O;(this._$EO??(this._$EO=new Set)).add(F),this.renderRoot!==void 0&&this.isConnected&&((O=F.hostConnected)==null||O.call(F))}removeController(F){var O;(O=this._$EO)==null||O.delete(F)}_$E_(){const F=new Map,O=this.constructor.elementProperties;for(const D of O.keys())this.hasOwnProperty(D)&&(F.set(D,this[D]),delete this[D]);F.size>0&&(this._$Ep=F)}createRenderRoot(){const F=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return S$1(F,this.constructor.elementStyles),F}connectedCallback(){var F;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(F=this._$EO)==null||F.forEach(O=>{var D;return(D=O.hostConnected)==null?void 0:D.call(O)})}enableUpdating(F){}disconnectedCallback(){var F;(F=this._$EO)==null||F.forEach(O=>{var D;return(D=O.hostDisconnected)==null?void 0:D.call(O)})}attributeChangedCallback(F,O,D){this._$AK(F,D)}_$EC(F,O){var tt;const D=this.constructor.elementProperties.get(F),U=this.constructor._$Eu(F,D);if(U!==void 0&&D.reflect===!0){const Q=(((tt=D.converter)==null?void 0:tt.toAttribute)!==void 0?D.converter:u$1).toAttribute(O,D.type);this._$Em=F,Q==null?this.removeAttribute(U):this.setAttribute(U,Q),this._$Em=null}}_$AK(F,O){var tt;const D=this.constructor,U=D._$Eh.get(F);if(U!==void 0&&this._$Em!==U){const Q=D.getPropertyOptions(U),Ft=typeof Q.converter=="function"?{fromAttribute:Q.converter}:((tt=Q.converter)==null?void 0:tt.fromAttribute)!==void 0?Q.converter:u$1;this._$Em=U,this[U]=Ft.fromAttribute(O,Q.type),this._$Em=null}}requestUpdate(F,O,D){if(F!==void 0){if(D??(D=this.constructor.getPropertyOptions(F)),!(D.hasChanged??f$1)(this[F],O))return;this.P(F,O,D)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(F,O,D){this._$AL.has(F)||this._$AL.set(F,O),D.reflect===!0&&this._$Em!==F&&(this._$Ej??(this._$Ej=new Set)).add(F)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(O){Promise.reject(O)}const F=this.scheduleUpdate();return F!=null&&await F,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var D;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[tt,Q]of this._$Ep)this[tt]=Q;this._$Ep=void 0}const U=this.constructor.elementProperties;if(U.size>0)for(const[tt,Q]of U)Q.wrapped!==!0||this._$AL.has(tt)||this[tt]===void 0||this.P(tt,this[tt],Q)}let F=!1;const O=this._$AL;try{F=this.shouldUpdate(O),F?(this.willUpdate(O),(D=this._$EO)==null||D.forEach(U=>{var tt;return(tt=U.hostUpdate)==null?void 0:tt.call(U)}),this.update(O)):this._$EU()}catch(U){throw F=!1,this._$EU(),U}F&&this._$AE(O)}willUpdate(F){}_$AE(F){var O;(O=this._$EO)==null||O.forEach(D=>{var U;return(U=D.hostUpdated)==null?void 0:U.call(D)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(F)),this.updated(F)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(F){return!0}update(F){this._$Ej&&(this._$Ej=this._$Ej.forEach(O=>this._$EC(O,this[O]))),this._$EU()}updated(F){}firstUpdated(F){}}b.elementStyles=[],b.shadowRootOptions={mode:"open"},b[d$1("elementProperties")]=new Map,b[d$1("finalized")]=new Map,p$1==null||p$1({ReactiveElement:b}),(a$1.reactiveElementVersions??(a$1.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t$1=globalThis,i$1=t$1.trustedTypes,s$1=i$1?i$1.createPolicy("lit-html",{createHTML:B=>B}):void 0,e$3="$lit$",h=`lit$${(Math.random()+"").slice(9)}$`,o$1="?"+h,n$1=`<${o$1}>`,r$3=document,l=()=>r$3.createComment(""),c=B=>B===null||typeof B!="object"&&typeof B!="function",a=Array.isArray,u=B=>a(B)||typeof(B==null?void 0:B[Symbol.iterator])=="function",d=`[ 	
\f\r]`,f=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\s"'>=/]+)(${d}*=${d}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),p=/'/g,g=/"/g,$=/^(?:script|style|textarea|title)$/i,y=B=>(F,...O)=>({_$litType$:B,strings:F,values:O}),x=y(1),w=Symbol.for("lit-noChange"),T=Symbol.for("lit-nothing"),A=new WeakMap,E=r$3.createTreeWalker(r$3,129);function C(B,F){if(!Array.isArray(B)||!B.hasOwnProperty("raw"))throw Error("invalid template strings array");return s$1!==void 0?s$1.createHTML(F):F}const P=(B,F)=>{const O=B.length-1,D=[];let U,tt=F===2?"<svg>":"",Q=f;for(let Ft=0;Ft<O;Ft++){const ht=B[Ft];let dt,st,yt=-1,Tt=0;for(;Tt<ht.length&&(Q.lastIndex=Tt,st=Q.exec(ht),st!==null);)Tt=Q.lastIndex,Q===f?st[1]==="!--"?Q=v:st[1]!==void 0?Q=_:st[2]!==void 0?($.test(st[2])&&(U=RegExp("</"+st[2],"g")),Q=m):st[3]!==void 0&&(Q=m):Q===m?st[0]===">"?(Q=U??f,yt=-1):st[1]===void 0?yt=-2:(yt=Q.lastIndex-st[2].length,dt=st[1],Q=st[3]===void 0?m:st[3]==='"'?g:p):Q===g||Q===p?Q=m:Q===v||Q===_?Q=f:(Q=m,U=void 0);const vt=Q===m&&B[Ft+1].startsWith("/>")?" ":"";tt+=Q===f?ht+n$1:yt>=0?(D.push(dt),ht.slice(0,yt)+e$3+ht.slice(yt)+h+vt):ht+h+(yt===-2?Ft:vt)}return[C(B,tt+(B[O]||"<?>")+(F===2?"</svg>":"")),D]};class V{constructor({strings:F,_$litType$:O},D){let U;this.parts=[];let tt=0,Q=0;const Ft=F.length-1,ht=this.parts,[dt,st]=P(F,O);if(this.el=V.createElement(dt,D),E.currentNode=this.el.content,O===2){const yt=this.el.content.firstChild;yt.replaceWith(...yt.childNodes)}for(;(U=E.nextNode())!==null&&ht.length<Ft;){if(U.nodeType===1){if(U.hasAttributes())for(const yt of U.getAttributeNames())if(yt.endsWith(e$3)){const Tt=st[Q++],vt=U.getAttribute(yt).split(h),ut=/([.?@])?(.*)/.exec(Tt);ht.push({type:1,index:tt,name:ut[2],strings:vt,ctor:ut[1]==="."?k:ut[1]==="?"?H:ut[1]==="@"?I:R}),U.removeAttribute(yt)}else yt.startsWith(h)&&(ht.push({type:6,index:tt}),U.removeAttribute(yt));if($.test(U.tagName)){const yt=U.textContent.split(h),Tt=yt.length-1;if(Tt>0){U.textContent=i$1?i$1.emptyScript:"";for(let vt=0;vt<Tt;vt++)U.append(yt[vt],l()),E.nextNode(),ht.push({type:2,index:++tt});U.append(yt[Tt],l())}}}else if(U.nodeType===8)if(U.data===o$1)ht.push({type:2,index:tt});else{let yt=-1;for(;(yt=U.data.indexOf(h,yt+1))!==-1;)ht.push({type:7,index:tt}),yt+=h.length-1}tt++}}static createElement(F,O){const D=r$3.createElement("template");return D.innerHTML=F,D}}function N(B,F,O=B,D){var Q,Ft;if(F===w)return F;let U=D!==void 0?(Q=O._$Co)==null?void 0:Q[D]:O._$Cl;const tt=c(F)?void 0:F._$litDirective$;return(U==null?void 0:U.constructor)!==tt&&((Ft=U==null?void 0:U._$AO)==null||Ft.call(U,!1),tt===void 0?U=void 0:(U=new tt(B),U._$AT(B,O,D)),D!==void 0?(O._$Co??(O._$Co=[]))[D]=U:O._$Cl=U),U!==void 0&&(F=N(B,U._$AS(B,F.values),U,D)),F}class S{constructor(F,O){this._$AV=[],this._$AN=void 0,this._$AD=F,this._$AM=O}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(F){const{el:{content:O},parts:D}=this._$AD,U=((F==null?void 0:F.creationScope)??r$3).importNode(O,!0);E.currentNode=U;let tt=E.nextNode(),Q=0,Ft=0,ht=D[0];for(;ht!==void 0;){if(Q===ht.index){let dt;ht.type===2?dt=new M(tt,tt.nextSibling,this,F):ht.type===1?dt=new ht.ctor(tt,ht.name,ht.strings,this,F):ht.type===6&&(dt=new L(tt,this,F)),this._$AV.push(dt),ht=D[++Ft]}Q!==(ht==null?void 0:ht.index)&&(tt=E.nextNode(),Q++)}return E.currentNode=r$3,U}p(F){let O=0;for(const D of this._$AV)D!==void 0&&(D.strings!==void 0?(D._$AI(F,D,O),O+=D.strings.length-2):D._$AI(F[O])),O++}}class M{get _$AU(){var F;return((F=this._$AM)==null?void 0:F._$AU)??this._$Cv}constructor(F,O,D,U){this.type=2,this._$AH=T,this._$AN=void 0,this._$AA=F,this._$AB=O,this._$AM=D,this.options=U,this._$Cv=(U==null?void 0:U.isConnected)??!0}get parentNode(){let F=this._$AA.parentNode;const O=this._$AM;return O!==void 0&&(F==null?void 0:F.nodeType)===11&&(F=O.parentNode),F}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(F,O=this){F=N(this,F,O),c(F)?F===T||F==null||F===""?(this._$AH!==T&&this._$AR(),this._$AH=T):F!==this._$AH&&F!==w&&this._(F):F._$litType$!==void 0?this.$(F):F.nodeType!==void 0?this.T(F):u(F)?this.k(F):this._(F)}S(F){return this._$AA.parentNode.insertBefore(F,this._$AB)}T(F){this._$AH!==F&&(this._$AR(),this._$AH=this.S(F))}_(F){this._$AH!==T&&c(this._$AH)?this._$AA.nextSibling.data=F:this.T(r$3.createTextNode(F)),this._$AH=F}$(F){var tt;const{values:O,_$litType$:D}=F,U=typeof D=="number"?this._$AC(F):(D.el===void 0&&(D.el=V.createElement(C(D.h,D.h[0]),this.options)),D);if(((tt=this._$AH)==null?void 0:tt._$AD)===U)this._$AH.p(O);else{const Q=new S(U,this),Ft=Q.u(this.options);Q.p(O),this.T(Ft),this._$AH=Q}}_$AC(F){let O=A.get(F.strings);return O===void 0&&A.set(F.strings,O=new V(F)),O}k(F){a(this._$AH)||(this._$AH=[],this._$AR());const O=this._$AH;let D,U=0;for(const tt of F)U===O.length?O.push(D=new M(this.S(l()),this.S(l()),this,this.options)):D=O[U],D._$AI(tt),U++;U<O.length&&(this._$AR(D&&D._$AB.nextSibling,U),O.length=U)}_$AR(F=this._$AA.nextSibling,O){var D;for((D=this._$AP)==null?void 0:D.call(this,!1,!0,O);F&&F!==this._$AB;){const U=F.nextSibling;F.remove(),F=U}}setConnected(F){var O;this._$AM===void 0&&(this._$Cv=F,(O=this._$AP)==null||O.call(this,F))}}class R{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(F,O,D,U,tt){this.type=1,this._$AH=T,this._$AN=void 0,this.element=F,this.name=O,this._$AM=U,this.options=tt,D.length>2||D[0]!==""||D[1]!==""?(this._$AH=Array(D.length-1).fill(new String),this.strings=D):this._$AH=T}_$AI(F,O=this,D,U){const tt=this.strings;let Q=!1;if(tt===void 0)F=N(this,F,O,0),Q=!c(F)||F!==this._$AH&&F!==w,Q&&(this._$AH=F);else{const Ft=F;let ht,dt;for(F=tt[0],ht=0;ht<tt.length-1;ht++)dt=N(this,Ft[D+ht],O,ht),dt===w&&(dt=this._$AH[ht]),Q||(Q=!c(dt)||dt!==this._$AH[ht]),dt===T?F=T:F!==T&&(F+=(dt??"")+tt[ht+1]),this._$AH[ht]=dt}Q&&!U&&this.j(F)}j(F){F===T?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,F??"")}}class k extends R{constructor(){super(...arguments),this.type=3}j(F){this.element[this.name]=F===T?void 0:F}}class H extends R{constructor(){super(...arguments),this.type=4}j(F){this.element.toggleAttribute(this.name,!!F&&F!==T)}}class I extends R{constructor(F,O,D,U,tt){super(F,O,D,U,tt),this.type=5}_$AI(F,O=this){if((F=N(this,F,O,0)??T)===w)return;const D=this._$AH,U=F===T&&D!==T||F.capture!==D.capture||F.once!==D.once||F.passive!==D.passive,tt=F!==T&&(D===T||U);U&&this.element.removeEventListener(this.name,this,D),tt&&this.element.addEventListener(this.name,this,F),this._$AH=F}handleEvent(F){var O;typeof this._$AH=="function"?this._$AH.call(((O=this.options)==null?void 0:O.host)??this.element,F):this._$AH.handleEvent(F)}}class L{constructor(F,O,D){this.element=F,this.type=6,this._$AN=void 0,this._$AM=O,this.options=D}get _$AU(){return this._$AM._$AU}_$AI(F){N(this,F)}}const Z=t$1.litHtmlPolyfillSupport;Z==null||Z(V,M),(t$1.litHtmlVersions??(t$1.litHtmlVersions=[])).push("3.1.2");const j=(B,F,O)=>{const D=(O==null?void 0:O.renderBefore)??F;let U=D._$litPart$;if(U===void 0){const tt=(O==null?void 0:O.renderBefore)??null;D._$litPart$=U=new M(F.insertBefore(l(),tt),tt,void 0,O??{})}return U._$AI(B),U};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class s extends b{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var O;const F=super.createRenderRoot();return(O=this.renderOptions).renderBefore??(O.renderBefore=F.firstChild),F}update(F){const O=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(F),this._$Do=j(O,this.renderRoot,this.renderOptions)}connectedCallback(){var F;super.connectedCallback(),(F=this._$Do)==null||F.setConnected(!0)}disconnectedCallback(){var F;super.disconnectedCallback(),(F=this._$Do)==null||F.setConnected(!1)}render(){return w}}var ls;s._$litElement$=!0,s.finalized=!0,(ls=globalThis.litElementHydrateSupport)==null||ls.call(globalThis,{LitElement:s});const r$2=globalThis.litElementPolyfillSupport;r$2==null||r$2({LitElement:s});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const t=B=>(F,O)=>{O!==void 0?O.addInitializer(()=>{customElements.define(B,F)}):customElements.define(B,F)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o={attribute:!0,type:String,converter:u$1,reflect:!1,hasChanged:f$1},r$1=(B=o,F,O)=>{const{kind:D,metadata:U}=O;let tt=globalThis.litPropertyMetadata.get(U);if(tt===void 0&&globalThis.litPropertyMetadata.set(U,tt=new Map),tt.set(O.name,B),D==="accessor"){const{name:Q}=O;return{set(Ft){const ht=F.get.call(this);F.set.call(this,Ft),this.requestUpdate(Q,ht,B)},init(Ft){return Ft!==void 0&&this.P(Q,void 0,B),Ft}}}if(D==="setter"){const{name:Q}=O;return function(Ft){const ht=this[Q];F.call(this,Ft),this.requestUpdate(Q,ht,B)}}throw Error("Unsupported decorator location: "+D)};function n(B){return(F,O)=>typeof O=="object"?r$1(B,F,O):((D,U,tt)=>{const Q=U.hasOwnProperty(tt);return U.constructor.createProperty(tt,Q?{...D,wrapped:!0}:D),Q?Object.getOwnPropertyDescriptor(U,tt):void 0})(B,F,O)}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const e$2=(B,F,O)=>(O.configurable=!0,O.enumerable=!0,Reflect.decorate&&typeof F!="object"&&Object.defineProperty(B,F,O),O);/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function e$1(B,F){return(O,D,U)=>{const tt=Q=>{var Ft;return((Ft=Q.renderRoot)==null?void 0:Ft.querySelector(B))??null};if(F){const{get:Q,set:Ft}=typeof D=="object"?O:U??(()=>{const ht=Symbol();return{get(){return this[ht]},set(dt){this[ht]=dt}}})();return e$2(O,D,{get(){let ht=Q.call(this);return ht===void 0&&(ht=tt(this),(ht!==null||this.hasUpdated)&&Ft.call(this,ht)),ht}})}return e$2(O,D,{get(){return tt(this)}})}}/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let e;function r(B){return(F,O)=>e$2(F,O,{get(){return(this.renderRoot??e??(e=document.createDocumentFragment())).querySelectorAll(B)}})}var __defProp$a=Object.defineProperty,__getOwnPropDesc$a=Object.getOwnPropertyDescriptor,__decorateClass$a=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$a(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$a(F,O,U),U};let CollapsableContainer=class extends s{constructor(){super(...arguments),this.title="",this.description=""}render(){return x`
      <div class="header">
        <div class="info" @click=${()=>{this.toggleAttribute("open")}}>
          <h3 class="title">${this.title}</h3>
          <p class="description">${this.description}</p>
        </div>
        <div class="tools">
          <slot name="header"></slot>
        </div>
      </div>

      <div class="content" @focusin=${()=>this.setAttribute("open","")}>
        <slot></slot>
      </div>
    `}};CollapsableContainer.styles=i$3`
    :host {
      display: grid;
      grid-template-rows: auto 1fr;
      grid-template-columns: 1fr;
      box-sizing: border-box;
      border-top: 1px solid var(--theme-color-background-light);
      transition: grid-template-rows .2s;
    }
    :host([collapsable]) {
      grid-template-rows: 1fr 0fr;
    }
    :host([open]) {
      grid-template-rows: auto 1fr;
    }
    :host([hidden]) {
      grid-template-rows: 0fr 0fr;
      transition: display 0s .5s, grid-template-rows .5s;
      display: none;
    }

    .content {
      overflow: hidden;
      box-sizing: border-box;
      transition: padding 0.5s;
    }
    :host([collapsable]) .content {
      opacity: 0;
      transition: opacity 0.5s;
      padding: 0 1em;
    }
    :host([open]) .content {
      opacity: 1;
      padding: 0 1em 1em;
    }
    /* when open and not collapsable */
    :host(:not([collapsable])) .content {
      padding: 0;
    }

    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1em;
      overflow: hidden;
      min-height: 0;
      transition: padding .5s;
    }
    :host([hidden]) .header {
      padding: 0 1em;
    }
    .info {
      font-size: .9em;
      flex: 1;
      /* make text non-selectable */
      user-select: none;
    }
    :host([collapsable]) .info {
      cursor: pointer;
    }
    .title, .description {
      display: block;
      margin: 0;
    }
    .tools {
      display: flex;
      gap: .5em;
    }

  `;__decorateClass$a([n({type:String})],CollapsableContainer.prototype,"title",2);__decorateClass$a([n({type:String})],CollapsableContainer.prototype,"description",2);CollapsableContainer=__decorateClass$a([t("app-container")],CollapsableContainer);const buttonStyle=i$3`
  button {
    background: var(--theme-color-background-light);
    border: none;
    outline: none;
    border-radius: 0.5em;
    padding: 0.5em 1em;
    color: var(--theme-color-text);
    cursor: pointer;
    font-weight: bold;
    text-transform: uppercase;
    user-select: none;
  }
  button:hover {
    scale: 1.05;
  }
  button:focus {
    box-shadow: 0 0 0 2px var(--theme-color-text-light);
  }
  button.primary {
    background: var(--theme-color-primary);
  }
`;var __defProp$9=Object.defineProperty,__getOwnPropDesc$9=Object.getOwnPropertyDescriptor,__decorateClass$9=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$9(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$9(F,O,U),U};const ui={get app(){return document.querySelector("app-root")}};function popup(B,F){const O=document.createElement("app-popup");return O.content=B,O.inputs=F,document.body.appendChild(O),O.promise}let AppPopup=class extends s{constructor(){super(...arguments),this.promise=new Promise((B,F)=>{this.resolve=B,this.reject=F})}connectedCallback(){super.connectedCallback(),ui.app.setAttribute("tabindex","-1"),this.promise.then(()=>this.remove()).catch(()=>this.remove())}disconnectedCallback(){super.disconnectedCallback(),ui.app.removeAttribute("tabindex")}updated(){this.okBtn.focus()}render(){return x`
      <div class="popup">
        <div id="content">
          ${this.content}
        </div>
        <div id="inputs" ?hidden=${!this.inputs}>
          ${this.inputs}
        </div>
        <div id="actions">
          <button id="ok" class="primary" @click=${()=>this.resolve(this.getValues())}>Ok</button>
          <button @click=${()=>this.reject()} ?hidden=${!this.inputs}>Cancel</button>
        </div>
      </div>
    `}getValues(){const B=[...this.inputFields];if(B.length===0)return;const F=new Map;return B.forEach(O=>{const{id:D,value:U}=O;D&&F.set(D,U)}),F}};AppPopup.styles=[buttonStyle,i$3`
      :host {
        display: grid;
        place-items: center;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        width: 100dvw;
        height: 100vh;
        height: 100dvh;
        background-color: var(--theme-color-background)bc;
        backdrop-filter: blur(5px);
        z-index: 100;
      }
      .popup {
        max-width: 80%;
        max-height: 80%;
        overflow: auto;
        display: flex;
        flex-direction: column;
        gap: 1em;
        background-color: var(--theme-color-background);
        padding: 1.5em;
        border: 1px solid var(--theme-color-background-light);
        border-radius: 2em;
        box-shadow: 0 0.6em 1em var(--theme-color-shadow);
        z-index: 101;
      }
      h1, h2, h3, h4, h5, h6, p, span {
        margin: 0;
        padding: 0;
      }
      .popup > div {
        display: flex;
        flex-wrap: wrap;
        /* align-items: center; */
        justify-content: stretch;
      }
      #content {
        flex: 1;
        flex-direction: column;
      }
      #inputs > input {
        display: block;
        min-width: 0;
        width: 100%;
        padding: 0.5em;
      }
      #actions {
        flex-direction: row-reverse;
        gap: .5em;
      }
    `];__decorateClass$9([r("#inputs > *")],AppPopup.prototype,"inputFields",2);__decorateClass$9([e$1("#ok")],AppPopup.prototype,"okBtn",2);AppPopup=__decorateClass$9([t("app-popup")],AppPopup);function lerp(B,F,O){return B+(F-B)*O}function rlerp(B,F,O){return(O-B)/(F-B)}function absoluteDistance(B,F){return Math.abs(B-F)}var __defProp$8=Object.defineProperty,__getOwnPropDesc$8=Object.getOwnPropertyDescriptor,__decorateClass$8=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$8(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$8(F,O,U),U};let InputSlider=class extends s{constructor(){super(...arguments),this.value=0,this.min=0,this.max=100,this.step=1}render(){return x`
      <div 
        class="container"
        tabindex="0"
        @mousedown=${this._handleMouse}
        @touchstart=${this._handleTouch}
        @keydown=${this._handleKey}
      >
        <div class="track"></div>
        <div class="thumb" style="left: ${lerp(0,100,rlerp(this.min,this.max,this.value))}%"></div>
      </div>
    `}_handleMouse(B){const F=D=>{D.preventDefault();const U=this.getBoundingClientRect(),tt=(D.clientX-U.left)/U.width,Q=lerp(this.min,this.max,tt);this.value=Math.max(this.min,Math.min(this.max,Math.round(Q/this.step)*this.step)),this._fireChangeEvent()},O=()=>{document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",O)};F(B),document.addEventListener("mousemove",F),document.addEventListener("mouseup",O)}_handleTouch(B){const F=D=>{const U=this.getBoundingClientRect(),tt=(D.touches[0].clientX-U.left)/U.width,Q=lerp(this.min,this.max,tt);this.value=Math.max(this.min,Math.min(this.max,Math.round(Q/this.step)*this.step)),this._fireChangeEvent()},O=()=>{document.removeEventListener("touchmove",F),document.removeEventListener("touchend",O),document.removeEventListener("touchcancel",O)};F(B),document.addEventListener("touchmove",F),document.addEventListener("touchend",O),document.addEventListener("touchcancel",O)}_handleKey(B){switch(B.key){case"ArrowLeft":case"ArrowDown":this.value=Math.max(this.min,this.value-this.step),this._fireChangeEvent();break;case"ArrowRight":case"ArrowUp":this.value=Math.min(this.max,this.value+this.step),this._fireChangeEvent();break;case"Home":this.value=this.min,this._fireChangeEvent();break;case"End":this.value=this.max,this._fireChangeEvent();break}}_fireChangeEvent(){this.dispatchEvent(new CustomEvent("change",{detail:this.value}))}};InputSlider.styles=i$3`
    :host {
      display: block;
      width: 100%;
    }
    .container {
      position: relative;
      width: 100%;
      height: 1em;
    }
    .track {
      position: absolute;
      top: 50%;
      left: 0;
      width: 100%;
      height: .1em;
      background: var(--theme-color-background-light);
      transform: translateY(-50%);
      border-radius: .1em;
      pointer-events: none;
      touch-action: none;
    }
    .thumb {
      position: absolute;
      top: 50%;
      left: 0;
      width: .8em;
      height: .8em;
      background: var(--theme-color-primary);
      transform: translate(-50%, -50%);
      border-radius: .5em;
      pointer-events: none;
      touch-action: none;
    }
    .container:focus .thumb {
      width: 1em;
      height: 1em;
    }
  `;__decorateClass$8([n({type:Number})],InputSlider.prototype,"value",2);__decorateClass$8([n({type:Number})],InputSlider.prototype,"min",2);__decorateClass$8([n({type:Number})],InputSlider.prototype,"max",2);__decorateClass$8([n({type:Number})],InputSlider.prototype,"step",2);InputSlider=__decorateClass$8([t("input-slider")],InputSlider);class ElectronFile{constructor(F,O){this.name=F,this.path=O}async arrayBuffer(){return await window.ipcRenderer.invoke("file-read",this.path)}async text(){return await window.ipcRenderer.invoke("file-read-text",this.path)}get handle(){return{name:this.name,path:this.path}}}class ElectronDirectory{constructor(F,O,D){this.name=F,this.path=O,this.entries=D}get handle(){return{name:this.name,path:this.path}}}const supported$3=!!window.ipcRenderer,platform$3="electron";async function fileOpen$3(B){if(B!=null&&B.name&&(B!=null&&B.path))return new ElectronFile(B.name,B.path);const F=await window.ipcRenderer.invoke("file-open",B);return new ElectronFile(F.name,F.path)}async function fileSave$3(B,F,O){const D=await B.arrayBuffer();return await window.ipcRenderer.invoke("file-save",D,F,O)}async function directoryOpen$3(B){const F=await window.ipcRenderer.invoke("directory-open",B),O=[];for(const D of F.entries)D.isDirectory?O.push(await directoryOpen$3(D)):O.push(await fileOpen$3(D));return new ElectronDirectory(F.name,F.path,O)}async function getRecent(){return[]}const fsElectron=Object.defineProperty({__proto__:null,directoryOpen:directoryOpen$3,fileOpen:fileOpen$3,fileSave:fileSave$3,getRecent,platform:platform$3,supported:supported$3},Symbol.toStringTag,{value:"Module"}),supported$2=window.showOpenFilePicker&&window.showSaveFilePicker&&window.showDirectoryPicker,platform$2="browser";class BrowserDirectory{constructor(F,O){this.handle=F,this.entries=O}get name(){return this.handle.name}}async function fileOpen$2(B){const F=B instanceof FileSystemFileHandle?B:(await window.showOpenFilePicker(transformOpenOptions(B)))[0];if(!F)throw new Error("File not provided");if(!await verifyPermission(F))throw new Error("Permission denied");const O=await F.getFile();return Object.assign(O,{handle:F})}async function fileSave$2(B,F,O){const D=O||await window.showSaveFilePicker(transformSaveOptions(F));if(!D)throw new Error("File not provided");if(!await verifyPermission(D,!0))throw new Error("Permission denied");const U=await D.createWritable();return await U.write(B),await U.close(),D}async function directoryOpen$2(B){const F=B instanceof FileSystemDirectoryHandle?B:await window.showDirectoryPicker(transformOpenOptions(B));if(!F)throw new Error("Directory not provided");if(!await verifyPermission(F))throw new Error("Permission denied");const O=[];for await(const D of F.values())D.kind==="file"?O.push(await fileOpen$2(D)):O.push(await directoryOpen$2(D));return new BrowserDirectory(F,O)}async function verifyPermission(B,F=!1){const O=F?{mode:"readwrite"}:{};return await B.queryPermission(O)==="granted"||await B.requestPermission(O)==="granted"}function transformOpenOptions(B){return{id:B.id,multiple:!1,excludeAcceptAllOption:!0,types:[{description:B.description,accept:B.accept}]}}function transformSaveOptions(B){return{id:B.id,suggestedName:B.fileName,types:[{description:B.description,accept:B.accept}]}}const fsBrowser=Object.defineProperty({__proto__:null,directoryOpen:directoryOpen$2,fileOpen:fileOpen$2,fileSave:fileSave$2,platform:platform$2,supported:supported$2},Symbol.toStringTag,{value:"Module"}),supported$1=!0,platform$1="legacy";async function fileOpen$1(B){const F=document.createElement("input");F.type="file";const O=Object.values(B.accept||{}).flat();F.accept=O.join(",");const D=await new Promise(U=>{F.onchange=()=>{var Q;const tt=(Q=F.files)==null?void 0:Q[0];U(tt)},F.click()});if(!D)throw new Error("File not provided");return D}async function fileSave$1(B,F){const O=document.createElement("a");O.href=URL.createObjectURL(B),O.download=F.fileName,O.click()}async function directoryOpen$1(){throw new Error("Not supported")}const fsLegacy=Object.defineProperty({__proto__:null,directoryOpen:directoryOpen$1,fileOpen:fileOpen$1,fileSave:fileSave$1,platform:platform$1,supported:supported$1},Symbol.toStringTag,{value:"Module"}),fs=supported$3?fsElectron:supported$2?fsBrowser:fsLegacy,{fileOpen,fileSave,directoryOpen,supported,platform}=fs;var __defProp$7=Object.defineProperty,__getOwnPropDesc$7=Object.getOwnPropertyDescriptor,__decorateClass$7=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$7(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$7(F,O,U),U};let ProjectManager=class extends s{render(){return x`
      <button 
        @click=${async()=>{const B=await directoryOpen(),F=B.entries.find(D=>D.name==="parts"),O=B.entries.find(D=>D.name==="recordings");console.log(F,O)}} 
      >
        Open Project
      </button>
    `}};ProjectManager=__decorateClass$7([t("project-manager")],ProjectManager);function createNoiseRemover(...B){const F=B.reduce((O,D)=>{for(let U=0;U<D.length;U++)O[U]=Math.max(O[U],D[U]);return O},new Uint8Array(B[0].length));return O=>{for(let D=0;D<O.length;D++)O[D]=Math.max(0,O[D]-F[D])}}function transformFrequencyData(B){const F=B.reduce((D,U)=>D+U,0)/B.length,O=Math.max(...B,50);for(let D=0;D<B.length;D++)B[D]=Math.min(255,Math.max(0,rlerp(F,O,B[D])*255))}class FrequencyFollower{constructor(F){this.recording=F,this.position=0,this.searchDistance=1,this.recentSpeed=1}guess(F,{treshold:O=100,minDistance:D=7,maxDistance:U=42,seekStep:tt=1.618}={}){if(this.position>=this.recording.data.length-this.searchDistance)return{over:!0};const Q=this.recording.getDifferences(F,this.position,this.position+Math.max(Math.round(this.searchDistance),D)).map(yt=>Math.max(...yt)),Ft=Math.min(...Q),ht=Q.lastIndexOf(Ft);Ft>O||ht<=0?(this.searchDistance=Math.min(this.searchDistance+tt,U),this.recentSpeed=lerp(this.recentSpeed,0,.1)):(this.recentSpeed=lerp(this.recentSpeed,ht,.1),this.searchDistance=1,this.position+=ht);let dt,st;if(this.recording.markings.length){const yt=[...this.recording.markings].reverse().find(vt=>vt[0]<=this.position),Tt=this.recording.markings.find(vt=>vt[0]>this.position);dt=yt?yt[1]:void 0,st=yt?rlerp(yt[0],(Tt==null?void 0:Tt[0])||this.recording.data.length,this.position):void 0}return{position:this.position,mark:dt,markPct:st,differences:Q,speed:this.recentSpeed}}}function compress(B){return B.map(F=>{const O=[];let D=F[0],U=1;for(let tt=1;tt<F.length;tt++)F[tt]===D?U++:(U>1?O.push([D,U]):O.push(D),D=F[tt],U=1);return U>1?O.push([D,U]):O.push(D),O})}function decompress(B){return B.map(F=>{const O=[];for(const D of F)if(Array.isArray(D)){const[U,tt]=D;O.push(...new Array(tt).fill(U))}else O.push(D);return new Uint8Array(O)})}class FrequencyRecording{constructor(){this.data=[],this.markings=[]}getDifferences(F,O=0,D=this.data.length){return this.data.slice(O,D).map(U=>new Uint8Array(U.map((tt,Q)=>absoluteDistance(tt,F[Q]))))}export(){return{data:compress(this.data),markings:this.markings,noiseProfile:this.noiseProfile?compress([this.noiseProfile]):void 0}}static import({data:F,markings:O,noiseProfile:D}){const U=new FrequencyRecording;return U.data=decompress(F),U.markings=O,U.noiseProfile=D?decompress(D)[0]:void 0,U}removeSilence(F=128){const O=FrequencyRecording.import(this.export());for(let D=0;D<O.data.length;D++)Math.max(...O.data[D])<F&&(O.data.splice(D,1),O.markings.forEach(U=>{U[0]>D&&U[0]--}),D--);return O}createFollower(){return new FrequencyFollower(this)}createProfile(){const F=new Uint8Array(this.data[0].length);for(let O=0;O<F.length;O++){const D=this.data.map(U=>U[O]);F[O]=Math.max(...D)}return F}}async function mic({resolution:B=12,crop:F=.125,smoothing:O=.5}={}){const D=await navigator.mediaDevices.getUserMedia({audio:{noiseSuppression:!1,echoCancellation:!1,autoGainControl:!1}}),U=new AudioContext,tt=U.createMediaStreamSource(D),Q=new GainNode(U,{gain:1});tt.connect(Q);const Ft=U.createAnalyser();Ft.fftSize=Math.pow(2,B),Ft.smoothingTimeConstant=O,tt.connect(Ft);function ht(){D.getTracks().forEach(st=>st.stop()),tt.disconnect(),Q.disconnect(),Ft.disconnect(),U.close()}function dt(){const st=Ft.frequencyBinCount,yt=new Uint8Array(Math.floor(st*F));return Ft.getByteFrequencyData(yt),yt}return{disconnect:ht,getData:dt}}function record(B,F={},O){const D=()=>{const Q=B.getData();Object.values(F).forEach(Ft=>Ft==null?void 0:Ft(Q))};let U,tt;if(O)tt=setInterval(D,O);else{const Q=()=>{D(),U=requestAnimationFrame(Q),console.log("frame",U)};U=requestAnimationFrame(Q)}return{stop:()=>{tt&&(clearInterval(tt),console.log("clearing interval",tt)),U&&(cancelAnimationFrame(U),console.log("canceling frame",U))}}}var __defProp$6=Object.defineProperty,__getOwnPropDesc$6=Object.getOwnPropertyDescriptor,__decorateClass$6=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$6(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$6(F,O,U),U};let FrequencyRecorder=class extends s{constructor(){super(...arguments),this.currentlyRecording=!1,this.starting=!1,this._status=""}async start(){if(!(this.currentlyRecording||this.starting)){this.starting=!0;try{this._status="connecting",this.source=await mic();const B={removeNoise:void 0,transform:void 0,capture:void 0};this.recorder=record(this.source,B),await delay(500),this._status="capturing noise";const F=new FrequencyRecording;B.capture=D=>{F.data.push(D)},await delay(2500),this._status="running";const O=[F.createProfile()];this.previousNoiseProfile&&O.push(this.previousNoiseProfile),B.removeNoise=createNoiseRemover(...O),B.transform=transformFrequencyData,B.capture=D=>{this.dispatchEvent(new CustomEvent("data",{detail:D}))},this.currentlyRecording=!0,this.dispatchEvent(new CustomEvent("start",{detail:{noiseProfile:O[0]}}))}catch{this._status="",popup(x`<h3>Could not connect to microphone</h3>`)}this.starting=!1}}stop(){var B,F;!this.currentlyRecording||this.starting||((B=this.recorder)==null||B.stop(),(F=this.source)==null||F.disconnect(),this.dispatchEvent(new CustomEvent("stop")),this.currentlyRecording=!1,this._status="")}toggle(){this.currentlyRecording?this.stop():this.start()}render(){return x`
      <button @click=${this.toggle} class=${this._status==="running"?"active":""}>
        <slot></slot>
        <p>${this._status}</p>
      </button>
    `}};FrequencyRecorder.styles=[buttonStyle,i$3`
      :host {
        display: block;
      }
      button.active {
        background: var(--theme-color-primary);
      }
      button p {
        text-transform: none;
        font-weight: normal;
        font-size: 0.8em;
        line-height: 1em;
        margin: 0;
      }
    `];__decorateClass$6([n({type:Boolean})],FrequencyRecorder.prototype,"currentlyRecording",2);__decorateClass$6([n({type:String})],FrequencyRecorder.prototype,"_status",2);FrequencyRecorder=__decorateClass$6([t("frequency-recorder")],FrequencyRecorder);async function delay(B){return new Promise(F=>setTimeout(F,B))}function heat(B){return`hsla(${360-B*360}, 100%, 50%, ${B})`}var __defProp$5=Object.defineProperty,__getOwnPropDesc$5=Object.getOwnPropertyDescriptor,__decorateClass$5=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$5(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$5(F,O,U),U};let Graph1D=class extends s{render(){return x`<canvas width="0" height="0"></canvas>`}updated(){const B=this.canvas,F=B.getContext("2d");if(!this.data){B.width=0,B.height=0;return}B.width=this.data.length,B.height=5,this.data.forEach((O,D)=>{F.fillStyle=heat(O/255),F.fillRect(D,0,1,5)})}};Graph1D.styles=i$3`
    :host {
      display: block;
    }
    canvas {
      display: block;
    }
  `;__decorateClass$5([n({type:Object})],Graph1D.prototype,"data",2);__decorateClass$5([e$1("canvas")],Graph1D.prototype,"canvas",2);Graph1D=__decorateClass$5([t("graph-1d")],Graph1D);var __defProp$4=Object.defineProperty,__getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__decorateClass$4=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$4(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$4(F,O,U),U};let Graph2D=class extends s{render(){return x`<canvas width="0" height="0" @click=${B=>{const F=this.canvas.getBoundingClientRect(),O=B.clientX-F.left,D=B.clientY-F.top,U=O/F.width,tt=D/F.height,Q=Math.floor(U*this.data.length||0),Ft=Math.floor((1-tt)*this.data[0].length);this.dispatchEvent(new CustomEvent("select",{detail:{column:Q,row:Ft,x:O,y:D}}))}}></canvas>`}updated(){var ht;if(!this.data||!this.data.length)return;const B=this.canvas,F=B.getContext("2d"),O=((ht=this.data[0])==null?void 0:ht.length)||0;B.width=this.data.length,B.height=O;let D=0,U=50,tt;const Q=45,Ft=dt=>{tt&&(dt-tt<Q?U++:U--),tt=dt;for(let st=D;st<Math.min(D+U,this.data.length);st++)for(let yt=0;yt<O;yt++)F.fillStyle=heat(this.data[st][yt]/255),F.fillRect(st,O-yt,1,1);D+=U,D<this.data.length&&requestAnimationFrame(Ft)};requestAnimationFrame(Ft)}};Graph2D.styles=i$3`
    :host {
      display: block;
    }
    canvas {
      display: block;
    }
  `;__decorateClass$4([n({type:Array})],Graph2D.prototype,"data",2);__decorateClass$4([e$1("canvas")],Graph2D.prototype,"canvas",2);Graph2D=__decorateClass$4([t("graph-2d")],Graph2D);function getAugmentedNamespace(B){if(B.__esModule)return B;var F=B.default;if(typeof F=="function"){var O=function D(){return this instanceof D?Reflect.construct(F,arguments,this.constructor):F.apply(this,arguments)};O.prototype=F.prototype}else O={};return Object.defineProperty(O,"__esModule",{value:!0}),Object.keys(B).forEach(function(D){var U=Object.getOwnPropertyDescriptor(B,D);Object.defineProperty(O,D,U.get?U:{enumerable:!0,get:function(){return B[D]}})}),O}function commonjsRequire(B){throw new Error('Could not dynamically require "'+B+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"}),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(F,O){module.exports=F.pdfjsLib=O()})(globalThis,()=>(()=>{var __webpack_modules__=[,(B,F)=>{var Le;Object.defineProperty(F,"__esModule",{value:!0}),F.VerbosityLevel=F.Util=F.UnknownErrorException=F.UnexpectedResponseException=F.TextRenderingMode=F.RenderingIntentFlag=F.PromiseCapability=F.PermissionFlag=F.PasswordResponses=F.PasswordException=F.PageActionEventType=F.OPS=F.MissingPDFException=F.MAX_IMAGE_SIZE_TO_CACHE=F.LINE_FACTOR=F.LINE_DESCENT_FACTOR=F.InvalidPDFException=F.ImageKind=F.IDENTITY_MATRIX=F.FormatError=F.FeatureTest=F.FONT_IDENTITY_MATRIX=F.DocumentActionEventType=F.CMapCompressionType=F.BaseException=F.BASELINE_FACTOR=F.AnnotationType=F.AnnotationReplyType=F.AnnotationPrefix=F.AnnotationMode=F.AnnotationFlag=F.AnnotationFieldFlag=F.AnnotationEditorType=F.AnnotationEditorPrefix=F.AnnotationEditorParamsType=F.AnnotationBorderStyleType=F.AnnotationActionEventType=F.AbortException=void 0,F.assert=Kt,F.bytesToString=xt,F.createValidAbsoluteUrl=de,F.getModificationDate=ue,F.getUuid=De,F.getVerbosityLevel=It,F.info=Vt,F.isArrayBuffer=Qt,F.isArrayEqual=he,F.isNodeJS=void 0,F.normalizeUnicode=Fe,F.objectFromMap=Jt,F.objectSize=Gt,F.setVerbosityLevel=mt,F.shadow=ge,F.string32=Ht,F.stringToBytes=qt,F.stringToPDFString=te,F.stringToUTF8String=Ut,F.unreachable=Mt,F.utf8StringToString=jt,F.warn=Xt;const O=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");F.isNodeJS=O;const D=[1,0,0,1,0,0];F.IDENTITY_MATRIX=D;const U=[.001,0,0,.001,0,0];F.FONT_IDENTITY_MATRIX=U;const tt=1e7;F.MAX_IMAGE_SIZE_TO_CACHE=tt;const Q=1.35;F.LINE_FACTOR=Q;const Ft=.35;F.LINE_DESCENT_FACTOR=Ft;const ht=Ft/Q;F.BASELINE_FACTOR=ht;const dt={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};F.RenderingIntentFlag=dt;const st={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};F.AnnotationMode=st;const yt="pdfjs_internal_editor_";F.AnnotationEditorPrefix=yt;const Tt={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};F.AnnotationEditorType=Tt;const vt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};F.AnnotationEditorParamsType=vt;const ut={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};F.PermissionFlag=ut;const ft={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};F.TextRenderingMode=ft;const nt={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};F.ImageKind=nt;const ct={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};F.AnnotationType=ct;const bt={GROUP:"Group",REPLY:"R"};F.AnnotationReplyType=bt;const _t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};F.AnnotationFlag=_t;const pt={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};F.AnnotationFieldFlag=pt;const K={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};F.AnnotationBorderStyleType=K;const et={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};F.AnnotationActionEventType=et;const St={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};F.DocumentActionEventType=St;const at={O:"PageOpen",C:"PageClose"};F.PageActionEventType=at;const Y={ERRORS:0,WARNINGS:1,INFOS:5};F.VerbosityLevel=Y;const At={NONE:0,BINARY:1};F.CMapCompressionType=At;const ot={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};F.OPS=ot;const kt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};F.PasswordResponses=kt;let Lt=Y.WARNINGS;function mt(Yt){Number.isInteger(Yt)&&(Lt=Yt)}function It(){return Lt}function Vt(Yt){Lt>=Y.INFOS&&console.log(`Info: ${Yt}`)}function Xt(Yt){Lt>=Y.WARNINGS&&console.log(`Warning: ${Yt}`)}function Mt(Yt){throw new Error(Yt)}function Kt(Yt,Bt){Yt||Mt(Bt)}function ee(Yt){switch(Yt==null?void 0:Yt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function de(Yt,Bt=null,Ot=null){if(!Yt)return null;try{if(Ot&&typeof Yt=="string"){if(Ot.addDefaultProtocol&&Yt.startsWith("www.")){const ae=Yt.match(/\./g);(ae==null?void 0:ae.length)>=2&&(Yt=`http://${Yt}`)}if(Ot.tryConvertEncoding)try{Yt=Ut(Yt)}catch{}}const se=Bt?new URL(Yt,Bt):new URL(Yt);if(ee(se))return se}catch{}return null}function ge(Yt,Bt,Ot,se=!1){return Object.defineProperty(Yt,Bt,{value:Ot,enumerable:!se,configurable:!0,writable:!1}),Ot}const gt=function(){function Bt(Ot,se){this.constructor===Bt&&Mt("Cannot initialize BaseException."),this.message=Ot,this.name=se}return Bt.prototype=new Error,Bt.constructor=Bt,Bt}();F.BaseException=gt;class z extends gt{constructor(Bt,Ot){super(Bt,"PasswordException"),this.code=Ot}}F.PasswordException=z;class X extends gt{constructor(Bt,Ot){super(Bt,"UnknownErrorException"),this.details=Ot}}F.UnknownErrorException=X;class G extends gt{constructor(Bt){super(Bt,"InvalidPDFException")}}F.InvalidPDFException=G;class J extends gt{constructor(Bt){super(Bt,"MissingPDFException")}}F.MissingPDFException=J;class it extends gt{constructor(Bt,Ot){super(Bt,"UnexpectedResponseException"),this.status=Ot}}F.UnexpectedResponseException=it;class lt extends gt{constructor(Bt){super(Bt,"FormatError")}}F.FormatError=lt;class Et extends gt{constructor(Bt){super(Bt,"AbortException")}}F.AbortException=Et;function xt(Yt){(typeof Yt!="object"||(Yt==null?void 0:Yt.length)===void 0)&&Mt("Invalid argument for bytesToString");const Bt=Yt.length,Ot=8192;if(Bt<Ot)return String.fromCharCode.apply(null,Yt);const se=[];for(let ae=0;ae<Bt;ae+=Ot){const je=Math.min(ae+Ot,Bt),Ue=Yt.subarray(ae,je);se.push(String.fromCharCode.apply(null,Ue))}return se.join("")}function qt(Yt){typeof Yt!="string"&&Mt("Invalid argument for stringToBytes");const Bt=Yt.length,Ot=new Uint8Array(Bt);for(let se=0;se<Bt;++se)Ot[se]=Yt.charCodeAt(se)&255;return Ot}function Ht(Yt){return String.fromCharCode(Yt>>24&255,Yt>>16&255,Yt>>8&255,Yt&255)}function Gt(Yt){return Object.keys(Yt).length}function Jt(Yt){const Bt=Object.create(null);for(const[Ot,se]of Yt)Bt[Ot]=se;return Bt}function oe(){const Yt=new Uint8Array(4);return Yt[0]=1,new Uint32Array(Yt.buffer,0,1)[0]===1}function Zt(){try{return new Function(""),!0}catch{return!1}}class be{static get isLittleEndian(){return ge(this,"isLittleEndian",oe())}static get isEvalSupported(){return ge(this,"isEvalSupported",Zt())}static get isOffscreenCanvasSupported(){return ge(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?ge(this,"platform",{isWin:!1,isMac:!1}):ge(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Bt,Ot;return ge(this,"isCSSRoundSupported",(Ot=(Bt=globalThis.CSS)==null?void 0:Bt.supports)==null?void 0:Ot.call(Bt,"width: round(1.5px, 1px)"))}}F.FeatureTest=be;const Ce=[...Array(256).keys()].map(Yt=>Yt.toString(16).padStart(2,"0"));class ce{static makeHexColor(Bt,Ot,se){return`#${Ce[Bt]}${Ce[Ot]}${Ce[se]}`}static scaleMinMax(Bt,Ot){let se;Bt[0]?(Bt[0]<0&&(se=Ot[0],Ot[0]=Ot[1],Ot[1]=se),Ot[0]*=Bt[0],Ot[1]*=Bt[0],Bt[3]<0&&(se=Ot[2],Ot[2]=Ot[3],Ot[3]=se),Ot[2]*=Bt[3],Ot[3]*=Bt[3]):(se=Ot[0],Ot[0]=Ot[2],Ot[2]=se,se=Ot[1],Ot[1]=Ot[3],Ot[3]=se,Bt[1]<0&&(se=Ot[2],Ot[2]=Ot[3],Ot[3]=se),Ot[2]*=Bt[1],Ot[3]*=Bt[1],Bt[2]<0&&(se=Ot[0],Ot[0]=Ot[1],Ot[1]=se),Ot[0]*=Bt[2],Ot[1]*=Bt[2]),Ot[0]+=Bt[4],Ot[1]+=Bt[4],Ot[2]+=Bt[5],Ot[3]+=Bt[5]}static transform(Bt,Ot){return[Bt[0]*Ot[0]+Bt[2]*Ot[1],Bt[1]*Ot[0]+Bt[3]*Ot[1],Bt[0]*Ot[2]+Bt[2]*Ot[3],Bt[1]*Ot[2]+Bt[3]*Ot[3],Bt[0]*Ot[4]+Bt[2]*Ot[5]+Bt[4],Bt[1]*Ot[4]+Bt[3]*Ot[5]+Bt[5]]}static applyTransform(Bt,Ot){const se=Bt[0]*Ot[0]+Bt[1]*Ot[2]+Ot[4],ae=Bt[0]*Ot[1]+Bt[1]*Ot[3]+Ot[5];return[se,ae]}static applyInverseTransform(Bt,Ot){const se=Ot[0]*Ot[3]-Ot[1]*Ot[2],ae=(Bt[0]*Ot[3]-Bt[1]*Ot[2]+Ot[2]*Ot[5]-Ot[4]*Ot[3])/se,je=(-Bt[0]*Ot[1]+Bt[1]*Ot[0]+Ot[4]*Ot[1]-Ot[5]*Ot[0])/se;return[ae,je]}static getAxialAlignedBoundingBox(Bt,Ot){const se=this.applyTransform(Bt,Ot),ae=this.applyTransform(Bt.slice(2,4),Ot),je=this.applyTransform([Bt[0],Bt[3]],Ot),Ue=this.applyTransform([Bt[2],Bt[1]],Ot);return[Math.min(se[0],ae[0],je[0],Ue[0]),Math.min(se[1],ae[1],je[1],Ue[1]),Math.max(se[0],ae[0],je[0],Ue[0]),Math.max(se[1],ae[1],je[1],Ue[1])]}static inverseTransform(Bt){const Ot=Bt[0]*Bt[3]-Bt[1]*Bt[2];return[Bt[3]/Ot,-Bt[1]/Ot,-Bt[2]/Ot,Bt[0]/Ot,(Bt[2]*Bt[5]-Bt[4]*Bt[3])/Ot,(Bt[4]*Bt[1]-Bt[5]*Bt[0])/Ot]}static singularValueDecompose2dScale(Bt){const Ot=[Bt[0],Bt[2],Bt[1],Bt[3]],se=Bt[0]*Ot[0]+Bt[1]*Ot[2],ae=Bt[0]*Ot[1]+Bt[1]*Ot[3],je=Bt[2]*Ot[0]+Bt[3]*Ot[2],Ue=Bt[2]*Ot[1]+Bt[3]*Ot[3],$t=(se+Ue)/2,le=Math.sqrt((se+Ue)**2-4*(se*Ue-je*ae))/2,Se=$t+le||1,pe=$t-le||1;return[Math.sqrt(Se),Math.sqrt(pe)]}static normalizeRect(Bt){const Ot=Bt.slice(0);return Bt[0]>Bt[2]&&(Ot[0]=Bt[2],Ot[2]=Bt[0]),Bt[1]>Bt[3]&&(Ot[1]=Bt[3],Ot[3]=Bt[1]),Ot}static intersect(Bt,Ot){const se=Math.max(Math.min(Bt[0],Bt[2]),Math.min(Ot[0],Ot[2])),ae=Math.min(Math.max(Bt[0],Bt[2]),Math.max(Ot[0],Ot[2]));if(se>ae)return null;const je=Math.max(Math.min(Bt[1],Bt[3]),Math.min(Ot[1],Ot[3])),Ue=Math.min(Math.max(Bt[1],Bt[3]),Math.max(Ot[1],Ot[3]));return je>Ue?null:[se,je,ae,Ue]}static bezierBoundingBox(Bt,Ot,se,ae,je,Ue,$t,le){const Se=[],pe=[[],[]];let Ee,we,$e,ne,Ie,ve,wt,q;for(let Nt=0;Nt<2;++Nt){if(Nt===0?(we=6*Bt-12*se+6*je,Ee=-3*Bt+9*se-9*je+3*$t,$e=3*se-3*Bt):(we=6*Ot-12*ae+6*Ue,Ee=-3*Ot+9*ae-9*Ue+3*le,$e=3*ae-3*Ot),Math.abs(Ee)<1e-12){if(Math.abs(we)<1e-12)continue;ne=-$e/we,0<ne&&ne<1&&Se.push(ne);continue}wt=we*we-4*$e*Ee,q=Math.sqrt(wt),!(wt<0)&&(Ie=(-we+q)/(2*Ee),0<Ie&&Ie<1&&Se.push(Ie),ve=(-we-q)/(2*Ee),0<ve&&ve<1&&Se.push(ve))}let rt=Se.length,Ct;const Rt=rt;for(;rt--;)ne=Se[rt],Ct=1-ne,pe[0][rt]=Ct*Ct*Ct*Bt+3*Ct*Ct*ne*se+3*Ct*ne*ne*je+ne*ne*ne*$t,pe[1][rt]=Ct*Ct*Ct*Ot+3*Ct*Ct*ne*ae+3*Ct*ne*ne*Ue+ne*ne*ne*le;return pe[0][Rt]=Bt,pe[1][Rt]=Ot,pe[0][Rt+1]=$t,pe[1][Rt+1]=le,pe[0].length=pe[1].length=Rt+2,[Math.min(...pe[0]),Math.min(...pe[1]),Math.max(...pe[0]),Math.max(...pe[1])]}}F.Util=ce;const Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function te(Yt){if(Yt[0]>=""){let Ot;if(Yt[0]===""&&Yt[1]===""?Ot="utf-16be":Yt[0]===""&&Yt[1]===""?Ot="utf-16le":Yt[0]===""&&Yt[1]===""&&Yt[2]===""&&(Ot="utf-8"),Ot)try{const se=new TextDecoder(Ot,{fatal:!0}),ae=qt(Yt);return se.decode(ae)}catch(se){Xt(`stringToPDFString: "${se}".`)}}const Bt=[];for(let Ot=0,se=Yt.length;Ot<se;Ot++){const ae=Ae[Yt.charCodeAt(Ot)];Bt.push(ae?String.fromCharCode(ae):Yt.charAt(Ot))}return Bt.join("")}function Ut(Yt){return decodeURIComponent(escape(Yt))}function jt(Yt){return unescape(encodeURIComponent(Yt))}function Qt(Yt){return typeof Yt=="object"&&(Yt==null?void 0:Yt.byteLength)!==void 0}function he(Yt,Bt){if(Yt.length!==Bt.length)return!1;for(let Ot=0,se=Yt.length;Ot<se;Ot++)if(Yt[Ot]!==Bt[Ot])return!1;return!0}function ue(Yt=new Date){return[Yt.getUTCFullYear().toString(),(Yt.getUTCMonth()+1).toString().padStart(2,"0"),Yt.getUTCDate().toString().padStart(2,"0"),Yt.getUTCHours().toString().padStart(2,"0"),Yt.getUTCMinutes().toString().padStart(2,"0"),Yt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Pe{constructor(){Pt(this,Le,!1);this.promise=new Promise((Bt,Ot)=>{this.resolve=se=>{Wt(this,Le,!0),Bt(se)},this.reject=se=>{Wt(this,Le,!0),Ot(se)}})}get settled(){return W(this,Le)}}Le=new WeakMap,F.PromiseCapability=Pe;let Re=null,xe=null;function Fe(Yt){return Re||(Re=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,xe=new Map([["","t"]])),Yt.replaceAll(Re,(Bt,Ot,se)=>Ot?Ot.normalize("NFKC"):xe.get(se))}function De(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Yt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Yt);else for(let Bt=0;Bt<32;Bt++)Yt[Bt]=Math.floor(Math.random()*255);return xt(Yt)}const ke="pdfjs_internal_id_";F.AnnotationPrefix=ke},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var B,O,D,U,Je,Q,di,ht,dt,st,yt,Tt,vt,ut,ft,nt,pi,bt,_t,Pi,K,et;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(at){if(typeof at=="string"||at instanceof URL?at={url:at}:(0,_util.isArrayBuffer)(at)&&(at={data:at}),typeof at!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!at.url&&!at.data&&!at.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const Y=new PDFDocumentLoadingTask,{docId:At}=Y,ot=at.url?getUrlProp(at.url):null,kt=at.data?getDataProp(at.data):null,Lt=at.httpHeaders||null,mt=at.withCredentials===!0,It=at.password??null,Vt=at.range instanceof PDFDataRangeTransport?at.range:null,Xt=Number.isInteger(at.rangeChunkSize)&&at.rangeChunkSize>0?at.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Mt=at.worker instanceof PDFWorker?at.worker:null;const Kt=at.verbosity,ee=typeof at.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(at.docBaseUrl)?at.docBaseUrl:null,de=typeof at.cMapUrl=="string"?at.cMapUrl:null,ge=at.cMapPacked!==!1,gt=at.CMapReaderFactory||DefaultCMapReaderFactory,z=typeof at.standardFontDataUrl=="string"?at.standardFontDataUrl:null,X=at.StandardFontDataFactory||DefaultStandardFontDataFactory,G=at.stopAtErrors!==!0,J=Number.isInteger(at.maxImageSize)&&at.maxImageSize>-1?at.maxImageSize:-1,it=at.isEvalSupported!==!1,lt=typeof at.isOffscreenCanvasSupported=="boolean"?at.isOffscreenCanvasSupported:!_util.isNodeJS,Et=Number.isInteger(at.canvasMaxAreaInBytes)?at.canvasMaxAreaInBytes:-1,xt=typeof at.disableFontFace=="boolean"?at.disableFontFace:_util.isNodeJS,qt=at.fontExtraProperties===!0,Ht=at.enableXfa===!0,Gt=at.ownerDocument||globalThis.document,Jt=at.disableRange===!0,oe=at.disableStream===!0,Zt=at.disableAutoFetch===!0,be=at.pdfBug===!0,Ce=Vt?Vt.length:at.length??NaN,ce=typeof at.useSystemFonts=="boolean"?at.useSystemFonts:!_util.isNodeJS&&!xt,Ae=typeof at.useWorkerFetch=="boolean"?at.useWorkerFetch:gt===_display_utils.DOMCMapReaderFactory&&X===_display_utils.DOMStandardFontDataFactory&&de&&z&&(0,_display_utils.isValidFetchUrl)(de,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(z,document.baseURI),te=at.canvasFactory||new DefaultCanvasFactory({ownerDocument:Gt}),Ut=at.filterFactory||new DefaultFilterFactory({docId:At,ownerDocument:Gt}),jt=null;(0,_util.setVerbosityLevel)(Kt);const Qt={canvasFactory:te,filterFactory:Ut};if(Ae||(Qt.cMapReaderFactory=new gt({baseUrl:de,isCompressed:ge}),Qt.standardFontDataFactory=new X({baseUrl:z})),!Mt){const Pe={verbosity:Kt,port:_worker_options.GlobalWorkerOptions.workerPort};Mt=Pe.port?PDFWorker.fromPort(Pe):new PDFWorker(Pe),Y._worker=Mt}const he={docId:At,apiVersion:"3.11.174",data:kt,password:It,disableAutoFetch:Zt,rangeChunkSize:Xt,length:Ce,docBaseUrl:ee,enableXfa:Ht,evaluatorOptions:{maxImageSize:J,disableFontFace:xt,ignoreErrors:G,isEvalSupported:it,isOffscreenCanvasSupported:lt,canvasMaxAreaInBytes:Et,fontExtraProperties:qt,useSystemFonts:ce,cMapUrl:Ae?de:null,standardFontDataUrl:Ae?z:null}},ue={ignoreErrors:G,isEvalSupported:it,disableFontFace:xt,fontExtraProperties:qt,enableXfa:Ht,ownerDocument:Gt,disableAutoFetch:Zt,pdfBug:be,styleElement:jt};return Mt.promise.then(function(){if(Y.destroyed)throw new Error("Loading aborted");const Pe=_fetchDocument(Mt,he),Re=new Promise(function(xe){let Fe;Vt?Fe=new _transport_stream.PDFDataTransportStream({length:Ce,initialData:Vt.initialData,progressiveDone:Vt.progressiveDone,contentDispositionFilename:Vt.contentDispositionFilename,disableRange:Jt,disableStream:oe},Vt):kt||(Fe=(ke=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(ke):(0,_display_utils.isValidFetchUrl)(ke.url)?new _displayFetch_stream.PDFFetchStream(ke):new _displayNetwork.PDFNetworkStream(ke))({url:ot,length:Ce,httpHeaders:Lt,withCredentials:mt,rangeChunkSize:Xt,disableRange:Jt,disableStream:oe})),xe(Fe)});return Promise.all([Pe,Re]).then(function([xe,Fe]){if(Y.destroyed)throw new Error("Loading aborted");const De=new _message_handler.MessageHandler(At,xe,Mt.port),ke=new WorkerTransport(De,Y,Fe,ue,Qt);Y._transport=ke,De.send("Ready",null)})}).catch(Y._capability.reject),Y}async function _fetchDocument(at,Y){if(at.destroyed)throw new Error("Worker was destroyed");const At=await at.messageHandler.sendWithPromise("GetDocRequest",Y,Y.data?[Y.data.buffer]:null);if(at.destroyed)throw new Error("Worker was destroyed");return At}function getUrlProp(at){if(at instanceof URL)return at.href;try{return new URL(at,window.location).href}catch{if(_util.isNodeJS&&typeof at=="string")return at}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(at){if(_util.isNodeJS&&typeof Buffer<"u"&&at instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(at instanceof Uint8Array&&at.byteLength===at.buffer.byteLength)return at;if(typeof at=="string")return(0,_util.stringToBytes)(at);if(typeof at=="object"&&!isNaN(at==null?void 0:at.length)||(0,_util.isArrayBuffer)(at))return new Uint8Array(at);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const F=class F{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${si(F,B)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var Y,At,ot;this.destroyed=!0;try{(Y=this._worker)!=null&&Y.port&&(this._worker._pendingDestroy=!0),await((At=this._transport)==null?void 0:At.destroy())}catch(kt){throw(ot=this._worker)!=null&&ot.port&&delete this._worker._pendingDestroy,kt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};B=new WeakMap,Pt(F,B,0);let PDFDocumentLoadingTask=F;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(Y,At,ot=!1,kt=null){this.length=Y,this.initialData=At,this.progressiveDone=ot,this.contentDispositionFilename=kt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(Y){this._rangeListeners.push(Y)}addProgressListener(Y){this._progressListeners.push(Y)}addProgressiveReadListener(Y){this._progressiveReadListeners.push(Y)}addProgressiveDoneListener(Y){this._progressiveDoneListeners.push(Y)}onDataRange(Y,At){for(const ot of this._rangeListeners)ot(Y,At)}onDataProgress(Y,At){this._readyCapability.promise.then(()=>{for(const ot of this._progressListeners)ot(Y,At)})}onDataProgressiveRead(Y){this._readyCapability.promise.then(()=>{for(const At of this._progressiveReadListeners)At(Y)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const Y of this._progressiveDoneListeners)Y()})}transportReady(){this._readyCapability.resolve()}requestDataRange(Y,At){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(Y,At){this._pdfInfo=Y,this._transport=At,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(ot=>{if(!ot)return ot;const kt=[];for(const Lt in ot)kt.push(...ot[Lt]);return kt}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(Y){return this._transport.getPage(Y)}getPageIndex(Y){return this._transport.getPageIndex(Y)}getDestinations(){return this._transport.getDestinations()}getDestination(Y){return this._transport.getDestination(Y)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(Y=!1){return this._transport.startCleanup(Y||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(Y,At,ot,kt=!1){Pt(this,U);Pt(this,Q);Pt(this,O,null);Pt(this,D,!1);this._pageIndex=Y,this._pageInfo=At,this._transport=ot,this._stats=kt?new _display_utils.StatTimer:null,this._pdfBug=kt,this.commonObjs=ot.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:Y,rotation:At=this.rotate,offsetX:ot=0,offsetY:kt=0,dontFlip:Lt=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:Y,rotation:At,offsetX:ot,offsetY:kt,dontFlip:Lt})}getAnnotations({intent:Y="display"}={}){const At=this._transport.getRenderingIntent(Y);return this._transport.getAnnotations(this._pageIndex,At.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var Y;return((Y=this._transport._htmlForXfa)==null?void 0:Y.children[this._pageIndex])||null}render({canvasContext:Y,viewport:At,intent:ot="display",annotationMode:kt=_util.AnnotationMode.ENABLE,transform:Lt=null,background:mt=null,optionalContentConfigPromise:It=null,annotationCanvasMap:Vt=null,pageColors:Xt=null,printAnnotationStorage:Mt=null}){var X,G;(X=this._stats)==null||X.time("Overall");const Kt=this._transport.getRenderingIntent(ot,kt,Mt);Wt(this,D,!1),Dt(this,Q,di).call(this),It||(It=this._transport.getOptionalContentConfig());let ee=this._intentStates.get(Kt.cacheKey);ee||(ee=Object.create(null),this._intentStates.set(Kt.cacheKey,ee)),ee.streamReaderCancelTimeout&&(clearTimeout(ee.streamReaderCancelTimeout),ee.streamReaderCancelTimeout=null);const de=!!(Kt.renderingIntent&_util.RenderingIntentFlag.PRINT);ee.displayReadyCapability||(ee.displayReadyCapability=new _util.PromiseCapability,ee.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(G=this._stats)==null||G.time("Page Request"),this._pumpOperatorList(Kt));const ge=J=>{var it,lt;ee.renderTasks.delete(gt),(this._maybeCleanupAfterRender||de)&&Wt(this,D,!0),Dt(this,U,Je).call(this,!de),J?(gt.capability.reject(J),this._abortOperatorList({intentState:ee,reason:J instanceof Error?J:new Error(J)})):gt.capability.resolve(),(it=this._stats)==null||it.timeEnd("Rendering"),(lt=this._stats)==null||lt.timeEnd("Overall")},gt=new InternalRenderTask({callback:ge,params:{canvasContext:Y,viewport:At,transform:Lt,background:mt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Vt,operatorList:ee.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!de,pdfBug:this._pdfBug,pageColors:Xt});(ee.renderTasks||(ee.renderTasks=new Set)).add(gt);const z=gt.task;return Promise.all([ee.displayReadyCapability.promise,It]).then(([J,it])=>{var lt;if(this.destroyed){ge();return}(lt=this._stats)==null||lt.time("Rendering"),gt.initializeGraphics({transparency:J,optionalContentConfig:it}),gt.operatorListChanged()}).catch(ge),z}getOperatorList({intent:Y="display",annotationMode:At=_util.AnnotationMode.ENABLE,printAnnotationStorage:ot=null}={}){var Vt;function kt(){mt.operatorList.lastChunk&&(mt.opListReadCapability.resolve(mt.operatorList),mt.renderTasks.delete(It))}const Lt=this._transport.getRenderingIntent(Y,At,ot,!0);let mt=this._intentStates.get(Lt.cacheKey);mt||(mt=Object.create(null),this._intentStates.set(Lt.cacheKey,mt));let It;return mt.opListReadCapability||(It=Object.create(null),It.operatorListChanged=kt,mt.opListReadCapability=new _util.PromiseCapability,(mt.renderTasks||(mt.renderTasks=new Set)).add(It),mt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Vt=this._stats)==null||Vt.time("Page Request"),this._pumpOperatorList(Lt)),mt.opListReadCapability.promise}streamTextContent({includeMarkedContent:Y=!1,disableNormalization:At=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:Y===!0,disableNormalization:At===!0},{highWaterMark:100,size(kt){return kt.items.length}})}getTextContent(Y={}){if(this._transport._htmlForXfa)return this.getXfa().then(ot=>_xfa_text.XfaText.textContent(ot));const At=this.streamTextContent(Y);return new Promise(function(ot,kt){function Lt(){mt.read().then(function({value:Vt,done:Xt}){if(Xt){ot(It);return}Object.assign(It.styles,Vt.styles),It.items.push(...Vt.items),Lt()},kt)}const mt=At.getReader(),It={items:[],styles:Object.create(null)};Lt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const Y=[];for(const At of this._intentStates.values())if(this._abortOperatorList({intentState:At,reason:new Error("Page was destroyed."),force:!0}),!At.opListReadCapability)for(const ot of At.renderTasks)Y.push(ot.completed),ot.cancel();return this.objs.clear(),Wt(this,D,!1),Dt(this,Q,di).call(this),Promise.all(Y)}cleanup(Y=!1){Wt(this,D,!0);const At=Dt(this,U,Je).call(this,!1);return Y&&At&&this._stats&&(this._stats=new _display_utils.StatTimer),At}_startRenderPage(Y,At){var kt,Lt;const ot=this._intentStates.get(At);ot&&((kt=this._stats)==null||kt.timeEnd("Page Request"),(Lt=ot.displayReadyCapability)==null||Lt.resolve(Y))}_renderPageChunk(Y,At){for(let ot=0,kt=Y.length;ot<kt;ot++)At.operatorList.fnArray.push(Y.fnArray[ot]),At.operatorList.argsArray.push(Y.argsArray[ot]);At.operatorList.lastChunk=Y.lastChunk,At.operatorList.separateAnnots=Y.separateAnnots;for(const ot of At.renderTasks)ot.operatorListChanged();Y.lastChunk&&Dt(this,U,Je).call(this,!0)}_pumpOperatorList({renderingIntent:Y,cacheKey:At,annotationStorageSerializable:ot}){const{map:kt,transfers:Lt}=ot,It=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:Y,cacheKey:At,annotationStorage:kt},Lt).getReader(),Vt=this._intentStates.get(At);Vt.streamReader=It;const Xt=()=>{It.read().then(({value:Mt,done:Kt})=>{if(Kt){Vt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Mt,Vt),Xt())},Mt=>{if(Vt.streamReader=null,!this._transport.destroyed){if(Vt.operatorList){Vt.operatorList.lastChunk=!0;for(const Kt of Vt.renderTasks)Kt.operatorListChanged();Dt(this,U,Je).call(this,!0)}if(Vt.displayReadyCapability)Vt.displayReadyCapability.reject(Mt);else if(Vt.opListReadCapability)Vt.opListReadCapability.reject(Mt);else throw Mt}})};Xt()}_abortOperatorList({intentState:Y,reason:At,force:ot=!1}){if(Y.streamReader){if(Y.streamReaderCancelTimeout&&(clearTimeout(Y.streamReaderCancelTimeout),Y.streamReaderCancelTimeout=null),!ot){if(Y.renderTasks.size>0)return;if(At instanceof _display_utils.RenderingCancelledException){let kt=RENDERING_CANCELLED_TIMEOUT;At.extraDelay>0&&At.extraDelay<1e3&&(kt+=At.extraDelay),Y.streamReaderCancelTimeout=setTimeout(()=>{Y.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:Y,reason:At,force:!0})},kt);return}}if(Y.streamReader.cancel(new _util.AbortException(At.message)).catch(()=>{}),Y.streamReader=null,!this._transport.destroyed){for(const[kt,Lt]of this._intentStates)if(Lt===Y){this._intentStates.delete(kt);break}this.cleanup()}}}get stats(){return this._stats}}O=new WeakMap,D=new WeakMap,U=new WeakSet,Je=function(Y=!1){if(Dt(this,Q,di).call(this),!W(this,D)||this.destroyed)return!1;if(Y)return Wt(this,O,setTimeout(()=>{Wt(this,O,null),Dt(this,U,Je).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:At,operatorList:ot}of this._intentStates.values())if(At.size>0||!ot.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Wt(this,D,!1),!0},Q=new WeakSet,di=function(){W(this,O)&&(clearTimeout(W(this,O)),Wt(this,O,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Pt(this,ht,new Set);Pt(this,dt,Promise.resolve())}postMessage(Y,At){const ot={data:structuredClone(Y,At?{transfer:At}:null)};W(this,dt).then(()=>{for(const kt of W(this,ht))kt.call(this,ot)})}addEventListener(Y,At){W(this,ht).add(At)}removeEventListener(Y,At){W(this,ht).delete(At)}terminate(){W(this,ht).clear()}}ht=new WeakMap,dt=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const at=(st=document==null?void 0:document.currentScript)==null?void 0:st.src;at&&(PDFWorkerUtil.fallbackWorkerSrc=at.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(at,Y){let At;try{if(At=new URL(at),!At.origin||At.origin==="null")return!1}catch{return!1}const ot=new URL(Y,At);return At.origin===ot.origin},PDFWorkerUtil.createCDNWrapper=function(at){const Y=`importScripts("${at}");`;return URL.createObjectURL(new Blob([Y]))}}const _PDFWorker=class _PDFWorker{constructor({name:at=null,port:Y=null,verbosity:At=(0,_util.getVerbosityLevel)()}={}){var ot;if(this.name=at,this.destroyed=!1,this.verbosity=At,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,Y){if((ot=W(_PDFWorker,yt))!=null&&ot.has(Y))throw new Error("Cannot use more than one PDFWorker per port.");(W(_PDFWorker,yt)||Wt(_PDFWorker,yt,new WeakMap)).set(Y,this),this._initializeFromPort(Y);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(at){this._port=at,this._messageHandler=new _message_handler.MessageHandler("main","worker",at),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:at}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,at)||(at=PDFWorkerUtil.createCDNWrapper(new URL(at,window.location).href));const Y=new Worker(at),At=new _message_handler.MessageHandler("main","worker",Y),ot=()=>{Y.removeEventListener("error",kt),At.destroy(),Y.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},kt=()=>{this._webWorker||ot()};Y.addEventListener("error",kt),At.on("test",mt=>{if(Y.removeEventListener("error",kt),this.destroyed){ot();return}mt?(this._messageHandler=At,this._port=Y,this._webWorker=Y,this._readyCapability.resolve(),At.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),At.destroy(),Y.terminate())}),At.on("ready",mt=>{if(Y.removeEventListener("error",kt),this.destroyed){ot();return}try{Lt()}catch{this._setupFakeWorker()}});const Lt=()=>{const mt=new Uint8Array;At.send("test",mt,[mt.buffer])};Lt();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(at=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const Y=new LoopbackPort;this._port=Y;const At=`fake${PDFWorkerUtil.fakeWorkerId++}`,ot=new _message_handler.MessageHandler(At+"_worker",At,Y);at.setup(ot,Y);const kt=new _message_handler.MessageHandler(At,At+"_worker",Y);this._messageHandler=kt,this._readyCapability.resolve(),kt.send("configure",{verbosity:this.verbosity})}).catch(at=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${at.message}".`))})}destroy(){var at;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(at=W(_PDFWorker,yt))==null||at.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(at){var At;if(!(at!=null&&at.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const Y=(At=W(this,yt))==null?void 0:At.get(at.port);if(Y){if(Y._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return Y}return new _PDFWorker(at)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var at;try{return((at=globalThis.pdfjsWorker)==null?void 0:at.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};yt=new WeakMap,Pt(_PDFWorker,yt,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(Y,At,ot,kt,Lt){Pt(this,nt);Pt(this,Tt,new Map);Pt(this,vt,new Map);Pt(this,ut,new Map);Pt(this,ft,null);this.messageHandler=Y,this.loadingTask=At,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:kt.ownerDocument,styleElement:kt.styleElement}),this._params=kt,this.canvasFactory=Lt.canvasFactory,this.filterFactory=Lt.filterFactory,this.cMapReaderFactory=Lt.cMapReaderFactory,this.standardFontDataFactory=Lt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=ot,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(Y,At=_util.AnnotationMode.ENABLE,ot=null,kt=!1){let Lt=_util.RenderingIntentFlag.DISPLAY,mt=_annotation_storage.SerializableEmpty;switch(Y){case"any":Lt=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Lt=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${Y}`)}switch(At){case _util.AnnotationMode.DISABLE:Lt+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Lt+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Lt+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,mt=(Lt&_util.RenderingIntentFlag.PRINT&&ot instanceof _annotation_storage.PrintAnnotationStorage?ot:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${At}`)}return kt&&(Lt+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Lt,cacheKey:`${Lt}_${mt.hash}`,annotationStorageSerializable:mt}}destroy(){var ot;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(ot=W(this,ft))==null||ot.reject(new Error("Worker was destroyed during onPassword callback"));const Y=[];for(const kt of W(this,vt).values())Y.push(kt._destroy());W(this,vt).clear(),W(this,ut).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const At=this.messageHandler.sendWithPromise("Terminate",null);return Y.push(At),Promise.all(Y).then(()=>{var kt;this.commonObjs.clear(),this.fontLoader.clear(),W(this,Tt).clear(),this.filterFactory.destroy(),(kt=this._networkStream)==null||kt.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:Y,loadingTask:At}=this;Y.on("GetReader",(ot,kt)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Lt=>{this._lastProgress={loaded:Lt.loaded,total:Lt.total}},kt.onPull=()=>{this._fullReader.read().then(function({value:Lt,done:mt}){if(mt){kt.close();return}(0,_util.assert)(Lt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),kt.enqueue(new Uint8Array(Lt),1,[Lt])}).catch(Lt=>{kt.error(Lt)})},kt.onCancel=Lt=>{this._fullReader.cancel(Lt),kt.ready.catch(mt=>{if(!this.destroyed)throw mt})}}),Y.on("ReaderHeadersReady",ot=>{const kt=new _util.PromiseCapability,Lt=this._fullReader;return Lt.headersReady.then(()=>{var mt;(!Lt.isStreamingSupported||!Lt.isRangeSupported)&&(this._lastProgress&&((mt=At.onProgress)==null||mt.call(At,this._lastProgress)),Lt.onProgress=It=>{var Vt;(Vt=At.onProgress)==null||Vt.call(At,{loaded:It.loaded,total:It.total})}),kt.resolve({isStreamingSupported:Lt.isStreamingSupported,isRangeSupported:Lt.isRangeSupported,contentLength:Lt.contentLength})},kt.reject),kt.promise}),Y.on("GetRangeReader",(ot,kt)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Lt=this._networkStream.getRangeReader(ot.begin,ot.end);if(!Lt){kt.close();return}kt.onPull=()=>{Lt.read().then(function({value:mt,done:It}){if(It){kt.close();return}(0,_util.assert)(mt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),kt.enqueue(new Uint8Array(mt),1,[mt])}).catch(mt=>{kt.error(mt)})},kt.onCancel=mt=>{Lt.cancel(mt),kt.ready.catch(It=>{if(!this.destroyed)throw It})}}),Y.on("GetDoc",({pdfInfo:ot})=>{this._numPages=ot.numPages,this._htmlForXfa=ot.htmlForXfa,delete ot.htmlForXfa,At._capability.resolve(new PDFDocumentProxy(ot,this))}),Y.on("DocException",function(ot){let kt;switch(ot.name){case"PasswordException":kt=new _util.PasswordException(ot.message,ot.code);break;case"InvalidPDFException":kt=new _util.InvalidPDFException(ot.message);break;case"MissingPDFException":kt=new _util.MissingPDFException(ot.message);break;case"UnexpectedResponseException":kt=new _util.UnexpectedResponseException(ot.message,ot.status);break;case"UnknownErrorException":kt=new _util.UnknownErrorException(ot.message,ot.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}At._capability.reject(kt)}),Y.on("PasswordRequest",ot=>{if(Wt(this,ft,new _util.PromiseCapability),At.onPassword){const kt=Lt=>{Lt instanceof Error?W(this,ft).reject(Lt):W(this,ft).resolve({password:Lt})};try{At.onPassword(kt,ot.code)}catch(Lt){W(this,ft).reject(Lt)}}else W(this,ft).reject(new _util.PasswordException(ot.message,ot.code));return W(this,ft).promise}),Y.on("DataLoaded",ot=>{var kt;(kt=At.onProgress)==null||kt.call(At,{loaded:ot.length,total:ot.length}),this.downloadInfoCapability.resolve(ot)}),Y.on("StartRenderPage",ot=>{if(this.destroyed)return;W(this,vt).get(ot.pageIndex)._startRenderPage(ot.transparency,ot.cacheKey)}),Y.on("commonobj",([ot,kt,Lt])=>{var mt;if(!this.destroyed&&!this.commonObjs.has(ot))switch(kt){case"Font":const It=this._params;if("error"in Lt){const Mt=Lt.error;(0,_util.warn)(`Error during font loading: ${Mt}`),this.commonObjs.resolve(ot,Mt);break}const Vt=It.pdfBug&&((mt=globalThis.FontInspector)!=null&&mt.enabled)?(Mt,Kt)=>globalThis.FontInspector.fontAdded(Mt,Kt):null,Xt=new _font_loader.FontFaceObject(Lt,{isEvalSupported:It.isEvalSupported,disableFontFace:It.disableFontFace,ignoreErrors:It.ignoreErrors,inspectFont:Vt});this.fontLoader.bind(Xt).catch(Mt=>Y.sendWithPromise("FontFallback",{id:ot})).finally(()=>{!It.fontExtraProperties&&Xt.data&&(Xt.data=null),this.commonObjs.resolve(ot,Xt)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(ot,Lt);break;default:throw new Error(`Got unknown common object type ${kt}`)}}),Y.on("obj",([ot,kt,Lt,mt])=>{var Vt;if(this.destroyed)return;const It=W(this,vt).get(kt);if(!It.objs.has(ot))switch(Lt){case"Image":if(It.objs.resolve(ot,mt),mt){let Xt;if(mt.bitmap){const{width:Mt,height:Kt}=mt;Xt=Mt*Kt*4}else Xt=((Vt=mt.data)==null?void 0:Vt.length)||0;Xt>_util.MAX_IMAGE_SIZE_TO_CACHE&&(It._maybeCleanupAfterRender=!0)}break;case"Pattern":It.objs.resolve(ot,mt);break;default:throw new Error(`Got unknown object type ${Lt}`)}}),Y.on("DocProgress",ot=>{var kt;this.destroyed||(kt=At.onProgress)==null||kt.call(At,{loaded:ot.loaded,total:ot.total})}),Y.on("FetchBuiltInCMap",ot=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(ot):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),Y.on("FetchStandardFontData",ot=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(ot):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var ot;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:Y,transfers:At}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:Y,filename:((ot=this._fullReader)==null?void 0:ot.filename)??null},At).finally(()=>{this.annotationStorage.resetModified()})}getPage(Y){if(!Number.isInteger(Y)||Y<=0||Y>this._numPages)return Promise.reject(new Error("Invalid page request."));const At=Y-1,ot=W(this,ut).get(At);if(ot)return ot;const kt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:At}).then(Lt=>{if(this.destroyed)throw new Error("Transport destroyed");const mt=new PDFPageProxy(At,Lt,this,this._params.pdfBug);return W(this,vt).set(At,mt),mt});return W(this,ut).set(At,kt),kt}getPageIndex(Y){return typeof Y!="object"||Y===null||!Number.isInteger(Y.num)||Y.num<0||!Number.isInteger(Y.gen)||Y.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:Y.num,gen:Y.gen})}getAnnotations(Y,At){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:Y,intent:At})}getFieldObjects(){return Dt(this,nt,pi).call(this,"GetFieldObjects")}hasJSActions(){return Dt(this,nt,pi).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(Y){return typeof Y!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:Y})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Dt(this,nt,pi).call(this,"GetDocJSActions")}getPageJSActions(Y){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:Y})}getStructTree(Y){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:Y})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(Y=>new _optional_content_config.OptionalContentConfig(Y))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const Y="GetMetadata",At=W(this,Tt).get(Y);if(At)return At;const ot=this.messageHandler.sendWithPromise(Y,null).then(kt=>{var Lt,mt;return{info:kt[0],metadata:kt[1]?new _metadata.Metadata(kt[1]):null,contentDispositionFilename:((Lt=this._fullReader)==null?void 0:Lt.filename)??null,contentLength:((mt=this._fullReader)==null?void 0:mt.contentLength)??null}});return W(this,Tt).set(Y,ot),ot}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(Y=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const At of W(this,vt).values())if(!At.cleanup())throw new Error(`startCleanup: Page ${At.pageNumber} is currently rendering.`);this.commonObjs.clear(),Y||this.fontLoader.clear(),W(this,Tt).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:Y,enableXfa:At}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:Y,enableXfa:At})}}Tt=new WeakMap,vt=new WeakMap,ut=new WeakMap,ft=new WeakMap,nt=new WeakSet,pi=function(Y,At=null){const ot=W(this,Tt).get(Y);if(ot)return ot;const kt=this.messageHandler.sendWithPromise(Y,At);return W(this,Tt).set(Y,kt),kt};class PDFObjects{constructor(){Pt(this,_t);Pt(this,bt,Object.create(null))}get(Y,At=null){if(At){const kt=Dt(this,_t,Pi).call(this,Y);return kt.capability.promise.then(()=>At(kt.data)),null}const ot=W(this,bt)[Y];if(!(ot!=null&&ot.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${Y}.`);return ot.data}has(Y){const At=W(this,bt)[Y];return(At==null?void 0:At.capability.settled)||!1}resolve(Y,At=null){const ot=Dt(this,_t,Pi).call(this,Y);ot.data=At,ot.capability.resolve()}clear(){var Y;for(const At in W(this,bt)){const{data:ot}=W(this,bt)[At];(Y=ot==null?void 0:ot.bitmap)==null||Y.close()}Wt(this,bt,Object.create(null))}}bt=new WeakMap,_t=new WeakSet,Pi=function(Y){var At;return(At=W(this,bt))[Y]||(At[Y]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(Y){Pt(this,K,null);Wt(this,K,Y),this.onContinue=null}get promise(){return W(this,K).capability.promise}cancel(Y=0){W(this,K).cancel(null,Y)}get separateAnnots(){const{separateAnnots:Y}=W(this,K).operatorList;if(!Y)return!1;const{annotationCanvasMap:At}=W(this,K);return Y.form||Y.canvas&&(At==null?void 0:At.size)>0}}K=new WeakMap,exports.RenderTask=RenderTask;const St=class St{constructor({callback:Y,params:At,objs:ot,commonObjs:kt,annotationCanvasMap:Lt,operatorList:mt,pageIndex:It,canvasFactory:Vt,filterFactory:Xt,useRequestAnimationFrame:Mt=!1,pdfBug:Kt=!1,pageColors:ee=null}){this.callback=Y,this.params=At,this.objs=ot,this.commonObjs=kt,this.annotationCanvasMap=Lt,this.operatorListIdx=null,this.operatorList=mt,this._pageIndex=It,this.canvasFactory=Vt,this.filterFactory=Xt,this._pdfBug=Kt,this.pageColors=ee,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Mt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=At.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:Y=!1,optionalContentConfig:At}){var It,Vt;if(this.cancelled)return;if(this._canvas){if(W(St,et).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");W(St,et).add(this._canvas)}this._pdfBug&&((It=globalThis.StepperManager)!=null&&It.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:ot,viewport:kt,transform:Lt,background:mt}=this.params;this.gfx=new _canvas.CanvasGraphics(ot,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:At},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Lt,viewport:kt,transparency:Y,background:mt}),this.operatorListIdx=0,this.graphicsReady=!0,(Vt=this.graphicsReadyCallback)==null||Vt.call(this)}cancel(Y=null,At=0){var ot;this.running=!1,this.cancelled=!0,(ot=this.gfx)==null||ot.endDrawing(),W(St,et).delete(this._canvas),this.callback(Y||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,At))}operatorListChanged(){var Y;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(Y=this.stepper)==null||Y.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),W(St,et).delete(this._canvas),this.callback())))}};et=new WeakMap,Pt(St,et,new WeakSet);let InternalRenderTask=St;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(B,F,O)=>{var dt,st,yt,cs,vt;Object.defineProperty(F,"__esModule",{value:!0}),F.SerializableEmpty=F.PrintAnnotationStorage=F.AnnotationStorage=void 0;var D=O(1),U=O(4),tt=O(8);const Q=Object.freeze({map:null,hash:"",transfers:void 0});F.SerializableEmpty=Q;class Ft{constructor(){Pt(this,yt);Pt(this,dt,!1);Pt(this,st,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(ft,nt){const ct=W(this,st).get(ft);return ct===void 0?nt:Object.assign(nt,ct)}getRawValue(ft){return W(this,st).get(ft)}remove(ft){if(W(this,st).delete(ft),W(this,st).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const nt of W(this,st).values())if(nt instanceof U.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(ft,nt){const ct=W(this,st).get(ft);let bt=!1;if(ct!==void 0)for(const[_t,pt]of Object.entries(nt))ct[_t]!==pt&&(bt=!0,ct[_t]=pt);else bt=!0,W(this,st).set(ft,nt);bt&&Dt(this,yt,cs).call(this),nt instanceof U.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(nt.constructor._type)}has(ft){return W(this,st).has(ft)}getAll(){return W(this,st).size>0?(0,D.objectFromMap)(W(this,st)):null}setAll(ft){for(const[nt,ct]of Object.entries(ft))this.setValue(nt,ct)}get size(){return W(this,st).size}resetModified(){W(this,dt)&&(Wt(this,dt,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ht(this)}get serializable(){if(W(this,st).size===0)return Q;const ft=new Map,nt=new tt.MurmurHash3_64,ct=[],bt=Object.create(null);let _t=!1;for(const[pt,K]of W(this,st)){const et=K instanceof U.AnnotationEditor?K.serialize(!1,bt):K;et&&(ft.set(pt,et),nt.update(`${pt}:${JSON.stringify(et)}`),_t||(_t=!!et.bitmap))}if(_t)for(const pt of ft.values())pt.bitmap&&ct.push(pt.bitmap);return ft.size>0?{map:ft,hash:nt.hexdigest(),transfers:ct}:Q}}dt=new WeakMap,st=new WeakMap,yt=new WeakSet,cs=function(){W(this,dt)||(Wt(this,dt,!0),typeof this.onSetModified=="function"&&this.onSetModified())},F.AnnotationStorage=Ft;class ht extends Ft{constructor(nt){super();Pt(this,vt,void 0);const{map:ct,hash:bt,transfers:_t}=nt.serializable,pt=structuredClone(ct,_t?{transfer:_t}:null);Wt(this,vt,{map:pt,hash:bt,transfers:_t})}get print(){(0,D.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return W(this,vt)}}vt=new WeakMap,F.PrintAnnotationStorage=ht},(B,F,O)=>{var ht,dt,st,yt,Tt,vt,ut,ft,nt,ct,bt,_t,pt,K,et,xi,at,ki,At,Ri,kt,Mi,mt,hs,Vt,ds,Mt,us,ee,Fi,ge,ps;Object.defineProperty(F,"__esModule",{value:!0}),F.AnnotationEditor=void 0;var D=O(5),U=O(1),tt=O(6);const z=class z{constructor(G){Pt(this,et);Pt(this,at);Pt(this,kt);Pt(this,mt);Pt(this,Vt);Pt(this,Mt);Pt(this,ee);Pt(this,ge);Pt(this,ht,"");Pt(this,dt,!1);Pt(this,st,null);Pt(this,yt,null);Pt(this,Tt,null);Pt(this,vt,!1);Pt(this,ut,null);Pt(this,ft,this.focusin.bind(this));Pt(this,nt,this.focusout.bind(this));Pt(this,ct,!1);Pt(this,bt,!1);Pt(this,_t,!1);He(this,"_initialOptions",Object.create(null));He(this,"_uiManager",null);He(this,"_focusEventsAllowed",!0);He(this,"_l10nPromise",null);Pt(this,pt,!1);Pt(this,K,z._zIndex++);this.constructor===z&&(0,U.unreachable)("Cannot initialize AnnotationEditor."),this.parent=G.parent,this.id=G.id,this.width=this.height=null,this.pageIndex=G.parent.pageIndex,this.name=G.name,this.div=null,this._uiManager=G.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=G.isCentered,this._structTreeParentId=null;const{rotation:J,rawDims:{pageWidth:it,pageHeight:lt,pageX:Et,pageY:xt}}=this.parent.viewport;this.rotation=J,this.pageRotation=(360+J-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[it,lt],this.pageTranslation=[Et,xt];const[qt,Ht]=this.parentDimensions;this.x=G.x/qt,this.y=G.y/Ht,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,U.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(G){const J=new Ft({id:G.parent.getNextId(),parent:G.parent,uiManager:G._uiManager});J.annotationElementId=G.annotationElementId,J.deleted=!0,J._uiManager.addToAnnotationStorage(J)}static initialize(G,J=null){if(z._l10nPromise||(z._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(lt=>[lt,G.get(lt)]))),J!=null&&J.strings)for(const lt of J.strings)z._l10nPromise.set(lt,G.get(lt));if(z._borderLineWidth!==-1)return;const it=getComputedStyle(document.documentElement);z._borderLineWidth=parseFloat(it.getPropertyValue("--outline-width"))||0}static updateDefaultParams(G,J){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(G){return!1}static paste(G,J){(0,U.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return W(this,pt)}set _isDraggable(G){var J;Wt(this,pt,G),(J=this.div)==null||J.classList.toggle("draggable",G)}center(){const[G,J]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*J/(G*2),this.y+=this.width*G/(J*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*J/(G*2),this.y-=this.width*G/(J*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(G){this._uiManager.addCommands(G)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=W(this,K)}setParent(G){G!==null&&(this.pageIndex=G.pageIndex,this.pageDimensions=G.pageDimensions),this.parent=G}focusin(G){this._focusEventsAllowed&&(W(this,ct)?Wt(this,ct,!1):this.parent.setSelected(this))}focusout(G){var it;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const J=G.relatedTarget;J!=null&&J.closest(`#${this.id}`)||(G.preventDefault(),(it=this.parent)!=null&&it.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(G,J,it,lt){const[Et,xt]=this.parentDimensions;[it,lt]=this.screenToPageTranslation(it,lt),this.x=(G+it)/Et,this.y=(J+lt)/xt,this.fixAndSetPosition()}translate(G,J){Dt(this,et,xi).call(this,this.parentDimensions,G,J)}translateInPage(G,J){Dt(this,et,xi).call(this,this.pageDimensions,G,J),this.div.scrollIntoView({block:"nearest"})}drag(G,J){const[it,lt]=this.parentDimensions;if(this.x+=G/it,this.y+=J/lt,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Gt,y:Jt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Gt,Jt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:Et,y:xt}=this;const[qt,Ht]=Dt(this,at,ki).call(this);Et+=qt,xt+=Ht,this.div.style.left=`${(100*Et).toFixed(2)}%`,this.div.style.top=`${(100*xt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[G,J]=this.pageDimensions;let{x:it,y:lt,width:Et,height:xt}=this;switch(Et*=G,xt*=J,it*=G,lt*=J,this.rotation){case 0:it=Math.max(0,Math.min(G-Et,it)),lt=Math.max(0,Math.min(J-xt,lt));break;case 90:it=Math.max(0,Math.min(G-xt,it)),lt=Math.min(J,Math.max(Et,lt));break;case 180:it=Math.min(G,Math.max(Et,it)),lt=Math.min(J,Math.max(xt,lt));break;case 270:it=Math.min(G,Math.max(xt,it)),lt=Math.max(0,Math.min(J-Et,lt));break}this.x=it/=G,this.y=lt/=J;const[qt,Ht]=Dt(this,at,ki).call(this);it+=qt,lt+=Ht;const{style:Gt}=this.div;Gt.left=`${(100*it).toFixed(2)}%`,Gt.top=`${(100*lt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(G,J){var it;return Dt(it=z,At,Ri).call(it,G,J,this.parentRotation)}pageTranslationToScreen(G,J){var it;return Dt(it=z,At,Ri).call(it,G,J,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:G,pageDimensions:[J,it]}=this,lt=J*G,Et=it*G;return U.FeatureTest.isCSSRoundSupported?[Math.round(lt),Math.round(Et)]:[lt,Et]}setDims(G,J){var Et;const[it,lt]=this.parentDimensions;this.div.style.width=`${(100*G/it).toFixed(2)}%`,W(this,vt)||(this.div.style.height=`${(100*J/lt).toFixed(2)}%`),(Et=W(this,st))==null||Et.classList.toggle("small",G<z.SMALL_EDITOR_SIZE||J<z.SMALL_EDITOR_SIZE)}fixDims(){const{style:G}=this.div,{height:J,width:it}=G,lt=it.endsWith("%"),Et=!W(this,vt)&&J.endsWith("%");if(lt&&Et)return;const[xt,qt]=this.parentDimensions;lt||(G.width=`${(100*parseFloat(it)/xt).toFixed(2)}%`),!W(this,vt)&&!Et&&(G.height=`${(100*parseFloat(J)/qt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(W(this,st))return;const G=Wt(this,st,document.createElement("button"));G.className="altText";const J=await z._l10nPromise.get("editor_alt_text_button_label");G.textContent=J,G.setAttribute("aria-label",J),G.tabIndex="0",G.addEventListener("contextmenu",tt.noContextMenu),G.addEventListener("pointerdown",it=>it.stopPropagation()),G.addEventListener("click",it=>{it.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),G.addEventListener("keydown",it=>{it.target===G&&it.key==="Enter"&&(it.preventDefault(),this._uiManager.editAltText(this))}),Dt(this,ee,Fi).call(this),this.div.append(G),z.SMALL_EDITOR_SIZE||(z.SMALL_EDITOR_SIZE=Math.min(128,Math.round(G.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:W(this,ht),decorative:W(this,dt)}}set altTextData({altText:G,decorative:J}){W(this,ht)===G&&W(this,dt)===J||(Wt(this,ht,G),Wt(this,dt,J),Dt(this,ee,Fi).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",W(this,ft)),this.div.addEventListener("focusout",W(this,nt));const[G,J]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*J/G).toFixed(2)}%`,this.div.style.maxHeight=`${(100*G/J).toFixed(2)}%`);const[it,lt]=this.getInitialTranslation();return this.translate(it,lt),(0,D.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(G){const{isMac:J}=U.FeatureTest.platform;if(G.button!==0||G.ctrlKey&&J){G.preventDefault();return}Wt(this,ct,!0),Dt(this,ge,ps).call(this,G)}moveInDOM(){var G;(G=this.parent)==null||G.moveEditorInDOM(this)}_setParentAndPosition(G,J,it){G.changeParent(this),this.x=J,this.y=it,this.fixAndSetPosition()}getRect(G,J){const it=this.parentScale,[lt,Et]=this.pageDimensions,[xt,qt]=this.pageTranslation,Ht=G/it,Gt=J/it,Jt=this.x*lt,oe=this.y*Et,Zt=this.width*lt,be=this.height*Et;switch(this.rotation){case 0:return[Jt+Ht+xt,Et-oe-Gt-be+qt,Jt+Ht+Zt+xt,Et-oe-Gt+qt];case 90:return[Jt+Gt+xt,Et-oe+Ht+qt,Jt+Gt+be+xt,Et-oe+Ht+Zt+qt];case 180:return[Jt-Ht-Zt+xt,Et-oe+Gt+qt,Jt-Ht+xt,Et-oe+Gt+be+qt];case 270:return[Jt-Gt-be+xt,Et-oe-Ht-Zt+qt,Jt-Gt+xt,Et-oe-Ht+qt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(G,J){const[it,lt,Et,xt]=G,qt=Et-it,Ht=xt-lt;switch(this.rotation){case 0:return[it,J-xt,qt,Ht];case 90:return[it,J-lt,Ht,qt];case 180:return[Et,J-lt,qt,Ht];case 270:return[Et,J-xt,Ht,qt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Wt(this,_t,!0)}disableEditMode(){Wt(this,_t,!1)}isInEditMode(){return W(this,_t)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var G,J;(G=this.div)==null||G.addEventListener("focusin",W(this,ft)),(J=this.div)==null||J.addEventListener("focusout",W(this,nt))}serialize(G=!1,J=null){(0,U.unreachable)("An editor must be serializable")}static deserialize(G,J,it){const lt=new this.prototype.constructor({parent:J,id:J.getNextId(),uiManager:it});lt.rotation=G.rotation;const[Et,xt]=lt.pageDimensions,[qt,Ht,Gt,Jt]=lt.getRectInCurrentCoords(G.rect,xt);return lt.x=qt/Et,lt.y=Ht/xt,lt.width=Gt/Et,lt.height=Jt/xt,lt}remove(){var G;this.div.removeEventListener("focusin",W(this,ft)),this.div.removeEventListener("focusout",W(this,nt)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(G=W(this,st))==null||G.remove(),Wt(this,st,null),Wt(this,yt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Dt(this,mt,hs).call(this),W(this,ut).classList.remove("hidden"))}select(){var G;this.makeResizable(),(G=this.div)==null||G.classList.add("selectedEditor")}unselect(){var G,J,it;(G=W(this,ut))==null||G.classList.add("hidden"),(J=this.div)==null||J.classList.remove("selectedEditor"),(it=this.div)!=null&&it.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(G,J){}disableEditing(){W(this,st)&&(W(this,st).hidden=!0)}enableEditing(){W(this,st)&&(W(this,st).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return W(this,bt)}set isEditing(G){Wt(this,bt,G),this.parent&&(G?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(G,J){Wt(this,vt,!0);const it=G/J,{style:lt}=this.div;lt.aspectRatio=it,lt.height="auto"}static get MIN_SIZE(){return 16}};ht=new WeakMap,dt=new WeakMap,st=new WeakMap,yt=new WeakMap,Tt=new WeakMap,vt=new WeakMap,ut=new WeakMap,ft=new WeakMap,nt=new WeakMap,ct=new WeakMap,bt=new WeakMap,_t=new WeakMap,pt=new WeakMap,K=new WeakMap,et=new WeakSet,xi=function([G,J],it,lt){[it,lt]=this.screenToPageTranslation(it,lt),this.x+=it/G,this.y+=lt/J,this.fixAndSetPosition()},at=new WeakSet,ki=function(){const[G,J]=this.parentDimensions,{_borderLineWidth:it}=z,lt=it/G,Et=it/J;switch(this.rotation){case 90:return[-lt,Et];case 180:return[lt,Et];case 270:return[lt,-Et];default:return[-lt,-Et]}},At=new WeakSet,Ri=function(G,J,it){switch(it){case 90:return[J,-G];case 180:return[-G,-J];case 270:return[-J,G];default:return[G,J]}},kt=new WeakSet,Mi=function(G){switch(G){case 90:{const[J,it]=this.pageDimensions;return[0,-J/it,it/J,0]}case 180:return[-1,0,0,-1];case 270:{const[J,it]=this.pageDimensions;return[0,J/it,-it/J,0]}default:return[1,0,0,1]}},mt=new WeakSet,hs=function(){if(W(this,ut))return;Wt(this,ut,document.createElement("div")),W(this,ut).classList.add("resizers");const G=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||G.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const J of G){const it=document.createElement("div");W(this,ut).append(it),it.classList.add("resizer",J),it.addEventListener("pointerdown",Dt(this,Vt,ds).bind(this,J)),it.addEventListener("contextmenu",tt.noContextMenu)}this.div.prepend(W(this,ut))},Vt=new WeakSet,ds=function(G,J){J.preventDefault();const{isMac:it}=U.FeatureTest.platform;if(J.button!==0||J.ctrlKey&&it)return;const lt=Dt(this,Mt,us).bind(this,G),Et=this._isDraggable;this._isDraggable=!1;const xt={passive:!0,capture:!0};window.addEventListener("pointermove",lt,xt);const qt=this.x,Ht=this.y,Gt=this.width,Jt=this.height,oe=this.parent.div.style.cursor,Zt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(J.target).cursor;const be=()=>{this._isDraggable=Et,window.removeEventListener("pointerup",be),window.removeEventListener("blur",be),window.removeEventListener("pointermove",lt,xt),this.parent.div.style.cursor=oe,this.div.style.cursor=Zt;const Ce=this.x,ce=this.y,Ae=this.width,te=this.height;Ce===qt&&ce===Ht&&Ae===Gt&&te===Jt||this.addCommands({cmd:()=>{this.width=Ae,this.height=te,this.x=Ce,this.y=ce;const[Ut,jt]=this.parentDimensions;this.setDims(Ut*Ae,jt*te),this.fixAndSetPosition()},undo:()=>{this.width=Gt,this.height=Jt,this.x=qt,this.y=Ht;const[Ut,jt]=this.parentDimensions;this.setDims(Ut*Gt,jt*Jt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",be),window.addEventListener("blur",be)},Mt=new WeakSet,us=function(G,J){const[it,lt]=this.parentDimensions,Et=this.x,xt=this.y,qt=this.width,Ht=this.height,Gt=z.MIN_SIZE/it,Jt=z.MIN_SIZE/lt,oe=se=>Math.round(se*1e4)/1e4,Zt=Dt(this,kt,Mi).call(this,this.rotation),be=(se,ae)=>[Zt[0]*se+Zt[2]*ae,Zt[1]*se+Zt[3]*ae],Ce=Dt(this,kt,Mi).call(this,360-this.rotation),ce=(se,ae)=>[Ce[0]*se+Ce[2]*ae,Ce[1]*se+Ce[3]*ae];let Ae,te,Ut=!1,jt=!1;switch(G){case"topLeft":Ut=!0,Ae=(se,ae)=>[0,0],te=(se,ae)=>[se,ae];break;case"topMiddle":Ae=(se,ae)=>[se/2,0],te=(se,ae)=>[se/2,ae];break;case"topRight":Ut=!0,Ae=(se,ae)=>[se,0],te=(se,ae)=>[0,ae];break;case"middleRight":jt=!0,Ae=(se,ae)=>[se,ae/2],te=(se,ae)=>[0,ae/2];break;case"bottomRight":Ut=!0,Ae=(se,ae)=>[se,ae],te=(se,ae)=>[0,0];break;case"bottomMiddle":Ae=(se,ae)=>[se/2,ae],te=(se,ae)=>[se/2,0];break;case"bottomLeft":Ut=!0,Ae=(se,ae)=>[0,ae],te=(se,ae)=>[se,0];break;case"middleLeft":jt=!0,Ae=(se,ae)=>[0,ae/2],te=(se,ae)=>[se,ae/2];break}const Qt=Ae(qt,Ht),he=te(qt,Ht);let ue=be(...he);const Pe=oe(Et+ue[0]),Re=oe(xt+ue[1]);let xe=1,Fe=1,[De,ke]=this.screenToPageTranslation(J.movementX,J.movementY);if([De,ke]=ce(De/it,ke/lt),Ut){const se=Math.hypot(qt,Ht);xe=Fe=Math.max(Math.min(Math.hypot(he[0]-Qt[0]-De,he[1]-Qt[1]-ke)/se,1/qt,1/Ht),Gt/qt,Jt/Ht)}else jt?xe=Math.max(Gt,Math.min(1,Math.abs(he[0]-Qt[0]-De)))/qt:Fe=Math.max(Jt,Math.min(1,Math.abs(he[1]-Qt[1]-ke)))/Ht;const Le=oe(qt*xe),Yt=oe(Ht*Fe);ue=be(...te(Le,Yt));const Bt=Pe-ue[0],Ot=Re-ue[1];this.width=Le,this.height=Yt,this.x=Bt,this.y=Ot,this.setDims(it*Le,lt*Yt),this.fixAndSetPosition()},ee=new WeakSet,Fi=async function(){var it;const G=W(this,st);if(!G)return;if(!W(this,ht)&&!W(this,dt)){G.classList.remove("done"),(it=W(this,yt))==null||it.remove();return}z._l10nPromise.get("editor_alt_text_edit_button_label").then(lt=>{G.setAttribute("aria-label",lt)});let J=W(this,yt);if(!J){Wt(this,yt,J=document.createElement("span")),J.className="tooltip",J.setAttribute("role","tooltip");const lt=J.id=`alt-text-tooltip-${this.id}`;G.setAttribute("aria-describedby",lt);const Et=100;G.addEventListener("mouseenter",()=>{Wt(this,Tt,setTimeout(()=>{Wt(this,Tt,null),W(this,yt).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},Et))}),G.addEventListener("mouseleave",()=>{var xt;clearTimeout(W(this,Tt)),Wt(this,Tt,null),(xt=W(this,yt))==null||xt.classList.remove("show")})}G.classList.add("done"),J.innerText=W(this,dt)?await z._l10nPromise.get("editor_alt_text_decorative_tooltip"):W(this,ht),J.parentNode||G.append(J)},ge=new WeakSet,ps=function(G){if(!this._isDraggable)return;const J=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let it,lt;J&&(it={passive:!0,capture:!0},lt=xt=>{const[qt,Ht]=this.screenToPageTranslation(xt.movementX,xt.movementY);this._uiManager.dragSelectedEditors(qt,Ht)},window.addEventListener("pointermove",lt,it));const Et=()=>{if(window.removeEventListener("pointerup",Et),window.removeEventListener("blur",Et),J&&window.removeEventListener("pointermove",lt,it),Wt(this,ct,!1),!this._uiManager.endDragSession()){const{isMac:xt}=U.FeatureTest.platform;G.ctrlKey&&!xt||G.shiftKey||G.metaKey&&xt?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",Et),window.addEventListener("blur",Et)},Pt(z,At),He(z,"_borderLineWidth",-1),He(z,"_colorManager",new D.ColorManager),He(z,"_zIndex",1),He(z,"SMALL_EDITOR_SIZE",0);let Q=z;F.AnnotationEditor=Q;class Ft extends Q{constructor(G){super(G),this.annotationElementId=G.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(B,F,O)=>{var vt,ut,ft,nt,ct,Di,pt,K,et,St,at,gs,ot,kt,Lt,mt,It,Vt,Xt,Mt,Kt,ee,de,ge,gt,z,X,G,J,it,lt,Et,xt,qt,Ht,Gt,Jt,oe,Zt,be,Ce,ce,Ae,te,Ut,jt,Qt,ms,ue,Oi,Re,Li,Fe,fi,ke,Ii,Yt,Ni,Ot,Ve,ae,ni,Ue,bs,le,_s,pe,$i,we,ri,ne,Bi;Object.defineProperty(F,"__esModule",{value:!0}),F.KeyboardManager=F.CommandManager=F.ColorManager=F.AnnotationEditorUIManager=void 0,F.bindEvents=tt,F.opacityToHex=Q;var D=O(1),U=O(6);function tt(wt,q,rt){for(const Ct of rt)q.addEventListener(Ct,wt[Ct].bind(wt))}function Q(wt){return Math.round(Math.min(255,Math.max(1,255*wt))).toString(16).padStart(2,"0")}class Ft{constructor(){Pt(this,vt,0)}getId(){return`${D.AnnotationEditorPrefix}${si(this,vt)._++}`}}vt=new WeakMap;const _t=class _t{constructor(){Pt(this,ct);Pt(this,ut,(0,D.getUuid)());Pt(this,ft,0);Pt(this,nt,null)}static get _isSVGFittingCanvas(){const q='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ct=new OffscreenCanvas(1,3).getContext("2d"),Rt=new Image;Rt.src=q;const Nt=Rt.decode().then(()=>(Ct.drawImage(Rt,0,0,1,1,0,0,1,3),new Uint32Array(Ct.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,D.shadow)(this,"_isSVGFittingCanvas",Nt)}async getFromFile(q){const{lastModified:rt,name:Ct,size:Rt,type:Nt}=q;return Dt(this,ct,Di).call(this,`${rt}_${Ct}_${Rt}_${Nt}`,q)}async getFromUrl(q){return Dt(this,ct,Di).call(this,q,q)}async getFromId(q){W(this,nt)||Wt(this,nt,new Map);const rt=W(this,nt).get(q);return rt?rt.bitmap?(rt.refCounter+=1,rt):rt.file?this.getFromFile(rt.file):this.getFromUrl(rt.url):null}getSvgUrl(q){const rt=W(this,nt).get(q);return rt!=null&&rt.isSvg?rt.svgUrl:null}deleteId(q){W(this,nt)||Wt(this,nt,new Map);const rt=W(this,nt).get(q);rt&&(rt.refCounter-=1,rt.refCounter===0&&(rt.bitmap=null))}isValidId(q){return q.startsWith(`image_${W(this,ut)}_`)}};ut=new WeakMap,ft=new WeakMap,nt=new WeakMap,ct=new WeakSet,Di=async function(q,rt){W(this,nt)||Wt(this,nt,new Map);let Ct=W(this,nt).get(q);if(Ct===null)return null;if(Ct!=null&&Ct.bitmap)return Ct.refCounter+=1,Ct;try{Ct||(Ct={bitmap:null,id:`image_${W(this,ut)}_${si(this,ft)._++}`,refCounter:0,isSvg:!1});let Rt;if(typeof rt=="string"){Ct.url=rt;const Nt=await fetch(rt);if(!Nt.ok)throw new Error(Nt.statusText);Rt=await Nt.blob()}else Rt=Ct.file=rt;if(Rt.type==="image/svg+xml"){const Nt=_t._isSVGFittingCanvas,zt=new FileReader,ie=new Image,me=new Promise((fe,Me)=>{ie.onload=()=>{Ct.bitmap=ie,Ct.isSvg=!0,fe()},zt.onload=async()=>{const _e=Ct.svgUrl=zt.result;ie.src=await Nt?`${_e}#svgView(preserveAspectRatio(none))`:_e},ie.onerror=zt.onerror=Me});zt.readAsDataURL(Rt),await me}else Ct.bitmap=await createImageBitmap(Rt);Ct.refCounter=1}catch(Rt){console.error(Rt),Ct=null}return W(this,nt).set(q,Ct),Ct&&W(this,nt).set(Ct.id,Ct),Ct};let ht=_t;class dt{constructor(q=128){Pt(this,pt,[]);Pt(this,K,!1);Pt(this,et,void 0);Pt(this,St,-1);Wt(this,et,q)}add({cmd:q,undo:rt,mustExec:Ct,type:Rt=NaN,overwriteIfSameType:Nt=!1,keepUndo:zt=!1}){if(Ct&&q(),W(this,K))return;const ie={cmd:q,undo:rt,type:Rt};if(W(this,St)===-1){W(this,pt).length>0&&(W(this,pt).length=0),Wt(this,St,0),W(this,pt).push(ie);return}if(Nt&&W(this,pt)[W(this,St)].type===Rt){zt&&(ie.undo=W(this,pt)[W(this,St)].undo),W(this,pt)[W(this,St)]=ie;return}const me=W(this,St)+1;me===W(this,et)?W(this,pt).splice(0,1):(Wt(this,St,me),me<W(this,pt).length&&W(this,pt).splice(me)),W(this,pt).push(ie)}undo(){W(this,St)!==-1&&(Wt(this,K,!0),W(this,pt)[W(this,St)].undo(),Wt(this,K,!1),Wt(this,St,W(this,St)-1))}redo(){W(this,St)<W(this,pt).length-1&&(Wt(this,St,W(this,St)+1),Wt(this,K,!0),W(this,pt)[W(this,St)].cmd(),Wt(this,K,!1))}hasSomethingToUndo(){return W(this,St)!==-1}hasSomethingToRedo(){return W(this,St)<W(this,pt).length-1}destroy(){Wt(this,pt,null)}}pt=new WeakMap,K=new WeakMap,et=new WeakMap,St=new WeakMap,F.CommandManager=dt;class st{constructor(q){Pt(this,at);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:rt}=D.FeatureTest.platform;for(const[Ct,Rt,Nt={}]of q)for(const zt of Ct){const ie=zt.startsWith("mac+");rt&&ie?(this.callbacks.set(zt.slice(4),{callback:Rt,options:Nt}),this.allKeys.add(zt.split("+").at(-1))):!rt&&!ie&&(this.callbacks.set(zt,{callback:Rt,options:Nt}),this.allKeys.add(zt.split("+").at(-1)))}}exec(q,rt){if(!this.allKeys.has(rt.key))return;const Ct=this.callbacks.get(Dt(this,at,gs).call(this,rt));if(!Ct)return;const{callback:Rt,options:{bubbles:Nt=!1,args:zt=[],checker:ie=null}}=Ct;ie&&!ie(q,rt)||(Rt.bind(q,...zt)(),Nt||(rt.stopPropagation(),rt.preventDefault()))}}at=new WeakSet,gs=function(q){q.altKey&&this.buffer.push("alt"),q.ctrlKey&&this.buffer.push("ctrl"),q.metaKey&&this.buffer.push("meta"),q.shiftKey&&this.buffer.push("shift"),this.buffer.push(q.key);const rt=this.buffer.join("+");return this.buffer.length=0,rt},F.KeyboardManager=st;const At=class At{get _colors(){const q=new Map([["CanvasText",null],["Canvas",null]]);return(0,U.getColorValues)(q),(0,D.shadow)(this,"_colors",q)}convert(q){const rt=(0,U.getRGB)(q);if(!window.matchMedia("(forced-colors: active)").matches)return rt;for(const[Ct,Rt]of this._colors)if(Rt.every((Nt,zt)=>Nt===rt[zt]))return At._colorsMapping.get(Ct);return rt}getHexCode(q){const rt=this._colors.get(q);return rt?D.Util.makeHexColor(...rt):q}};He(At,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let yt=At;F.ColorManager=yt;const ve=class ve{constructor(q,rt,Ct,Rt,Nt,zt){Pt(this,Qt);Pt(this,ue);Pt(this,Re);Pt(this,Fe);Pt(this,ke);Pt(this,Yt);Pt(this,Ot);Pt(this,ae);Pt(this,Ue);Pt(this,le);Pt(this,pe);Pt(this,we);Pt(this,ne);Pt(this,ot,null);Pt(this,kt,new Map);Pt(this,Lt,new Map);Pt(this,mt,null);Pt(this,It,null);Pt(this,Vt,new dt);Pt(this,Xt,0);Pt(this,Mt,new Set);Pt(this,Kt,null);Pt(this,ee,null);Pt(this,de,new Set);Pt(this,ge,null);Pt(this,gt,new Ft);Pt(this,z,!1);Pt(this,X,!1);Pt(this,G,null);Pt(this,J,D.AnnotationEditorType.NONE);Pt(this,it,new Set);Pt(this,lt,null);Pt(this,Et,this.blur.bind(this));Pt(this,xt,this.focus.bind(this));Pt(this,qt,this.copy.bind(this));Pt(this,Ht,this.cut.bind(this));Pt(this,Gt,this.paste.bind(this));Pt(this,Jt,this.keydown.bind(this));Pt(this,oe,this.onEditingAction.bind(this));Pt(this,Zt,this.onPageChanging.bind(this));Pt(this,be,this.onScaleChanging.bind(this));Pt(this,Ce,this.onRotationChanging.bind(this));Pt(this,ce,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Pt(this,Ae,[0,0]);Pt(this,te,null);Pt(this,Ut,null);Pt(this,jt,null);Wt(this,Ut,q),Wt(this,jt,rt),Wt(this,mt,Ct),this._eventBus=Rt,this._eventBus._on("editingaction",W(this,oe)),this._eventBus._on("pagechanging",W(this,Zt)),this._eventBus._on("scalechanging",W(this,be)),this._eventBus._on("rotationchanging",W(this,Ce)),Wt(this,It,Nt.annotationStorage),Wt(this,ge,Nt.filterFactory),Wt(this,lt,zt),this.viewParameters={realScale:U.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const q=ve.prototype,rt=Nt=>{const{activeElement:zt}=document;return zt&&W(Nt,Ut).contains(zt)&&Nt.hasSomethingToControl()},Ct=this.TRANSLATE_SMALL,Rt=this.TRANSLATE_BIG;return(0,D.shadow)(this,"_keyboardManager",new st([[["ctrl+a","mac+meta+a"],q.selectAll],[["ctrl+z","mac+meta+z"],q.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],q.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],q.delete],[["Escape","mac+Escape"],q.unselectAll],[["ArrowLeft","mac+ArrowLeft"],q.translateSelectedEditors,{args:[-Ct,0],checker:rt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],q.translateSelectedEditors,{args:[-Rt,0],checker:rt}],[["ArrowRight","mac+ArrowRight"],q.translateSelectedEditors,{args:[Ct,0],checker:rt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],q.translateSelectedEditors,{args:[Rt,0],checker:rt}],[["ArrowUp","mac+ArrowUp"],q.translateSelectedEditors,{args:[0,-Ct],checker:rt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],q.translateSelectedEditors,{args:[0,-Rt],checker:rt}],[["ArrowDown","mac+ArrowDown"],q.translateSelectedEditors,{args:[0,Ct],checker:rt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],q.translateSelectedEditors,{args:[0,Rt],checker:rt}]]))}destroy(){Dt(this,Fe,fi).call(this),Dt(this,ue,Oi).call(this),this._eventBus._off("editingaction",W(this,oe)),this._eventBus._off("pagechanging",W(this,Zt)),this._eventBus._off("scalechanging",W(this,be)),this._eventBus._off("rotationchanging",W(this,Ce));for(const q of W(this,Lt).values())q.destroy();W(this,Lt).clear(),W(this,kt).clear(),W(this,de).clear(),Wt(this,ot,null),W(this,it).clear(),W(this,Vt).destroy(),W(this,mt).destroy()}get hcmFilter(){return(0,D.shadow)(this,"hcmFilter",W(this,lt)?W(this,ge).addHCMFilter(W(this,lt).foreground,W(this,lt).background):"none")}get direction(){return(0,D.shadow)(this,"direction",getComputedStyle(W(this,Ut)).direction)}editAltText(q){var rt;(rt=W(this,mt))==null||rt.editAltText(this,q)}onPageChanging({pageNumber:q}){Wt(this,Xt,q-1)}focusMainContainer(){W(this,Ut).focus()}findParent(q,rt){for(const Ct of W(this,Lt).values()){const{x:Rt,y:Nt,width:zt,height:ie}=Ct.div.getBoundingClientRect();if(q>=Rt&&q<=Rt+zt&&rt>=Nt&&rt<=Nt+ie)return Ct}return null}disableUserSelect(q=!1){W(this,jt).classList.toggle("noUserSelect",q)}addShouldRescale(q){W(this,de).add(q)}removeShouldRescale(q){W(this,de).delete(q)}onScaleChanging({scale:q}){this.commitOrRemove(),this.viewParameters.realScale=q*U.PixelsPerInch.PDF_TO_CSS_UNITS;for(const rt of W(this,de))rt.onScaleChanging()}onRotationChanging({pagesRotation:q}){this.commitOrRemove(),this.viewParameters.rotation=q}addToAnnotationStorage(q){!q.isEmpty()&&W(this,It)&&!W(this,It).has(q.id)&&W(this,It).setValue(q.id,q)}blur(){if(!this.hasSelection)return;const{activeElement:q}=document;for(const rt of W(this,it))if(rt.div.contains(q)){Wt(this,G,[rt,q]),rt._focusEventsAllowed=!1;break}}focus(){if(!W(this,G))return;const[q,rt]=W(this,G);Wt(this,G,null),rt.addEventListener("focusin",()=>{q._focusEventsAllowed=!0},{once:!0}),rt.focus()}addEditListeners(){Dt(this,Re,Li).call(this),Dt(this,ke,Ii).call(this)}removeEditListeners(){Dt(this,Fe,fi).call(this),Dt(this,Yt,Ni).call(this)}copy(q){var Ct;if(q.preventDefault(),(Ct=W(this,ot))==null||Ct.commitOrRemove(),!this.hasSelection)return;const rt=[];for(const Rt of W(this,it)){const Nt=Rt.serialize(!0);Nt&&rt.push(Nt)}rt.length!==0&&q.clipboardData.setData("application/pdfjs",JSON.stringify(rt))}cut(q){this.copy(q),this.delete()}paste(q){q.preventDefault();const{clipboardData:rt}=q;for(const Nt of rt.items)for(const zt of W(this,ee))if(zt.isHandlingMimeForPasting(Nt.type)){zt.paste(Nt,this.currentLayer);return}let Ct=rt.getData("application/pdfjs");if(!Ct)return;try{Ct=JSON.parse(Ct)}catch(Nt){(0,D.warn)(`paste: "${Nt.message}".`);return}if(!Array.isArray(Ct))return;this.unselectAll();const Rt=this.currentLayer;try{const Nt=[];for(const me of Ct){const fe=Rt.deserialize(me);if(!fe)return;Nt.push(fe)}const zt=()=>{for(const me of Nt)Dt(this,pe,$i).call(this,me);Dt(this,ne,Bi).call(this,Nt)},ie=()=>{for(const me of Nt)me.remove()};this.addCommands({cmd:zt,undo:ie,mustExec:!0})}catch(Nt){(0,D.warn)(`paste: "${Nt.message}".`)}}keydown(q){var rt;(rt=this.getActive())!=null&&rt.shouldGetKeyboardEvents()||ve._keyboardManager.exec(this,q)}onEditingAction(q){["undo","redo","delete","selectAll"].includes(q.name)&&this[q.name]()}setEditingState(q){q?(Dt(this,Qt,ms).call(this),Dt(this,Re,Li).call(this),Dt(this,ke,Ii).call(this),Dt(this,Ot,Ve).call(this,{isEditing:W(this,J)!==D.AnnotationEditorType.NONE,isEmpty:Dt(this,we,ri).call(this),hasSomethingToUndo:W(this,Vt).hasSomethingToUndo(),hasSomethingToRedo:W(this,Vt).hasSomethingToRedo(),hasSelectedEditor:!1})):(Dt(this,ue,Oi).call(this),Dt(this,Fe,fi).call(this),Dt(this,Yt,Ni).call(this),Dt(this,Ot,Ve).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(q){if(!W(this,ee)){Wt(this,ee,q);for(const rt of W(this,ee))Dt(this,ae,ni).call(this,rt.defaultPropertiesToUpdate)}}getId(){return W(this,gt).getId()}get currentLayer(){return W(this,Lt).get(W(this,Xt))}getLayer(q){return W(this,Lt).get(q)}get currentPageIndex(){return W(this,Xt)}addLayer(q){W(this,Lt).set(q.pageIndex,q),W(this,z)?q.enable():q.disable()}removeLayer(q){W(this,Lt).delete(q.pageIndex)}updateMode(q,rt=null){if(W(this,J)!==q){if(Wt(this,J,q),q===D.AnnotationEditorType.NONE){this.setEditingState(!1),Dt(this,le,_s).call(this);return}this.setEditingState(!0),Dt(this,Ue,bs).call(this),this.unselectAll();for(const Ct of W(this,Lt).values())Ct.updateMode(q);if(rt){for(const Ct of W(this,kt).values())if(Ct.annotationElementId===rt){this.setSelected(Ct),Ct.enterInEditMode();break}}}}updateToolbar(q){q!==W(this,J)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:q})}updateParams(q,rt){if(W(this,ee)){if(q===D.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(q);return}for(const Ct of W(this,it))Ct.updateParams(q,rt);for(const Ct of W(this,ee))Ct.updateDefaultParams(q,rt)}}enableWaiting(q=!1){if(W(this,X)!==q){Wt(this,X,q);for(const rt of W(this,Lt).values())q?rt.disableClick():rt.enableClick(),rt.div.classList.toggle("waiting",q)}}getEditors(q){const rt=[];for(const Ct of W(this,kt).values())Ct.pageIndex===q&&rt.push(Ct);return rt}getEditor(q){return W(this,kt).get(q)}addEditor(q){W(this,kt).set(q.id,q)}removeEditor(q){var rt;W(this,kt).delete(q.id),this.unselect(q),(!q.annotationElementId||!W(this,Mt).has(q.annotationElementId))&&((rt=W(this,It))==null||rt.remove(q.id))}addDeletedAnnotationElement(q){W(this,Mt).add(q.annotationElementId),q.deleted=!0}isDeletedAnnotationElement(q){return W(this,Mt).has(q)}removeDeletedAnnotationElement(q){W(this,Mt).delete(q.annotationElementId),q.deleted=!1}setActiveEditor(q){W(this,ot)!==q&&(Wt(this,ot,q),q&&Dt(this,ae,ni).call(this,q.propertiesToUpdate))}toggleSelected(q){if(W(this,it).has(q)){W(this,it).delete(q),q.unselect(),Dt(this,Ot,Ve).call(this,{hasSelectedEditor:this.hasSelection});return}W(this,it).add(q),q.select(),Dt(this,ae,ni).call(this,q.propertiesToUpdate),Dt(this,Ot,Ve).call(this,{hasSelectedEditor:!0})}setSelected(q){for(const rt of W(this,it))rt!==q&&rt.unselect();W(this,it).clear(),W(this,it).add(q),q.select(),Dt(this,ae,ni).call(this,q.propertiesToUpdate),Dt(this,Ot,Ve).call(this,{hasSelectedEditor:!0})}isSelected(q){return W(this,it).has(q)}unselect(q){q.unselect(),W(this,it).delete(q),Dt(this,Ot,Ve).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return W(this,it).size!==0}undo(){W(this,Vt).undo(),Dt(this,Ot,Ve).call(this,{hasSomethingToUndo:W(this,Vt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Dt(this,we,ri).call(this)})}redo(){W(this,Vt).redo(),Dt(this,Ot,Ve).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:W(this,Vt).hasSomethingToRedo(),isEmpty:Dt(this,we,ri).call(this)})}addCommands(q){W(this,Vt).add(q),Dt(this,Ot,Ve).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Dt(this,we,ri).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const q=[...W(this,it)],rt=()=>{for(const Rt of q)Rt.remove()},Ct=()=>{for(const Rt of q)Dt(this,pe,$i).call(this,Rt)};this.addCommands({cmd:rt,undo:Ct,mustExec:!0})}commitOrRemove(){var q;(q=W(this,ot))==null||q.commitOrRemove()}hasSomethingToControl(){return W(this,ot)||this.hasSelection}selectAll(){for(const q of W(this,it))q.commit();Dt(this,ne,Bi).call(this,W(this,kt).values())}unselectAll(){if(W(this,ot)){W(this,ot).commitOrRemove();return}if(this.hasSelection){for(const q of W(this,it))q.unselect();W(this,it).clear(),Dt(this,Ot,Ve).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(q,rt,Ct=!1){if(Ct||this.commitOrRemove(),!this.hasSelection)return;W(this,Ae)[0]+=q,W(this,Ae)[1]+=rt;const[Rt,Nt]=W(this,Ae),zt=[...W(this,it)],ie=1e3;W(this,te)&&clearTimeout(W(this,te)),Wt(this,te,setTimeout(()=>{Wt(this,te,null),W(this,Ae)[0]=W(this,Ae)[1]=0,this.addCommands({cmd:()=>{for(const me of zt)W(this,kt).has(me.id)&&me.translateInPage(Rt,Nt)},undo:()=>{for(const me of zt)W(this,kt).has(me.id)&&me.translateInPage(-Rt,-Nt)},mustExec:!1})},ie));for(const me of zt)me.translateInPage(q,rt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Wt(this,Kt,new Map);for(const q of W(this,it))W(this,Kt).set(q,{savedX:q.x,savedY:q.y,savedPageIndex:q.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!W(this,Kt))return!1;this.disableUserSelect(!1);const q=W(this,Kt);Wt(this,Kt,null);let rt=!1;for(const[{x:Rt,y:Nt,pageIndex:zt},ie]of q)ie.newX=Rt,ie.newY=Nt,ie.newPageIndex=zt,rt||(rt=Rt!==ie.savedX||Nt!==ie.savedY||zt!==ie.savedPageIndex);if(!rt)return!1;const Ct=(Rt,Nt,zt,ie)=>{if(W(this,kt).has(Rt.id)){const me=W(this,Lt).get(ie);me?Rt._setParentAndPosition(me,Nt,zt):(Rt.pageIndex=ie,Rt.x=Nt,Rt.y=zt)}};return this.addCommands({cmd:()=>{for(const[Rt,{newX:Nt,newY:zt,newPageIndex:ie}]of q)Ct(Rt,Nt,zt,ie)},undo:()=>{for(const[Rt,{savedX:Nt,savedY:zt,savedPageIndex:ie}]of q)Ct(Rt,Nt,zt,ie)},mustExec:!0}),!0}dragSelectedEditors(q,rt){if(W(this,Kt))for(const Ct of W(this,Kt).keys())Ct.drag(q,rt)}rebuild(q){if(q.parent===null){const rt=this.getLayer(q.pageIndex);rt?(rt.changeParent(q),rt.addOrRebuild(q)):(this.addEditor(q),this.addToAnnotationStorage(q),q.rebuild())}else q.parent.addOrRebuild(q)}isActive(q){return W(this,ot)===q}getActive(){return W(this,ot)}getMode(){return W(this,J)}get imageManager(){return(0,D.shadow)(this,"imageManager",new ht)}};ot=new WeakMap,kt=new WeakMap,Lt=new WeakMap,mt=new WeakMap,It=new WeakMap,Vt=new WeakMap,Xt=new WeakMap,Mt=new WeakMap,Kt=new WeakMap,ee=new WeakMap,de=new WeakMap,ge=new WeakMap,gt=new WeakMap,z=new WeakMap,X=new WeakMap,G=new WeakMap,J=new WeakMap,it=new WeakMap,lt=new WeakMap,Et=new WeakMap,xt=new WeakMap,qt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,Zt=new WeakMap,be=new WeakMap,Ce=new WeakMap,ce=new WeakMap,Ae=new WeakMap,te=new WeakMap,Ut=new WeakMap,jt=new WeakMap,Qt=new WeakSet,ms=function(){window.addEventListener("focus",W(this,xt)),window.addEventListener("blur",W(this,Et))},ue=new WeakSet,Oi=function(){window.removeEventListener("focus",W(this,xt)),window.removeEventListener("blur",W(this,Et))},Re=new WeakSet,Li=function(){window.addEventListener("keydown",W(this,Jt),{capture:!0})},Fe=new WeakSet,fi=function(){window.removeEventListener("keydown",W(this,Jt),{capture:!0})},ke=new WeakSet,Ii=function(){document.addEventListener("copy",W(this,qt)),document.addEventListener("cut",W(this,Ht)),document.addEventListener("paste",W(this,Gt))},Yt=new WeakSet,Ni=function(){document.removeEventListener("copy",W(this,qt)),document.removeEventListener("cut",W(this,Ht)),document.removeEventListener("paste",W(this,Gt))},Ot=new WeakSet,Ve=function(q){Object.entries(q).some(([Ct,Rt])=>W(this,ce)[Ct]!==Rt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(W(this,ce),q)})},ae=new WeakSet,ni=function(q){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:q})},Ue=new WeakSet,bs=function(){if(!W(this,z)){Wt(this,z,!0);for(const q of W(this,Lt).values())q.enable()}},le=new WeakSet,_s=function(){if(this.unselectAll(),W(this,z)){Wt(this,z,!1);for(const q of W(this,Lt).values())q.disable()}},pe=new WeakSet,$i=function(q){const rt=W(this,Lt).get(q.pageIndex);rt?rt.addOrRebuild(q):this.addEditor(q)},we=new WeakSet,ri=function(){if(W(this,kt).size===0)return!0;if(W(this,kt).size===1)for(const q of W(this,kt).values())return q.isEmpty();return!1},ne=new WeakSet,Bi=function(q){W(this,it).clear();for(const rt of q)rt.isEmpty()||(W(this,it).add(rt),rt.select());Dt(this,Ot,Ve).call(this,{hasSelectedEditor:!0})},He(ve,"TRANSLATE_SMALL",1),He(ve,"TRANSLATE_BIG",10);let Tt=ve;F.AnnotationEditorUIManager=Tt},(B,F,O)=>{var Xt,Mt,Kt,ee,de,ge,gt,z,X,G,J,it,Qe,Et,Ze,qt,Ui,Gt,gi,oe,mi,be,ai,ce,oi;Object.defineProperty(F,"__esModule",{value:!0}),F.StatTimer=F.RenderingCancelledException=F.PixelsPerInch=F.PageViewport=F.PDFDateString=F.DOMStandardFontDataFactory=F.DOMSVGFactory=F.DOMFilterFactory=F.DOMCanvasFactory=F.DOMCMapReaderFactory=void 0,F.deprecated=St,F.getColorValues=kt,F.getCurrentTransform=Lt,F.getCurrentTransformInverse=mt,F.getFilenameFromUrl=ct,F.getPdfFilenameFromUrl=bt,F.getRGB=ot,F.getXfaPageViewport=At,F.isDataScheme=ft,F.isPdfFile=nt,F.isValidFetchUrl=pt,F.loadScript=et,F.noContextMenu=K,F.setLayerDimensions=It;var D=O(7),U=O(1);const tt="http://www.w3.org/2000/svg",Vt=class Vt{};He(Vt,"CSS",96),He(Vt,"PDF",72),He(Vt,"PDF_TO_CSS_UNITS",Vt.CSS/Vt.PDF);let Q=Vt;F.PixelsPerInch=Q;class Ft extends D.BaseFilterFactory{constructor({docId:jt,ownerDocument:Qt=globalThis.document}={}){super();Pt(this,it);Pt(this,Et);Pt(this,qt);Pt(this,Gt);Pt(this,oe);Pt(this,be);Pt(this,ce);Pt(this,Xt,void 0);Pt(this,Mt,void 0);Pt(this,Kt,void 0);Pt(this,ee,void 0);Pt(this,de,void 0);Pt(this,ge,void 0);Pt(this,gt,void 0);Pt(this,z,void 0);Pt(this,X,void 0);Pt(this,G,void 0);Pt(this,J,0);Wt(this,Kt,jt),Wt(this,ee,Qt)}addFilter(jt){if(!jt)return"none";let Qt=W(this,it,Qe).get(jt);if(Qt)return Qt;let he,ue,Pe,Re;if(jt.length===1){const ke=jt[0],Le=new Array(256);for(let Yt=0;Yt<256;Yt++)Le[Yt]=ke[Yt]/255;Re=he=ue=Pe=Le.join(",")}else{const[ke,Le,Yt]=jt,Bt=new Array(256),Ot=new Array(256),se=new Array(256);for(let ae=0;ae<256;ae++)Bt[ae]=ke[ae]/255,Ot[ae]=Le[ae]/255,se[ae]=Yt[ae]/255;he=Bt.join(","),ue=Ot.join(","),Pe=se.join(","),Re=`${he}${ue}${Pe}`}if(Qt=W(this,it,Qe).get(Re),Qt)return W(this,it,Qe).set(jt,Qt),Qt;const xe=`g_${W(this,Kt)}_transfer_map_${si(this,J)._++}`,Fe=`url(#${xe})`;W(this,it,Qe).set(jt,Fe),W(this,it,Qe).set(Re,Fe);const De=Dt(this,Gt,gi).call(this,xe);return Dt(this,be,ai).call(this,he,ue,Pe,De),Fe}addHCMFilter(jt,Qt){var Le;const he=`${jt}-${Qt}`;if(W(this,ge)===he)return W(this,gt);if(Wt(this,ge,he),Wt(this,gt,"none"),(Le=W(this,de))==null||Le.remove(),!jt||!Qt)return W(this,gt);const ue=Dt(this,ce,oi).call(this,jt);jt=U.Util.makeHexColor(...ue);const Pe=Dt(this,ce,oi).call(this,Qt);if(Qt=U.Util.makeHexColor(...Pe),W(this,Et,Ze).style.color="",jt==="#000000"&&Qt==="#ffffff"||jt===Qt)return W(this,gt);const Re=new Array(256);for(let Yt=0;Yt<=255;Yt++){const Bt=Yt/255;Re[Yt]=Bt<=.03928?Bt/12.92:((Bt+.055)/1.055)**2.4}const xe=Re.join(","),Fe=`g_${W(this,Kt)}_hcm_filter`,De=Wt(this,z,Dt(this,Gt,gi).call(this,Fe));Dt(this,be,ai).call(this,xe,xe,xe,De),Dt(this,qt,Ui).call(this,De);const ke=(Yt,Bt)=>{const Ot=ue[Yt]/255,se=Pe[Yt]/255,ae=new Array(Bt+1);for(let je=0;je<=Bt;je++)ae[je]=Ot+je/Bt*(se-Ot);return ae.join(",")};return Dt(this,be,ai).call(this,ke(0,5),ke(1,5),ke(2,5),De),Wt(this,gt,`url(#${Fe})`),W(this,gt)}addHighlightHCMFilter(jt,Qt,he,ue){var se;const Pe=`${jt}-${Qt}-${he}-${ue}`;if(W(this,X)===Pe)return W(this,G);if(Wt(this,X,Pe),Wt(this,G,"none"),(se=W(this,z))==null||se.remove(),!jt||!Qt)return W(this,G);const[Re,xe]=[jt,Qt].map(Dt(this,ce,oi).bind(this));let Fe=Math.round(.2126*Re[0]+.7152*Re[1]+.0722*Re[2]),De=Math.round(.2126*xe[0]+.7152*xe[1]+.0722*xe[2]),[ke,Le]=[he,ue].map(Dt(this,ce,oi).bind(this));De<Fe&&([Fe,De,ke,Le]=[De,Fe,Le,ke]),W(this,Et,Ze).style.color="";const Yt=(ae,je,Ue)=>{const $t=new Array(256),le=(De-Fe)/Ue,Se=ae/255,pe=(je-ae)/(255*Ue);let Ee=0;for(let we=0;we<=Ue;we++){const $e=Math.round(Fe+we*le),ne=Se+we*pe;for(let Ie=Ee;Ie<=$e;Ie++)$t[Ie]=ne;Ee=$e+1}for(let we=Ee;we<256;we++)$t[we]=$t[Ee-1];return $t.join(",")},Bt=`g_${W(this,Kt)}_hcm_highlight_filter`,Ot=Wt(this,z,Dt(this,Gt,gi).call(this,Bt));return Dt(this,qt,Ui).call(this,Ot),Dt(this,be,ai).call(this,Yt(ke[0],Le[0],5),Yt(ke[1],Le[1],5),Yt(ke[2],Le[2],5),Ot),Wt(this,G,`url(#${Bt})`),W(this,G)}destroy(jt=!1){jt&&(W(this,gt)||W(this,G))||(W(this,Mt)&&(W(this,Mt).parentNode.parentNode.remove(),Wt(this,Mt,null)),W(this,Xt)&&(W(this,Xt).clear(),Wt(this,Xt,null)),Wt(this,J,0))}}Xt=new WeakMap,Mt=new WeakMap,Kt=new WeakMap,ee=new WeakMap,de=new WeakMap,ge=new WeakMap,gt=new WeakMap,z=new WeakMap,X=new WeakMap,G=new WeakMap,J=new WeakMap,it=new WeakSet,Qe=function(){return W(this,Xt)||Wt(this,Xt,new Map)},Et=new WeakSet,Ze=function(){if(!W(this,Mt)){const jt=W(this,ee).createElement("div"),{style:Qt}=jt;Qt.visibility="hidden",Qt.contain="strict",Qt.width=Qt.height=0,Qt.position="absolute",Qt.top=Qt.left=0,Qt.zIndex=-1;const he=W(this,ee).createElementNS(tt,"svg");he.setAttribute("width",0),he.setAttribute("height",0),Wt(this,Mt,W(this,ee).createElementNS(tt,"defs")),jt.append(he),he.append(W(this,Mt)),W(this,ee).body.append(jt)}return W(this,Mt)},qt=new WeakSet,Ui=function(jt){const Qt=W(this,ee).createElementNS(tt,"feColorMatrix");Qt.setAttribute("type","matrix"),Qt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),jt.append(Qt)},Gt=new WeakSet,gi=function(jt){const Qt=W(this,ee).createElementNS(tt,"filter");return Qt.setAttribute("color-interpolation-filters","sRGB"),Qt.setAttribute("id",jt),W(this,Et,Ze).append(Qt),Qt},oe=new WeakSet,mi=function(jt,Qt,he){const ue=W(this,ee).createElementNS(tt,Qt);ue.setAttribute("type","discrete"),ue.setAttribute("tableValues",he),jt.append(ue)},be=new WeakSet,ai=function(jt,Qt,he,ue){const Pe=W(this,ee).createElementNS(tt,"feComponentTransfer");ue.append(Pe),Dt(this,oe,mi).call(this,Pe,"feFuncR",jt),Dt(this,oe,mi).call(this,Pe,"feFuncG",Qt),Dt(this,oe,mi).call(this,Pe,"feFuncB",he)},ce=new WeakSet,oi=function(jt){return W(this,Et,Ze).style.color=jt,ot(getComputedStyle(W(this,Et,Ze)).getPropertyValue("color"))},F.DOMFilterFactory=Ft;class ht extends D.BaseCanvasFactory{constructor({ownerDocument:Ut=globalThis.document}={}){super(),this._document=Ut}_createCanvas(Ut,jt){const Qt=this._document.createElement("canvas");return Qt.width=Ut,Qt.height=jt,Qt}}F.DOMCanvasFactory=ht;async function dt(te,Ut=!1){if(pt(te,document.baseURI)){const jt=await fetch(te);if(!jt.ok)throw new Error(jt.statusText);return Ut?new Uint8Array(await jt.arrayBuffer()):(0,U.stringToBytes)(await jt.text())}return new Promise((jt,Qt)=>{const he=new XMLHttpRequest;he.open("GET",te,!0),Ut&&(he.responseType="arraybuffer"),he.onreadystatechange=()=>{if(he.readyState===XMLHttpRequest.DONE){if(he.status===200||he.status===0){let ue;if(Ut&&he.response?ue=new Uint8Array(he.response):!Ut&&he.responseText&&(ue=(0,U.stringToBytes)(he.responseText)),ue){jt(ue);return}}Qt(new Error(he.statusText))}},he.send(null)})}class st extends D.BaseCMapReaderFactory{_fetchData(Ut,jt){return dt(Ut,this.isCompressed).then(Qt=>({cMapData:Qt,compressionType:jt}))}}F.DOMCMapReaderFactory=st;class yt extends D.BaseStandardFontDataFactory{_fetchData(Ut){return dt(Ut,!0)}}F.DOMStandardFontDataFactory=yt;class Tt extends D.BaseSVGFactory{_createSVG(Ut){return document.createElementNS(tt,Ut)}}F.DOMSVGFactory=Tt;class vt{constructor({viewBox:Ut,scale:jt,rotation:Qt,offsetX:he=0,offsetY:ue=0,dontFlip:Pe=!1}){this.viewBox=Ut,this.scale=jt,this.rotation=Qt,this.offsetX=he,this.offsetY=ue;const Re=(Ut[2]+Ut[0])/2,xe=(Ut[3]+Ut[1])/2;let Fe,De,ke,Le;switch(Qt%=360,Qt<0&&(Qt+=360),Qt){case 180:Fe=-1,De=0,ke=0,Le=1;break;case 90:Fe=0,De=1,ke=1,Le=0;break;case 270:Fe=0,De=-1,ke=-1,Le=0;break;case 0:Fe=1,De=0,ke=0,Le=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Pe&&(ke=-ke,Le=-Le);let Yt,Bt,Ot,se;Fe===0?(Yt=Math.abs(xe-Ut[1])*jt+he,Bt=Math.abs(Re-Ut[0])*jt+ue,Ot=(Ut[3]-Ut[1])*jt,se=(Ut[2]-Ut[0])*jt):(Yt=Math.abs(Re-Ut[0])*jt+he,Bt=Math.abs(xe-Ut[1])*jt+ue,Ot=(Ut[2]-Ut[0])*jt,se=(Ut[3]-Ut[1])*jt),this.transform=[Fe*jt,De*jt,ke*jt,Le*jt,Yt-Fe*jt*Re-ke*jt*xe,Bt-De*jt*Re-Le*jt*xe],this.width=Ot,this.height=se}get rawDims(){const{viewBox:Ut}=this;return(0,U.shadow)(this,"rawDims",{pageWidth:Ut[2]-Ut[0],pageHeight:Ut[3]-Ut[1],pageX:Ut[0],pageY:Ut[1]})}clone({scale:Ut=this.scale,rotation:jt=this.rotation,offsetX:Qt=this.offsetX,offsetY:he=this.offsetY,dontFlip:ue=!1}={}){return new vt({viewBox:this.viewBox.slice(),scale:Ut,rotation:jt,offsetX:Qt,offsetY:he,dontFlip:ue})}convertToViewportPoint(Ut,jt){return U.Util.applyTransform([Ut,jt],this.transform)}convertToViewportRectangle(Ut){const jt=U.Util.applyTransform([Ut[0],Ut[1]],this.transform),Qt=U.Util.applyTransform([Ut[2],Ut[3]],this.transform);return[jt[0],jt[1],Qt[0],Qt[1]]}convertToPdfPoint(Ut,jt){return U.Util.applyInverseTransform([Ut,jt],this.transform)}}F.PageViewport=vt;class ut extends U.BaseException{constructor(Ut,jt=0){super(Ut,"RenderingCancelledException"),this.extraDelay=jt}}F.RenderingCancelledException=ut;function ft(te){const Ut=te.length;let jt=0;for(;jt<Ut&&te[jt].trim()==="";)jt++;return te.substring(jt,jt+5).toLowerCase()==="data:"}function nt(te){return typeof te=="string"&&/\.pdf$/i.test(te)}function ct(te,Ut=!1){return Ut||([te]=te.split(/[#?]/,1)),te.substring(te.lastIndexOf("/")+1)}function bt(te,Ut="document.pdf"){if(typeof te!="string")return Ut;if(ft(te))return(0,U.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Ut;const jt=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Qt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,he=jt.exec(te);let ue=Qt.exec(he[1])||Qt.exec(he[2])||Qt.exec(he[3]);if(ue&&(ue=ue[0],ue.includes("%")))try{ue=Qt.exec(decodeURIComponent(ue))[0]}catch{}return ue||Ut}class _t{constructor(){He(this,"started",Object.create(null));He(this,"times",[])}time(Ut){Ut in this.started&&(0,U.warn)(`Timer is already running for ${Ut}`),this.started[Ut]=Date.now()}timeEnd(Ut){Ut in this.started||(0,U.warn)(`Timer has not been started for ${Ut}`),this.times.push({name:Ut,start:this.started[Ut],end:Date.now()}),delete this.started[Ut]}toString(){const Ut=[];let jt=0;for(const{name:Qt}of this.times)jt=Math.max(Qt.length,jt);for(const{name:Qt,start:he,end:ue}of this.times)Ut.push(`${Qt.padEnd(jt)} ${ue-he}ms
`);return Ut.join("")}}F.StatTimer=_t;function pt(te,Ut){try{const{protocol:jt}=Ut?new URL(te,Ut):new URL(te);return jt==="http:"||jt==="https:"}catch{return!1}}function K(te){te.preventDefault()}function et(te,Ut=!1){return new Promise((jt,Qt)=>{const he=document.createElement("script");he.src=te,he.onload=function(ue){Ut&&he.remove(),jt(ue)},he.onerror=function(){Qt(new Error(`Cannot load script at: ${he.src}`))},(document.head||document.documentElement).append(he)})}function St(te){console.log("Deprecated API usage: "+te)}let at;class Y{static toDateObject(Ut){if(!Ut||typeof Ut!="string")return null;at||(at=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const jt=at.exec(Ut);if(!jt)return null;const Qt=parseInt(jt[1],10);let he=parseInt(jt[2],10);he=he>=1&&he<=12?he-1:0;let ue=parseInt(jt[3],10);ue=ue>=1&&ue<=31?ue:1;let Pe=parseInt(jt[4],10);Pe=Pe>=0&&Pe<=23?Pe:0;let Re=parseInt(jt[5],10);Re=Re>=0&&Re<=59?Re:0;let xe=parseInt(jt[6],10);xe=xe>=0&&xe<=59?xe:0;const Fe=jt[7]||"Z";let De=parseInt(jt[8],10);De=De>=0&&De<=23?De:0;let ke=parseInt(jt[9],10)||0;return ke=ke>=0&&ke<=59?ke:0,Fe==="-"?(Pe+=De,Re+=ke):Fe==="+"&&(Pe-=De,Re-=ke),new Date(Date.UTC(Qt,he,ue,Pe,Re,xe))}}F.PDFDateString=Y;function At(te,{scale:Ut=1,rotation:jt=0}){const{width:Qt,height:he}=te.attributes.style,ue=[0,0,parseInt(Qt),parseInt(he)];return new vt({viewBox:ue,scale:Ut,rotation:jt})}function ot(te){if(te.startsWith("#")){const Ut=parseInt(te.slice(1),16);return[(Ut&16711680)>>16,(Ut&65280)>>8,Ut&255]}return te.startsWith("rgb(")?te.slice(4,-1).split(",").map(Ut=>parseInt(Ut)):te.startsWith("rgba(")?te.slice(5,-1).split(",").map(Ut=>parseInt(Ut)).slice(0,3):((0,U.warn)(`Not a valid color format: "${te}"`),[0,0,0])}function kt(te){const Ut=document.createElement("span");Ut.style.visibility="hidden",document.body.append(Ut);for(const jt of te.keys()){Ut.style.color=jt;const Qt=window.getComputedStyle(Ut).color;te.set(jt,ot(Qt))}Ut.remove()}function Lt(te){const{a:Ut,b:jt,c:Qt,d:he,e:ue,f:Pe}=te.getTransform();return[Ut,jt,Qt,he,ue,Pe]}function mt(te){const{a:Ut,b:jt,c:Qt,d:he,e:ue,f:Pe}=te.getTransform().invertSelf();return[Ut,jt,Qt,he,ue,Pe]}function It(te,Ut,jt=!1,Qt=!0){if(Ut instanceof vt){const{pageWidth:he,pageHeight:ue}=Ut.rawDims,{style:Pe}=te,Re=U.FeatureTest.isCSSRoundSupported,xe=`var(--scale-factor) * ${he}px`,Fe=`var(--scale-factor) * ${ue}px`,De=Re?`round(${xe}, 1px)`:`calc(${xe})`,ke=Re?`round(${Fe}, 1px)`:`calc(${Fe})`;!jt||Ut.rotation%180===0?(Pe.width=De,Pe.height=ke):(Pe.width=ke,Pe.height=De)}Qt&&te.setAttribute("data-main-rotation",Ut.rotation)}},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.BaseStandardFontDataFactory=F.BaseSVGFactory=F.BaseFilterFactory=F.BaseCanvasFactory=F.BaseCMapReaderFactory=void 0;var D=O(1);class U{constructor(){this.constructor===U&&(0,D.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(st){return"none"}addHCMFilter(st,yt){return"none"}addHighlightHCMFilter(st,yt,Tt,vt){return"none"}destroy(st=!1){}}F.BaseFilterFactory=U;class tt{constructor(){this.constructor===tt&&(0,D.unreachable)("Cannot initialize BaseCanvasFactory.")}create(st,yt){if(st<=0||yt<=0)throw new Error("Invalid canvas size");const Tt=this._createCanvas(st,yt);return{canvas:Tt,context:Tt.getContext("2d")}}reset(st,yt,Tt){if(!st.canvas)throw new Error("Canvas is not specified");if(yt<=0||Tt<=0)throw new Error("Invalid canvas size");st.canvas.width=yt,st.canvas.height=Tt}destroy(st){if(!st.canvas)throw new Error("Canvas is not specified");st.canvas.width=0,st.canvas.height=0,st.canvas=null,st.context=null}_createCanvas(st,yt){(0,D.unreachable)("Abstract method `_createCanvas` called.")}}F.BaseCanvasFactory=tt;class Q{constructor({baseUrl:st=null,isCompressed:yt=!0}){this.constructor===Q&&(0,D.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=st,this.isCompressed=yt}async fetch({name:st}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!st)throw new Error("CMap name must be specified.");const yt=this.baseUrl+st+(this.isCompressed?".bcmap":""),Tt=this.isCompressed?D.CMapCompressionType.BINARY:D.CMapCompressionType.NONE;return this._fetchData(yt,Tt).catch(vt=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${yt}`)})}_fetchData(st,yt){(0,D.unreachable)("Abstract method `_fetchData` called.")}}F.BaseCMapReaderFactory=Q;class Ft{constructor({baseUrl:st=null}){this.constructor===Ft&&(0,D.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=st}async fetch({filename:st}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!st)throw new Error("Font filename must be specified.");const yt=`${this.baseUrl}${st}`;return this._fetchData(yt).catch(Tt=>{throw new Error(`Unable to load font data at: ${yt}`)})}_fetchData(st){(0,D.unreachable)("Abstract method `_fetchData` called.")}}F.BaseStandardFontDataFactory=Ft;class ht{constructor(){this.constructor===ht&&(0,D.unreachable)("Cannot initialize BaseSVGFactory.")}create(st,yt,Tt=!1){if(st<=0||yt<=0)throw new Error("Invalid SVG dimensions");const vt=this._createSVG("svg:svg");return vt.setAttribute("version","1.1"),Tt||(vt.setAttribute("width",`${st}px`),vt.setAttribute("height",`${yt}px`)),vt.setAttribute("preserveAspectRatio","none"),vt.setAttribute("viewBox",`0 0 ${st} ${yt}`),vt}createElement(st){if(typeof st!="string")throw new Error("Invalid SVG element type");return this._createSVG(st)}_createSVG(st){(0,D.unreachable)("Abstract method `_createSVG` called.")}}F.BaseSVGFactory=ht},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.MurmurHash3_64=void 0;var D=O(1);const U=3285377520,tt=4294901760,Q=65535;class Ft{constructor(dt){this.h1=dt?dt&4294967295:U,this.h2=dt?dt&4294967295:U}update(dt){let st,yt;if(typeof dt=="string"){st=new Uint8Array(dt.length*2),yt=0;for(let St=0,at=dt.length;St<at;St++){const Y=dt.charCodeAt(St);Y<=255?st[yt++]=Y:(st[yt++]=Y>>>8,st[yt++]=Y&255)}}else if((0,D.isArrayBuffer)(dt))st=dt.slice(),yt=st.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const Tt=yt>>2,vt=yt-Tt*4,ut=new Uint32Array(st.buffer,0,Tt);let ft=0,nt=0,ct=this.h1,bt=this.h2;const _t=3432918353,pt=461845907,K=_t&Q,et=pt&Q;for(let St=0;St<Tt;St++)St&1?(ft=ut[St],ft=ft*_t&tt|ft*K&Q,ft=ft<<15|ft>>>17,ft=ft*pt&tt|ft*et&Q,ct^=ft,ct=ct<<13|ct>>>19,ct=ct*5+3864292196):(nt=ut[St],nt=nt*_t&tt|nt*K&Q,nt=nt<<15|nt>>>17,nt=nt*pt&tt|nt*et&Q,bt^=nt,bt=bt<<13|bt>>>19,bt=bt*5+3864292196);switch(ft=0,vt){case 3:ft^=st[Tt*4+2]<<16;case 2:ft^=st[Tt*4+1]<<8;case 1:ft^=st[Tt*4],ft=ft*_t&tt|ft*K&Q,ft=ft<<15|ft>>>17,ft=ft*pt&tt|ft*et&Q,Tt&1?ct^=ft:bt^=ft}this.h1=ct,this.h2=bt}hexdigest(){let dt=this.h1,st=this.h2;return dt^=st>>>1,dt=dt*3981806797&tt|dt*36045&Q,st=st*4283543511&tt|((st<<16|dt>>>16)*2950163797&tt)>>>16,dt^=st>>>1,dt=dt*444984403&tt|dt*60499&Q,st=st*3301882366&tt|((st<<16|dt>>>16)*3120437893&tt)>>>16,dt^=st>>>1,(dt>>>0).toString(16).padStart(8,"0")+(st>>>0).toString(16).padStart(8,"0")}}F.MurmurHash3_64=Ft},(B,F,O)=>{var Q;Object.defineProperty(F,"__esModule",{value:!0}),F.FontLoader=F.FontFaceObject=void 0;var D=O(1);class U{constructor({ownerDocument:ht=globalThis.document,styleElement:dt=null}){Pt(this,Q,new Set);this._document=ht,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(ht){this.nativeFontFaces.add(ht),this._document.fonts.add(ht)}removeNativeFontFace(ht){this.nativeFontFaces.delete(ht),this._document.fonts.delete(ht)}insertRule(ht){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const dt=this.styleElement.sheet;dt.insertRule(ht,dt.cssRules.length)}clear(){for(const ht of this.nativeFontFaces)this._document.fonts.delete(ht);this.nativeFontFaces.clear(),W(this,Q).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(ht){if(!(!ht||W(this,Q).has(ht.loadedName))){if((0,D.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:dt,src:st,style:yt}=ht,Tt=new FontFace(dt,st,yt);this.addNativeFontFace(Tt);try{await Tt.load(),W(this,Q).add(dt)}catch{(0,D.warn)(`Cannot load system font: ${ht.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(Tt)}return}(0,D.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(ht){if(ht.attached||ht.missingFile&&!ht.systemFontInfo)return;if(ht.attached=!0,ht.systemFontInfo){await this.loadSystemFont(ht.systemFontInfo);return}if(this.isFontLoadingAPISupported){const st=ht.createNativeFontFace();if(st){this.addNativeFontFace(st);try{await st.loaded}catch(yt){throw(0,D.warn)(`Failed to load font '${st.family}': '${yt}'.`),ht.disableFontFace=!0,yt}}return}const dt=ht.createFontFaceRule();if(dt){if(this.insertRule(dt),this.isSyncFontLoadingSupported)return;await new Promise(st=>{const yt=this._queueLoadingCallback(st);this._prepareFontLoadEvent(ht,yt)})}}get isFontLoadingAPISupported(){var dt;const ht=!!((dt=this._document)!=null&&dt.fonts);return(0,D.shadow)(this,"isFontLoadingAPISupported",ht)}get isSyncFontLoadingSupported(){let ht=!1;return(D.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(ht=!0),(0,D.shadow)(this,"isSyncFontLoadingSupported",ht)}_queueLoadingCallback(ht){function dt(){for((0,D.assert)(!yt.done,"completeRequest() cannot be called twice."),yt.done=!0;st.length>0&&st[0].done;){const Tt=st.shift();setTimeout(Tt.callback,0)}}const{loadingRequests:st}=this,yt={done:!1,complete:dt,callback:ht};return st.push(yt),yt}get _loadTestFont(){const ht=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,D.shadow)(this,"_loadTestFont",ht)}_prepareFontLoadEvent(ht,dt){function st(ot,kt){return ot.charCodeAt(kt)<<24|ot.charCodeAt(kt+1)<<16|ot.charCodeAt(kt+2)<<8|ot.charCodeAt(kt+3)&255}function yt(ot,kt,Lt,mt){const It=ot.substring(0,kt),Vt=ot.substring(kt+Lt);return It+mt+Vt}let Tt,vt;const ut=this._document.createElement("canvas");ut.width=1,ut.height=1;const ft=ut.getContext("2d");let nt=0;function ct(ot,kt){if(++nt>30){(0,D.warn)("Load test font never loaded."),kt();return}if(ft.font="30px "+ot,ft.fillText(".",0,20),ft.getImageData(0,0,1,1).data[3]>0){kt();return}setTimeout(ct.bind(null,ot,kt))}const bt=`lt${Date.now()}${this.loadTestFontId++}`;let _t=this._loadTestFont;_t=yt(_t,976,bt.length,bt);const K=16,et=1482184792;let St=st(_t,K);for(Tt=0,vt=bt.length-3;Tt<vt;Tt+=4)St=St-et+st(bt,Tt)|0;Tt<bt.length&&(St=St-et+st(bt+"XXX",Tt)|0),_t=yt(_t,K,4,(0,D.string32)(St));const at=`url(data:font/opentype;base64,${btoa(_t)});`,Y=`@font-face {font-family:"${bt}";src:${at}}`;this.insertRule(Y);const At=this._document.createElement("div");At.style.visibility="hidden",At.style.width=At.style.height="10px",At.style.position="absolute",At.style.top=At.style.left="0px";for(const ot of[ht.loadedName,bt]){const kt=this._document.createElement("span");kt.textContent="Hi",kt.style.fontFamily=ot,At.append(kt)}this._document.body.append(At),ct(bt,()=>{At.remove(),dt.complete()})}}Q=new WeakMap,F.FontLoader=U;class tt{constructor(ht,{isEvalSupported:dt=!0,disableFontFace:st=!1,ignoreErrors:yt=!1,inspectFont:Tt=null}){this.compiledGlyphs=Object.create(null);for(const vt in ht)this[vt]=ht[vt];this.isEvalSupported=dt!==!1,this.disableFontFace=st===!0,this.ignoreErrors=yt===!0,this._inspectFont=Tt}createNativeFontFace(){var dt;if(!this.data||this.disableFontFace)return null;let ht;if(!this.cssFontInfo)ht=new FontFace(this.loadedName,this.data,{});else{const st={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(st.style=`oblique ${this.cssFontInfo.italicAngle}deg`),ht=new FontFace(this.cssFontInfo.fontFamily,this.data,st)}return(dt=this._inspectFont)==null||dt.call(this,this),ht}createFontFaceRule(){var yt;if(!this.data||this.disableFontFace)return null;const ht=(0,D.bytesToString)(this.data),dt=`url(data:${this.mimetype};base64,${btoa(ht)});`;let st;if(!this.cssFontInfo)st=`@font-face {font-family:"${this.loadedName}";src:${dt}}`;else{let Tt=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(Tt+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),st=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${Tt}src:${dt}}`}return(yt=this._inspectFont)==null||yt.call(this,this,dt),st}getPathGenerator(ht,dt){if(this.compiledGlyphs[dt]!==void 0)return this.compiledGlyphs[dt];let st;try{st=ht.get(this.loadedName+"_path_"+dt)}catch(yt){if(!this.ignoreErrors)throw yt;return(0,D.warn)(`getPathGenerator - ignoring character: "${yt}".`),this.compiledGlyphs[dt]=function(Tt,vt){}}if(this.isEvalSupported&&D.FeatureTest.isEvalSupported){const yt=[];for(const Tt of st){const vt=Tt.args!==void 0?Tt.args.join(","):"";yt.push("c.",Tt.cmd,"(",vt,`);
`)}return this.compiledGlyphs[dt]=new Function("c","size",yt.join(""))}return this.compiledGlyphs[dt]=function(yt,Tt){for(const vt of st)vt.cmd==="scale"&&(vt.args=[Tt,-Tt]),yt[vt.cmd].apply(yt,vt.args)}}}F.FontFaceObject=tt},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.NodeStandardFontDataFactory=F.NodeFilterFactory=F.NodeCanvasFactory=F.NodeCMapReaderFactory=void 0;var D=O(7);O(1);const U=function(dt){return new Promise((st,yt)=>{require("fs").readFile(dt,(vt,ut)=>{if(vt||!ut){yt(new Error(vt));return}st(new Uint8Array(ut))})})};class tt extends D.BaseFilterFactory{}F.NodeFilterFactory=tt;class Q extends D.BaseCanvasFactory{_createCanvas(st,yt){return require$$0.createCanvas(st,yt)}}F.NodeCanvasFactory=Q;class Ft extends D.BaseCMapReaderFactory{_fetchData(st,yt){return U(st).then(Tt=>({cMapData:Tt,compressionType:yt}))}}F.NodeCMapReaderFactory=Ft;class ht extends D.BaseStandardFontDataFactory{_fetchData(st){return U(st)}}F.NodeStandardFontDataFactory=ht},(B,F,O)=>{var Mt,ji,ee,Hi;Object.defineProperty(F,"__esModule",{value:!0}),F.CanvasGraphics=void 0;var D=O(1),U=O(6),tt=O(12),Q=O(13);const Ft=16,ht=100,dt=4096,st=15,yt=10,Tt=1e3,vt=16;function ut(gt,z){if(gt._removeMirroring)throw new Error("Context is already forwarding operations.");gt.__originalSave=gt.save,gt.__originalRestore=gt.restore,gt.__originalRotate=gt.rotate,gt.__originalScale=gt.scale,gt.__originalTranslate=gt.translate,gt.__originalTransform=gt.transform,gt.__originalSetTransform=gt.setTransform,gt.__originalResetTransform=gt.resetTransform,gt.__originalClip=gt.clip,gt.__originalMoveTo=gt.moveTo,gt.__originalLineTo=gt.lineTo,gt.__originalBezierCurveTo=gt.bezierCurveTo,gt.__originalRect=gt.rect,gt.__originalClosePath=gt.closePath,gt.__originalBeginPath=gt.beginPath,gt._removeMirroring=()=>{gt.save=gt.__originalSave,gt.restore=gt.__originalRestore,gt.rotate=gt.__originalRotate,gt.scale=gt.__originalScale,gt.translate=gt.__originalTranslate,gt.transform=gt.__originalTransform,gt.setTransform=gt.__originalSetTransform,gt.resetTransform=gt.__originalResetTransform,gt.clip=gt.__originalClip,gt.moveTo=gt.__originalMoveTo,gt.lineTo=gt.__originalLineTo,gt.bezierCurveTo=gt.__originalBezierCurveTo,gt.rect=gt.__originalRect,gt.closePath=gt.__originalClosePath,gt.beginPath=gt.__originalBeginPath,delete gt._removeMirroring},gt.save=function(){z.save(),this.__originalSave()},gt.restore=function(){z.restore(),this.__originalRestore()},gt.translate=function(G,J){z.translate(G,J),this.__originalTranslate(G,J)},gt.scale=function(G,J){z.scale(G,J),this.__originalScale(G,J)},gt.transform=function(G,J,it,lt,Et,xt){z.transform(G,J,it,lt,Et,xt),this.__originalTransform(G,J,it,lt,Et,xt)},gt.setTransform=function(G,J,it,lt,Et,xt){z.setTransform(G,J,it,lt,Et,xt),this.__originalSetTransform(G,J,it,lt,Et,xt)},gt.resetTransform=function(){z.resetTransform(),this.__originalResetTransform()},gt.rotate=function(G){z.rotate(G),this.__originalRotate(G)},gt.clip=function(G){z.clip(G),this.__originalClip(G)},gt.moveTo=function(X,G){z.moveTo(X,G),this.__originalMoveTo(X,G)},gt.lineTo=function(X,G){z.lineTo(X,G),this.__originalLineTo(X,G)},gt.bezierCurveTo=function(X,G,J,it,lt,Et){z.bezierCurveTo(X,G,J,it,lt,Et),this.__originalBezierCurveTo(X,G,J,it,lt,Et)},gt.rect=function(X,G,J,it){z.rect(X,G,J,it),this.__originalRect(X,G,J,it)},gt.closePath=function(){z.closePath(),this.__originalClosePath()},gt.beginPath=function(){z.beginPath(),this.__originalBeginPath()}}class ft{constructor(z){this.canvasFactory=z,this.cache=Object.create(null)}getCanvas(z,X,G){let J;return this.cache[z]!==void 0?(J=this.cache[z],this.canvasFactory.reset(J,X,G)):(J=this.canvasFactory.create(X,G),this.cache[z]=J),J}delete(z){delete this.cache[z]}clear(){for(const z in this.cache){const X=this.cache[z];this.canvasFactory.destroy(X),delete this.cache[z]}}}function nt(gt,z,X,G,J,it,lt,Et,xt,qt){const[Ht,Gt,Jt,oe,Zt,be]=(0,U.getCurrentTransform)(gt);if(Gt===0&&Jt===0){const Ae=lt*Ht+Zt,te=Math.round(Ae),Ut=Et*oe+be,jt=Math.round(Ut),Qt=(lt+xt)*Ht+Zt,he=Math.abs(Math.round(Qt)-te)||1,ue=(Et+qt)*oe+be,Pe=Math.abs(Math.round(ue)-jt)||1;return gt.setTransform(Math.sign(Ht),0,0,Math.sign(oe),te,jt),gt.drawImage(z,X,G,J,it,0,0,he,Pe),gt.setTransform(Ht,Gt,Jt,oe,Zt,be),[he,Pe]}if(Ht===0&&oe===0){const Ae=Et*Jt+Zt,te=Math.round(Ae),Ut=lt*Gt+be,jt=Math.round(Ut),Qt=(Et+qt)*Jt+Zt,he=Math.abs(Math.round(Qt)-te)||1,ue=(lt+xt)*Gt+be,Pe=Math.abs(Math.round(ue)-jt)||1;return gt.setTransform(0,Math.sign(Gt),Math.sign(Jt),0,te,jt),gt.drawImage(z,X,G,J,it,0,0,Pe,he),gt.setTransform(Ht,Gt,Jt,oe,Zt,be),[Pe,he]}gt.drawImage(z,X,G,J,it,lt,Et,xt,qt);const Ce=Math.hypot(Ht,Gt),ce=Math.hypot(Jt,oe);return[Ce*xt,ce*qt]}function ct(gt){const{width:z,height:X}=gt;if(z>Tt||X>Tt)return null;const G=1e3,J=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),it=z+1;let lt=new Uint8Array(it*(X+1)),Et,xt,qt;const Ht=z+7&-8;let Gt=new Uint8Array(Ht*X),Jt=0;for(const ce of gt.data){let Ae=128;for(;Ae>0;)Gt[Jt++]=ce&Ae?0:255,Ae>>=1}let oe=0;for(Jt=0,Gt[Jt]!==0&&(lt[0]=1,++oe),xt=1;xt<z;xt++)Gt[Jt]!==Gt[Jt+1]&&(lt[xt]=Gt[Jt]?2:1,++oe),Jt++;for(Gt[Jt]!==0&&(lt[xt]=2,++oe),Et=1;Et<X;Et++){Jt=Et*Ht,qt=Et*it,Gt[Jt-Ht]!==Gt[Jt]&&(lt[qt]=Gt[Jt]?1:8,++oe);let ce=(Gt[Jt]?4:0)+(Gt[Jt-Ht]?8:0);for(xt=1;xt<z;xt++)ce=(ce>>2)+(Gt[Jt+1]?4:0)+(Gt[Jt-Ht+1]?8:0),J[ce]&&(lt[qt+xt]=J[ce],++oe),Jt++;if(Gt[Jt-Ht]!==Gt[Jt]&&(lt[qt+xt]=Gt[Jt]?2:4,++oe),oe>G)return null}for(Jt=Ht*(X-1),qt=Et*it,Gt[Jt]!==0&&(lt[qt]=8,++oe),xt=1;xt<z;xt++)Gt[Jt]!==Gt[Jt+1]&&(lt[qt+xt]=Gt[Jt]?4:8,++oe),Jt++;if(Gt[Jt]!==0&&(lt[qt+xt]=4,++oe),oe>G)return null;const Zt=new Int32Array([0,it,-1,0,-it,0,0,0,1]),be=new Path2D;for(Et=0;oe&&Et<=X;Et++){let ce=Et*it;const Ae=ce+z;for(;ce<Ae&&!lt[ce];)ce++;if(ce===Ae)continue;be.moveTo(ce%it,Et);const te=ce;let Ut=lt[ce];do{const jt=Zt[Ut];do ce+=jt;while(!lt[ce]);const Qt=lt[ce];Qt!==5&&Qt!==10?(Ut=Qt,lt[ce]=0):(Ut=Qt&51*Ut>>4,lt[ce]&=Ut>>2|Ut<<2),be.lineTo(ce%it,ce/it|0),lt[ce]||--oe}while(te!==ce);--Et}return Gt=null,lt=null,function(ce){ce.save(),ce.scale(1/z,-1/X),ce.translate(0,-X),ce.fill(be),ce.beginPath(),ce.restore()}}class bt{constructor(z,X){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=D.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=D.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=D.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,z,X])}clone(){const z=Object.create(this);return z.clipBox=this.clipBox.slice(),z}setCurrentPoint(z,X){this.x=z,this.y=X}updatePathMinMax(z,X,G){[X,G]=D.Util.applyTransform([X,G],z),this.minX=Math.min(this.minX,X),this.minY=Math.min(this.minY,G),this.maxX=Math.max(this.maxX,X),this.maxY=Math.max(this.maxY,G)}updateRectMinMax(z,X){const G=D.Util.applyTransform(X,z),J=D.Util.applyTransform(X.slice(2),z);this.minX=Math.min(this.minX,G[0],J[0]),this.minY=Math.min(this.minY,G[1],J[1]),this.maxX=Math.max(this.maxX,G[0],J[0]),this.maxY=Math.max(this.maxY,G[1],J[1])}updateScalingPathMinMax(z,X){D.Util.scaleMinMax(z,X),this.minX=Math.min(this.minX,X[0]),this.maxX=Math.max(this.maxX,X[1]),this.minY=Math.min(this.minY,X[2]),this.maxY=Math.max(this.maxY,X[3])}updateCurvePathMinMax(z,X,G,J,it,lt,Et,xt,qt,Ht){const Gt=D.Util.bezierBoundingBox(X,G,J,it,lt,Et,xt,qt);if(Ht){Ht[0]=Math.min(Ht[0],Gt[0],Gt[2]),Ht[1]=Math.max(Ht[1],Gt[0],Gt[2]),Ht[2]=Math.min(Ht[2],Gt[1],Gt[3]),Ht[3]=Math.max(Ht[3],Gt[1],Gt[3]);return}this.updateRectMinMax(z,Gt)}getPathBoundingBox(z=tt.PathType.FILL,X=null){const G=[this.minX,this.minY,this.maxX,this.maxY];if(z===tt.PathType.STROKE){X||(0,D.unreachable)("Stroke bounding box must include transform.");const J=D.Util.singularValueDecompose2dScale(X),it=J[0]*this.lineWidth/2,lt=J[1]*this.lineWidth/2;G[0]-=it,G[1]-=lt,G[2]+=it,G[3]+=lt}return G}updateClipFromPath(){const z=D.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(z||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(z){this.clipBox=z,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(z=tt.PathType.FILL,X=null){return D.Util.intersect(this.clipBox,this.getPathBoundingBox(z,X))}}function _t(gt,z){if(typeof ImageData<"u"&&z instanceof ImageData){gt.putImageData(z,0,0);return}const X=z.height,G=z.width,J=X%vt,it=(X-J)/vt,lt=J===0?it:it+1,Et=gt.createImageData(G,vt);let xt=0,qt;const Ht=z.data,Gt=Et.data;let Jt,oe,Zt,be;if(z.kind===D.ImageKind.GRAYSCALE_1BPP){const Ce=Ht.byteLength,ce=new Uint32Array(Gt.buffer,0,Gt.byteLength>>2),Ae=ce.length,te=G+7>>3,Ut=4294967295,jt=D.FeatureTest.isLittleEndian?4278190080:255;for(Jt=0;Jt<lt;Jt++){for(Zt=Jt<it?vt:J,qt=0,oe=0;oe<Zt;oe++){const Qt=Ce-xt;let he=0;const ue=Qt>te?G:Qt*8-7,Pe=ue&-8;let Re=0,xe=0;for(;he<Pe;he+=8)xe=Ht[xt++],ce[qt++]=xe&128?Ut:jt,ce[qt++]=xe&64?Ut:jt,ce[qt++]=xe&32?Ut:jt,ce[qt++]=xe&16?Ut:jt,ce[qt++]=xe&8?Ut:jt,ce[qt++]=xe&4?Ut:jt,ce[qt++]=xe&2?Ut:jt,ce[qt++]=xe&1?Ut:jt;for(;he<ue;he++)Re===0&&(xe=Ht[xt++],Re=128),ce[qt++]=xe&Re?Ut:jt,Re>>=1}for(;qt<Ae;)ce[qt++]=0;gt.putImageData(Et,0,Jt*vt)}}else if(z.kind===D.ImageKind.RGBA_32BPP){for(oe=0,be=G*vt*4,Jt=0;Jt<it;Jt++)Gt.set(Ht.subarray(xt,xt+be)),xt+=be,gt.putImageData(Et,0,oe),oe+=vt;Jt<lt&&(be=G*J*4,Gt.set(Ht.subarray(xt,xt+be)),gt.putImageData(Et,0,oe))}else if(z.kind===D.ImageKind.RGB_24BPP)for(Zt=vt,be=G*Zt,Jt=0;Jt<lt;Jt++){for(Jt>=it&&(Zt=J,be=G*Zt),qt=0,oe=be;oe--;)Gt[qt++]=Ht[xt++],Gt[qt++]=Ht[xt++],Gt[qt++]=Ht[xt++],Gt[qt++]=255;gt.putImageData(Et,0,Jt*vt)}else throw new Error(`bad image kind: ${z.kind}`)}function pt(gt,z){if(z.bitmap){gt.drawImage(z.bitmap,0,0);return}const X=z.height,G=z.width,J=X%vt,it=(X-J)/vt,lt=J===0?it:it+1,Et=gt.createImageData(G,vt);let xt=0;const qt=z.data,Ht=Et.data;for(let Gt=0;Gt<lt;Gt++){const Jt=Gt<it?vt:J;({srcPos:xt}=(0,Q.convertBlackAndWhiteToRGBA)({src:qt,srcPos:xt,dest:Ht,width:G,height:Jt,nonBlackColor:0})),gt.putImageData(Et,0,Gt*vt)}}function K(gt,z){const X=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const G of X)gt[G]!==void 0&&(z[G]=gt[G]);gt.setLineDash!==void 0&&(z.setLineDash(gt.getLineDash()),z.lineDashOffset=gt.lineDashOffset)}function et(gt){if(gt.strokeStyle=gt.fillStyle="#000000",gt.fillRule="nonzero",gt.globalAlpha=1,gt.lineWidth=1,gt.lineCap="butt",gt.lineJoin="miter",gt.miterLimit=10,gt.globalCompositeOperation="source-over",gt.font="10px sans-serif",gt.setLineDash!==void 0&&(gt.setLineDash([]),gt.lineDashOffset=0),!D.isNodeJS){const{filter:z}=gt;z!=="none"&&z!==""&&(gt.filter="none")}}function St(gt,z,X,G){const J=gt.length;for(let it=3;it<J;it+=4){const lt=gt[it];if(lt===0)gt[it-3]=z,gt[it-2]=X,gt[it-1]=G;else if(lt<255){const Et=255-lt;gt[it-3]=gt[it-3]*lt+z*Et>>8,gt[it-2]=gt[it-2]*lt+X*Et>>8,gt[it-1]=gt[it-1]*lt+G*Et>>8}}}function at(gt,z,X){const G=gt.length,J=1/255;for(let it=3;it<G;it+=4){const lt=X?X[gt[it]]:gt[it];z[it]=z[it]*lt*J|0}}function Y(gt,z,X){const G=gt.length;for(let J=3;J<G;J+=4){const it=gt[J-3]*77+gt[J-2]*152+gt[J-1]*28;z[J]=X?z[J]*X[it>>8]>>8:z[J]*it>>16}}function At(gt,z,X,G,J,it,lt,Et,xt,qt,Ht){const Gt=!!it,Jt=Gt?it[0]:0,oe=Gt?it[1]:0,Zt=Gt?it[2]:0,be=J==="Luminosity"?Y:at,ce=Math.min(G,Math.ceil(1048576/X));for(let Ae=0;Ae<G;Ae+=ce){const te=Math.min(ce,G-Ae),Ut=gt.getImageData(Et-qt,Ae+(xt-Ht),X,te),jt=z.getImageData(Et,Ae+xt,X,te);Gt&&St(Ut.data,Jt,oe,Zt),be(Ut.data,jt.data,lt),z.putImageData(jt,Et,Ae+xt)}}function ot(gt,z,X,G){const J=G[0],it=G[1],lt=G[2]-J,Et=G[3]-it;lt===0||Et===0||(At(z.context,X,lt,Et,z.subtype,z.backdrop,z.transferMap,J,it,z.offsetX,z.offsetY),gt.save(),gt.globalAlpha=1,gt.globalCompositeOperation="source-over",gt.setTransform(1,0,0,1,0,0),gt.drawImage(X.canvas,0,0),gt.restore())}function kt(gt,z){const X=D.Util.singularValueDecompose2dScale(gt);X[0]=Math.fround(X[0]),X[1]=Math.fround(X[1]);const G=Math.fround((globalThis.devicePixelRatio||1)*U.PixelsPerInch.PDF_TO_CSS_UNITS);return z!==void 0?z:X[0]<=G||X[1]<=G}const Lt=["butt","round","square"],mt=["miter","round","bevel"],It={},Vt={},ge=class ge{constructor(z,X,G,J,it,{optionalContentConfig:lt,markedContentStack:Et=null},xt,qt){Pt(this,Mt);Pt(this,ee);this.ctx=z,this.current=new bt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=X,this.objs=G,this.canvasFactory=J,this.filterFactory=it,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Et||[],this.optionalContentConfig=lt,this.cachedCanvases=new ft(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=xt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=qt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(z,X=null){return typeof z=="string"?z.startsWith("g_")?this.commonObjs.get(z):this.objs.get(z):X}beginDrawing({transform:z,viewport:X,transparency:G=!1,background:J=null}){const it=this.ctx.canvas.width,lt=this.ctx.canvas.height,Et=this.ctx.fillStyle;if(this.ctx.fillStyle=J||"#ffffff",this.ctx.fillRect(0,0,it,lt),this.ctx.fillStyle=Et,G){const xt=this.cachedCanvases.getCanvas("transparent",it,lt);this.compositeCtx=this.ctx,this.transparentCanvas=xt.canvas,this.ctx=xt.context,this.ctx.save(),this.ctx.transform(...(0,U.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),et(this.ctx),z&&(this.ctx.transform(...z),this.outputScaleX=z[0],this.outputScaleY=z[0]),this.ctx.transform(...X.transform),this.viewportScale=X.scale,this.baseTransform=(0,U.getCurrentTransform)(this.ctx)}executeOperatorList(z,X,G,J){const it=z.argsArray,lt=z.fnArray;let Et=X||0;const xt=it.length;if(xt===Et)return Et;const qt=xt-Et>yt&&typeof G=="function",Ht=qt?Date.now()+st:0;let Gt=0;const Jt=this.commonObjs,oe=this.objs;let Zt;for(;;){if(J!==void 0&&Et===J.nextBreakPoint)return J.breakIt(Et,G),Et;if(Zt=lt[Et],Zt!==D.OPS.dependency)this[Zt].apply(this,it[Et]);else for(const be of it[Et]){const Ce=be.startsWith("g_")?Jt:oe;if(!Ce.has(be))return Ce.get(be,G),Et}if(Et++,Et===xt)return Et;if(qt&&++Gt>yt){if(Date.now()>Ht)return G(),Et;Gt=0}}}endDrawing(){Dt(this,Mt,ji).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const z of this._cachedBitmapsMap.values()){for(const X of z.values())typeof HTMLCanvasElement<"u"&&X instanceof HTMLCanvasElement&&(X.width=X.height=0);z.clear()}this._cachedBitmapsMap.clear(),Dt(this,ee,Hi).call(this)}_scaleImage(z,X){const G=z.width,J=z.height;let it=Math.max(Math.hypot(X[0],X[1]),1),lt=Math.max(Math.hypot(X[2],X[3]),1),Et=G,xt=J,qt="prescale1",Ht,Gt;for(;it>2&&Et>1||lt>2&&xt>1;){let Jt=Et,oe=xt;it>2&&Et>1&&(Jt=Et>=16384?Math.floor(Et/2)-1||1:Math.ceil(Et/2),it/=Et/Jt),lt>2&&xt>1&&(oe=xt>=16384?Math.floor(xt/2)-1||1:Math.ceil(xt)/2,lt/=xt/oe),Ht=this.cachedCanvases.getCanvas(qt,Jt,oe),Gt=Ht.context,Gt.clearRect(0,0,Jt,oe),Gt.drawImage(z,0,0,Et,xt,0,0,Jt,oe),z=Ht.canvas,Et=Jt,xt=oe,qt=qt==="prescale1"?"prescale2":"prescale1"}return{img:z,paintWidth:Et,paintHeight:xt}}_createMaskCanvas(z){const X=this.ctx,{width:G,height:J}=z,it=this.current.fillColor,lt=this.current.patternFill,Et=(0,U.getCurrentTransform)(X);let xt,qt,Ht,Gt;if((z.bitmap||z.data)&&z.count>1){const he=z.bitmap||z.data.buffer;qt=JSON.stringify(lt?Et:[Et.slice(0,4),it]),xt=this._cachedBitmapsMap.get(he),xt||(xt=new Map,this._cachedBitmapsMap.set(he,xt));const ue=xt.get(qt);if(ue&&!lt){const Pe=Math.round(Math.min(Et[0],Et[2])+Et[4]),Re=Math.round(Math.min(Et[1],Et[3])+Et[5]);return{canvas:ue,offsetX:Pe,offsetY:Re}}Ht=ue}Ht||(Gt=this.cachedCanvases.getCanvas("maskCanvas",G,J),pt(Gt.context,z));let Jt=D.Util.transform(Et,[1/G,0,0,-1/J,0,0]);Jt=D.Util.transform(Jt,[1,0,0,1,0,-J]);const oe=D.Util.applyTransform([0,0],Jt),Zt=D.Util.applyTransform([G,J],Jt),be=D.Util.normalizeRect([oe[0],oe[1],Zt[0],Zt[1]]),Ce=Math.round(be[2]-be[0])||1,ce=Math.round(be[3]-be[1])||1,Ae=this.cachedCanvases.getCanvas("fillCanvas",Ce,ce),te=Ae.context,Ut=Math.min(oe[0],Zt[0]),jt=Math.min(oe[1],Zt[1]);te.translate(-Ut,-jt),te.transform(...Jt),Ht||(Ht=this._scaleImage(Gt.canvas,(0,U.getCurrentTransformInverse)(te)),Ht=Ht.img,xt&&lt&&xt.set(qt,Ht)),te.imageSmoothingEnabled=kt((0,U.getCurrentTransform)(te),z.interpolate),nt(te,Ht,0,0,Ht.width,Ht.height,0,0,G,J),te.globalCompositeOperation="source-in";const Qt=D.Util.transform((0,U.getCurrentTransformInverse)(te),[1,0,0,1,-Ut,-jt]);return te.fillStyle=lt?it.getPattern(X,this,Qt,tt.PathType.FILL):it,te.fillRect(0,0,G,J),xt&&!lt&&(this.cachedCanvases.delete("fillCanvas"),xt.set(qt,Ae.canvas)),{canvas:Ae.canvas,offsetX:Math.round(Ut),offsetY:Math.round(jt)}}setLineWidth(z){z!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=z,this.ctx.lineWidth=z}setLineCap(z){this.ctx.lineCap=Lt[z]}setLineJoin(z){this.ctx.lineJoin=mt[z]}setMiterLimit(z){this.ctx.miterLimit=z}setDash(z,X){const G=this.ctx;G.setLineDash!==void 0&&(G.setLineDash(z),G.lineDashOffset=X)}setRenderingIntent(z){}setFlatness(z){}setGState(z){for(const[X,G]of z)switch(X){case"LW":this.setLineWidth(G);break;case"LC":this.setLineCap(G);break;case"LJ":this.setLineJoin(G);break;case"ML":this.setMiterLimit(G);break;case"D":this.setDash(G[0],G[1]);break;case"RI":this.setRenderingIntent(G);break;case"FL":this.setFlatness(G);break;case"Font":this.setFont(G[0],G[1]);break;case"CA":this.current.strokeAlpha=G;break;case"ca":this.current.fillAlpha=G,this.ctx.globalAlpha=G;break;case"BM":this.ctx.globalCompositeOperation=G;break;case"SMask":this.current.activeSMask=G?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(G);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const z=this.inSMaskMode;this.current.activeSMask&&!z?this.beginSMaskMode():!this.current.activeSMask&&z&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const z=this.ctx.canvas.width,X=this.ctx.canvas.height,G="smaskGroupAt"+this.groupLevel,J=this.cachedCanvases.getCanvas(G,z,X);this.suspendedCtx=this.ctx,this.ctx=J.context;const it=this.ctx;it.setTransform(...(0,U.getCurrentTransform)(this.suspendedCtx)),K(this.suspendedCtx,it),ut(it,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),K(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(z){if(!this.current.activeSMask)return;z?(z[0]=Math.floor(z[0]),z[1]=Math.floor(z[1]),z[2]=Math.ceil(z[2]),z[3]=Math.ceil(z[3])):z=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const X=this.current.activeSMask,G=this.suspendedCtx;ot(G,X,this.ctx,z),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(K(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const z=this.current;this.stateStack.push(z),this.current=z.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),K(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(z,X,G,J,it,lt){this.ctx.transform(z,X,G,J,it,lt),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(z,X,G){const J=this.ctx,it=this.current;let lt=it.x,Et=it.y,xt,qt;const Ht=(0,U.getCurrentTransform)(J),Gt=Ht[0]===0&&Ht[3]===0||Ht[1]===0&&Ht[2]===0,Jt=Gt?G.slice(0):null;for(let oe=0,Zt=0,be=z.length;oe<be;oe++)switch(z[oe]|0){case D.OPS.rectangle:lt=X[Zt++],Et=X[Zt++];const Ce=X[Zt++],ce=X[Zt++],Ae=lt+Ce,te=Et+ce;J.moveTo(lt,Et),Ce===0||ce===0?J.lineTo(Ae,te):(J.lineTo(Ae,Et),J.lineTo(Ae,te),J.lineTo(lt,te)),Gt||it.updateRectMinMax(Ht,[lt,Et,Ae,te]),J.closePath();break;case D.OPS.moveTo:lt=X[Zt++],Et=X[Zt++],J.moveTo(lt,Et),Gt||it.updatePathMinMax(Ht,lt,Et);break;case D.OPS.lineTo:lt=X[Zt++],Et=X[Zt++],J.lineTo(lt,Et),Gt||it.updatePathMinMax(Ht,lt,Et);break;case D.OPS.curveTo:xt=lt,qt=Et,lt=X[Zt+4],Et=X[Zt+5],J.bezierCurveTo(X[Zt],X[Zt+1],X[Zt+2],X[Zt+3],lt,Et),it.updateCurvePathMinMax(Ht,xt,qt,X[Zt],X[Zt+1],X[Zt+2],X[Zt+3],lt,Et,Jt),Zt+=6;break;case D.OPS.curveTo2:xt=lt,qt=Et,J.bezierCurveTo(lt,Et,X[Zt],X[Zt+1],X[Zt+2],X[Zt+3]),it.updateCurvePathMinMax(Ht,xt,qt,lt,Et,X[Zt],X[Zt+1],X[Zt+2],X[Zt+3],Jt),lt=X[Zt+2],Et=X[Zt+3],Zt+=4;break;case D.OPS.curveTo3:xt=lt,qt=Et,lt=X[Zt+2],Et=X[Zt+3],J.bezierCurveTo(X[Zt],X[Zt+1],lt,Et,lt,Et),it.updateCurvePathMinMax(Ht,xt,qt,X[Zt],X[Zt+1],lt,Et,lt,Et,Jt),Zt+=4;break;case D.OPS.closePath:J.closePath();break}Gt&&it.updateScalingPathMinMax(Ht,Jt),it.setCurrentPoint(lt,Et)}closePath(){this.ctx.closePath()}stroke(z=!0){const X=this.ctx,G=this.current.strokeColor;X.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof G=="object"&&(G!=null&&G.getPattern)?(X.save(),X.strokeStyle=G.getPattern(X,this,(0,U.getCurrentTransformInverse)(X),tt.PathType.STROKE),this.rescaleAndStroke(!1),X.restore()):this.rescaleAndStroke(!0)),z&&this.consumePath(this.current.getClippedPathBoundingBox()),X.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(z=!0){const X=this.ctx,G=this.current.fillColor,J=this.current.patternFill;let it=!1;J&&(X.save(),X.fillStyle=G.getPattern(X,this,(0,U.getCurrentTransformInverse)(X),tt.PathType.FILL),it=!0);const lt=this.current.getClippedPathBoundingBox();this.contentVisible&&lt!==null&&(this.pendingEOFill?(X.fill("evenodd"),this.pendingEOFill=!1):X.fill()),it&&X.restore(),z&&this.consumePath(lt)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=It}eoClip(){this.pendingClip=Vt}beginText(){this.current.textMatrix=D.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const z=this.pendingTextPaths,X=this.ctx;if(z===void 0){X.beginPath();return}X.save(),X.beginPath();for(const G of z)X.setTransform(...G.transform),X.translate(G.x,G.y),G.addToPath(X,G.fontSize);X.restore(),X.clip(),X.beginPath(),delete this.pendingTextPaths}setCharSpacing(z){this.current.charSpacing=z}setWordSpacing(z){this.current.wordSpacing=z}setHScale(z){this.current.textHScale=z/100}setLeading(z){this.current.leading=-z}setFont(z,X){var Ht;const G=this.commonObjs.get(z),J=this.current;if(!G)throw new Error(`Can't find font for ${z}`);if(J.fontMatrix=G.fontMatrix||D.FONT_IDENTITY_MATRIX,(J.fontMatrix[0]===0||J.fontMatrix[3]===0)&&(0,D.warn)("Invalid font matrix for font "+z),X<0?(X=-X,J.fontDirection=-1):J.fontDirection=1,this.current.font=G,this.current.fontSize=X,G.isType3Font)return;const it=G.loadedName||"sans-serif",lt=((Ht=G.systemFontInfo)==null?void 0:Ht.css)||`"${it}", ${G.fallbackName}`;let Et="normal";G.black?Et="900":G.bold&&(Et="bold");const xt=G.italic?"italic":"normal";let qt=X;X<Ft?qt=Ft:X>ht&&(qt=ht),this.current.fontSizeScale=X/qt,this.ctx.font=`${xt} ${Et} ${qt}px ${lt}`}setTextRenderingMode(z){this.current.textRenderingMode=z}setTextRise(z){this.current.textRise=z}moveText(z,X){this.current.x=this.current.lineX+=z,this.current.y=this.current.lineY+=X}setLeadingMoveText(z,X){this.setLeading(-X),this.moveText(z,X)}setTextMatrix(z,X,G,J,it,lt){this.current.textMatrix=[z,X,G,J,it,lt],this.current.textMatrixScale=Math.hypot(z,X),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(z,X,G,J){const it=this.ctx,lt=this.current,Et=lt.font,xt=lt.textRenderingMode,qt=lt.fontSize/lt.fontSizeScale,Ht=xt&D.TextRenderingMode.FILL_STROKE_MASK,Gt=!!(xt&D.TextRenderingMode.ADD_TO_PATH_FLAG),Jt=lt.patternFill&&!Et.missingFile;let oe;(Et.disableFontFace||Gt||Jt)&&(oe=Et.getPathGenerator(this.commonObjs,z)),Et.disableFontFace||Jt?(it.save(),it.translate(X,G),it.beginPath(),oe(it,qt),J&&it.setTransform(...J),(Ht===D.TextRenderingMode.FILL||Ht===D.TextRenderingMode.FILL_STROKE)&&it.fill(),(Ht===D.TextRenderingMode.STROKE||Ht===D.TextRenderingMode.FILL_STROKE)&&it.stroke(),it.restore()):((Ht===D.TextRenderingMode.FILL||Ht===D.TextRenderingMode.FILL_STROKE)&&it.fillText(z,X,G),(Ht===D.TextRenderingMode.STROKE||Ht===D.TextRenderingMode.FILL_STROKE)&&it.strokeText(z,X,G)),Gt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,U.getCurrentTransform)(it),x:X,y:G,fontSize:qt,addToPath:oe})}get isFontSubpixelAAEnabled(){const{context:z}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);z.scale(1.5,1),z.fillText("I",0,10);const X=z.getImageData(0,0,10,10).data;let G=!1;for(let J=3;J<X.length;J+=4)if(X[J]>0&&X[J]<255){G=!0;break}return(0,D.shadow)(this,"isFontSubpixelAAEnabled",G)}showText(z){const X=this.current,G=X.font;if(G.isType3Font)return this.showType3Text(z);const J=X.fontSize;if(J===0)return;const it=this.ctx,lt=X.fontSizeScale,Et=X.charSpacing,xt=X.wordSpacing,qt=X.fontDirection,Ht=X.textHScale*qt,Gt=z.length,Jt=G.vertical,oe=Jt?1:-1,Zt=G.defaultVMetrics,be=J*X.fontMatrix[0],Ce=X.textRenderingMode===D.TextRenderingMode.FILL&&!G.disableFontFace&&!X.patternFill;it.save(),it.transform(...X.textMatrix),it.translate(X.x,X.y+X.textRise),qt>0?it.scale(Ht,-1):it.scale(Ht,1);let ce;if(X.patternFill){it.save();const Qt=X.fillColor.getPattern(it,this,(0,U.getCurrentTransformInverse)(it),tt.PathType.FILL);ce=(0,U.getCurrentTransform)(it),it.restore(),it.fillStyle=Qt}let Ae=X.lineWidth;const te=X.textMatrixScale;if(te===0||Ae===0){const Qt=X.textRenderingMode&D.TextRenderingMode.FILL_STROKE_MASK;(Qt===D.TextRenderingMode.STROKE||Qt===D.TextRenderingMode.FILL_STROKE)&&(Ae=this.getSinglePixelWidth())}else Ae/=te;if(lt!==1&&(it.scale(lt,lt),Ae/=lt),it.lineWidth=Ae,G.isInvalidPDFjsFont){const Qt=[];let he=0;for(const ue of z)Qt.push(ue.unicode),he+=ue.width;it.fillText(Qt.join(""),0,0),X.x+=he*be*Ht,it.restore(),this.compose();return}let Ut=0,jt;for(jt=0;jt<Gt;++jt){const Qt=z[jt];if(typeof Qt=="number"){Ut+=oe*Qt*J/1e3;continue}let he=!1;const ue=(Qt.isSpace?xt:0)+Et,Pe=Qt.fontChar,Re=Qt.accent;let xe,Fe,De=Qt.width;if(Jt){const Le=Qt.vmetric||Zt,Yt=-(Qt.vmetric?Le[1]:De*.5)*be,Bt=Le[2]*be;De=Le?-Le[0]:De,xe=Yt/lt,Fe=(Ut+Bt)/lt}else xe=Ut/lt,Fe=0;if(G.remeasure&&De>0){const Le=it.measureText(Pe).width*1e3/J*lt;if(De<Le&&this.isFontSubpixelAAEnabled){const Yt=De/Le;he=!0,it.save(),it.scale(Yt,1),xe/=Yt}else De!==Le&&(xe+=(De-Le)/2e3*J/lt)}if(this.contentVisible&&(Qt.isInFont||G.missingFile)){if(Ce&&!Re)it.fillText(Pe,xe,Fe);else if(this.paintChar(Pe,xe,Fe,ce),Re){const Le=xe+J*Re.offset.x/lt,Yt=Fe-J*Re.offset.y/lt;this.paintChar(Re.fontChar,Le,Yt,ce)}}const ke=Jt?De*be-ue*qt:De*be+ue*qt;Ut+=ke,he&&it.restore()}Jt?X.y-=Ut:X.x+=Ut*Ht,it.restore(),this.compose()}showType3Text(z){const X=this.ctx,G=this.current,J=G.font,it=G.fontSize,lt=G.fontDirection,Et=J.vertical?1:-1,xt=G.charSpacing,qt=G.wordSpacing,Ht=G.textHScale*lt,Gt=G.fontMatrix||D.FONT_IDENTITY_MATRIX,Jt=z.length,oe=G.textRenderingMode===D.TextRenderingMode.INVISIBLE;let Zt,be,Ce,ce;if(!(oe||it===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,X.save(),X.transform(...G.textMatrix),X.translate(G.x,G.y),X.scale(Ht,lt),Zt=0;Zt<Jt;++Zt){if(be=z[Zt],typeof be=="number"){ce=Et*be*it/1e3,this.ctx.translate(ce,0),G.x+=ce*Ht;continue}const Ae=(be.isSpace?qt:0)+xt,te=J.charProcOperatorList[be.operatorListId];if(!te){(0,D.warn)(`Type3 character "${be.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=be,this.save(),X.scale(it,it),X.transform(...Gt),this.executeOperatorList(te),this.restore()),Ce=D.Util.applyTransform([be.width,0],Gt)[0]*it+Ae,X.translate(Ce,0),G.x+=Ce*Ht}X.restore(),this.processingType3=null}}setCharWidth(z,X){}setCharWidthAndBounds(z,X,G,J,it,lt){this.ctx.rect(G,J,it-G,lt-J),this.ctx.clip(),this.endPath()}getColorN_Pattern(z){let X;if(z[0]==="TilingPattern"){const G=z[1],J=this.baseTransform||(0,U.getCurrentTransform)(this.ctx),it={createCanvasGraphics:lt=>new ge(lt,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};X=new tt.TilingPattern(z,G,this.ctx,it,J)}else X=this._getPattern(z[1],z[2]);return X}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(z,X,G){const J=D.Util.makeHexColor(z,X,G);this.ctx.strokeStyle=J,this.current.strokeColor=J}setFillRGBColor(z,X,G){const J=D.Util.makeHexColor(z,X,G);this.ctx.fillStyle=J,this.current.fillColor=J,this.current.patternFill=!1}_getPattern(z,X=null){let G;return this.cachedPatterns.has(z)?G=this.cachedPatterns.get(z):(G=(0,tt.getShadingPattern)(this.getObject(z)),this.cachedPatterns.set(z,G)),X&&(G.matrix=X),G}shadingFill(z){if(!this.contentVisible)return;const X=this.ctx;this.save();const G=this._getPattern(z);X.fillStyle=G.getPattern(X,this,(0,U.getCurrentTransformInverse)(X),tt.PathType.SHADING);const J=(0,U.getCurrentTransformInverse)(X);if(J){const{width:it,height:lt}=X.canvas,[Et,xt,qt,Ht]=D.Util.getAxialAlignedBoundingBox([0,0,it,lt],J);this.ctx.fillRect(Et,xt,qt-Et,Ht-xt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,D.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,D.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(z,X){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(z)&&z.length===6&&this.transform(...z),this.baseTransform=(0,U.getCurrentTransform)(this.ctx),X)){const G=X[2]-X[0],J=X[3]-X[1];this.ctx.rect(X[0],X[1],G,J),this.current.updateRectMinMax((0,U.getCurrentTransform)(this.ctx),X),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(z){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const X=this.ctx;z.isolated||(0,D.info)("TODO: Support non-isolated groups."),z.knockout&&(0,D.warn)("Knockout groups not supported.");const G=(0,U.getCurrentTransform)(X);if(z.matrix&&X.transform(...z.matrix),!z.bbox)throw new Error("Bounding box is required.");let J=D.Util.getAxialAlignedBoundingBox(z.bbox,(0,U.getCurrentTransform)(X));const it=[0,0,X.canvas.width,X.canvas.height];J=D.Util.intersect(J,it)||[0,0,0,0];const lt=Math.floor(J[0]),Et=Math.floor(J[1]);let xt=Math.max(Math.ceil(J[2])-lt,1),qt=Math.max(Math.ceil(J[3])-Et,1),Ht=1,Gt=1;xt>dt&&(Ht=xt/dt,xt=dt),qt>dt&&(Gt=qt/dt,qt=dt),this.current.startNewPathAndClipBox([0,0,xt,qt]);let Jt="groupAt"+this.groupLevel;z.smask&&(Jt+="_smask_"+this.smaskCounter++%2);const oe=this.cachedCanvases.getCanvas(Jt,xt,qt),Zt=oe.context;Zt.scale(1/Ht,1/Gt),Zt.translate(-lt,-Et),Zt.transform(...G),z.smask?this.smaskStack.push({canvas:oe.canvas,context:Zt,offsetX:lt,offsetY:Et,scaleX:Ht,scaleY:Gt,subtype:z.smask.subtype,backdrop:z.smask.backdrop,transferMap:z.smask.transferMap||null,startTransformInverse:null}):(X.setTransform(1,0,0,1,0,0),X.translate(lt,Et),X.scale(Ht,Gt),X.save()),K(X,Zt),this.ctx=Zt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(X),this.groupLevel++}endGroup(z){if(!this.contentVisible)return;this.groupLevel--;const X=this.ctx,G=this.groupStack.pop();if(this.ctx=G,this.ctx.imageSmoothingEnabled=!1,z.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const J=(0,U.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...J);const it=D.Util.getAxialAlignedBoundingBox([0,0,X.canvas.width,X.canvas.height],J);this.ctx.drawImage(X.canvas,0,0),this.ctx.restore(),this.compose(it)}}beginAnnotation(z,X,G,J,it){if(Dt(this,Mt,ji).call(this),et(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(X)&&X.length===4){const lt=X[2]-X[0],Et=X[3]-X[1];if(it&&this.annotationCanvasMap){G=G.slice(),G[4]-=X[0],G[5]-=X[1],X=X.slice(),X[0]=X[1]=0,X[2]=lt,X[3]=Et;const[xt,qt]=D.Util.singularValueDecompose2dScale((0,U.getCurrentTransform)(this.ctx)),{viewportScale:Ht}=this,Gt=Math.ceil(lt*this.outputScaleX*Ht),Jt=Math.ceil(Et*this.outputScaleY*Ht);this.annotationCanvas=this.canvasFactory.create(Gt,Jt);const{canvas:oe,context:Zt}=this.annotationCanvas;this.annotationCanvasMap.set(z,oe),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Zt,this.ctx.save(),this.ctx.setTransform(xt,0,0,-qt,0,Et*qt),et(this.ctx)}else et(this.ctx),this.ctx.rect(X[0],X[1],lt,Et),this.ctx.clip(),this.endPath()}this.current=new bt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...G),this.transform(...J)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Dt(this,ee,Hi).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(z){if(!this.contentVisible)return;const X=z.count;z=this.getObject(z.data,z),z.count=X;const G=this.ctx,J=this.processingType3;if(J&&(J.compiled===void 0&&(J.compiled=ct(z)),J.compiled)){J.compiled(G);return}const it=this._createMaskCanvas(z),lt=it.canvas;G.save(),G.setTransform(1,0,0,1,0,0),G.drawImage(lt,it.offsetX,it.offsetY),G.restore(),this.compose()}paintImageMaskXObjectRepeat(z,X,G=0,J=0,it,lt){if(!this.contentVisible)return;z=this.getObject(z.data,z);const Et=this.ctx;Et.save();const xt=(0,U.getCurrentTransform)(Et);Et.transform(X,G,J,it,0,0);const qt=this._createMaskCanvas(z);Et.setTransform(1,0,0,1,qt.offsetX-xt[4],qt.offsetY-xt[5]);for(let Ht=0,Gt=lt.length;Ht<Gt;Ht+=2){const Jt=D.Util.transform(xt,[X,G,J,it,lt[Ht],lt[Ht+1]]),[oe,Zt]=D.Util.applyTransform([0,0],Jt);Et.drawImage(qt.canvas,oe,Zt)}Et.restore(),this.compose()}paintImageMaskXObjectGroup(z){if(!this.contentVisible)return;const X=this.ctx,G=this.current.fillColor,J=this.current.patternFill;for(const it of z){const{data:lt,width:Et,height:xt,transform:qt}=it,Ht=this.cachedCanvases.getCanvas("maskCanvas",Et,xt),Gt=Ht.context;Gt.save();const Jt=this.getObject(lt,it);pt(Gt,Jt),Gt.globalCompositeOperation="source-in",Gt.fillStyle=J?G.getPattern(Gt,this,(0,U.getCurrentTransformInverse)(X),tt.PathType.FILL):G,Gt.fillRect(0,0,Et,xt),Gt.restore(),X.save(),X.transform(...qt),X.scale(1,-1),nt(X,Ht.canvas,0,0,Et,xt,0,-1,1,1),X.restore()}this.compose()}paintImageXObject(z){if(!this.contentVisible)return;const X=this.getObject(z);if(!X){(0,D.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(X)}paintImageXObjectRepeat(z,X,G,J){if(!this.contentVisible)return;const it=this.getObject(z);if(!it){(0,D.warn)("Dependent image isn't ready yet");return}const lt=it.width,Et=it.height,xt=[];for(let qt=0,Ht=J.length;qt<Ht;qt+=2)xt.push({transform:[X,0,0,G,J[qt],J[qt+1]],x:0,y:0,w:lt,h:Et});this.paintInlineImageXObjectGroup(it,xt)}applyTransferMapsToCanvas(z){return this.current.transferMaps!=="none"&&(z.filter=this.current.transferMaps,z.drawImage(z.canvas,0,0),z.filter="none"),z.canvas}applyTransferMapsToBitmap(z){if(this.current.transferMaps==="none")return z.bitmap;const{bitmap:X,width:G,height:J}=z,it=this.cachedCanvases.getCanvas("inlineImage",G,J),lt=it.context;return lt.filter=this.current.transferMaps,lt.drawImage(X,0,0),lt.filter="none",it.canvas}paintInlineImageXObject(z){if(!this.contentVisible)return;const X=z.width,G=z.height,J=this.ctx;if(this.save(),!D.isNodeJS){const{filter:Et}=J;Et!=="none"&&Et!==""&&(J.filter="none")}J.scale(1/X,-1/G);let it;if(z.bitmap)it=this.applyTransferMapsToBitmap(z);else if(typeof HTMLElement=="function"&&z instanceof HTMLElement||!z.data)it=z;else{const xt=this.cachedCanvases.getCanvas("inlineImage",X,G).context;_t(xt,z),it=this.applyTransferMapsToCanvas(xt)}const lt=this._scaleImage(it,(0,U.getCurrentTransformInverse)(J));J.imageSmoothingEnabled=kt((0,U.getCurrentTransform)(J),z.interpolate),nt(J,lt.img,0,0,lt.paintWidth,lt.paintHeight,0,-G,X,G),this.compose(),this.restore()}paintInlineImageXObjectGroup(z,X){if(!this.contentVisible)return;const G=this.ctx;let J;if(z.bitmap)J=z.bitmap;else{const it=z.width,lt=z.height,xt=this.cachedCanvases.getCanvas("inlineImage",it,lt).context;_t(xt,z),J=this.applyTransferMapsToCanvas(xt)}for(const it of X)G.save(),G.transform(...it.transform),G.scale(1,-1),nt(G,J,it.x,it.y,it.w,it.h,0,-1,1,1),G.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(z){}markPointProps(z,X){}beginMarkedContent(z){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(z,X){z==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(X)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(z){const X=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(z);const G=this.ctx;this.pendingClip&&(X||(this.pendingClip===Vt?G.clip("evenodd"):G.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),G.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const z=(0,U.getCurrentTransform)(this.ctx);if(z[1]===0&&z[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(z[0]),Math.abs(z[3]));else{const X=Math.abs(z[0]*z[3]-z[2]*z[1]),G=Math.hypot(z[0],z[2]),J=Math.hypot(z[1],z[3]);this._cachedGetSinglePixelWidth=Math.max(G,J)/X}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:z}=this.current,{a:X,b:G,c:J,d:it}=this.ctx.getTransform();let lt,Et;if(G===0&&J===0){const xt=Math.abs(X),qt=Math.abs(it);if(xt===qt)if(z===0)lt=Et=1/xt;else{const Ht=xt*z;lt=Et=Ht<1?1/Ht:1}else if(z===0)lt=1/xt,Et=1/qt;else{const Ht=xt*z,Gt=qt*z;lt=Ht<1?1/Ht:1,Et=Gt<1?1/Gt:1}}else{const xt=Math.abs(X*it-G*J),qt=Math.hypot(X,G),Ht=Math.hypot(J,it);if(z===0)lt=Ht/xt,Et=qt/xt;else{const Gt=z*xt;lt=Ht>Gt?Ht/Gt:1,Et=qt>Gt?qt/Gt:1}}this._cachedScaleForStroking[0]=lt,this._cachedScaleForStroking[1]=Et}return this._cachedScaleForStroking}rescaleAndStroke(z){const{ctx:X}=this,{lineWidth:G}=this.current,[J,it]=this.getScaleForStroking();if(X.lineWidth=G||1,J===1&&it===1){X.stroke();return}const lt=X.getLineDash();if(z&&X.save(),X.scale(J,it),lt.length>0){const Et=Math.max(J,it);X.setLineDash(lt.map(xt=>xt/Et)),X.lineDashOffset/=Et}X.stroke(),z&&X.restore()}isContentVisible(){for(let z=this.markedContentStack.length-1;z>=0;z--)if(!this.markedContentStack[z].visible)return!1;return!0}};Mt=new WeakSet,ji=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ee=new WeakSet,Hi=function(){if(this.pageColors){const z=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(z!=="none"){const X=this.ctx.filter;this.ctx.filter=z,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=X}}};let Xt=ge;F.CanvasGraphics=Xt;for(const gt in D.OPS)Xt.prototype[gt]!==void 0&&(Xt.prototype[D.OPS[gt]]=Xt.prototype[gt])},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.TilingPattern=F.PathType=void 0,F.getShadingPattern=vt;var D=O(1),U=O(6);const tt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};F.PathType=tt;function Q(ct,bt){if(!bt)return;const _t=bt[2]-bt[0],pt=bt[3]-bt[1],K=new Path2D;K.rect(bt[0],bt[1],_t,pt),ct.clip(K)}class Ft{constructor(){this.constructor===Ft&&(0,D.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,D.unreachable)("Abstract method `getPattern` called.")}}class ht extends Ft{constructor(bt){super(),this._type=bt[1],this._bbox=bt[2],this._colorStops=bt[3],this._p0=bt[4],this._p1=bt[5],this._r0=bt[6],this._r1=bt[7],this.matrix=null}_createGradient(bt){let _t;this._type==="axial"?_t=bt.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(_t=bt.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const pt of this._colorStops)_t.addColorStop(pt[0],pt[1]);return _t}getPattern(bt,_t,pt,K){let et;if(K===tt.STROKE||K===tt.FILL){const St=_t.current.getClippedPathBoundingBox(K,(0,U.getCurrentTransform)(bt))||[0,0,0,0],at=Math.ceil(St[2]-St[0])||1,Y=Math.ceil(St[3]-St[1])||1,At=_t.cachedCanvases.getCanvas("pattern",at,Y,!0),ot=At.context;ot.clearRect(0,0,ot.canvas.width,ot.canvas.height),ot.beginPath(),ot.rect(0,0,ot.canvas.width,ot.canvas.height),ot.translate(-St[0],-St[1]),pt=D.Util.transform(pt,[1,0,0,1,St[0],St[1]]),ot.transform(..._t.baseTransform),this.matrix&&ot.transform(...this.matrix),Q(ot,this._bbox),ot.fillStyle=this._createGradient(ot),ot.fill(),et=bt.createPattern(At.canvas,"no-repeat");const kt=new DOMMatrix(pt);et.setTransform(kt)}else Q(bt,this._bbox),et=this._createGradient(bt);return et}}function dt(ct,bt,_t,pt,K,et,St,at){const Y=bt.coords,At=bt.colors,ot=ct.data,kt=ct.width*4;let Lt;Y[_t+1]>Y[pt+1]&&(Lt=_t,_t=pt,pt=Lt,Lt=et,et=St,St=Lt),Y[pt+1]>Y[K+1]&&(Lt=pt,pt=K,K=Lt,Lt=St,St=at,at=Lt),Y[_t+1]>Y[pt+1]&&(Lt=_t,_t=pt,pt=Lt,Lt=et,et=St,St=Lt);const mt=(Y[_t]+bt.offsetX)*bt.scaleX,It=(Y[_t+1]+bt.offsetY)*bt.scaleY,Vt=(Y[pt]+bt.offsetX)*bt.scaleX,Xt=(Y[pt+1]+bt.offsetY)*bt.scaleY,Mt=(Y[K]+bt.offsetX)*bt.scaleX,Kt=(Y[K+1]+bt.offsetY)*bt.scaleY;if(It>=Kt)return;const ee=At[et],de=At[et+1],ge=At[et+2],gt=At[St],z=At[St+1],X=At[St+2],G=At[at],J=At[at+1],it=At[at+2],lt=Math.round(It),Et=Math.round(Kt);let xt,qt,Ht,Gt,Jt,oe,Zt,be;for(let Ce=lt;Ce<=Et;Ce++){if(Ce<Xt){const jt=Ce<It?0:(It-Ce)/(It-Xt);xt=mt-(mt-Vt)*jt,qt=ee-(ee-gt)*jt,Ht=de-(de-z)*jt,Gt=ge-(ge-X)*jt}else{let jt;Ce>Kt?jt=1:Xt===Kt?jt=0:jt=(Xt-Ce)/(Xt-Kt),xt=Vt-(Vt-Mt)*jt,qt=gt-(gt-G)*jt,Ht=z-(z-J)*jt,Gt=X-(X-it)*jt}let ce;Ce<It?ce=0:Ce>Kt?ce=1:ce=(It-Ce)/(It-Kt),Jt=mt-(mt-Mt)*ce,oe=ee-(ee-G)*ce,Zt=de-(de-J)*ce,be=ge-(ge-it)*ce;const Ae=Math.round(Math.min(xt,Jt)),te=Math.round(Math.max(xt,Jt));let Ut=kt*Ce+Ae*4;for(let jt=Ae;jt<=te;jt++)ce=(xt-jt)/(xt-Jt),ce<0?ce=0:ce>1&&(ce=1),ot[Ut++]=qt-(qt-oe)*ce|0,ot[Ut++]=Ht-(Ht-Zt)*ce|0,ot[Ut++]=Gt-(Gt-be)*ce|0,ot[Ut++]=255}}function st(ct,bt,_t){const pt=bt.coords,K=bt.colors;let et,St;switch(bt.type){case"lattice":const at=bt.verticesPerRow,Y=Math.floor(pt.length/at)-1,At=at-1;for(et=0;et<Y;et++){let ot=et*at;for(let kt=0;kt<At;kt++,ot++)dt(ct,_t,pt[ot],pt[ot+1],pt[ot+at],K[ot],K[ot+1],K[ot+at]),dt(ct,_t,pt[ot+at+1],pt[ot+1],pt[ot+at],K[ot+at+1],K[ot+1],K[ot+at])}break;case"triangles":for(et=0,St=pt.length;et<St;et+=3)dt(ct,_t,pt[et],pt[et+1],pt[et+2],K[et],K[et+1],K[et+2]);break;default:throw new Error("illegal figure")}}class yt extends Ft{constructor(bt){super(),this._coords=bt[2],this._colors=bt[3],this._figures=bt[4],this._bounds=bt[5],this._bbox=bt[7],this._background=bt[8],this.matrix=null}_createMeshCanvas(bt,_t,pt){const at=Math.floor(this._bounds[0]),Y=Math.floor(this._bounds[1]),At=Math.ceil(this._bounds[2])-at,ot=Math.ceil(this._bounds[3])-Y,kt=Math.min(Math.ceil(Math.abs(At*bt[0]*1.1)),3e3),Lt=Math.min(Math.ceil(Math.abs(ot*bt[1]*1.1)),3e3),mt=At/kt,It=ot/Lt,Vt={coords:this._coords,colors:this._colors,offsetX:-at,offsetY:-Y,scaleX:1/mt,scaleY:1/It},Xt=kt+2*2,Mt=Lt+2*2,Kt=pt.getCanvas("mesh",Xt,Mt,!1),ee=Kt.context,de=ee.createImageData(kt,Lt);if(_t){const gt=de.data;for(let z=0,X=gt.length;z<X;z+=4)gt[z]=_t[0],gt[z+1]=_t[1],gt[z+2]=_t[2],gt[z+3]=255}for(const gt of this._figures)st(de,gt,Vt);return ee.putImageData(de,2,2),{canvas:Kt.canvas,offsetX:at-2*mt,offsetY:Y-2*It,scaleX:mt,scaleY:It}}getPattern(bt,_t,pt,K){Q(bt,this._bbox);let et;if(K===tt.SHADING)et=D.Util.singularValueDecompose2dScale((0,U.getCurrentTransform)(bt));else if(et=D.Util.singularValueDecompose2dScale(_t.baseTransform),this.matrix){const at=D.Util.singularValueDecompose2dScale(this.matrix);et=[et[0]*at[0],et[1]*at[1]]}const St=this._createMeshCanvas(et,K===tt.SHADING?null:this._background,_t.cachedCanvases);return K!==tt.SHADING&&(bt.setTransform(..._t.baseTransform),this.matrix&&bt.transform(...this.matrix)),bt.translate(St.offsetX,St.offsetY),bt.scale(St.scaleX,St.scaleY),bt.createPattern(St.canvas,"no-repeat")}}class Tt extends Ft{getPattern(){return"hotpink"}}function vt(ct){switch(ct[0]){case"RadialAxial":return new ht(ct);case"Mesh":return new yt(ct);case"Dummy":return new Tt}throw new Error(`Unknown IR type: ${ct[0]}`)}const ut={COLORED:1,UNCOLORED:2},nt=class nt{constructor(bt,_t,pt,K,et){this.operatorList=bt[2],this.matrix=bt[3]||[1,0,0,1,0,0],this.bbox=bt[4],this.xstep=bt[5],this.ystep=bt[6],this.paintType=bt[7],this.tilingType=bt[8],this.color=_t,this.ctx=pt,this.canvasGraphicsFactory=K,this.baseTransform=et}createPatternCanvas(bt){const _t=this.operatorList,pt=this.bbox,K=this.xstep,et=this.ystep,St=this.paintType,at=this.tilingType,Y=this.color,At=this.canvasGraphicsFactory;(0,D.info)("TilingType: "+at);const ot=pt[0],kt=pt[1],Lt=pt[2],mt=pt[3],It=D.Util.singularValueDecompose2dScale(this.matrix),Vt=D.Util.singularValueDecompose2dScale(this.baseTransform),Xt=[It[0]*Vt[0],It[1]*Vt[1]],Mt=this.getSizeAndScale(K,this.ctx.canvas.width,Xt[0]),Kt=this.getSizeAndScale(et,this.ctx.canvas.height,Xt[1]),ee=bt.cachedCanvases.getCanvas("pattern",Mt.size,Kt.size,!0),de=ee.context,ge=At.createCanvasGraphics(de);ge.groupLevel=bt.groupLevel,this.setFillAndStrokeStyleToContext(ge,St,Y);let gt=ot,z=kt,X=Lt,G=mt;return ot<0&&(gt=0,X+=Math.abs(ot)),kt<0&&(z=0,G+=Math.abs(kt)),de.translate(-(Mt.scale*gt),-(Kt.scale*z)),ge.transform(Mt.scale,0,0,Kt.scale,0,0),de.save(),this.clipBbox(ge,gt,z,X,G),ge.baseTransform=(0,U.getCurrentTransform)(ge.ctx),ge.executeOperatorList(_t),ge.endDrawing(),{canvas:ee.canvas,scaleX:Mt.scale,scaleY:Kt.scale,offsetX:gt,offsetY:z}}getSizeAndScale(bt,_t,pt){bt=Math.abs(bt);const K=Math.max(nt.MAX_PATTERN_SIZE,_t);let et=Math.ceil(bt*pt);return et>=K?et=K:pt=et/bt,{scale:pt,size:et}}clipBbox(bt,_t,pt,K,et){const St=K-_t,at=et-pt;bt.ctx.rect(_t,pt,St,at),bt.current.updateRectMinMax((0,U.getCurrentTransform)(bt.ctx),[_t,pt,K,et]),bt.clip(),bt.endPath()}setFillAndStrokeStyleToContext(bt,_t,pt){const K=bt.ctx,et=bt.current;switch(_t){case ut.COLORED:const St=this.ctx;K.fillStyle=St.fillStyle,K.strokeStyle=St.strokeStyle,et.fillColor=St.fillStyle,et.strokeColor=St.strokeStyle;break;case ut.UNCOLORED:const at=D.Util.makeHexColor(pt[0],pt[1],pt[2]);K.fillStyle=at,K.strokeStyle=at,et.fillColor=at,et.strokeColor=at;break;default:throw new D.FormatError(`Unsupported paint type: ${_t}`)}}getPattern(bt,_t,pt,K){let et=pt;K!==tt.SHADING&&(et=D.Util.transform(et,_t.baseTransform),this.matrix&&(et=D.Util.transform(et,this.matrix)));const St=this.createPatternCanvas(_t);let at=new DOMMatrix(et);at=at.translate(St.offsetX,St.offsetY),at=at.scale(1/St.scaleX,1/St.scaleY);const Y=bt.createPattern(St.canvas,"repeat");return Y.setTransform(at),Y}};He(nt,"MAX_PATTERN_SIZE",3e3);let ft=nt;F.TilingPattern=ft},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.convertBlackAndWhiteToRGBA=tt,F.convertToRGBA=U,F.grayToRGBA=Ft;var D=O(1);function U(ht){switch(ht.kind){case D.ImageKind.GRAYSCALE_1BPP:return tt(ht);case D.ImageKind.RGB_24BPP:return Q(ht)}return null}function tt({src:ht,srcPos:dt=0,dest:st,width:yt,height:Tt,nonBlackColor:vt=4294967295,inverseDecode:ut=!1}){const ft=D.FeatureTest.isLittleEndian?4278190080:255,[nt,ct]=ut?[vt,ft]:[ft,vt],bt=yt>>3,_t=yt&7,pt=ht.length;st=new Uint32Array(st.buffer);let K=0;for(let et=0;et<Tt;et++){for(const at=dt+bt;dt<at;dt++){const Y=dt<pt?ht[dt]:255;st[K++]=Y&128?ct:nt,st[K++]=Y&64?ct:nt,st[K++]=Y&32?ct:nt,st[K++]=Y&16?ct:nt,st[K++]=Y&8?ct:nt,st[K++]=Y&4?ct:nt,st[K++]=Y&2?ct:nt,st[K++]=Y&1?ct:nt}if(_t===0)continue;const St=dt<pt?ht[dt++]:255;for(let at=0;at<_t;at++)st[K++]=St&1<<7-at?ct:nt}return{srcPos:dt,destPos:K}}function Q({src:ht,srcPos:dt=0,dest:st,destPos:yt=0,width:Tt,height:vt}){let ut=0;const ft=ht.length>>2,nt=new Uint32Array(ht.buffer,dt,ft);if(D.FeatureTest.isLittleEndian){for(;ut<ft-2;ut+=3,yt+=4){const ct=nt[ut],bt=nt[ut+1],_t=nt[ut+2];st[yt]=ct|4278190080,st[yt+1]=ct>>>24|bt<<8|4278190080,st[yt+2]=bt>>>16|_t<<16|4278190080,st[yt+3]=_t>>>8|4278190080}for(let ct=ut*4,bt=ht.length;ct<bt;ct+=3)st[yt++]=ht[ct]|ht[ct+1]<<8|ht[ct+2]<<16|4278190080}else{for(;ut<ft-2;ut+=3,yt+=4){const ct=nt[ut],bt=nt[ut+1],_t=nt[ut+2];st[yt]=ct|255,st[yt+1]=ct<<24|bt>>>8|255,st[yt+2]=bt<<16|_t>>>16|255,st[yt+3]=_t<<8|255}for(let ct=ut*4,bt=ht.length;ct<bt;ct+=3)st[yt++]=ht[ct]<<24|ht[ct+1]<<16|ht[ct+2]<<8|255}return{srcPos:dt,destPos:yt}}function Ft(ht,dt){if(D.FeatureTest.isLittleEndian)for(let st=0,yt=ht.length;st<yt;st++)dt[st]=ht[st]*65793|4278190080;else for(let st=0,yt=ht.length;st<yt;st++)dt[st]=ht[st]*16843008|255}},(B,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.GlobalWorkerOptions=void 0;const O=Object.create(null);F.GlobalWorkerOptions=O,O.workerPort=null,O.workerSrc=""},(B,F,O)=>{var ht,ys,st,As,Tt,bi;Object.defineProperty(F,"__esModule",{value:!0}),F.MessageHandler=void 0;var D=O(1);const U={UNKNOWN:0,DATA:1,ERROR:2},tt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Q(ut){switch(ut instanceof Error||typeof ut=="object"&&ut!==null||(0,D.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),ut.name){case"AbortException":return new D.AbortException(ut.message);case"MissingPDFException":return new D.MissingPDFException(ut.message);case"PasswordException":return new D.PasswordException(ut.message,ut.code);case"UnexpectedResponseException":return new D.UnexpectedResponseException(ut.message,ut.status);case"UnknownErrorException":return new D.UnknownErrorException(ut.message,ut.details);default:return new D.UnknownErrorException(ut.message,ut.toString())}}class Ft{constructor(ft,nt,ct){Pt(this,ht);Pt(this,st);Pt(this,Tt);this.sourceName=ft,this.targetName=nt,this.comObj=ct,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=bt=>{const _t=bt.data;if(_t.targetName!==this.sourceName)return;if(_t.stream){Dt(this,st,As).call(this,_t);return}if(_t.callback){const K=_t.callbackId,et=this.callbackCapabilities[K];if(!et)throw new Error(`Cannot resolve callback ${K}`);if(delete this.callbackCapabilities[K],_t.callback===U.DATA)et.resolve(_t.data);else if(_t.callback===U.ERROR)et.reject(Q(_t.reason));else throw new Error("Unexpected callback case");return}const pt=this.actionHandler[_t.action];if(!pt)throw new Error(`Unknown action from worker: ${_t.action}`);if(_t.callbackId){const K=this.sourceName,et=_t.sourceName;new Promise(function(St){St(pt(_t.data))}).then(function(St){ct.postMessage({sourceName:K,targetName:et,callback:U.DATA,callbackId:_t.callbackId,data:St})},function(St){ct.postMessage({sourceName:K,targetName:et,callback:U.ERROR,callbackId:_t.callbackId,reason:Q(St)})});return}if(_t.streamId){Dt(this,ht,ys).call(this,_t);return}pt(_t.data)},ct.addEventListener("message",this._onComObjOnMessage)}on(ft,nt){const ct=this.actionHandler;if(ct[ft])throw new Error(`There is already an actionName called "${ft}"`);ct[ft]=nt}send(ft,nt,ct){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:ft,data:nt},ct)}sendWithPromise(ft,nt,ct){const bt=this.callbackId++,_t=new D.PromiseCapability;this.callbackCapabilities[bt]=_t;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:ft,callbackId:bt,data:nt},ct)}catch(pt){_t.reject(pt)}return _t.promise}sendWithStream(ft,nt,ct,bt){const _t=this.streamId++,pt=this.sourceName,K=this.targetName,et=this.comObj;return new ReadableStream({start:St=>{const at=new D.PromiseCapability;return this.streamControllers[_t]={controller:St,startCall:at,pullCall:null,cancelCall:null,isClosed:!1},et.postMessage({sourceName:pt,targetName:K,action:ft,streamId:_t,data:nt,desiredSize:St.desiredSize},bt),at.promise},pull:St=>{const at=new D.PromiseCapability;return this.streamControllers[_t].pullCall=at,et.postMessage({sourceName:pt,targetName:K,stream:tt.PULL,streamId:_t,desiredSize:St.desiredSize}),at.promise},cancel:St=>{(0,D.assert)(St instanceof Error,"cancel must have a valid reason");const at=new D.PromiseCapability;return this.streamControllers[_t].cancelCall=at,this.streamControllers[_t].isClosed=!0,et.postMessage({sourceName:pt,targetName:K,stream:tt.CANCEL,streamId:_t,reason:Q(St)}),at.promise}},ct)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}ht=new WeakSet,ys=function(ft){const nt=ft.streamId,ct=this.sourceName,bt=ft.sourceName,_t=this.comObj,pt=this,K=this.actionHandler[ft.action],et={enqueue(St,at=1,Y){if(this.isCancelled)return;const At=this.desiredSize;this.desiredSize-=at,At>0&&this.desiredSize<=0&&(this.sinkCapability=new D.PromiseCapability,this.ready=this.sinkCapability.promise),_t.postMessage({sourceName:ct,targetName:bt,stream:tt.ENQUEUE,streamId:nt,chunk:St},Y)},close(){this.isCancelled||(this.isCancelled=!0,_t.postMessage({sourceName:ct,targetName:bt,stream:tt.CLOSE,streamId:nt}),delete pt.streamSinks[nt])},error(St){(0,D.assert)(St instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,_t.postMessage({sourceName:ct,targetName:bt,stream:tt.ERROR,streamId:nt,reason:Q(St)}))},sinkCapability:new D.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:ft.desiredSize,ready:null};et.sinkCapability.resolve(),et.ready=et.sinkCapability.promise,this.streamSinks[nt]=et,new Promise(function(St){St(K(ft.data,et))}).then(function(){_t.postMessage({sourceName:ct,targetName:bt,stream:tt.START_COMPLETE,streamId:nt,success:!0})},function(St){_t.postMessage({sourceName:ct,targetName:bt,stream:tt.START_COMPLETE,streamId:nt,reason:Q(St)})})},st=new WeakSet,As=function(ft){const nt=ft.streamId,ct=this.sourceName,bt=ft.sourceName,_t=this.comObj,pt=this.streamControllers[nt],K=this.streamSinks[nt];switch(ft.stream){case tt.START_COMPLETE:ft.success?pt.startCall.resolve():pt.startCall.reject(Q(ft.reason));break;case tt.PULL_COMPLETE:ft.success?pt.pullCall.resolve():pt.pullCall.reject(Q(ft.reason));break;case tt.PULL:if(!K){_t.postMessage({sourceName:ct,targetName:bt,stream:tt.PULL_COMPLETE,streamId:nt,success:!0});break}K.desiredSize<=0&&ft.desiredSize>0&&K.sinkCapability.resolve(),K.desiredSize=ft.desiredSize,new Promise(function(et){var St;et((St=K.onPull)==null?void 0:St.call(K))}).then(function(){_t.postMessage({sourceName:ct,targetName:bt,stream:tt.PULL_COMPLETE,streamId:nt,success:!0})},function(et){_t.postMessage({sourceName:ct,targetName:bt,stream:tt.PULL_COMPLETE,streamId:nt,reason:Q(et)})});break;case tt.ENQUEUE:if((0,D.assert)(pt,"enqueue should have stream controller"),pt.isClosed)break;pt.controller.enqueue(ft.chunk);break;case tt.CLOSE:if((0,D.assert)(pt,"close should have stream controller"),pt.isClosed)break;pt.isClosed=!0,pt.controller.close(),Dt(this,Tt,bi).call(this,pt,nt);break;case tt.ERROR:(0,D.assert)(pt,"error should have stream controller"),pt.controller.error(Q(ft.reason)),Dt(this,Tt,bi).call(this,pt,nt);break;case tt.CANCEL_COMPLETE:ft.success?pt.cancelCall.resolve():pt.cancelCall.reject(Q(ft.reason)),Dt(this,Tt,bi).call(this,pt,nt);break;case tt.CANCEL:if(!K)break;new Promise(function(et){var St;et((St=K.onCancel)==null?void 0:St.call(K,Q(ft.reason)))}).then(function(){_t.postMessage({sourceName:ct,targetName:bt,stream:tt.CANCEL_COMPLETE,streamId:nt,success:!0})},function(et){_t.postMessage({sourceName:ct,targetName:bt,stream:tt.CANCEL_COMPLETE,streamId:nt,reason:Q(et)})}),K.sinkCapability.reject(Q(ft.reason)),K.isCancelled=!0,delete this.streamSinks[nt];break;default:throw new Error("Unexpected stream case")}},Tt=new WeakSet,bi=async function(ft,nt){var ct,bt,_t;await Promise.allSettled([(ct=ft.startCall)==null?void 0:ct.promise,(bt=ft.pullCall)==null?void 0:bt.promise,(_t=ft.cancelCall)==null?void 0:_t.promise]),delete this.streamControllers[nt]},F.MessageHandler=Ft},(B,F,O)=>{var tt,Q;Object.defineProperty(F,"__esModule",{value:!0}),F.Metadata=void 0;var D=O(1);class U{constructor({parsedData:ht,rawData:dt}){Pt(this,tt,void 0);Pt(this,Q,void 0);Wt(this,tt,ht),Wt(this,Q,dt)}getRaw(){return W(this,Q)}get(ht){return W(this,tt).get(ht)??null}getAll(){return(0,D.objectFromMap)(W(this,tt))}has(ht){return W(this,tt).has(ht)}}tt=new WeakMap,Q=new WeakMap,F.Metadata=U},(B,F,O)=>{var ht,dt,st,yt,Tt,vt,Wi;Object.defineProperty(F,"__esModule",{value:!0}),F.OptionalContentConfig=void 0;var D=O(1),U=O(8);const tt=Symbol("INTERNAL");class Q{constructor(nt,ct){Pt(this,ht,!0);this.name=nt,this.intent=ct}get visible(){return W(this,ht)}_setVisible(nt,ct){nt!==tt&&(0,D.unreachable)("Internal method `_setVisible` called."),Wt(this,ht,ct)}}ht=new WeakMap;class Ft{constructor(nt){Pt(this,vt);Pt(this,dt,null);Pt(this,st,new Map);Pt(this,yt,null);Pt(this,Tt,null);if(this.name=null,this.creator=null,nt!==null){this.name=nt.name,this.creator=nt.creator,Wt(this,Tt,nt.order);for(const ct of nt.groups)W(this,st).set(ct.id,new Q(ct.name,ct.intent));if(nt.baseState==="OFF")for(const ct of W(this,st).values())ct._setVisible(tt,!1);for(const ct of nt.on)W(this,st).get(ct)._setVisible(tt,!0);for(const ct of nt.off)W(this,st).get(ct)._setVisible(tt,!1);Wt(this,yt,this.getHash())}}isVisible(nt){if(W(this,st).size===0)return!0;if(!nt)return(0,D.warn)("Optional content group not defined."),!0;if(nt.type==="OCG")return W(this,st).has(nt.id)?W(this,st).get(nt.id).visible:((0,D.warn)(`Optional content group not found: ${nt.id}`),!0);if(nt.type==="OCMD"){if(nt.expression)return Dt(this,vt,Wi).call(this,nt.expression);if(!nt.policy||nt.policy==="AnyOn"){for(const ct of nt.ids){if(!W(this,st).has(ct))return(0,D.warn)(`Optional content group not found: ${ct}`),!0;if(W(this,st).get(ct).visible)return!0}return!1}else if(nt.policy==="AllOn"){for(const ct of nt.ids){if(!W(this,st).has(ct))return(0,D.warn)(`Optional content group not found: ${ct}`),!0;if(!W(this,st).get(ct).visible)return!1}return!0}else if(nt.policy==="AnyOff"){for(const ct of nt.ids){if(!W(this,st).has(ct))return(0,D.warn)(`Optional content group not found: ${ct}`),!0;if(!W(this,st).get(ct).visible)return!0}return!1}else if(nt.policy==="AllOff"){for(const ct of nt.ids){if(!W(this,st).has(ct))return(0,D.warn)(`Optional content group not found: ${ct}`),!0;if(W(this,st).get(ct).visible)return!1}return!0}return(0,D.warn)(`Unknown optional content policy ${nt.policy}.`),!0}return(0,D.warn)(`Unknown group type ${nt.type}.`),!0}setVisibility(nt,ct=!0){if(!W(this,st).has(nt)){(0,D.warn)(`Optional content group not found: ${nt}`);return}W(this,st).get(nt)._setVisible(tt,!!ct),Wt(this,dt,null)}get hasInitialVisibility(){return W(this,yt)===null||this.getHash()===W(this,yt)}getOrder(){return W(this,st).size?W(this,Tt)?W(this,Tt).slice():[...W(this,st).keys()]:null}getGroups(){return W(this,st).size>0?(0,D.objectFromMap)(W(this,st)):null}getGroup(nt){return W(this,st).get(nt)||null}getHash(){if(W(this,dt)!==null)return W(this,dt);const nt=new U.MurmurHash3_64;for(const[ct,bt]of W(this,st))nt.update(`${ct}:${bt.visible}`);return Wt(this,dt,nt.hexdigest())}}dt=new WeakMap,st=new WeakMap,yt=new WeakMap,Tt=new WeakMap,vt=new WeakSet,Wi=function(nt){const ct=nt.length;if(ct<2)return!0;const bt=nt[0];for(let _t=1;_t<ct;_t++){const pt=nt[_t];let K;if(Array.isArray(pt))K=Dt(this,vt,Wi).call(this,pt);else if(W(this,st).has(pt))K=W(this,st).get(pt).visible;else return(0,D.warn)(`Optional content group not found: ${pt}`),!0;switch(bt){case"And":if(!K)return!1;break;case"Or":if(K)return!0;break;case"Not":return!K;default:return!0}}return bt==="And"},F.OptionalContentConfig=Ft},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFDataTransportStream=void 0;var D=O(1),U=O(6);class tt{constructor({length:dt,initialData:st,progressiveDone:yt=!1,contentDispositionFilename:Tt=null,disableRange:vt=!1,disableStream:ut=!1},ft){if((0,D.assert)(ft,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=yt,this._contentDispositionFilename=Tt,(st==null?void 0:st.length)>0){const nt=st instanceof Uint8Array&&st.byteLength===st.buffer.byteLength?st.buffer:new Uint8Array(st).buffer;this._queuedChunks.push(nt)}this._pdfDataRangeTransport=ft,this._isStreamingSupported=!ut,this._isRangeSupported=!vt,this._contentLength=dt,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((nt,ct)=>{this._onReceiveData({begin:nt,chunk:ct})}),this._pdfDataRangeTransport.addProgressListener((nt,ct)=>{this._onProgress({loaded:nt,total:ct})}),this._pdfDataRangeTransport.addProgressiveReadListener(nt=>{this._onReceiveData({chunk:nt})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:dt,chunk:st}){const yt=st instanceof Uint8Array&&st.byteLength===st.buffer.byteLength?st.buffer:new Uint8Array(st).buffer;if(dt===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(yt):this._queuedChunks.push(yt);else{const Tt=this._rangeReaders.some(function(vt){return vt._begin!==dt?!1:(vt._enqueue(yt),!0)});(0,D.assert)(Tt,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var dt;return((dt=this._fullRequestReader)==null?void 0:dt._loaded)??0}_onProgress(dt){var st,yt,Tt,vt;dt.total===void 0?(yt=(st=this._rangeReaders[0])==null?void 0:st.onProgress)==null||yt.call(st,{loaded:dt.loaded}):(vt=(Tt=this._fullRequestReader)==null?void 0:Tt.onProgress)==null||vt.call(Tt,{loaded:dt.loaded,total:dt.total})}_onProgressiveDone(){var dt;(dt=this._fullRequestReader)==null||dt.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(dt){const st=this._rangeReaders.indexOf(dt);st>=0&&this._rangeReaders.splice(st,1)}getFullReader(){(0,D.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const dt=this._queuedChunks;return this._queuedChunks=null,new Q(this,dt,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(dt,st){if(st<=this._progressiveDataLength)return null;const yt=new Ft(this,dt,st);return this._pdfDataRangeTransport.requestDataRange(dt,st),this._rangeReaders.push(yt),yt}cancelAllRequests(dt){var st;(st=this._fullRequestReader)==null||st.cancel(dt);for(const yt of this._rangeReaders.slice(0))yt.cancel(dt);this._pdfDataRangeTransport.abort()}}F.PDFDataTransportStream=tt;class Q{constructor(dt,st,yt=!1,Tt=null){this._stream=dt,this._done=yt||!1,this._filename=(0,U.isPdfFile)(Tt)?Tt:null,this._queuedChunks=st||[],this._loaded=0;for(const vt of this._queuedChunks)this._loaded+=vt.byteLength;this._requests=[],this._headersReady=Promise.resolve(),dt._fullRequestReader=this,this.onProgress=null}_enqueue(dt){this._done||(this._requests.length>0?this._requests.shift().resolve({value:dt,done:!1}):this._queuedChunks.push(dt),this._loaded+=dt.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const dt=new D.PromiseCapability;return this._requests.push(dt),dt.promise}cancel(dt){this._done=!0;for(const st of this._requests)st.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Ft{constructor(dt,st,yt){this._stream=dt,this._begin=st,this._end=yt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(dt){if(!this._done){if(this._requests.length===0)this._queuedChunk=dt;else{this._requests.shift().resolve({value:dt,done:!1});for(const yt of this._requests)yt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const st=this._queuedChunk;return this._queuedChunk=null,{value:st,done:!1}}if(this._done)return{value:void 0,done:!0};const dt=new D.PromiseCapability;return this._requests.push(dt),dt.promise}cancel(dt){this._done=!0;for(const st of this._requests)st.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFFetchStream=void 0;var D=O(1),U=O(20);function tt(yt,Tt,vt){return{method:"GET",headers:yt,signal:vt.signal,mode:"cors",credentials:Tt?"include":"same-origin",redirect:"follow"}}function Q(yt){const Tt=new Headers;for(const vt in yt){const ut=yt[vt];ut!==void 0&&Tt.append(vt,ut)}return Tt}function Ft(yt){return yt instanceof Uint8Array?yt.buffer:yt instanceof ArrayBuffer?yt:((0,D.warn)(`getArrayBuffer - unexpected data format: ${yt}`),new Uint8Array(yt).buffer)}class ht{constructor(Tt){this.source=Tt,this.isHttp=/^https?:/i.test(Tt.url),this.httpHeaders=this.isHttp&&Tt.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var Tt;return((Tt=this._fullRequestReader)==null?void 0:Tt._loaded)??0}getFullReader(){return(0,D.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new dt(this),this._fullRequestReader}getRangeReader(Tt,vt){if(vt<=this._progressiveDataLength)return null;const ut=new st(this,Tt,vt);return this._rangeRequestReaders.push(ut),ut}cancelAllRequests(Tt){var vt;(vt=this._fullRequestReader)==null||vt.cancel(Tt);for(const ut of this._rangeRequestReaders.slice(0))ut.cancel(Tt)}}F.PDFFetchStream=ht;class dt{constructor(Tt){this._stream=Tt,this._reader=null,this._loaded=0,this._filename=null;const vt=Tt.source;this._withCredentials=vt.withCredentials||!1,this._contentLength=vt.length,this._headersCapability=new D.PromiseCapability,this._disableRange=vt.disableRange||!1,this._rangeChunkSize=vt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!vt.disableStream,this._isRangeSupported=!vt.disableRange,this._headers=Q(this._stream.httpHeaders);const ut=vt.url;fetch(ut,tt(this._headers,this._withCredentials,this._abortController)).then(ft=>{if(!(0,U.validateResponseStatus)(ft.status))throw(0,U.createResponseStatusError)(ft.status,ut);this._reader=ft.body.getReader(),this._headersCapability.resolve();const nt=_t=>ft.headers.get(_t),{allowRangeRequests:ct,suggestedLength:bt}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:nt,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=ct,this._contentLength=bt||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(nt),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new D.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ut;await this._headersCapability.promise;const{value:Tt,done:vt}=await this._reader.read();return vt?{value:Tt,done:vt}:(this._loaded+=Tt.byteLength,(ut=this.onProgress)==null||ut.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Ft(Tt),done:!1})}cancel(Tt){var vt;(vt=this._reader)==null||vt.cancel(Tt),this._abortController.abort()}}class st{constructor(Tt,vt,ut){this._stream=Tt,this._reader=null,this._loaded=0;const ft=Tt.source;this._withCredentials=ft.withCredentials||!1,this._readCapability=new D.PromiseCapability,this._isStreamingSupported=!ft.disableStream,this._abortController=new AbortController,this._headers=Q(this._stream.httpHeaders),this._headers.append("Range",`bytes=${vt}-${ut-1}`);const nt=ft.url;fetch(nt,tt(this._headers,this._withCredentials,this._abortController)).then(ct=>{if(!(0,U.validateResponseStatus)(ct.status))throw(0,U.createResponseStatusError)(ct.status,nt);this._readCapability.resolve(),this._reader=ct.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ut;await this._readCapability.promise;const{value:Tt,done:vt}=await this._reader.read();return vt?{value:Tt,done:vt}:(this._loaded+=Tt.byteLength,(ut=this.onProgress)==null||ut.call(this,{loaded:this._loaded}),{value:Ft(Tt),done:!1})}cancel(Tt){var vt;(vt=this._reader)==null||vt.cancel(Tt),this._abortController.abort()}}},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.createResponseStatusError=ht,F.extractFilenameFromHeader=Ft,F.validateRangeRequestCapabilities=Q,F.validateResponseStatus=dt;var D=O(1),U=O(21),tt=O(6);function Q({getResponseHeader:st,isHttp:yt,rangeChunkSize:Tt,disableRange:vt}){const ut={allowRangeRequests:!1,suggestedLength:void 0},ft=parseInt(st("Content-Length"),10);return!Number.isInteger(ft)||(ut.suggestedLength=ft,ft<=2*Tt)||vt||!yt||st("Accept-Ranges")!=="bytes"||(st("Content-Encoding")||"identity")!=="identity"||(ut.allowRangeRequests=!0),ut}function Ft(st){const yt=st("Content-Disposition");if(yt){let Tt=(0,U.getFilenameFromContentDispositionHeader)(yt);if(Tt.includes("%"))try{Tt=decodeURIComponent(Tt)}catch{}if((0,tt.isPdfFile)(Tt))return Tt}return null}function ht(st,yt){return st===404||st===0&&yt.startsWith("file:")?new D.MissingPDFException('Missing PDF "'+yt+'".'):new D.UnexpectedResponseException(`Unexpected server response (${st}) while retrieving PDF "${yt}".`,st)}function dt(st){return st===200||st===206}},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.getFilenameFromContentDispositionHeader=U;var D=O(1);function U(tt){let Q=!0,Ft=ht("filename\\*","i").exec(tt);if(Ft){Ft=Ft[1];let ft=Tt(Ft);return ft=unescape(ft),ft=vt(ft),ft=ut(ft),st(ft)}if(Ft=yt(tt),Ft){const ft=ut(Ft);return st(ft)}if(Ft=ht("filename","i").exec(tt),Ft){Ft=Ft[1];let ft=Tt(Ft);return ft=ut(ft),st(ft)}function ht(ft,nt){return new RegExp("(?:^|;)\\s*"+ft+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',nt)}function dt(ft,nt){if(ft){if(!/^[\x00-\xFF]+$/.test(nt))return nt;try{const ct=new TextDecoder(ft,{fatal:!0}),bt=(0,D.stringToBytes)(nt);nt=ct.decode(bt),Q=!1}catch{}}return nt}function st(ft){return Q&&/[\x80-\xff]/.test(ft)&&(ft=dt("utf-8",ft),Q&&(ft=dt("iso-8859-1",ft))),ft}function yt(ft){const nt=[];let ct;const bt=ht("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(ct=bt.exec(ft))!==null;){let[,pt,K,et]=ct;if(pt=parseInt(pt,10),pt in nt){if(pt===0)break;continue}nt[pt]=[K,et]}const _t=[];for(let pt=0;pt<nt.length&&pt in nt;++pt){let[K,et]=nt[pt];et=Tt(et),K&&(et=unescape(et),pt===0&&(et=vt(et))),_t.push(et)}return _t.join("")}function Tt(ft){if(ft.startsWith('"')){const nt=ft.slice(1).split('\\"');for(let ct=0;ct<nt.length;++ct){const bt=nt[ct].indexOf('"');bt!==-1&&(nt[ct]=nt[ct].slice(0,bt),nt.length=ct+1),nt[ct]=nt[ct].replaceAll(/\\(.)/g,"$1")}ft=nt.join('"')}return ft}function vt(ft){const nt=ft.indexOf("'");if(nt===-1)return ft;const ct=ft.slice(0,nt),_t=ft.slice(nt+1).replace(/^[^']*'/,"");return dt(ct,_t)}function ut(ft){return!ft.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(ft)?ft:ft.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(nt,ct,bt,_t){if(bt==="q"||bt==="Q")return _t=_t.replaceAll("_"," "),_t=_t.replaceAll(/=([0-9a-fA-F]{2})/g,function(pt,K){return String.fromCharCode(parseInt(K,16))}),dt(ct,_t);try{_t=atob(_t)}catch{}return dt(ct,_t)})}return""}},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFNetworkStream=void 0;var D=O(1),U=O(20);const tt=200,Q=206;function Ft(Tt){const vt=Tt.response;return typeof vt!="string"?vt:(0,D.stringToBytes)(vt).buffer}class ht{constructor(vt,ut={}){this.url=vt,this.isHttp=/^https?:/i.test(vt),this.httpHeaders=this.isHttp&&ut.httpHeaders||Object.create(null),this.withCredentials=ut.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(vt,ut,ft){const nt={begin:vt,end:ut};for(const ct in ft)nt[ct]=ft[ct];return this.request(nt)}requestFull(vt){return this.request(vt)}request(vt){const ut=new XMLHttpRequest,ft=this.currXhrId++,nt=this.pendingRequests[ft]={xhr:ut};ut.open("GET",this.url),ut.withCredentials=this.withCredentials;for(const ct in this.httpHeaders){const bt=this.httpHeaders[ct];bt!==void 0&&ut.setRequestHeader(ct,bt)}return this.isHttp&&"begin"in vt&&"end"in vt?(ut.setRequestHeader("Range",`bytes=${vt.begin}-${vt.end-1}`),nt.expectedStatus=Q):nt.expectedStatus=tt,ut.responseType="arraybuffer",vt.onError&&(ut.onerror=function(ct){vt.onError(ut.status)}),ut.onreadystatechange=this.onStateChange.bind(this,ft),ut.onprogress=this.onProgress.bind(this,ft),nt.onHeadersReceived=vt.onHeadersReceived,nt.onDone=vt.onDone,nt.onError=vt.onError,nt.onProgress=vt.onProgress,ut.send(null),ft}onProgress(vt,ut){var nt;const ft=this.pendingRequests[vt];ft&&((nt=ft.onProgress)==null||nt.call(ft,ut))}onStateChange(vt,ut){var pt,K,et;const ft=this.pendingRequests[vt];if(!ft)return;const nt=ft.xhr;if(nt.readyState>=2&&ft.onHeadersReceived&&(ft.onHeadersReceived(),delete ft.onHeadersReceived),nt.readyState!==4||!(vt in this.pendingRequests))return;if(delete this.pendingRequests[vt],nt.status===0&&this.isHttp){(pt=ft.onError)==null||pt.call(ft,nt.status);return}const ct=nt.status||tt;if(!(ct===tt&&ft.expectedStatus===Q)&&ct!==ft.expectedStatus){(K=ft.onError)==null||K.call(ft,nt.status);return}const _t=Ft(nt);if(ct===Q){const St=nt.getResponseHeader("Content-Range"),at=/bytes (\d+)-(\d+)\/(\d+)/.exec(St);ft.onDone({begin:parseInt(at[1],10),chunk:_t})}else _t?ft.onDone({begin:0,chunk:_t}):(et=ft.onError)==null||et.call(ft,nt.status)}getRequestXhr(vt){return this.pendingRequests[vt].xhr}isPendingRequest(vt){return vt in this.pendingRequests}abortRequest(vt){const ut=this.pendingRequests[vt].xhr;delete this.pendingRequests[vt],ut.abort()}}class dt{constructor(vt){this._source=vt,this._manager=new ht(vt.url,{httpHeaders:vt.httpHeaders,withCredentials:vt.withCredentials}),this._rangeChunkSize=vt.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(vt){const ut=this._rangeRequestReaders.indexOf(vt);ut>=0&&this._rangeRequestReaders.splice(ut,1)}getFullReader(){return(0,D.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new st(this._manager,this._source),this._fullRequestReader}getRangeReader(vt,ut){const ft=new yt(this._manager,vt,ut);return ft.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(ft),ft}cancelAllRequests(vt){var ut;(ut=this._fullRequestReader)==null||ut.cancel(vt);for(const ft of this._rangeRequestReaders.slice(0))ft.cancel(vt)}}F.PDFNetworkStream=dt;class st{constructor(vt,ut){this._manager=vt;const ft={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=ut.url,this._fullRequestId=vt.requestFull(ft),this._headersReceivedCapability=new D.PromiseCapability,this._disableRange=ut.disableRange||!1,this._contentLength=ut.length,this._rangeChunkSize=ut.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const vt=this._fullRequestId,ut=this._manager.getRequestXhr(vt),ft=bt=>ut.getResponseHeader(bt),{allowRangeRequests:nt,suggestedLength:ct}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:ft,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});nt&&(this._isRangeSupported=!0),this._contentLength=ct||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(ft),this._isRangeSupported&&this._manager.abortRequest(vt),this._headersReceivedCapability.resolve()}_onDone(vt){if(vt&&(this._requests.length>0?this._requests.shift().resolve({value:vt.chunk,done:!1}):this._cachedChunks.push(vt.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const ut of this._requests)ut.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(vt){this._storedError=(0,U.createResponseStatusError)(vt,this._url),this._headersReceivedCapability.reject(this._storedError);for(const ut of this._requests)ut.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(vt){var ut;(ut=this.onProgress)==null||ut.call(this,{loaded:vt.loaded,total:vt.lengthComputable?vt.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const vt=new D.PromiseCapability;return this._requests.push(vt),vt.promise}cancel(vt){this._done=!0,this._headersReceivedCapability.reject(vt);for(const ut of this._requests)ut.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class yt{constructor(vt,ut,ft){this._manager=vt;const nt={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=vt.url,this._requestId=vt.requestRange(ut,ft,nt),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var vt;(vt=this.onClosed)==null||vt.call(this,this)}_onDone(vt){const ut=vt.chunk;this._requests.length>0?this._requests.shift().resolve({value:ut,done:!1}):this._queuedChunk=ut,this._done=!0;for(const ft of this._requests)ft.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(vt){this._storedError=(0,U.createResponseStatusError)(vt,this._url);for(const ut of this._requests)ut.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(vt){var ut;this.isStreamingSupported||(ut=this.onProgress)==null||ut.call(this,{loaded:vt.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const ut=this._queuedChunk;return this._queuedChunk=null,{value:ut,done:!1}}if(this._done)return{value:void 0,done:!0};const vt=new D.PromiseCapability;return this._requests.push(vt),vt.promise}cancel(vt){this._done=!0;for(const ut of this._requests)ut.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.PDFNodeStream=void 0;var D=O(1),U=O(20);const tt=/^file:\/\/\/[a-zA-Z]:\//;function Q(ft){const nt=require("url"),ct=nt.parse(ft);return ct.protocol==="file:"||ct.host?ct:/^[a-z]:[/\\]/i.test(ft)?nt.parse(`file:///${ft}`):(ct.host||(ct.protocol="file:"),ct)}class Ft{constructor(nt){this.source=nt,this.url=Q(nt.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&nt.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var nt;return((nt=this._fullRequestReader)==null?void 0:nt._loaded)??0}getFullReader(){return(0,D.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new vt(this):new yt(this),this._fullRequestReader}getRangeReader(nt,ct){if(ct<=this._progressiveDataLength)return null;const bt=this.isFsUrl?new ut(this,nt,ct):new Tt(this,nt,ct);return this._rangeRequestReaders.push(bt),bt}cancelAllRequests(nt){var ct;(ct=this._fullRequestReader)==null||ct.cancel(nt);for(const bt of this._rangeRequestReaders.slice(0))bt.cancel(nt)}}F.PDFNodeStream=Ft;class ht{constructor(nt){this._url=nt.url,this._done=!1,this._storedError=null,this.onProgress=null;const ct=nt.source;this._contentLength=ct.length,this._loaded=0,this._filename=null,this._disableRange=ct.disableRange||!1,this._rangeChunkSize=ct.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!ct.disableStream,this._isRangeSupported=!ct.disableRange,this._readableStream=null,this._readCapability=new D.PromiseCapability,this._headersCapability=new D.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var bt;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const nt=this._readableStream.read();return nt===null?(this._readCapability=new D.PromiseCapability,this.read()):(this._loaded+=nt.length,(bt=this.onProgress)==null||bt.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(nt).buffer,done:!1})}cancel(nt){if(!this._readableStream){this._error(nt);return}this._readableStream.destroy(nt)}_error(nt){this._storedError=nt,this._readCapability.resolve()}_setReadableStream(nt){this._readableStream=nt,nt.on("readable",()=>{this._readCapability.resolve()}),nt.on("end",()=>{nt.destroy(),this._done=!0,this._readCapability.resolve()}),nt.on("error",ct=>{this._error(ct)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new D.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class dt{constructor(nt){this._url=nt.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new D.PromiseCapability;const ct=nt.source;this._isStreamingSupported=!ct.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var bt;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const nt=this._readableStream.read();return nt===null?(this._readCapability=new D.PromiseCapability,this.read()):(this._loaded+=nt.length,(bt=this.onProgress)==null||bt.call(this,{loaded:this._loaded}),{value:new Uint8Array(nt).buffer,done:!1})}cancel(nt){if(!this._readableStream){this._error(nt);return}this._readableStream.destroy(nt)}_error(nt){this._storedError=nt,this._readCapability.resolve()}_setReadableStream(nt){this._readableStream=nt,nt.on("readable",()=>{this._readCapability.resolve()}),nt.on("end",()=>{nt.destroy(),this._done=!0,this._readCapability.resolve()}),nt.on("error",ct=>{this._error(ct)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function st(ft,nt){return{protocol:ft.protocol,auth:ft.auth,host:ft.hostname,port:ft.port,path:ft.path,method:"GET",headers:nt}}class yt extends ht{constructor(nt){super(nt);const ct=bt=>{if(bt.statusCode===404){const et=new D.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=et,this._headersCapability.reject(et);return}this._headersCapability.resolve(),this._setReadableStream(bt);const _t=et=>this._readableStream.headers[et.toLowerCase()],{allowRangeRequests:pt,suggestedLength:K}=(0,U.validateRangeRequestCapabilities)({getResponseHeader:_t,isHttp:nt.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=pt,this._contentLength=K||this._contentLength,this._filename=(0,U.extractFilenameFromHeader)(_t)};if(this._request=null,this._url.protocol==="http:"){const bt=require("http");this._request=bt.request(st(this._url,nt.httpHeaders),ct)}else{const bt=require("https");this._request=bt.request(st(this._url,nt.httpHeaders),ct)}this._request.on("error",bt=>{this._storedError=bt,this._headersCapability.reject(bt)}),this._request.end()}}class Tt extends dt{constructor(nt,ct,bt){super(nt),this._httpHeaders={};for(const pt in nt.httpHeaders){const K=nt.httpHeaders[pt];K!==void 0&&(this._httpHeaders[pt]=K)}this._httpHeaders.Range=`bytes=${ct}-${bt-1}`;const _t=pt=>{if(pt.statusCode===404){const K=new D.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=K;return}this._setReadableStream(pt)};if(this._request=null,this._url.protocol==="http:"){const pt=require("http");this._request=pt.request(st(this._url,this._httpHeaders),_t)}else{const pt=require("https");this._request=pt.request(st(this._url,this._httpHeaders),_t)}this._request.on("error",pt=>{this._storedError=pt}),this._request.end()}}class vt extends ht{constructor(nt){super(nt);let ct=decodeURIComponent(this._url.path);tt.test(this._url.href)&&(ct=ct.replace(/^\//,""));const bt=require("fs");bt.lstat(ct,(_t,pt)=>{if(_t){_t.code==="ENOENT"&&(_t=new D.MissingPDFException(`Missing PDF "${ct}".`)),this._storedError=_t,this._headersCapability.reject(_t);return}this._contentLength=pt.size,this._setReadableStream(bt.createReadStream(ct)),this._headersCapability.resolve()})}}class ut extends dt{constructor(nt,ct,bt){super(nt);let _t=decodeURIComponent(this._url.path);tt.test(this._url.href)&&(_t=_t.replace(/^\//,""));const pt=require("fs");this._setReadableStream(pt.createReadStream(_t,{start:ct,end:bt-1}))}}},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.SVGGraphics=void 0;var D=O(6),U=O(1);const tt={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},Q="http://www.w3.org/XML/1998/namespace",Ft="http://www.w3.org/1999/xlink",ht=["butt","round","square"],dt=["miter","round","bevel"],st=function(pt,K="",et=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!et)return URL.createObjectURL(new Blob([pt],{type:K}));const St="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let at=`data:${K};base64,`;for(let Y=0,At=pt.length;Y<At;Y+=3){const ot=pt[Y]&255,kt=pt[Y+1]&255,Lt=pt[Y+2]&255,mt=ot>>2,It=(ot&3)<<4|kt>>4,Vt=Y+1<At?(kt&15)<<2|Lt>>6:64,Xt=Y+2<At?Lt&63:64;at+=St[mt]+St[It]+St[Vt]+St[Xt]}return at},yt=function(){const pt=new Uint8Array([137,80,78,71,13,10,26,10]),K=12,et=new Int32Array(256);for(let Lt=0;Lt<256;Lt++){let mt=Lt;for(let It=0;It<8;It++)mt=mt&1?3988292384^mt>>1&2147483647:mt>>1&2147483647;et[Lt]=mt}function St(Lt,mt,It){let Vt=-1;for(let Xt=mt;Xt<It;Xt++){const Mt=(Vt^Lt[Xt])&255,Kt=et[Mt];Vt=Vt>>>8^Kt}return Vt^-1}function at(Lt,mt,It,Vt){let Xt=Vt;const Mt=mt.length;It[Xt]=Mt>>24&255,It[Xt+1]=Mt>>16&255,It[Xt+2]=Mt>>8&255,It[Xt+3]=Mt&255,Xt+=4,It[Xt]=Lt.charCodeAt(0)&255,It[Xt+1]=Lt.charCodeAt(1)&255,It[Xt+2]=Lt.charCodeAt(2)&255,It[Xt+3]=Lt.charCodeAt(3)&255,Xt+=4,It.set(mt,Xt),Xt+=mt.length;const Kt=St(It,Vt+4,Xt);It[Xt]=Kt>>24&255,It[Xt+1]=Kt>>16&255,It[Xt+2]=Kt>>8&255,It[Xt+3]=Kt&255}function Y(Lt,mt,It){let Vt=1,Xt=0;for(let Mt=mt;Mt<It;++Mt)Vt=(Vt+(Lt[Mt]&255))%65521,Xt=(Xt+Vt)%65521;return Xt<<16|Vt}function At(Lt){if(!U.isNodeJS)return ot(Lt);try{const mt=parseInt(process.versions.node)>=8?Lt:Buffer.from(Lt),It=require("zlib").deflateSync(mt,{level:9});return It instanceof Uint8Array?It:new Uint8Array(It)}catch(mt){(0,U.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+mt)}return ot(Lt)}function ot(Lt){let mt=Lt.length;const It=65535,Vt=Math.ceil(mt/It),Xt=new Uint8Array(2+mt+Vt*5+4);let Mt=0;Xt[Mt++]=120,Xt[Mt++]=156;let Kt=0;for(;mt>It;)Xt[Mt++]=0,Xt[Mt++]=255,Xt[Mt++]=255,Xt[Mt++]=0,Xt[Mt++]=0,Xt.set(Lt.subarray(Kt,Kt+It),Mt),Mt+=It,Kt+=It,mt-=It;Xt[Mt++]=1,Xt[Mt++]=mt&255,Xt[Mt++]=mt>>8&255,Xt[Mt++]=~mt&65535&255,Xt[Mt++]=(~mt&65535)>>8&255,Xt.set(Lt.subarray(Kt),Mt),Mt+=Lt.length-Kt;const ee=Y(Lt,0,Lt.length);return Xt[Mt++]=ee>>24&255,Xt[Mt++]=ee>>16&255,Xt[Mt++]=ee>>8&255,Xt[Mt++]=ee&255,Xt}function kt(Lt,mt,It,Vt){const Xt=Lt.width,Mt=Lt.height;let Kt,ee,de;const ge=Lt.data;switch(mt){case U.ImageKind.GRAYSCALE_1BPP:ee=0,Kt=1,de=Xt+7>>3;break;case U.ImageKind.RGB_24BPP:ee=2,Kt=8,de=Xt*3;break;case U.ImageKind.RGBA_32BPP:ee=6,Kt=8,de=Xt*4;break;default:throw new Error("invalid format")}const gt=new Uint8Array((1+de)*Mt);let z=0,X=0;for(let xt=0;xt<Mt;++xt)gt[z++]=0,gt.set(ge.subarray(X,X+de),z),X+=de,z+=de;if(mt===U.ImageKind.GRAYSCALE_1BPP&&Vt){z=0;for(let xt=0;xt<Mt;xt++){z++;for(let qt=0;qt<de;qt++)gt[z++]^=255}}const G=new Uint8Array([Xt>>24&255,Xt>>16&255,Xt>>8&255,Xt&255,Mt>>24&255,Mt>>16&255,Mt>>8&255,Mt&255,Kt,ee,0,0,0]),J=At(gt),it=pt.length+K*3+G.length+J.length,lt=new Uint8Array(it);let Et=0;return lt.set(pt,Et),Et+=pt.length,at("IHDR",G,lt,Et),Et+=K+G.length,at("IDATA",J,lt,Et),Et+=K+J.length,at("IEND",new Uint8Array(0),lt,Et),st(lt,"image/png",It)}return function(mt,It,Vt){const Xt=mt.kind===void 0?U.ImageKind.GRAYSCALE_1BPP:mt.kind;return kt(mt,Xt,It,Vt)}}();class Tt{constructor(){this.fontSizeScale=1,this.fontWeight=tt.fontWeight,this.fontSize=0,this.textMatrix=U.IDENTITY_MATRIX,this.fontMatrix=U.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=U.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=tt.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(K,et){this.x=K,this.y=et}}function vt(pt){let K=[];const et=[];for(const St of pt){if(St.fn==="save"){K.push({fnId:92,fn:"group",items:[]}),et.push(K),K=K.at(-1).items;continue}St.fn==="restore"?K=et.pop():K.push(St)}return K}function ut(pt){if(Number.isInteger(pt))return pt.toString();const K=pt.toFixed(10);let et=K.length-1;if(K[et]!=="0")return K;do et--;while(K[et]==="0");return K.substring(0,K[et]==="."?et:et+1)}function ft(pt){if(pt[4]===0&&pt[5]===0){if(pt[1]===0&&pt[2]===0)return pt[0]===1&&pt[3]===1?"":`scale(${ut(pt[0])} ${ut(pt[3])})`;if(pt[0]===pt[3]&&pt[1]===-pt[2]){const K=Math.acos(pt[0])*180/Math.PI;return`rotate(${ut(K)})`}}else if(pt[0]===1&&pt[1]===0&&pt[2]===0&&pt[3]===1)return`translate(${ut(pt[4])} ${ut(pt[5])})`;return`matrix(${ut(pt[0])} ${ut(pt[1])} ${ut(pt[2])} ${ut(pt[3])} ${ut(pt[4])} ${ut(pt[5])})`}let nt=0,ct=0,bt=0;class _t{constructor(K,et,St=!1){(0,D.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new D.DOMSVGFactory,this.current=new Tt,this.transformMatrix=U.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=K,this.objs=et,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!St,this._operatorIdMapping=[];for(const at in U.OPS)this._operatorIdMapping[U.OPS[at]]=at}getObject(K,et=null){return typeof K=="string"?K.startsWith("g_")?this.commonObjs.get(K):this.objs.get(K):et}save(){this.transformStack.push(this.transformMatrix);const K=this.current;this.extraStack.push(K),this.current=K.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(K){this.save(),this.executeOpTree(K),this.restore()}loadDependencies(K){const et=K.fnArray,St=K.argsArray;for(let at=0,Y=et.length;at<Y;at++)if(et[at]===U.OPS.dependency)for(const At of St[at]){const ot=At.startsWith("g_")?this.commonObjs:this.objs,kt=new Promise(Lt=>{ot.get(At,Lt)});this.current.dependencies.push(kt)}return Promise.all(this.current.dependencies)}transform(K,et,St,at,Y,At){const ot=[K,et,St,at,Y,At];this.transformMatrix=U.Util.transform(this.transformMatrix,ot),this.tgrp=null}getSVG(K,et){this.viewport=et;const St=this._initialize(et);return this.loadDependencies(K).then(()=>(this.transformMatrix=U.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(K)),St))}convertOpList(K){const et=this._operatorIdMapping,St=K.argsArray,at=K.fnArray,Y=[];for(let At=0,ot=at.length;At<ot;At++){const kt=at[At];Y.push({fnId:kt,fn:et[kt],args:St[At]})}return vt(Y)}executeOpTree(K){for(const et of K){const St=et.fn,at=et.fnId,Y=et.args;switch(at|0){case U.OPS.beginText:this.beginText();break;case U.OPS.dependency:break;case U.OPS.setLeading:this.setLeading(Y);break;case U.OPS.setLeadingMoveText:this.setLeadingMoveText(Y[0],Y[1]);break;case U.OPS.setFont:this.setFont(Y);break;case U.OPS.showText:this.showText(Y[0]);break;case U.OPS.showSpacedText:this.showText(Y[0]);break;case U.OPS.endText:this.endText();break;case U.OPS.moveText:this.moveText(Y[0],Y[1]);break;case U.OPS.setCharSpacing:this.setCharSpacing(Y[0]);break;case U.OPS.setWordSpacing:this.setWordSpacing(Y[0]);break;case U.OPS.setHScale:this.setHScale(Y[0]);break;case U.OPS.setTextMatrix:this.setTextMatrix(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]);break;case U.OPS.setTextRise:this.setTextRise(Y[0]);break;case U.OPS.setTextRenderingMode:this.setTextRenderingMode(Y[0]);break;case U.OPS.setLineWidth:this.setLineWidth(Y[0]);break;case U.OPS.setLineJoin:this.setLineJoin(Y[0]);break;case U.OPS.setLineCap:this.setLineCap(Y[0]);break;case U.OPS.setMiterLimit:this.setMiterLimit(Y[0]);break;case U.OPS.setFillRGBColor:this.setFillRGBColor(Y[0],Y[1],Y[2]);break;case U.OPS.setStrokeRGBColor:this.setStrokeRGBColor(Y[0],Y[1],Y[2]);break;case U.OPS.setStrokeColorN:this.setStrokeColorN(Y);break;case U.OPS.setFillColorN:this.setFillColorN(Y);break;case U.OPS.shadingFill:this.shadingFill(Y[0]);break;case U.OPS.setDash:this.setDash(Y[0],Y[1]);break;case U.OPS.setRenderingIntent:this.setRenderingIntent(Y[0]);break;case U.OPS.setFlatness:this.setFlatness(Y[0]);break;case U.OPS.setGState:this.setGState(Y[0]);break;case U.OPS.fill:this.fill();break;case U.OPS.eoFill:this.eoFill();break;case U.OPS.stroke:this.stroke();break;case U.OPS.fillStroke:this.fillStroke();break;case U.OPS.eoFillStroke:this.eoFillStroke();break;case U.OPS.clip:this.clip("nonzero");break;case U.OPS.eoClip:this.clip("evenodd");break;case U.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case U.OPS.paintImageXObject:this.paintImageXObject(Y[0]);break;case U.OPS.paintInlineImageXObject:this.paintInlineImageXObject(Y[0]);break;case U.OPS.paintImageMaskXObject:this.paintImageMaskXObject(Y[0]);break;case U.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(Y[0],Y[1]);break;case U.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case U.OPS.closePath:this.closePath();break;case U.OPS.closeStroke:this.closeStroke();break;case U.OPS.closeFillStroke:this.closeFillStroke();break;case U.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case U.OPS.nextLine:this.nextLine();break;case U.OPS.transform:this.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]);break;case U.OPS.constructPath:this.constructPath(Y[0],Y[1]);break;case U.OPS.endPath:this.endPath();break;case 92:this.group(et.items);break;default:(0,U.warn)(`Unimplemented operator ${St}`);break}}}setWordSpacing(K){this.current.wordSpacing=K}setCharSpacing(K){this.current.charSpacing=K}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(K,et,St,at,Y,At){const ot=this.current;ot.textMatrix=ot.lineMatrix=[K,et,St,at,Y,At],ot.textMatrixScale=Math.hypot(K,et),ot.x=ot.lineX=0,ot.y=ot.lineY=0,ot.xcoords=[],ot.ycoords=[],ot.tspan=this.svgFactory.createElement("svg:tspan"),ot.tspan.setAttributeNS(null,"font-family",ot.fontFamily),ot.tspan.setAttributeNS(null,"font-size",`${ut(ot.fontSize)}px`),ot.tspan.setAttributeNS(null,"y",ut(-ot.y)),ot.txtElement=this.svgFactory.createElement("svg:text"),ot.txtElement.append(ot.tspan)}beginText(){const K=this.current;K.x=K.lineX=0,K.y=K.lineY=0,K.textMatrix=U.IDENTITY_MATRIX,K.lineMatrix=U.IDENTITY_MATRIX,K.textMatrixScale=1,K.tspan=this.svgFactory.createElement("svg:tspan"),K.txtElement=this.svgFactory.createElement("svg:text"),K.txtgrp=this.svgFactory.createElement("svg:g"),K.xcoords=[],K.ycoords=[]}moveText(K,et){const St=this.current;St.x=St.lineX+=K,St.y=St.lineY+=et,St.xcoords=[],St.ycoords=[],St.tspan=this.svgFactory.createElement("svg:tspan"),St.tspan.setAttributeNS(null,"font-family",St.fontFamily),St.tspan.setAttributeNS(null,"font-size",`${ut(St.fontSize)}px`),St.tspan.setAttributeNS(null,"y",ut(-St.y))}showText(K){const et=this.current,St=et.font,at=et.fontSize;if(at===0)return;const Y=et.fontSizeScale,At=et.charSpacing,ot=et.wordSpacing,kt=et.fontDirection,Lt=et.textHScale*kt,mt=St.vertical,It=mt?1:-1,Vt=St.defaultVMetrics,Xt=at*et.fontMatrix[0];let Mt=0;for(const de of K){if(de===null){Mt+=kt*ot;continue}else if(typeof de=="number"){Mt+=It*de*at/1e3;continue}const ge=(de.isSpace?ot:0)+At,gt=de.fontChar;let z,X,G=de.width;if(mt){let it;const lt=de.vmetric||Vt;it=de.vmetric?lt[1]:G*.5,it=-it*Xt;const Et=lt[2]*Xt;G=lt?-lt[0]:G,z=it/Y,X=(Mt+Et)/Y}else z=Mt/Y,X=0;(de.isInFont||St.missingFile)&&(et.xcoords.push(et.x+z),mt&&et.ycoords.push(-et.y+X),et.tspan.textContent+=gt);const J=mt?G*Xt-ge*kt:G*Xt+ge*kt;Mt+=J}et.tspan.setAttributeNS(null,"x",et.xcoords.map(ut).join(" ")),mt?et.tspan.setAttributeNS(null,"y",et.ycoords.map(ut).join(" ")):et.tspan.setAttributeNS(null,"y",ut(-et.y)),mt?et.y-=Mt:et.x+=Mt*Lt,et.tspan.setAttributeNS(null,"font-family",et.fontFamily),et.tspan.setAttributeNS(null,"font-size",`${ut(et.fontSize)}px`),et.fontStyle!==tt.fontStyle&&et.tspan.setAttributeNS(null,"font-style",et.fontStyle),et.fontWeight!==tt.fontWeight&&et.tspan.setAttributeNS(null,"font-weight",et.fontWeight);const Kt=et.textRenderingMode&U.TextRenderingMode.FILL_STROKE_MASK;if(Kt===U.TextRenderingMode.FILL||Kt===U.TextRenderingMode.FILL_STROKE?(et.fillColor!==tt.fillColor&&et.tspan.setAttributeNS(null,"fill",et.fillColor),et.fillAlpha<1&&et.tspan.setAttributeNS(null,"fill-opacity",et.fillAlpha)):et.textRenderingMode===U.TextRenderingMode.ADD_TO_PATH?et.tspan.setAttributeNS(null,"fill","transparent"):et.tspan.setAttributeNS(null,"fill","none"),Kt===U.TextRenderingMode.STROKE||Kt===U.TextRenderingMode.FILL_STROKE){const de=1/(et.textMatrixScale||1);this._setStrokeAttributes(et.tspan,de)}let ee=et.textMatrix;et.textRise!==0&&(ee=ee.slice(),ee[5]+=et.textRise),et.txtElement.setAttributeNS(null,"transform",`${ft(ee)} scale(${ut(Lt)}, -1)`),et.txtElement.setAttributeNS(Q,"xml:space","preserve"),et.txtElement.append(et.tspan),et.txtgrp.append(et.txtElement),this._ensureTransformGroup().append(et.txtElement)}setLeadingMoveText(K,et){this.setLeading(-et),this.moveText(K,et)}addFontStyle(K){if(!K.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const et=st(K.data,K.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${K.loadedName}"; src: url(${et}); }
`}setFont(K){const et=this.current,St=this.commonObjs.get(K[0]);let at=K[1];et.font=St,this.embedFonts&&!St.missingFile&&!this.embeddedFonts[St.loadedName]&&(this.addFontStyle(St),this.embeddedFonts[St.loadedName]=St),et.fontMatrix=St.fontMatrix||U.FONT_IDENTITY_MATRIX;let Y="normal";St.black?Y="900":St.bold&&(Y="bold");const At=St.italic?"italic":"normal";at<0?(at=-at,et.fontDirection=-1):et.fontDirection=1,et.fontSize=at,et.fontFamily=St.loadedName,et.fontWeight=Y,et.fontStyle=At,et.tspan=this.svgFactory.createElement("svg:tspan"),et.tspan.setAttributeNS(null,"y",ut(-et.y)),et.xcoords=[],et.ycoords=[]}endText(){var et;const K=this.current;K.textRenderingMode&U.TextRenderingMode.ADD_TO_PATH_FLAG&&((et=K.txtElement)!=null&&et.hasChildNodes())&&(K.element=K.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(K){K>0&&(this.current.lineWidth=K)}setLineCap(K){this.current.lineCap=ht[K]}setLineJoin(K){this.current.lineJoin=dt[K]}setMiterLimit(K){this.current.miterLimit=K}setStrokeAlpha(K){this.current.strokeAlpha=K}setStrokeRGBColor(K,et,St){this.current.strokeColor=U.Util.makeHexColor(K,et,St)}setFillAlpha(K){this.current.fillAlpha=K}setFillRGBColor(K,et,St){this.current.fillColor=U.Util.makeHexColor(K,et,St),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(K){this.current.strokeColor=this._makeColorN_Pattern(K)}setFillColorN(K){this.current.fillColor=this._makeColorN_Pattern(K)}shadingFill(K){const{width:et,height:St}=this.viewport,at=U.Util.inverseTransform(this.transformMatrix),[Y,At,ot,kt]=U.Util.getAxialAlignedBoundingBox([0,0,et,St],at),Lt=this.svgFactory.createElement("svg:rect");Lt.setAttributeNS(null,"x",Y),Lt.setAttributeNS(null,"y",At),Lt.setAttributeNS(null,"width",ot-Y),Lt.setAttributeNS(null,"height",kt-At),Lt.setAttributeNS(null,"fill",this._makeShadingPattern(K)),this.current.fillAlpha<1&&Lt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Lt)}_makeColorN_Pattern(K){return K[0]==="TilingPattern"?this._makeTilingPattern(K):this._makeShadingPattern(K)}_makeTilingPattern(K){const et=K[1],St=K[2],at=K[3]||U.IDENTITY_MATRIX,[Y,At,ot,kt]=K[4],Lt=K[5],mt=K[6],It=K[7],Vt=`shading${bt++}`,[Xt,Mt,Kt,ee]=U.Util.normalizeRect([...U.Util.applyTransform([Y,At],at),...U.Util.applyTransform([ot,kt],at)]),[de,ge]=U.Util.singularValueDecompose2dScale(at),gt=Lt*de,z=mt*ge,X=this.svgFactory.createElement("svg:pattern");X.setAttributeNS(null,"id",Vt),X.setAttributeNS(null,"patternUnits","userSpaceOnUse"),X.setAttributeNS(null,"width",gt),X.setAttributeNS(null,"height",z),X.setAttributeNS(null,"x",`${Xt}`),X.setAttributeNS(null,"y",`${Mt}`);const G=this.svg,J=this.transformMatrix,it=this.current.fillColor,lt=this.current.strokeColor,Et=this.svgFactory.create(Kt-Xt,ee-Mt);if(this.svg=Et,this.transformMatrix=at,It===2){const xt=U.Util.makeHexColor(...et);this.current.fillColor=xt,this.current.strokeColor=xt}return this.executeOpTree(this.convertOpList(St)),this.svg=G,this.transformMatrix=J,this.current.fillColor=it,this.current.strokeColor=lt,X.append(Et.childNodes[0]),this.defs.append(X),`url(#${Vt})`}_makeShadingPattern(K){switch(typeof K=="string"&&(K=this.objs.get(K)),K[0]){case"RadialAxial":const et=`shading${bt++}`,St=K[3];let at;switch(K[1]){case"axial":const Y=K[4],At=K[5];at=this.svgFactory.createElement("svg:linearGradient"),at.setAttributeNS(null,"id",et),at.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),at.setAttributeNS(null,"x1",Y[0]),at.setAttributeNS(null,"y1",Y[1]),at.setAttributeNS(null,"x2",At[0]),at.setAttributeNS(null,"y2",At[1]);break;case"radial":const ot=K[4],kt=K[5],Lt=K[6],mt=K[7];at=this.svgFactory.createElement("svg:radialGradient"),at.setAttributeNS(null,"id",et),at.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),at.setAttributeNS(null,"cx",kt[0]),at.setAttributeNS(null,"cy",kt[1]),at.setAttributeNS(null,"r",mt),at.setAttributeNS(null,"fx",ot[0]),at.setAttributeNS(null,"fy",ot[1]),at.setAttributeNS(null,"fr",Lt);break;default:throw new Error(`Unknown RadialAxial type: ${K[1]}`)}for(const Y of St){const At=this.svgFactory.createElement("svg:stop");At.setAttributeNS(null,"offset",Y[0]),At.setAttributeNS(null,"stop-color",Y[1]),at.append(At)}return this.defs.append(at),`url(#${et})`;case"Mesh":return(0,U.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${K[0]}`)}}setDash(K,et){this.current.dashArray=K,this.current.dashPhase=et}constructPath(K,et){const St=this.current;let at=St.x,Y=St.y,At=[],ot=0;for(const kt of K)switch(kt|0){case U.OPS.rectangle:at=et[ot++],Y=et[ot++];const Lt=et[ot++],mt=et[ot++],It=at+Lt,Vt=Y+mt;At.push("M",ut(at),ut(Y),"L",ut(It),ut(Y),"L",ut(It),ut(Vt),"L",ut(at),ut(Vt),"Z");break;case U.OPS.moveTo:at=et[ot++],Y=et[ot++],At.push("M",ut(at),ut(Y));break;case U.OPS.lineTo:at=et[ot++],Y=et[ot++],At.push("L",ut(at),ut(Y));break;case U.OPS.curveTo:at=et[ot+4],Y=et[ot+5],At.push("C",ut(et[ot]),ut(et[ot+1]),ut(et[ot+2]),ut(et[ot+3]),ut(at),ut(Y)),ot+=6;break;case U.OPS.curveTo2:At.push("C",ut(at),ut(Y),ut(et[ot]),ut(et[ot+1]),ut(et[ot+2]),ut(et[ot+3])),at=et[ot+2],Y=et[ot+3],ot+=4;break;case U.OPS.curveTo3:at=et[ot+2],Y=et[ot+3],At.push("C",ut(et[ot]),ut(et[ot+1]),ut(at),ut(Y),ut(at),ut(Y)),ot+=4;break;case U.OPS.closePath:At.push("Z");break}At=At.join(" "),St.path&&K.length>0&&K[0]!==U.OPS.rectangle&&K[0]!==U.OPS.moveTo?At=St.path.getAttributeNS(null,"d")+At:(St.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(St.path)),St.path.setAttributeNS(null,"d",At),St.path.setAttributeNS(null,"fill","none"),St.element=St.path,St.setCurrentPoint(at,Y)}endPath(){const K=this.current;if(K.path=null,!this.pendingClip)return;if(!K.element){this.pendingClip=null;return}const et=`clippath${nt++}`,St=this.svgFactory.createElement("svg:clipPath");St.setAttributeNS(null,"id",et),St.setAttributeNS(null,"transform",ft(this.transformMatrix));const at=K.element.cloneNode(!0);if(this.pendingClip==="evenodd"?at.setAttributeNS(null,"clip-rule","evenodd"):at.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,St.append(at),this.defs.append(St),K.activeClipUrl){K.clipGroup=null;for(const Y of this.extraStack)Y.clipGroup=null;St.setAttributeNS(null,"clip-path",K.activeClipUrl)}K.activeClipUrl=`url(#${et})`,this.tgrp=null}clip(K){this.pendingClip=K}closePath(){const K=this.current;if(K.path){const et=`${K.path.getAttributeNS(null,"d")}Z`;K.path.setAttributeNS(null,"d",et)}}setLeading(K){this.current.leading=-K}setTextRise(K){this.current.textRise=K}setTextRenderingMode(K){this.current.textRenderingMode=K}setHScale(K){this.current.textHScale=K/100}setRenderingIntent(K){}setFlatness(K){}setGState(K){for(const[et,St]of K)switch(et){case"LW":this.setLineWidth(St);break;case"LC":this.setLineCap(St);break;case"LJ":this.setLineJoin(St);break;case"ML":this.setMiterLimit(St);break;case"D":this.setDash(St[0],St[1]);break;case"RI":this.setRenderingIntent(St);break;case"FL":this.setFlatness(St);break;case"Font":this.setFont(St);break;case"CA":this.setStrokeAlpha(St);break;case"ca":this.setFillAlpha(St);break;default:(0,U.warn)(`Unimplemented graphic state operator ${et}`);break}}fill(){const K=this.current;K.element&&(K.element.setAttributeNS(null,"fill",K.fillColor),K.element.setAttributeNS(null,"fill-opacity",K.fillAlpha),this.endPath())}stroke(){const K=this.current;K.element&&(this._setStrokeAttributes(K.element),K.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(K,et=1){const St=this.current;let at=St.dashArray;et!==1&&at.length>0&&(at=at.map(function(Y){return et*Y})),K.setAttributeNS(null,"stroke",St.strokeColor),K.setAttributeNS(null,"stroke-opacity",St.strokeAlpha),K.setAttributeNS(null,"stroke-miterlimit",ut(St.miterLimit)),K.setAttributeNS(null,"stroke-linecap",St.lineCap),K.setAttributeNS(null,"stroke-linejoin",St.lineJoin),K.setAttributeNS(null,"stroke-width",ut(et*St.lineWidth)+"px"),K.setAttributeNS(null,"stroke-dasharray",at.map(ut).join(" ")),K.setAttributeNS(null,"stroke-dashoffset",ut(et*St.dashPhase)+"px")}eoFill(){var K;(K=this.current.element)==null||K.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var K;(K=this.current.element)==null||K.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const K=this.svgFactory.createElement("svg:rect");K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y","0"),K.setAttributeNS(null,"width","1px"),K.setAttributeNS(null,"height","1px"),K.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(K)}paintImageXObject(K){const et=this.getObject(K);if(!et){(0,U.warn)(`Dependent image with object ID ${K} is not ready yet`);return}this.paintInlineImageXObject(et)}paintInlineImageXObject(K,et){const St=K.width,at=K.height,Y=yt(K,this.forceDataSchema,!!et),At=this.svgFactory.createElement("svg:rect");At.setAttributeNS(null,"x","0"),At.setAttributeNS(null,"y","0"),At.setAttributeNS(null,"width",ut(St)),At.setAttributeNS(null,"height",ut(at)),this.current.element=At,this.clip("nonzero");const ot=this.svgFactory.createElement("svg:image");ot.setAttributeNS(Ft,"xlink:href",Y),ot.setAttributeNS(null,"x","0"),ot.setAttributeNS(null,"y",ut(-at)),ot.setAttributeNS(null,"width",ut(St)+"px"),ot.setAttributeNS(null,"height",ut(at)+"px"),ot.setAttributeNS(null,"transform",`scale(${ut(1/St)} ${ut(-1/at)})`),et?et.append(ot):this._ensureTransformGroup().append(ot)}paintImageMaskXObject(K){const et=this.getObject(K.data,K);if(et.bitmap){(0,U.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const St=this.current,at=et.width,Y=et.height,At=St.fillColor;St.maskId=`mask${ct++}`;const ot=this.svgFactory.createElement("svg:mask");ot.setAttributeNS(null,"id",St.maskId);const kt=this.svgFactory.createElement("svg:rect");kt.setAttributeNS(null,"x","0"),kt.setAttributeNS(null,"y","0"),kt.setAttributeNS(null,"width",ut(at)),kt.setAttributeNS(null,"height",ut(Y)),kt.setAttributeNS(null,"fill",At),kt.setAttributeNS(null,"mask",`url(#${St.maskId})`),this.defs.append(ot),this._ensureTransformGroup().append(kt),this.paintInlineImageXObject(et,ot)}paintFormXObjectBegin(K,et){if(Array.isArray(K)&&K.length===6&&this.transform(K[0],K[1],K[2],K[3],K[4],K[5]),et){const St=et[2]-et[0],at=et[3]-et[1],Y=this.svgFactory.createElement("svg:rect");Y.setAttributeNS(null,"x",et[0]),Y.setAttributeNS(null,"y",et[1]),Y.setAttributeNS(null,"width",ut(St)),Y.setAttributeNS(null,"height",ut(at)),this.current.element=Y,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(K){const et=this.svgFactory.create(K.width,K.height),St=this.svgFactory.createElement("svg:defs");et.append(St),this.defs=St;const at=this.svgFactory.createElement("svg:g");return at.setAttributeNS(null,"transform",ft(K.transform)),et.append(at),this.svg=at,et}_ensureClipGroup(){if(!this.current.clipGroup){const K=this.svgFactory.createElement("svg:g");K.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(K),this.current.clipGroup=K}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",ft(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}F.SVGGraphics=_t},(B,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.XfaText=void 0;class O{static textContent(U){const tt=[],Q={items:tt,styles:Object.create(null)};function Ft(ht){var yt;if(!ht)return;let dt=null;const st=ht.name;if(st==="#text")dt=ht.value;else if(O.shouldBuildText(st))(yt=ht==null?void 0:ht.attributes)!=null&&yt.textContent?dt=ht.attributes.textContent:ht.value&&(dt=ht.value);else return;if(dt!==null&&tt.push({str:dt}),!!ht.children)for(const Tt of ht.children)Ft(Tt)}return Ft(U),Q}static shouldBuildText(U){return!(U==="textarea"||U==="input"||U==="option"||U==="select")}}F.XfaText=O},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.TextLayerRenderTask=void 0,F.renderTextLayer=ft,F.updateTextLayer=nt;var D=O(1),U=O(6);const tt=1e5,Q=30,Ft=.8,ht=new Map;function dt(ct,bt){let _t;if(bt&&D.FeatureTest.isOffscreenCanvasSupported)_t=new OffscreenCanvas(ct,ct).getContext("2d",{alpha:!1});else{const pt=document.createElement("canvas");pt.width=pt.height=ct,_t=pt.getContext("2d",{alpha:!1})}return _t}function st(ct,bt){const _t=ht.get(ct);if(_t)return _t;const pt=dt(Q,bt);pt.font=`${Q}px ${ct}`;const K=pt.measureText("");let et=K.fontBoundingBoxAscent,St=Math.abs(K.fontBoundingBoxDescent);if(et){const Y=et/(et+St);return ht.set(ct,Y),pt.canvas.width=pt.canvas.height=0,Y}pt.strokeStyle="red",pt.clearRect(0,0,Q,Q),pt.strokeText("g",0,0);let at=pt.getImageData(0,0,Q,Q).data;St=0;for(let Y=at.length-1-3;Y>=0;Y-=4)if(at[Y]>0){St=Math.ceil(Y/4/Q);break}pt.clearRect(0,0,Q,Q),pt.strokeText("A",0,Q),at=pt.getImageData(0,0,Q,Q).data,et=0;for(let Y=0,At=at.length;Y<At;Y+=4)if(at[Y]>0){et=Q-Math.floor(Y/4/Q);break}if(pt.canvas.width=pt.canvas.height=0,et){const Y=et/(et+St);return ht.set(ct,Y),Y}return ht.set(ct,Ft),Ft}function yt(ct,bt,_t){const pt=document.createElement("span"),K={angle:0,canvasWidth:0,hasText:bt.str!=="",hasEOL:bt.hasEOL,fontSize:0};ct._textDivs.push(pt);const et=D.Util.transform(ct._transform,bt.transform);let St=Math.atan2(et[1],et[0]);const at=_t[bt.fontName];at.vertical&&(St+=Math.PI/2);const Y=Math.hypot(et[2],et[3]),At=Y*st(at.fontFamily,ct._isOffscreenCanvasSupported);let ot,kt;St===0?(ot=et[4],kt=et[5]-At):(ot=et[4]+At*Math.sin(St),kt=et[5]-At*Math.cos(St));const Lt="calc(var(--scale-factor)*",mt=pt.style;ct._container===ct._rootContainer?(mt.left=`${(100*ot/ct._pageWidth).toFixed(2)}%`,mt.top=`${(100*kt/ct._pageHeight).toFixed(2)}%`):(mt.left=`${Lt}${ot.toFixed(2)}px)`,mt.top=`${Lt}${kt.toFixed(2)}px)`),mt.fontSize=`${Lt}${Y.toFixed(2)}px)`,mt.fontFamily=at.fontFamily,K.fontSize=Y,pt.setAttribute("role","presentation"),pt.textContent=bt.str,pt.dir=bt.dir,ct._fontInspectorEnabled&&(pt.dataset.fontName=bt.fontName),St!==0&&(K.angle=St*(180/Math.PI));let It=!1;if(bt.str.length>1)It=!0;else if(bt.str!==" "&&bt.transform[0]!==bt.transform[3]){const Vt=Math.abs(bt.transform[0]),Xt=Math.abs(bt.transform[3]);Vt!==Xt&&Math.max(Vt,Xt)/Math.min(Vt,Xt)>1.5&&(It=!0)}It&&(K.canvasWidth=at.vertical?bt.height:bt.width),ct._textDivProperties.set(pt,K),ct._isReadableStream&&ct._layoutText(pt)}function Tt(ct){const{div:bt,scale:_t,properties:pt,ctx:K,prevFontSize:et,prevFontFamily:St}=ct,{style:at}=bt;let Y="";if(pt.canvasWidth!==0&&pt.hasText){const{fontFamily:At}=at,{canvasWidth:ot,fontSize:kt}=pt;(et!==kt||St!==At)&&(K.font=`${kt*_t}px ${At}`,ct.prevFontSize=kt,ct.prevFontFamily=At);const{width:Lt}=K.measureText(bt.textContent);Lt>0&&(Y=`scaleX(${ot*_t/Lt})`)}pt.angle!==0&&(Y=`rotate(${pt.angle}deg) ${Y}`),Y.length>0&&(at.transform=Y)}function vt(ct){if(ct._canceled)return;const bt=ct._textDivs,_t=ct._capability;if(bt.length>tt){_t.resolve();return}if(!ct._isReadableStream)for(const K of bt)ct._layoutText(K);_t.resolve()}class ut{constructor({textContentSource:bt,container:_t,viewport:pt,textDivs:K,textDivProperties:et,textContentItemsStr:St,isOffscreenCanvasSupported:at}){var Lt;this._textContentSource=bt,this._isReadableStream=bt instanceof ReadableStream,this._container=this._rootContainer=_t,this._textDivs=K||[],this._textContentItemsStr=St||[],this._isOffscreenCanvasSupported=at,this._fontInspectorEnabled=!!((Lt=globalThis.FontInspector)!=null&&Lt.enabled),this._reader=null,this._textDivProperties=et||new WeakMap,this._canceled=!1,this._capability=new D.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:pt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:dt(0,at)};const{pageWidth:Y,pageHeight:At,pageX:ot,pageY:kt}=pt.rawDims;this._transform=[1,0,0,-1,-ot,kt+At],this._pageWidth=Y,this._pageHeight=At,(0,U.setLayerDimensions)(_t,pt),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new D.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new D.AbortException("TextLayer task cancelled."))}_processItems(bt,_t){for(const pt of bt){if(pt.str===void 0){if(pt.type==="beginMarkedContentProps"||pt.type==="beginMarkedContent"){const K=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),pt.id!==null&&this._container.setAttribute("id",`${pt.id}`),K.append(this._container)}else pt.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(pt.str),yt(this,pt,_t)}}_layoutText(bt){const _t=this._layoutTextParams.properties=this._textDivProperties.get(bt);if(this._layoutTextParams.div=bt,Tt(this._layoutTextParams),_t.hasText&&this._container.append(bt),_t.hasEOL){const pt=document.createElement("br");pt.setAttribute("role","presentation"),this._container.append(pt)}}_render(){const bt=new D.PromiseCapability;let _t=Object.create(null);if(this._isReadableStream){const pt=()=>{this._reader.read().then(({value:K,done:et})=>{if(et){bt.resolve();return}Object.assign(_t,K.styles),this._processItems(K.items,_t),pt()},bt.reject)};this._reader=this._textContentSource.getReader(),pt()}else if(this._textContentSource){const{items:pt,styles:K}=this._textContentSource;this._processItems(pt,K),bt.resolve()}else throw new Error('No "textContentSource" parameter specified.');bt.promise.then(()=>{_t=null,vt(this)},this._capability.reject)}}F.TextLayerRenderTask=ut;function ft(ct){!ct.textContentSource&&(ct.textContent||ct.textContentStream)&&((0,U.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),ct.textContentSource=ct.textContent||ct.textContentStream);const{container:bt,viewport:_t}=ct,pt=getComputedStyle(bt),K=pt.getPropertyValue("visibility"),et=parseFloat(pt.getPropertyValue("--scale-factor"));K==="visible"&&(!et||Math.abs(et-_t.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const St=new ut(ct);return St._render(),St}function nt({container:ct,viewport:bt,textDivs:_t,textDivProperties:pt,isOffscreenCanvasSupported:K,mustRotate:et=!0,mustRescale:St=!0}){if(et&&(0,U.setLayerDimensions)(ct,{rotation:bt.rotation}),St){const at=dt(0,K),At={prevFontSize:null,prevFontFamily:null,div:null,scale:bt.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:at};for(const ot of _t)At.properties=pt.get(ot),At.div=ot,Tt(At)}}},(B,F,O)=>{var st,yt,Tt,vt,ut,ft,nt,ct,bt,_t,pt,qi,et,_i,at,zi,At,Vi;Object.defineProperty(F,"__esModule",{value:!0}),F.AnnotationEditorLayer=void 0;var D=O(1),U=O(4),tt=O(28),Q=O(33),Ft=O(6),ht=O(34);const kt=class kt{constructor({uiManager:mt,pageIndex:It,div:Vt,accessibilityManager:Xt,annotationLayer:Mt,viewport:Kt,l10n:ee}){Pt(this,pt);Pt(this,et);Pt(this,at);Pt(this,At);Pt(this,st,void 0);Pt(this,yt,!1);Pt(this,Tt,null);Pt(this,vt,this.pointerup.bind(this));Pt(this,ut,this.pointerdown.bind(this));Pt(this,ft,new Map);Pt(this,nt,!1);Pt(this,ct,!1);Pt(this,bt,!1);Pt(this,_t,void 0);const de=[tt.FreeTextEditor,Q.InkEditor,ht.StampEditor];if(!kt._initialized){kt._initialized=!0;for(const ge of de)ge.initialize(ee)}mt.registerEditorTypes(de),Wt(this,_t,mt),this.pageIndex=It,this.div=Vt,Wt(this,st,Xt),Wt(this,Tt,Mt),this.viewport=Kt,W(this,_t).addLayer(this)}get isEmpty(){return W(this,ft).size===0}updateToolbar(mt){W(this,_t).updateToolbar(mt)}updateMode(mt=W(this,_t).getMode()){Dt(this,At,Vi).call(this),mt===D.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),mt!==D.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",mt===D.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",mt===D.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",mt===D.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(mt){if(!mt&&W(this,_t).getMode()!==D.AnnotationEditorType.INK)return;if(!mt){for(const Vt of W(this,ft).values())if(Vt.isEmpty()){Vt.setInBackground();return}}Dt(this,et,_i).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(mt){W(this,_t).setEditingState(mt)}addCommands(mt){W(this,_t).addCommands(mt)}enable(){this.div.style.pointerEvents="auto";const mt=new Set;for(const Vt of W(this,ft).values())Vt.enableEditing(),Vt.annotationElementId&&mt.add(Vt.annotationElementId);if(!W(this,Tt))return;const It=W(this,Tt).getEditableAnnotations();for(const Vt of It){if(Vt.hide(),W(this,_t).isDeletedAnnotationElement(Vt.data.id)||mt.has(Vt.data.id))continue;const Xt=this.deserialize(Vt);Xt&&(this.addOrRebuild(Xt),Xt.enableEditing())}}disable(){var It;Wt(this,bt,!0),this.div.style.pointerEvents="none";const mt=new Set;for(const Vt of W(this,ft).values()){if(Vt.disableEditing(),!Vt.annotationElementId||Vt.serialize()!==null){mt.add(Vt.annotationElementId);continue}(It=this.getEditableAnnotation(Vt.annotationElementId))==null||It.show(),Vt.remove()}if(W(this,Tt)){const Vt=W(this,Tt).getEditableAnnotations();for(const Xt of Vt){const{id:Mt}=Xt.data;mt.has(Mt)||W(this,_t).isDeletedAnnotationElement(Mt)||Xt.show()}}Dt(this,At,Vi).call(this),this.isEmpty&&(this.div.hidden=!0),Wt(this,bt,!1)}getEditableAnnotation(mt){var It;return((It=W(this,Tt))==null?void 0:It.getEditableAnnotation(mt))||null}setActiveEditor(mt){W(this,_t).getActive()!==mt&&W(this,_t).setActiveEditor(mt)}enableClick(){this.div.addEventListener("pointerdown",W(this,ut)),this.div.addEventListener("pointerup",W(this,vt))}disableClick(){this.div.removeEventListener("pointerdown",W(this,ut)),this.div.removeEventListener("pointerup",W(this,vt))}attach(mt){W(this,ft).set(mt.id,mt);const{annotationElementId:It}=mt;It&&W(this,_t).isDeletedAnnotationElement(It)&&W(this,_t).removeDeletedAnnotationElement(mt)}detach(mt){var It;W(this,ft).delete(mt.id),(It=W(this,st))==null||It.removePointerInTextLayer(mt.contentDiv),!W(this,bt)&&mt.annotationElementId&&W(this,_t).addDeletedAnnotationElement(mt)}remove(mt){this.detach(mt),W(this,_t).removeEditor(mt),mt.div.contains(document.activeElement)&&setTimeout(()=>{W(this,_t).focusMainContainer()},0),mt.div.remove(),mt.isAttachedToDOM=!1,W(this,ct)||this.addInkEditorIfNeeded(!1)}changeParent(mt){var It;mt.parent!==this&&(mt.annotationElementId&&(W(this,_t).addDeletedAnnotationElement(mt.annotationElementId),U.AnnotationEditor.deleteAnnotationElement(mt),mt.annotationElementId=null),this.attach(mt),(It=mt.parent)==null||It.detach(mt),mt.setParent(this),mt.div&&mt.isAttachedToDOM&&(mt.div.remove(),this.div.append(mt.div)))}add(mt){if(this.changeParent(mt),W(this,_t).addEditor(mt),this.attach(mt),!mt.isAttachedToDOM){const It=mt.render();this.div.append(It),mt.isAttachedToDOM=!0}mt.fixAndSetPosition(),mt.onceAdded(),W(this,_t).addToAnnotationStorage(mt)}moveEditorInDOM(mt){var Vt;if(!mt.isAttachedToDOM)return;const{activeElement:It}=document;mt.div.contains(It)&&(mt._focusEventsAllowed=!1,setTimeout(()=>{mt.div.contains(document.activeElement)?mt._focusEventsAllowed=!0:(mt.div.addEventListener("focusin",()=>{mt._focusEventsAllowed=!0},{once:!0}),It.focus())},0)),mt._structTreeParentId=(Vt=W(this,st))==null?void 0:Vt.moveElementInDOM(this.div,mt.div,mt.contentDiv,!0)}addOrRebuild(mt){mt.needsToBeRebuilt()?mt.rebuild():this.add(mt)}addUndoableEditor(mt){const It=()=>mt._uiManager.rebuild(mt),Vt=()=>{mt.remove()};this.addCommands({cmd:It,undo:Vt,mustExec:!1})}getNextId(){return W(this,_t).getId()}pasteEditor(mt,It){W(this,_t).updateToolbar(mt),W(this,_t).updateMode(mt);const{offsetX:Vt,offsetY:Xt}=Dt(this,at,zi).call(this),Mt=this.getNextId(),Kt=Dt(this,pt,qi).call(this,{parent:this,id:Mt,x:Vt,y:Xt,uiManager:W(this,_t),isCentered:!0,...It});Kt&&this.add(Kt)}deserialize(mt){switch(mt.annotationType??mt.annotationEditorType){case D.AnnotationEditorType.FREETEXT:return tt.FreeTextEditor.deserialize(mt,this,W(this,_t));case D.AnnotationEditorType.INK:return Q.InkEditor.deserialize(mt,this,W(this,_t));case D.AnnotationEditorType.STAMP:return ht.StampEditor.deserialize(mt,this,W(this,_t))}return null}addNewEditor(){Dt(this,et,_i).call(this,Dt(this,at,zi).call(this),!0)}setSelected(mt){W(this,_t).setSelected(mt)}toggleSelected(mt){W(this,_t).toggleSelected(mt)}isSelected(mt){return W(this,_t).isSelected(mt)}unselect(mt){W(this,_t).unselect(mt)}pointerup(mt){const{isMac:It}=D.FeatureTest.platform;if(!(mt.button!==0||mt.ctrlKey&&It)&&mt.target===this.div&&W(this,nt)){if(Wt(this,nt,!1),!W(this,yt)){Wt(this,yt,!0);return}if(W(this,_t).getMode()===D.AnnotationEditorType.STAMP){W(this,_t).unselectAll();return}Dt(this,et,_i).call(this,mt,!1)}}pointerdown(mt){if(W(this,nt)){Wt(this,nt,!1);return}const{isMac:It}=D.FeatureTest.platform;if(mt.button!==0||mt.ctrlKey&&It||mt.target!==this.div)return;Wt(this,nt,!0);const Vt=W(this,_t).getActive();Wt(this,yt,!Vt||Vt.isEmpty())}findNewParent(mt,It,Vt){const Xt=W(this,_t).findParent(It,Vt);return Xt===null||Xt===this?!1:(Xt.changeParent(mt),!0)}destroy(){var mt,It;((mt=W(this,_t).getActive())==null?void 0:mt.parent)===this&&(W(this,_t).commitOrRemove(),W(this,_t).setActiveEditor(null));for(const Vt of W(this,ft).values())(It=W(this,st))==null||It.removePointerInTextLayer(Vt.contentDiv),Vt.setParent(null),Vt.isAttachedToDOM=!1,Vt.div.remove();this.div=null,W(this,ft).clear(),W(this,_t).removeLayer(this)}render({viewport:mt}){this.viewport=mt,(0,Ft.setLayerDimensions)(this.div,mt);for(const It of W(this,_t).getEditors(this.pageIndex))this.add(It);this.updateMode()}update({viewport:mt}){W(this,_t).commitOrRemove(),this.viewport=mt,(0,Ft.setLayerDimensions)(this.div,{rotation:mt.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:mt,pageHeight:It}=this.viewport.rawDims;return[mt,It]}};st=new WeakMap,yt=new WeakMap,Tt=new WeakMap,vt=new WeakMap,ut=new WeakMap,ft=new WeakMap,nt=new WeakMap,ct=new WeakMap,bt=new WeakMap,_t=new WeakMap,pt=new WeakSet,qi=function(mt){switch(W(this,_t).getMode()){case D.AnnotationEditorType.FREETEXT:return new tt.FreeTextEditor(mt);case D.AnnotationEditorType.INK:return new Q.InkEditor(mt);case D.AnnotationEditorType.STAMP:return new ht.StampEditor(mt)}return null},et=new WeakSet,_i=function(mt,It){const Vt=this.getNextId(),Xt=Dt(this,pt,qi).call(this,{parent:this,id:Vt,x:mt.offsetX,y:mt.offsetY,uiManager:W(this,_t),isCentered:It});return Xt&&this.add(Xt),Xt},at=new WeakSet,zi=function(){const{x:mt,y:It,width:Vt,height:Xt}=this.div.getBoundingClientRect(),Mt=Math.max(0,mt),Kt=Math.max(0,It),ee=Math.min(window.innerWidth,mt+Vt),de=Math.min(window.innerHeight,It+Xt),ge=(Mt+ee)/2-mt,gt=(Kt+de)/2-It,[z,X]=this.viewport.rotation%180===0?[ge,gt]:[gt,ge];return{offsetX:z,offsetY:X}},At=new WeakSet,Vi=function(){Wt(this,ct,!0);for(const mt of W(this,ft).values())mt.isEmpty()&&mt.remove();Wt(this,ct,!1)},He(kt,"_initialized",!1);let dt=kt;F.AnnotationEditorLayer=dt},(B,F,O)=>{var ht,dt,st,yt,Tt,vt,ut,ft,nt,ct,vs,_t,Ss,K,Es,St,li,Y,Gi,ot,ws,Lt,Xi;Object.defineProperty(F,"__esModule",{value:!0}),F.FreeTextEditor=void 0;var D=O(1),U=O(5),tt=O(4),Q=O(29);const It=class It extends tt.AnnotationEditor{constructor(Mt){super({...Mt,name:"freeTextEditor"});Pt(this,ct);Pt(this,_t);Pt(this,K);Pt(this,St);Pt(this,Y);Pt(this,ot);Pt(this,Lt);Pt(this,ht,this.editorDivBlur.bind(this));Pt(this,dt,this.editorDivFocus.bind(this));Pt(this,st,this.editorDivInput.bind(this));Pt(this,yt,this.editorDivKeydown.bind(this));Pt(this,Tt,void 0);Pt(this,vt,"");Pt(this,ut,`${this.id}-editor`);Pt(this,ft,void 0);Pt(this,nt,null);Wt(this,Tt,Mt.color||It._defaultColor||tt.AnnotationEditor._defaultLineColor),Wt(this,ft,Mt.fontSize||It._defaultFontSize)}static get _keyboardManager(){const Mt=It.prototype,Kt=ge=>ge.isEmpty(),ee=U.AnnotationEditorUIManager.TRANSLATE_SMALL,de=U.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,D.shadow)(this,"_keyboardManager",new U.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Mt.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Mt.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Mt._translateEmpty,{args:[-ee,0],checker:Kt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Mt._translateEmpty,{args:[-de,0],checker:Kt}],[["ArrowRight","mac+ArrowRight"],Mt._translateEmpty,{args:[ee,0],checker:Kt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Mt._translateEmpty,{args:[de,0],checker:Kt}],[["ArrowUp","mac+ArrowUp"],Mt._translateEmpty,{args:[0,-ee],checker:Kt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Mt._translateEmpty,{args:[0,-de],checker:Kt}],[["ArrowDown","mac+ArrowDown"],Mt._translateEmpty,{args:[0,ee],checker:Kt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Mt._translateEmpty,{args:[0,de],checker:Kt}]]))}static initialize(Mt){tt.AnnotationEditor.initialize(Mt,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Kt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Kt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Mt,Kt){switch(Mt){case D.AnnotationEditorParamsType.FREETEXT_SIZE:It._defaultFontSize=Kt;break;case D.AnnotationEditorParamsType.FREETEXT_COLOR:It._defaultColor=Kt;break}}updateParams(Mt,Kt){switch(Mt){case D.AnnotationEditorParamsType.FREETEXT_SIZE:Dt(this,ct,vs).call(this,Kt);break;case D.AnnotationEditorParamsType.FREETEXT_COLOR:Dt(this,_t,Ss).call(this,Kt);break}}static get defaultPropertiesToUpdate(){return[[D.AnnotationEditorParamsType.FREETEXT_SIZE,It._defaultFontSize],[D.AnnotationEditorParamsType.FREETEXT_COLOR,It._defaultColor||tt.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[D.AnnotationEditorParamsType.FREETEXT_SIZE,W(this,ft)],[D.AnnotationEditorParamsType.FREETEXT_COLOR,W(this,Tt)]]}_translateEmpty(Mt,Kt){this._uiManager.translateSelectedEditors(Mt,Kt,!0)}getInitialTranslation(){const Mt=this.parentScale;return[-It._internalPadding*Mt,-(It._internalPadding+W(this,ft))*Mt]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(D.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",W(this,yt)),this.editorDiv.addEventListener("focus",W(this,dt)),this.editorDiv.addEventListener("blur",W(this,ht)),this.editorDiv.addEventListener("input",W(this,st)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",W(this,ut)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",W(this,yt)),this.editorDiv.removeEventListener("focus",W(this,dt)),this.editorDiv.removeEventListener("blur",W(this,ht)),this.editorDiv.removeEventListener("input",W(this,st)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Mt){this._focusEventsAllowed&&(super.focusin(Mt),Mt.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Mt;if(this.width){Dt(this,Lt,Xi).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Mt=this._initialOptions)!=null&&Mt.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Mt=W(this,vt),Kt=Wt(this,vt,Dt(this,K,Es).call(this).trimEnd());if(Mt===Kt)return;const ee=de=>{if(Wt(this,vt,de),!de){this.remove();return}Dt(this,Y,Gi).call(this),this._uiManager.rebuild(this),Dt(this,St,li).call(this)};this.addCommands({cmd:()=>{ee(Kt)},undo:()=>{ee(Mt)},mustExec:!1}),Dt(this,St,li).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Mt){this.enterInEditMode()}keydown(Mt){Mt.target===this.div&&Mt.key==="Enter"&&(this.enterInEditMode(),Mt.preventDefault())}editorDivKeydown(Mt){It._keyboardManager.exec(this,Mt)}editorDivFocus(Mt){this.isEditing=!0}editorDivBlur(Mt){this.isEditing=!1}editorDivInput(Mt){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Mt,Kt;this.width&&(Mt=this.x,Kt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",W(this,ut)),this.enableEditing(),tt.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(de=>{var ge;return(ge=this.editorDiv)==null?void 0:ge.setAttribute("aria-label",de)}),tt.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(de=>{var ge;return(ge=this.editorDiv)==null?void 0:ge.setAttribute("default-content",de)}),this.editorDiv.contentEditable=!0;const{style:ee}=this.editorDiv;if(ee.fontSize=`calc(${W(this,ft)}px * var(--scale-factor))`,ee.color=W(this,Tt),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,U.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[de,ge]=this.parentDimensions;if(this.annotationElementId){const{position:gt}=W(this,nt);let[z,X]=this.getInitialTranslation();[z,X]=this.pageTranslationToScreen(z,X);const[G,J]=this.pageDimensions,[it,lt]=this.pageTranslation;let Et,xt;switch(this.rotation){case 0:Et=Mt+(gt[0]-it)/G,xt=Kt+this.height-(gt[1]-lt)/J;break;case 90:Et=Mt+(gt[0]-it)/G,xt=Kt-(gt[1]-lt)/J,[z,X]=[X,-z];break;case 180:Et=Mt-this.width+(gt[0]-it)/G,xt=Kt-(gt[1]-lt)/J,[z,X]=[-z,-X];break;case 270:Et=Mt+(gt[0]-it-this.height*J)/G,xt=Kt+(gt[1]-lt-this.width*G)/J,[z,X]=[-X,z];break}this.setAt(Et*de,xt*ge,z,X)}else this.setAt(Mt*de,Kt*ge,this.width*de,this.height*ge);Dt(this,Y,Gi).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Mt,Kt,ee){let de=null;if(Mt instanceof Q.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:gt,fontColor:z},rect:X,rotation:G,id:J},textContent:it,textPosition:lt,parent:{page:{pageNumber:Et}}}=Mt;if(!it||it.length===0)return null;de=Mt={annotationType:D.AnnotationEditorType.FREETEXT,color:Array.from(z),fontSize:gt,value:it.join(`
`),position:lt,pageIndex:Et-1,rect:X,rotation:G,id:J,deleted:!1}}const ge=super.deserialize(Mt,Kt,ee);return Wt(ge,ft,Mt.fontSize),Wt(ge,Tt,D.Util.makeHexColor(...Mt.color)),Wt(ge,vt,Mt.value),ge.annotationElementId=Mt.id||null,Wt(ge,nt,de),ge}serialize(Mt=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Kt=It._internalPadding*this.parentScale,ee=this.getRect(Kt,Kt),de=tt.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:W(this,Tt)),ge={annotationType:D.AnnotationEditorType.FREETEXT,color:de,fontSize:W(this,ft),value:W(this,vt),pageIndex:this.pageIndex,rect:ee,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Mt?ge:this.annotationElementId&&!Dt(this,ot,ws).call(this,ge)?null:(ge.id=this.annotationElementId,ge)}};ht=new WeakMap,dt=new WeakMap,st=new WeakMap,yt=new WeakMap,Tt=new WeakMap,vt=new WeakMap,ut=new WeakMap,ft=new WeakMap,nt=new WeakMap,ct=new WeakSet,vs=function(Mt){const Kt=de=>{this.editorDiv.style.fontSize=`calc(${de}px * var(--scale-factor))`,this.translate(0,-(de-W(this,ft))*this.parentScale),Wt(this,ft,de),Dt(this,St,li).call(this)},ee=W(this,ft);this.addCommands({cmd:()=>{Kt(Mt)},undo:()=>{Kt(ee)},mustExec:!0,type:D.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},_t=new WeakSet,Ss=function(Mt){const Kt=W(this,Tt);this.addCommands({cmd:()=>{Wt(this,Tt,this.editorDiv.style.color=Mt)},undo:()=>{Wt(this,Tt,this.editorDiv.style.color=Kt)},mustExec:!0,type:D.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},K=new WeakSet,Es=function(){const Mt=this.editorDiv.getElementsByTagName("div");if(Mt.length===0)return this.editorDiv.innerText;const Kt=[];for(const ee of Mt)Kt.push(ee.innerText.replace(/\r\n?|\n/,""));return Kt.join(`
`)},St=new WeakSet,li=function(){const[Mt,Kt]=this.parentDimensions;let ee;if(this.isAttachedToDOM)ee=this.div.getBoundingClientRect();else{const{currentLayer:de,div:ge}=this,gt=ge.style.display;ge.style.display="hidden",de.div.append(this.div),ee=ge.getBoundingClientRect(),ge.remove(),ge.style.display=gt}this.rotation%180===this.parentRotation%180?(this.width=ee.width/Mt,this.height=ee.height/Kt):(this.width=ee.height/Mt,this.height=ee.width/Kt),this.fixAndSetPosition()},Y=new WeakSet,Gi=function(){if(this.editorDiv.replaceChildren(),!!W(this,vt))for(const Mt of W(this,vt).split(`
`)){const Kt=document.createElement("div");Kt.append(Mt?document.createTextNode(Mt):document.createElement("br")),this.editorDiv.append(Kt)}},ot=new WeakSet,ws=function(Mt){const{value:Kt,fontSize:ee,color:de,rect:ge,pageIndex:gt}=W(this,nt);return Mt.value!==Kt||Mt.fontSize!==ee||Mt.rect.some((z,X)=>Math.abs(z-ge[X])>=1)||Mt.color.some((z,X)=>z!==de[X])||Mt.pageIndex!==gt},Lt=new WeakSet,Xi=function(Mt=!1){if(!this.annotationElementId)return;if(Dt(this,St,li).call(this),!Mt&&(this.width===0||this.height===0)){setTimeout(()=>Dt(this,Lt,Xi).call(this,!0),0);return}const Kt=It._internalPadding*this.parentScale;W(this,nt).rect=this.getRect(Kt,Kt)},He(It,"_freeTextDefaultContent",""),He(It,"_internalPadding",0),He(It,"_defaultColor",null),He(It,"_defaultFontSize",10),He(It,"_type","freetext");let Ft=It;F.FreeTextEditor=Ft},(B,F,O)=>{var X,J,Ke,lt,Cs,xt,qt,Ht,Gt,Jt,oe,Zt,be,Ce,ce,Ae,te,Ut,jt,Qt,he,ue,Pe,Ts,xe,yi,De,Yi,Le,Ki,Bt,Ot,se,ae,je,Ue,$t,Ji,Se,pe,Ee,we,Ps,ne,Qi;Object.defineProperty(F,"__esModule",{value:!0}),F.StampAnnotationElement=F.InkAnnotationElement=F.FreeTextAnnotationElement=F.AnnotationLayer=void 0;var D=O(1),U=O(6),tt=O(3),Q=O(30),Ft=O(31),ht=O(32);const dt=1e3,st=9,yt=new WeakSet;function Tt(ve){return{width:ve[2]-ve[0],height:ve[3]-ve[1]}}class vt{static create(wt){switch(wt.data.annotationType){case D.AnnotationType.LINK:return new ft(wt);case D.AnnotationType.TEXT:return new nt(wt);case D.AnnotationType.WIDGET:switch(wt.data.fieldType){case"Tx":return new bt(wt);case"Btn":return wt.data.radioButton?new K(wt):wt.data.checkBox?new pt(wt):new et(wt);case"Ch":return new St(wt);case"Sig":return new _t(wt)}return new ct(wt);case D.AnnotationType.POPUP:return new at(wt);case D.AnnotationType.FREETEXT:return new At(wt);case D.AnnotationType.LINE:return new ot(wt);case D.AnnotationType.SQUARE:return new kt(wt);case D.AnnotationType.CIRCLE:return new Lt(wt);case D.AnnotationType.POLYLINE:return new mt(wt);case D.AnnotationType.CARET:return new Vt(wt);case D.AnnotationType.INK:return new Xt(wt);case D.AnnotationType.POLYGON:return new It(wt);case D.AnnotationType.HIGHLIGHT:return new Mt(wt);case D.AnnotationType.UNDERLINE:return new Kt(wt);case D.AnnotationType.SQUIGGLY:return new ee(wt);case D.AnnotationType.STRIKEOUT:return new de(wt);case D.AnnotationType.STAMP:return new ge(wt);case D.AnnotationType.FILEATTACHMENT:return new gt(wt);default:return new ut(wt)}}}const G=class G{constructor(wt,{isRenderable:q=!1,ignoreBorder:rt=!1,createQuadrilaterals:Ct=!1}={}){Pt(this,X,!1);this.isRenderable=q,this.data=wt.data,this.layer=wt.layer,this.linkService=wt.linkService,this.downloadManager=wt.downloadManager,this.imageResourcesPath=wt.imageResourcesPath,this.renderForms=wt.renderForms,this.svgFactory=wt.svgFactory,this.annotationStorage=wt.annotationStorage,this.enableScripting=wt.enableScripting,this.hasJSActions=wt.hasJSActions,this._fieldObjects=wt.fieldObjects,this.parent=wt.parent,q&&(this.container=this._createContainer(rt)),Ct&&this._createQuadrilaterals()}static _hasPopupData({titleObj:wt,contentsObj:q,richText:rt}){return!!(wt!=null&&wt.str||q!=null&&q.str||rt!=null&&rt.str)}get hasPopupData(){return G._hasPopupData(this.data)}_createContainer(wt){const{data:q,parent:{page:rt,viewport:Ct}}=this,Rt=document.createElement("section");Rt.setAttribute("data-annotation-id",q.id),this instanceof ct||(Rt.tabIndex=dt),Rt.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Rt.setAttribute("aria-haspopup","dialog"),q.noRotate&&Rt.classList.add("norotate");const{pageWidth:Nt,pageHeight:zt,pageX:ie,pageY:me}=Ct.rawDims;if(!q.rect||this instanceof at){const{rotation:Te}=q;return!q.hasOwnCanvas&&Te!==0&&this.setRotation(Te,Rt),Rt}const{width:fe,height:Me}=Tt(q.rect),_e=D.Util.normalizeRect([q.rect[0],rt.view[3]-q.rect[1]+rt.view[1],q.rect[2],rt.view[3]-q.rect[3]+rt.view[1]]);if(!wt&&q.borderStyle.width>0){Rt.style.borderWidth=`${q.borderStyle.width}px`;const Te=q.borderStyle.horizontalCornerRadius,Oe=q.borderStyle.verticalCornerRadius;if(Te>0||Oe>0){const Be=`calc(${Te}px * var(--scale-factor)) / calc(${Oe}px * var(--scale-factor))`;Rt.style.borderRadius=Be}else if(this instanceof K){const Be=`calc(${fe}px * var(--scale-factor)) / calc(${Me}px * var(--scale-factor))`;Rt.style.borderRadius=Be}switch(q.borderStyle.style){case D.AnnotationBorderStyleType.SOLID:Rt.style.borderStyle="solid";break;case D.AnnotationBorderStyleType.DASHED:Rt.style.borderStyle="dashed";break;case D.AnnotationBorderStyleType.BEVELED:(0,D.warn)("Unimplemented border style: beveled");break;case D.AnnotationBorderStyleType.INSET:(0,D.warn)("Unimplemented border style: inset");break;case D.AnnotationBorderStyleType.UNDERLINE:Rt.style.borderBottomStyle="solid";break}const Ne=q.borderColor||null;Ne?(Wt(this,X,!0),Rt.style.borderColor=D.Util.makeHexColor(Ne[0]|0,Ne[1]|0,Ne[2]|0)):Rt.style.borderWidth=0}Rt.style.left=`${100*(_e[0]-ie)/Nt}%`,Rt.style.top=`${100*(_e[1]-me)/zt}%`;const{rotation:ye}=q;return q.hasOwnCanvas||ye===0?(Rt.style.width=`${100*fe/Nt}%`,Rt.style.height=`${100*Me/zt}%`):this.setRotation(ye,Rt),Rt}setRotation(wt,q=this.container){if(!this.data.rect)return;const{pageWidth:rt,pageHeight:Ct}=this.parent.viewport.rawDims,{width:Rt,height:Nt}=Tt(this.data.rect);let zt,ie;wt%180===0?(zt=100*Rt/rt,ie=100*Nt/Ct):(zt=100*Nt/rt,ie=100*Rt/Ct),q.style.width=`${zt}%`,q.style.height=`${ie}%`,q.setAttribute("data-main-rotation",(360-wt)%360)}get _commonActions(){const wt=(q,rt,Ct)=>{const Rt=Ct.detail[q],Nt=Rt[0],zt=Rt.slice(1);Ct.target.style[rt]=Q.ColorConverters[`${Nt}_HTML`](zt),this.annotationStorage.setValue(this.data.id,{[rt]:Q.ColorConverters[`${Nt}_rgb`](zt)})};return(0,D.shadow)(this,"_commonActions",{display:q=>{const{display:rt}=q.detail,Ct=rt%2===1;this.container.style.visibility=Ct?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Ct,noPrint:rt===1||rt===2})},print:q=>{this.annotationStorage.setValue(this.data.id,{noPrint:!q.detail.print})},hidden:q=>{const{hidden:rt}=q.detail;this.container.style.visibility=rt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:rt,noView:rt})},focus:q=>{setTimeout(()=>q.target.focus({preventScroll:!1}),0)},userName:q=>{q.target.title=q.detail.userName},readonly:q=>{q.target.disabled=q.detail.readonly},required:q=>{this._setRequired(q.target,q.detail.required)},bgColor:q=>{wt("bgColor","backgroundColor",q)},fillColor:q=>{wt("fillColor","backgroundColor",q)},fgColor:q=>{wt("fgColor","color",q)},textColor:q=>{wt("textColor","color",q)},borderColor:q=>{wt("borderColor","borderColor",q)},strokeColor:q=>{wt("strokeColor","borderColor",q)},rotation:q=>{const rt=q.detail.rotation;this.setRotation(rt),this.annotationStorage.setValue(this.data.id,{rotation:rt})}})}_dispatchEventFromSandbox(wt,q){const rt=this._commonActions;for(const Ct of Object.keys(q.detail)){const Rt=wt[Ct]||rt[Ct];Rt==null||Rt(q)}}_setDefaultPropertiesFromJS(wt){if(!this.enableScripting)return;const q=this.annotationStorage.getRawValue(this.data.id);if(!q)return;const rt=this._commonActions;for(const[Ct,Rt]of Object.entries(q)){const Nt=rt[Ct];if(Nt){const zt={detail:{[Ct]:Rt},target:wt};Nt(zt),delete q[Ct]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:wt}=this.data;if(!wt)return;const[q,rt,Ct,Rt]=this.data.rect;if(wt.length===1){const[,{x:Oe,y:Ne},{x:Be,y:qe}]=wt[0];if(Ct===Oe&&Rt===Ne&&q===Be&&rt===qe)return}const{style:Nt}=this.container;let zt;if(W(this,X)){const{borderColor:Oe,borderWidth:Ne}=Nt;Nt.borderWidth=0,zt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Oe}" stroke-width="${Ne}">`],this.container.classList.add("hasBorder")}const ie=Ct-q,me=Rt-rt,{svgFactory:fe}=this,Me=fe.createElement("svg");Me.classList.add("quadrilateralsContainer"),Me.setAttribute("width",0),Me.setAttribute("height",0);const _e=fe.createElement("defs");Me.append(_e);const ye=fe.createElement("clipPath"),Te=`clippath_${this.data.id}`;ye.setAttribute("id",Te),ye.setAttribute("clipPathUnits","objectBoundingBox"),_e.append(ye);for(const[,{x:Oe,y:Ne},{x:Be,y:qe}]of wt){const We=fe.createElement("rect"),ze=(Be-q)/ie,Xe=(Rt-Ne)/me,Ye=(Oe-Be)/ie,os=(Ne-qe)/me;We.setAttribute("x",ze),We.setAttribute("y",Xe),We.setAttribute("width",Ye),We.setAttribute("height",os),ye.append(We),zt==null||zt.push(`<rect vector-effect="non-scaling-stroke" x="${ze}" y="${Xe}" width="${Ye}" height="${os}"/>`)}W(this,X)&&(zt.push("</g></svg>')"),Nt.backgroundImage=zt.join("")),this.container.append(Me),this.container.style.clipPath=`url(#${Te})`}_createPopup(){const{container:wt,data:q}=this;wt.setAttribute("aria-haspopup","dialog");const rt=new at({data:{color:q.color,titleObj:q.titleObj,modificationDate:q.modificationDate,contentsObj:q.contentsObj,richText:q.richText,parentRect:q.rect,borderStyle:0,id:`popup_${q.id}`,rotation:q.rotation},parent:this.parent,elements:[this]});this.parent.div.append(rt.render())}render(){(0,D.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(wt,q=null){const rt=[];if(this._fieldObjects){const Ct=this._fieldObjects[wt];if(Ct)for(const{page:Rt,id:Nt,exportValues:zt}of Ct){if(Rt===-1||Nt===q)continue;const ie=typeof zt=="string"?zt:null,me=document.querySelector(`[data-element-id="${Nt}"]`);if(me&&!yt.has(me)){(0,D.warn)(`_getElementsByName - element not allowed: ${Nt}`);continue}rt.push({id:Nt,exportValue:ie,domElement:me})}return rt}for(const Ct of document.getElementsByName(wt)){const{exportValue:Rt}=Ct,Nt=Ct.getAttribute("data-element-id");Nt!==q&&yt.has(Ct)&&rt.push({id:Nt,exportValue:Rt,domElement:Ct})}return rt}show(){var wt;this.container&&(this.container.hidden=!1),(wt=this.popup)==null||wt.maybeShow()}hide(){var wt;this.container&&(this.container.hidden=!0),(wt=this.popup)==null||wt.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const wt=this.getElementsToTriggerPopup();if(Array.isArray(wt))for(const q of wt)q.classList.add("highlightArea");else wt.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:wt,data:{id:q}}=this;this.container.addEventListener("dblclick",()=>{var rt;(rt=this.linkService.eventBus)==null||rt.dispatch("switchannotationeditormode",{source:this,mode:wt,editId:q})})}};X=new WeakMap;let ut=G;class ft extends ut{constructor(q,rt=null){super(q,{isRenderable:!0,ignoreBorder:!!(rt!=null&&rt.ignoreBorder),createQuadrilaterals:!0});Pt(this,J);Pt(this,lt);this.isTooltipOnly=q.data.isTooltipOnly}render(){const{data:q,linkService:rt}=this,Ct=document.createElement("a");Ct.setAttribute("data-element-id",q.id);let Rt=!1;return q.url?(rt.addLinkAttributes(Ct,q.url,q.newWindow),Rt=!0):q.action?(this._bindNamedAction(Ct,q.action),Rt=!0):q.attachment?(this._bindAttachment(Ct,q.attachment),Rt=!0):q.setOCGState?(Dt(this,lt,Cs).call(this,Ct,q.setOCGState),Rt=!0):q.dest?(this._bindLink(Ct,q.dest),Rt=!0):(q.actions&&(q.actions.Action||q.actions["Mouse Up"]||q.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Ct,q),Rt=!0),q.resetForm?(this._bindResetFormAction(Ct,q.resetForm),Rt=!0):this.isTooltipOnly&&!Rt&&(this._bindLink(Ct,""),Rt=!0)),this.container.classList.add("linkAnnotation"),Rt&&this.container.append(Ct),this.container}_bindLink(q,rt){q.href=this.linkService.getDestinationHash(rt),q.onclick=()=>(rt&&this.linkService.goToDestination(rt),!1),(rt||rt==="")&&Dt(this,J,Ke).call(this)}_bindNamedAction(q,rt){q.href=this.linkService.getAnchorUrl(""),q.onclick=()=>(this.linkService.executeNamedAction(rt),!1),Dt(this,J,Ke).call(this)}_bindAttachment(q,rt){q.href=this.linkService.getAnchorUrl(""),q.onclick=()=>{var Ct;return(Ct=this.downloadManager)==null||Ct.openOrDownloadData(this.container,rt.content,rt.filename),!1},Dt(this,J,Ke).call(this)}_bindJSAction(q,rt){q.href=this.linkService.getAnchorUrl("");const Ct=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Rt of Object.keys(rt.actions)){const Nt=Ct.get(Rt);Nt&&(q[Nt]=()=>{var zt;return(zt=this.linkService.eventBus)==null||zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:rt.id,name:Rt}}),!1})}q.onclick||(q.onclick=()=>!1),Dt(this,J,Ke).call(this)}_bindResetFormAction(q,rt){const Ct=q.onclick;if(Ct||(q.href=this.linkService.getAnchorUrl("")),Dt(this,J,Ke).call(this),!this._fieldObjects){(0,D.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Ct||(q.onclick=()=>!1);return}q.onclick=()=>{var Me;Ct==null||Ct();const{fields:Rt,refs:Nt,include:zt}=rt,ie=[];if(Rt.length!==0||Nt.length!==0){const _e=new Set(Nt);for(const ye of Rt){const Te=this._fieldObjects[ye]||[];for(const{id:Oe}of Te)_e.add(Oe)}for(const ye of Object.values(this._fieldObjects))for(const Te of ye)_e.has(Te.id)===zt&&ie.push(Te)}else for(const _e of Object.values(this._fieldObjects))ie.push(..._e);const me=this.annotationStorage,fe=[];for(const _e of ie){const{id:ye}=_e;switch(fe.push(ye),_e.type){case"text":{const Oe=_e.defaultValue||"";me.setValue(ye,{value:Oe});break}case"checkbox":case"radiobutton":{const Oe=_e.defaultValue===_e.exportValues;me.setValue(ye,{value:Oe});break}case"combobox":case"listbox":{const Oe=_e.defaultValue||"";me.setValue(ye,{value:Oe});break}default:continue}const Te=document.querySelector(`[data-element-id="${ye}"]`);if(Te){if(!yt.has(Te)){(0,D.warn)(`_bindResetFormAction - element not allowed: ${ye}`);continue}}else continue;Te.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Me=this.linkService.eventBus)==null||Me.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:fe,name:"ResetForm"}})),!1}}}J=new WeakSet,Ke=function(){this.container.setAttribute("data-internal-link","")},lt=new WeakSet,Cs=function(q,rt){q.href=this.linkService.getAnchorUrl(""),q.onclick=()=>(this.linkService.executeSetOCGState(rt),!1),Dt(this,J,Ke).call(this)};class nt extends ut{constructor(wt){super(wt,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const wt=document.createElement("img");return wt.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",wt.alt="[{{type}} Annotation]",wt.dataset.l10nId="text_annotation_type",wt.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(wt),this.container}}class ct extends ut{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(wt){var q;this.data.hasOwnCanvas&&(((q=wt.previousSibling)==null?void 0:q.nodeName)==="CANVAS"&&(wt.previousSibling.hidden=!0),wt.hidden=!1)}_getKeyModifier(wt){const{isWin:q,isMac:rt}=D.FeatureTest.platform;return q&&wt.ctrlKey||rt&&wt.metaKey}_setEventListener(wt,q,rt,Ct,Rt){rt.includes("mouse")?wt.addEventListener(rt,Nt=>{var zt;(zt=this.linkService.eventBus)==null||zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ct,value:Rt(Nt),shift:Nt.shiftKey,modifier:this._getKeyModifier(Nt)}})}):wt.addEventListener(rt,Nt=>{var zt;if(rt==="blur"){if(!q.focused||!Nt.relatedTarget)return;q.focused=!1}else if(rt==="focus"){if(q.focused)return;q.focused=!0}Rt&&((zt=this.linkService.eventBus)==null||zt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Ct,value:Rt(Nt)}}))})}_setEventListeners(wt,q,rt,Ct){var Rt,Nt,zt;for(const[ie,me]of rt)(me==="Action"||(Rt=this.data.actions)!=null&&Rt[me])&&((me==="Focus"||me==="Blur")&&(q||(q={focused:!1})),this._setEventListener(wt,q,ie,me,Ct),me==="Focus"&&!((Nt=this.data.actions)!=null&&Nt.Blur)?this._setEventListener(wt,q,"blur","Blur",null):me==="Blur"&&!((zt=this.data.actions)!=null&&zt.Focus)&&this._setEventListener(wt,q,"focus","Focus",null))}_setBackgroundColor(wt){const q=this.data.backgroundColor||null;wt.style.backgroundColor=q===null?"transparent":D.Util.makeHexColor(q[0],q[1],q[2])}_setTextStyle(wt){const q=["left","center","right"],{fontColor:rt}=this.data.defaultAppearanceData,Ct=this.data.defaultAppearanceData.fontSize||st,Rt=wt.style;let Nt;const zt=2,ie=me=>Math.round(10*me)/10;if(this.data.multiLine){const me=Math.abs(this.data.rect[3]-this.data.rect[1]-zt),fe=Math.round(me/(D.LINE_FACTOR*Ct))||1,Me=me/fe;Nt=Math.min(Ct,ie(Me/D.LINE_FACTOR))}else{const me=Math.abs(this.data.rect[3]-this.data.rect[1]-zt);Nt=Math.min(Ct,ie(me/D.LINE_FACTOR))}Rt.fontSize=`calc(${Nt}px * var(--scale-factor))`,Rt.color=D.Util.makeHexColor(rt[0],rt[1],rt[2]),this.data.textAlignment!==null&&(Rt.textAlign=q[this.data.textAlignment])}_setRequired(wt,q){q?wt.setAttribute("required",!0):wt.removeAttribute("required"),wt.setAttribute("aria-required",q)}}class bt extends ct{constructor(wt){const q=wt.renderForms||!wt.data.hasAppearance&&!!wt.data.fieldValue;super(wt,{isRenderable:q})}setPropertyOnSiblings(wt,q,rt,Ct){const Rt=this.annotationStorage;for(const Nt of this._getElementsByName(wt.name,wt.id))Nt.domElement&&(Nt.domElement[q]=rt),Rt.setValue(Nt.id,{[Ct]:rt})}render(){var Ct,Rt;const wt=this.annotationStorage,q=this.data.id;this.container.classList.add("textWidgetAnnotation");let rt=null;if(this.renderForms){const Nt=wt.getValue(q,{value:this.data.fieldValue});let zt=Nt.value||"";const ie=wt.getValue(q,{charLimit:this.data.maxLen}).charLimit;ie&&zt.length>ie&&(zt=zt.slice(0,ie));let me=Nt.formattedValue||((Ct=this.data.textContent)==null?void 0:Ct.join(`
`))||null;me&&this.data.comb&&(me=me.replaceAll(/\s+/g,""));const fe={userValue:zt,formattedValue:me,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(rt=document.createElement("textarea"),rt.textContent=me??zt,this.data.doNotScroll&&(rt.style.overflowY="hidden")):(rt=document.createElement("input"),rt.type="text",rt.setAttribute("value",me??zt),this.data.doNotScroll&&(rt.style.overflowX="hidden")),this.data.hasOwnCanvas&&(rt.hidden=!0),yt.add(rt),rt.setAttribute("data-element-id",q),rt.disabled=this.data.readOnly,rt.name=this.data.fieldName,rt.tabIndex=dt,this._setRequired(rt,this.data.required),ie&&(rt.maxLength=ie),rt.addEventListener("input",_e=>{wt.setValue(q,{value:_e.target.value}),this.setPropertyOnSiblings(rt,"value",_e.target.value,"value"),fe.formattedValue=null}),rt.addEventListener("resetform",_e=>{const ye=this.data.defaultFieldValue??"";rt.value=fe.userValue=ye,fe.formattedValue=null});let Me=_e=>{const{formattedValue:ye}=fe;ye!=null&&(_e.target.value=ye),_e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){rt.addEventListener("focus",ye=>{if(fe.focused)return;const{target:Te}=ye;fe.userValue&&(Te.value=fe.userValue),fe.lastCommittedValue=Te.value,fe.commitKey=1,fe.focused=!0}),rt.addEventListener("updatefromsandbox",ye=>{this.showElementAndHideCanvas(ye.target);const Te={value(Oe){fe.userValue=Oe.detail.value??"",wt.setValue(q,{value:fe.userValue.toString()}),Oe.target.value=fe.userValue},formattedValue(Oe){const{formattedValue:Ne}=Oe.detail;fe.formattedValue=Ne,Ne!=null&&Oe.target!==document.activeElement&&(Oe.target.value=Ne),wt.setValue(q,{formattedValue:Ne})},selRange(Oe){Oe.target.setSelectionRange(...Oe.detail.selRange)},charLimit:Oe=>{var We;const{charLimit:Ne}=Oe.detail,{target:Be}=Oe;if(Ne===0){Be.removeAttribute("maxLength");return}Be.setAttribute("maxLength",Ne);let qe=fe.userValue;!qe||qe.length<=Ne||(qe=qe.slice(0,Ne),Be.value=fe.userValue=qe,wt.setValue(q,{value:qe}),(We=this.linkService.eventBus)==null||We.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:qe,willCommit:!0,commitKey:1,selStart:Be.selectionStart,selEnd:Be.selectionEnd}}))}};this._dispatchEventFromSandbox(Te,ye)}),rt.addEventListener("keydown",ye=>{var Ne;fe.commitKey=1;let Te=-1;if(ye.key==="Escape"?Te=0:ye.key==="Enter"&&!this.data.multiLine?Te=2:ye.key==="Tab"&&(fe.commitKey=3),Te===-1)return;const{value:Oe}=ye.target;fe.lastCommittedValue!==Oe&&(fe.lastCommittedValue=Oe,fe.userValue=Oe,(Ne=this.linkService.eventBus)==null||Ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:Oe,willCommit:!0,commitKey:Te,selStart:ye.target.selectionStart,selEnd:ye.target.selectionEnd}}))});const _e=Me;Me=null,rt.addEventListener("blur",ye=>{var Oe;if(!fe.focused||!ye.relatedTarget)return;fe.focused=!1;const{value:Te}=ye.target;fe.userValue=Te,fe.lastCommittedValue!==Te&&((Oe=this.linkService.eventBus)==null||Oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:Te,willCommit:!0,commitKey:fe.commitKey,selStart:ye.target.selectionStart,selEnd:ye.target.selectionEnd}})),_e(ye)}),(Rt=this.data.actions)!=null&&Rt.Keystroke&&rt.addEventListener("beforeinput",ye=>{var Xe;fe.lastCommittedValue=null;const{data:Te,target:Oe}=ye,{value:Ne,selectionStart:Be,selectionEnd:qe}=Oe;let We=Be,ze=qe;switch(ye.inputType){case"deleteWordBackward":{const Ye=Ne.substring(0,Be).match(/\w*[^\w]*$/);Ye&&(We-=Ye[0].length);break}case"deleteWordForward":{const Ye=Ne.substring(Be).match(/^[^\w]*\w*/);Ye&&(ze+=Ye[0].length);break}case"deleteContentBackward":Be===qe&&(We-=1);break;case"deleteContentForward":Be===qe&&(ze+=1);break}ye.preventDefault(),(Xe=this.linkService.eventBus)==null||Xe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:Ne,change:Te||"",willCommit:!1,selStart:We,selEnd:ze}})}),this._setEventListeners(rt,fe,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ye=>ye.target.value)}if(Me&&rt.addEventListener("blur",Me),this.data.comb){const ye=(this.data.rect[2]-this.data.rect[0])/ie;rt.classList.add("comb"),rt.style.letterSpacing=`calc(${ye}px * var(--scale-factor) - 1ch)`}}else rt=document.createElement("div"),rt.textContent=this.data.fieldValue,rt.style.verticalAlign="middle",rt.style.display="table-cell";return this._setTextStyle(rt),this._setBackgroundColor(rt),this._setDefaultPropertiesFromJS(rt),this.container.append(rt),this.container}}class _t extends ct{constructor(wt){super(wt,{isRenderable:!!wt.data.hasOwnCanvas})}}class pt extends ct{constructor(wt){super(wt,{isRenderable:wt.renderForms})}render(){const wt=this.annotationStorage,q=this.data,rt=q.id;let Ct=wt.getValue(rt,{value:q.exportValue===q.fieldValue}).value;typeof Ct=="string"&&(Ct=Ct!=="Off",wt.setValue(rt,{value:Ct})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Rt=document.createElement("input");return yt.add(Rt),Rt.setAttribute("data-element-id",rt),Rt.disabled=q.readOnly,this._setRequired(Rt,this.data.required),Rt.type="checkbox",Rt.name=q.fieldName,Ct&&Rt.setAttribute("checked",!0),Rt.setAttribute("exportValue",q.exportValue),Rt.tabIndex=dt,Rt.addEventListener("change",Nt=>{const{name:zt,checked:ie}=Nt.target;for(const me of this._getElementsByName(zt,rt)){const fe=ie&&me.exportValue===q.exportValue;me.domElement&&(me.domElement.checked=fe),wt.setValue(me.id,{value:fe})}wt.setValue(rt,{value:ie})}),Rt.addEventListener("resetform",Nt=>{const zt=q.defaultFieldValue||"Off";Nt.target.checked=zt===q.exportValue}),this.enableScripting&&this.hasJSActions&&(Rt.addEventListener("updatefromsandbox",Nt=>{const zt={value(ie){ie.target.checked=ie.detail.value!=="Off",wt.setValue(rt,{value:ie.target.checked})}};this._dispatchEventFromSandbox(zt,Nt)}),this._setEventListeners(Rt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Nt=>Nt.target.checked)),this._setBackgroundColor(Rt),this._setDefaultPropertiesFromJS(Rt),this.container.append(Rt),this.container}}class K extends ct{constructor(wt){super(wt,{isRenderable:wt.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const wt=this.annotationStorage,q=this.data,rt=q.id;let Ct=wt.getValue(rt,{value:q.fieldValue===q.buttonValue}).value;typeof Ct=="string"&&(Ct=Ct!==q.buttonValue,wt.setValue(rt,{value:Ct}));const Rt=document.createElement("input");if(yt.add(Rt),Rt.setAttribute("data-element-id",rt),Rt.disabled=q.readOnly,this._setRequired(Rt,this.data.required),Rt.type="radio",Rt.name=q.fieldName,Ct&&Rt.setAttribute("checked",!0),Rt.tabIndex=dt,Rt.addEventListener("change",Nt=>{const{name:zt,checked:ie}=Nt.target;for(const me of this._getElementsByName(zt,rt))wt.setValue(me.id,{value:!1});wt.setValue(rt,{value:ie})}),Rt.addEventListener("resetform",Nt=>{const zt=q.defaultFieldValue;Nt.target.checked=zt!=null&&zt===q.buttonValue}),this.enableScripting&&this.hasJSActions){const Nt=q.buttonValue;Rt.addEventListener("updatefromsandbox",zt=>{const ie={value:me=>{const fe=Nt===me.detail.value;for(const Me of this._getElementsByName(me.target.name)){const _e=fe&&Me.id===rt;Me.domElement&&(Me.domElement.checked=_e),wt.setValue(Me.id,{value:_e})}}};this._dispatchEventFromSandbox(ie,zt)}),this._setEventListeners(Rt,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],zt=>zt.target.checked)}return this._setBackgroundColor(Rt),this._setDefaultPropertiesFromJS(Rt),this.container.append(Rt),this.container}}class et extends ft{constructor(wt){super(wt,{ignoreBorder:wt.data.hasAppearance})}render(){const wt=super.render();wt.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(wt.title=this.data.alternativeText);const q=wt.lastChild;return this.enableScripting&&this.hasJSActions&&q&&(this._setDefaultPropertiesFromJS(q),q.addEventListener("updatefromsandbox",rt=>{this._dispatchEventFromSandbox({},rt)})),wt}}class St extends ct{constructor(wt){super(wt,{isRenderable:wt.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const wt=this.annotationStorage,q=this.data.id,rt=wt.getValue(q,{value:this.data.fieldValue}),Ct=document.createElement("select");yt.add(Ct),Ct.setAttribute("data-element-id",q),Ct.disabled=this.data.readOnly,this._setRequired(Ct,this.data.required),Ct.name=this.data.fieldName,Ct.tabIndex=dt;let Rt=this.data.combo&&this.data.options.length>0;this.data.combo||(Ct.size=this.data.options.length,this.data.multiSelect&&(Ct.multiple=!0)),Ct.addEventListener("resetform",fe=>{const Me=this.data.defaultFieldValue;for(const _e of Ct.options)_e.selected=_e.value===Me});for(const fe of this.data.options){const Me=document.createElement("option");Me.textContent=fe.displayValue,Me.value=fe.exportValue,rt.value.includes(fe.exportValue)&&(Me.setAttribute("selected",!0),Rt=!1),Ct.append(Me)}let Nt=null;if(Rt){const fe=document.createElement("option");fe.value=" ",fe.setAttribute("hidden",!0),fe.setAttribute("selected",!0),Ct.prepend(fe),Nt=()=>{fe.remove(),Ct.removeEventListener("input",Nt),Nt=null},Ct.addEventListener("input",Nt)}const zt=fe=>{const Me=fe?"value":"textContent",{options:_e,multiple:ye}=Ct;return ye?Array.prototype.filter.call(_e,Te=>Te.selected).map(Te=>Te[Me]):_e.selectedIndex===-1?null:_e[_e.selectedIndex][Me]};let ie=zt(!1);const me=fe=>{const Me=fe.target.options;return Array.prototype.map.call(Me,_e=>({displayValue:_e.textContent,exportValue:_e.value}))};return this.enableScripting&&this.hasJSActions?(Ct.addEventListener("updatefromsandbox",fe=>{const Me={value(_e){Nt==null||Nt();const ye=_e.detail.value,Te=new Set(Array.isArray(ye)?ye:[ye]);for(const Oe of Ct.options)Oe.selected=Te.has(Oe.value);wt.setValue(q,{value:zt(!0)}),ie=zt(!1)},multipleSelection(_e){Ct.multiple=!0},remove(_e){const ye=Ct.options,Te=_e.detail.remove;ye[Te].selected=!1,Ct.remove(Te),ye.length>0&&Array.prototype.findIndex.call(ye,Ne=>Ne.selected)===-1&&(ye[0].selected=!0),wt.setValue(q,{value:zt(!0),items:me(_e)}),ie=zt(!1)},clear(_e){for(;Ct.length!==0;)Ct.remove(0);wt.setValue(q,{value:null,items:[]}),ie=zt(!1)},insert(_e){const{index:ye,displayValue:Te,exportValue:Oe}=_e.detail.insert,Ne=Ct.children[ye],Be=document.createElement("option");Be.textContent=Te,Be.value=Oe,Ne?Ne.before(Be):Ct.append(Be),wt.setValue(q,{value:zt(!0),items:me(_e)}),ie=zt(!1)},items(_e){const{items:ye}=_e.detail;for(;Ct.length!==0;)Ct.remove(0);for(const Te of ye){const{displayValue:Oe,exportValue:Ne}=Te,Be=document.createElement("option");Be.textContent=Oe,Be.value=Ne,Ct.append(Be)}Ct.options.length>0&&(Ct.options[0].selected=!0),wt.setValue(q,{value:zt(!0),items:me(_e)}),ie=zt(!1)},indices(_e){const ye=new Set(_e.detail.indices);for(const Te of _e.target.options)Te.selected=ye.has(Te.index);wt.setValue(q,{value:zt(!0)}),ie=zt(!1)},editable(_e){_e.target.disabled=!_e.detail.editable}};this._dispatchEventFromSandbox(Me,fe)}),Ct.addEventListener("input",fe=>{var _e;const Me=zt(!0);wt.setValue(q,{value:Me}),fe.preventDefault(),(_e=this.linkService.eventBus)==null||_e.dispatch("dispatcheventinsandbox",{source:this,detail:{id:q,name:"Keystroke",value:ie,changeEx:Me,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Ct,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],fe=>fe.target.value)):Ct.addEventListener("input",function(fe){wt.setValue(q,{value:zt(!0)})}),this.data.combo&&this._setTextStyle(Ct),this._setBackgroundColor(Ct),this._setDefaultPropertiesFromJS(Ct),this.container.append(Ct),this.container}}class at extends ut{constructor(wt){const{data:q,elements:rt}=wt;super(wt,{isRenderable:ut._hasPopupData(q)}),this.elements=rt}render(){this.container.classList.add("popupAnnotation");const wt=new Y({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),q=[];for(const rt of this.elements)rt.popup=wt,q.push(rt.data.id),rt.addHighlightArea();return this.container.setAttribute("aria-controls",q.map(rt=>`${D.AnnotationPrefix}${rt}`).join(",")),this.container}}class Y{constructor({container:wt,color:q,elements:rt,titleObj:Ct,modificationDate:Rt,contentsObj:Nt,richText:zt,parent:ie,rect:me,parentRect:fe,open:Me}){Pt(this,Pe);Pt(this,xe);Pt(this,De);Pt(this,Le);Pt(this,xt,null);Pt(this,qt,Dt(this,Pe,Ts).bind(this));Pt(this,Ht,Dt(this,Le,Ki).bind(this));Pt(this,Gt,Dt(this,De,Yi).bind(this));Pt(this,Jt,Dt(this,xe,yi).bind(this));Pt(this,oe,null);Pt(this,Zt,null);Pt(this,be,null);Pt(this,Ce,null);Pt(this,ce,null);Pt(this,Ae,null);Pt(this,te,!1);Pt(this,Ut,null);Pt(this,jt,null);Pt(this,Qt,null);Pt(this,he,null);Pt(this,ue,!1);var ye;Wt(this,Zt,wt),Wt(this,he,Ct),Wt(this,be,Nt),Wt(this,Qt,zt),Wt(this,ce,ie),Wt(this,oe,q),Wt(this,jt,me),Wt(this,Ae,fe),Wt(this,Ce,rt);const _e=U.PDFDateString.toDateObject(Rt);_e&&Wt(this,xt,ie.l10n.get("annotation_date_string",{date:_e.toLocaleDateString(),time:_e.toLocaleTimeString()})),this.trigger=rt.flatMap(Te=>Te.getElementsToTriggerPopup());for(const Te of this.trigger)Te.addEventListener("click",W(this,Jt)),Te.addEventListener("mouseenter",W(this,Gt)),Te.addEventListener("mouseleave",W(this,Ht)),Te.classList.add("popupTriggerArea");for(const Te of rt)(ye=Te.container)==null||ye.addEventListener("keydown",W(this,qt));W(this,Zt).hidden=!0,Me&&Dt(this,xe,yi).call(this)}render(){if(W(this,Ut))return;const{page:{view:wt},viewport:{rawDims:{pageWidth:q,pageHeight:rt,pageX:Ct,pageY:Rt}}}=W(this,ce),Nt=Wt(this,Ut,document.createElement("div"));if(Nt.className="popup",W(this,oe)){const We=Nt.style.outlineColor=D.Util.makeHexColor(...W(this,oe));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Nt.style.backgroundColor=`color-mix(in srgb, ${We} 30%, white)`:Nt.style.backgroundColor=D.Util.makeHexColor(...W(this,oe).map(Xe=>Math.floor(.7*(255-Xe)+Xe)))}const zt=document.createElement("span");zt.className="header";const ie=document.createElement("h1");if(zt.append(ie),{dir:ie.dir,str:ie.textContent}=W(this,he),Nt.append(zt),W(this,xt)){const We=document.createElement("span");We.classList.add("popupDate"),W(this,xt).then(ze=>{We.textContent=ze}),zt.append(We)}const me=W(this,be),fe=W(this,Qt);if(fe!=null&&fe.str&&(!(me!=null&&me.str)||me.str===fe.str))ht.XfaLayer.render({xfaHtml:fe.html,intent:"richText",div:Nt}),Nt.lastChild.classList.add("richText","popupContent");else{const We=this._formatContents(me);Nt.append(We)}let Me=!!W(this,Ae),_e=Me?W(this,Ae):W(this,jt);for(const We of W(this,Ce))if(!_e||D.Util.intersect(We.data.rect,_e)!==null){_e=We.data.rect,Me=!0;break}const ye=D.Util.normalizeRect([_e[0],wt[3]-_e[1]+wt[1],_e[2],wt[3]-_e[3]+wt[1]]),Te=5,Oe=Me?_e[2]-_e[0]+Te:0,Ne=ye[0]+Oe,Be=ye[1],{style:qe}=W(this,Zt);qe.left=`${100*(Ne-Ct)/q}%`,qe.top=`${100*(Be-Rt)/rt}%`,W(this,Zt).append(Nt)}_formatContents({str:wt,dir:q}){const rt=document.createElement("p");rt.classList.add("popupContent"),rt.dir=q;const Ct=wt.split(/(?:\r\n?|\n)/);for(let Rt=0,Nt=Ct.length;Rt<Nt;++Rt){const zt=Ct[Rt];rt.append(document.createTextNode(zt)),Rt<Nt-1&&rt.append(document.createElement("br"))}return rt}forceHide(){Wt(this,ue,this.isVisible),W(this,ue)&&(W(this,Zt).hidden=!0)}maybeShow(){W(this,ue)&&(Wt(this,ue,!1),W(this,Zt).hidden=!1)}get isVisible(){return W(this,Zt).hidden===!1}}xt=new WeakMap,qt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,oe=new WeakMap,Zt=new WeakMap,be=new WeakMap,Ce=new WeakMap,ce=new WeakMap,Ae=new WeakMap,te=new WeakMap,Ut=new WeakMap,jt=new WeakMap,Qt=new WeakMap,he=new WeakMap,ue=new WeakMap,Pe=new WeakSet,Ts=function(wt){wt.altKey||wt.shiftKey||wt.ctrlKey||wt.metaKey||(wt.key==="Enter"||wt.key==="Escape"&&W(this,te))&&Dt(this,xe,yi).call(this)},xe=new WeakSet,yi=function(){Wt(this,te,!W(this,te)),W(this,te)?(Dt(this,De,Yi).call(this),W(this,Zt).addEventListener("click",W(this,Jt)),W(this,Zt).addEventListener("keydown",W(this,qt))):(Dt(this,Le,Ki).call(this),W(this,Zt).removeEventListener("click",W(this,Jt)),W(this,Zt).removeEventListener("keydown",W(this,qt)))},De=new WeakSet,Yi=function(){W(this,Ut)||this.render(),this.isVisible?W(this,te)&&W(this,Zt).classList.add("focused"):(W(this,Zt).hidden=!1,W(this,Zt).style.zIndex=parseInt(W(this,Zt).style.zIndex)+1e3)},Le=new WeakSet,Ki=function(){W(this,Zt).classList.remove("focused"),!(W(this,te)||!this.isVisible)&&(W(this,Zt).hidden=!0,W(this,Zt).style.zIndex=parseInt(W(this,Zt).style.zIndex)-1e3)};class At extends ut{constructor(wt){super(wt,{isRenderable:!0,ignoreBorder:!0}),this.textContent=wt.data.textContent,this.textPosition=wt.data.textPosition,this.annotationEditorType=D.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const wt=document.createElement("div");wt.classList.add("annotationTextContent"),wt.setAttribute("role","comment");for(const q of this.textContent){const rt=document.createElement("span");rt.textContent=q,wt.append(rt)}this.container.append(wt)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}F.FreeTextAnnotationElement=At;class ot extends ut{constructor(q){super(q,{isRenderable:!0,ignoreBorder:!0});Pt(this,Bt,null)}render(){this.container.classList.add("lineAnnotation");const q=this.data,{width:rt,height:Ct}=Tt(q.rect),Rt=this.svgFactory.create(rt,Ct,!0),Nt=Wt(this,Bt,this.svgFactory.createElement("svg:line"));return Nt.setAttribute("x1",q.rect[2]-q.lineCoordinates[0]),Nt.setAttribute("y1",q.rect[3]-q.lineCoordinates[1]),Nt.setAttribute("x2",q.rect[2]-q.lineCoordinates[2]),Nt.setAttribute("y2",q.rect[3]-q.lineCoordinates[3]),Nt.setAttribute("stroke-width",q.borderStyle.width||1),Nt.setAttribute("stroke","transparent"),Nt.setAttribute("fill","transparent"),Rt.append(Nt),this.container.append(Rt),!q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return W(this,Bt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bt=new WeakMap;class kt extends ut{constructor(q){super(q,{isRenderable:!0,ignoreBorder:!0});Pt(this,Ot,null)}render(){this.container.classList.add("squareAnnotation");const q=this.data,{width:rt,height:Ct}=Tt(q.rect),Rt=this.svgFactory.create(rt,Ct,!0),Nt=q.borderStyle.width,zt=Wt(this,Ot,this.svgFactory.createElement("svg:rect"));return zt.setAttribute("x",Nt/2),zt.setAttribute("y",Nt/2),zt.setAttribute("width",rt-Nt),zt.setAttribute("height",Ct-Nt),zt.setAttribute("stroke-width",Nt||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),Rt.append(zt),this.container.append(Rt),!q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return W(this,Ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ot=new WeakMap;class Lt extends ut{constructor(q){super(q,{isRenderable:!0,ignoreBorder:!0});Pt(this,se,null)}render(){this.container.classList.add("circleAnnotation");const q=this.data,{width:rt,height:Ct}=Tt(q.rect),Rt=this.svgFactory.create(rt,Ct,!0),Nt=q.borderStyle.width,zt=Wt(this,se,this.svgFactory.createElement("svg:ellipse"));return zt.setAttribute("cx",rt/2),zt.setAttribute("cy",Ct/2),zt.setAttribute("rx",rt/2-Nt/2),zt.setAttribute("ry",Ct/2-Nt/2),zt.setAttribute("stroke-width",Nt||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),Rt.append(zt),this.container.append(Rt),!q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return W(this,se)}addHighlightArea(){this.container.classList.add("highlightArea")}}se=new WeakMap;class mt extends ut{constructor(q){super(q,{isRenderable:!0,ignoreBorder:!0});Pt(this,ae,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const q=this.data,{width:rt,height:Ct}=Tt(q.rect),Rt=this.svgFactory.create(rt,Ct,!0);let Nt=[];for(const ie of q.vertices){const me=ie.x-q.rect[0],fe=q.rect[3]-ie.y;Nt.push(me+","+fe)}Nt=Nt.join(" ");const zt=Wt(this,ae,this.svgFactory.createElement(this.svgElementName));return zt.setAttribute("points",Nt),zt.setAttribute("stroke-width",q.borderStyle.width||1),zt.setAttribute("stroke","transparent"),zt.setAttribute("fill","transparent"),Rt.append(zt),this.container.append(Rt),!q.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return W(this,ae)}addHighlightArea(){this.container.classList.add("highlightArea")}}ae=new WeakMap;class It extends mt{constructor(wt){super(wt),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Vt extends ut{constructor(wt){super(wt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Xt extends ut{constructor(q){super(q,{isRenderable:!0,ignoreBorder:!0});Pt(this,je,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=D.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const q=this.data,{width:rt,height:Ct}=Tt(q.rect),Rt=this.svgFactory.create(rt,Ct,!0);for(const Nt of q.inkLists){let zt=[];for(const me of Nt){const fe=me.x-q.rect[0],Me=q.rect[3]-me.y;zt.push(`${fe},${Me}`)}zt=zt.join(" ");const ie=this.svgFactory.createElement(this.svgElementName);W(this,je).push(ie),ie.setAttribute("points",zt),ie.setAttribute("stroke-width",q.borderStyle.width||1),ie.setAttribute("stroke","transparent"),ie.setAttribute("fill","transparent"),!q.popupRef&&this.hasPopupData&&this._createPopup(),Rt.append(ie)}return this.container.append(Rt),this.container}getElementsToTriggerPopup(){return W(this,je)}addHighlightArea(){this.container.classList.add("highlightArea")}}je=new WeakMap,F.InkAnnotationElement=Xt;class Mt extends ut{constructor(wt){super(wt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Kt extends ut{constructor(wt){super(wt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ee extends ut{constructor(wt){super(wt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class de extends ut{constructor(wt){super(wt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class ge extends ut{constructor(wt){super(wt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}F.StampAnnotationElement=ge;class gt extends ut{constructor(q){var Rt;super(q,{isRenderable:!0});Pt(this,$t);Pt(this,Ue,null);const{filename:rt,content:Ct}=this.data.file;this.filename=(0,U.getFilenameFromUrl)(rt,!0),this.content=Ct,(Rt=this.linkService.eventBus)==null||Rt.dispatch("fileattachmentannotation",{source:this,filename:rt,content:Ct})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:q,data:rt}=this;let Ct;rt.hasAppearance||rt.fillAlpha===0?Ct=document.createElement("div"):(Ct=document.createElement("img"),Ct.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(rt.name)?"paperclip":"pushpin"}.svg`,rt.fillAlpha&&rt.fillAlpha<1&&(Ct.style=`filter: opacity(${Math.round(rt.fillAlpha*100)}%);`)),Ct.addEventListener("dblclick",Dt(this,$t,Ji).bind(this)),Wt(this,Ue,Ct);const{isMac:Rt}=D.FeatureTest.platform;return q.addEventListener("keydown",Nt=>{Nt.key==="Enter"&&(Rt?Nt.metaKey:Nt.ctrlKey)&&Dt(this,$t,Ji).call(this)}),!rt.popupRef&&this.hasPopupData?this._createPopup():Ct.classList.add("popupTriggerArea"),q.append(Ct),q}getElementsToTriggerPopup(){return W(this,Ue)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ue=new WeakMap,$t=new WeakSet,Ji=function(){var q;(q=this.downloadManager)==null||q.openOrDownloadData(this.container,this.content,this.filename)};class z{constructor({div:wt,accessibilityManager:q,annotationCanvasMap:rt,l10n:Ct,page:Rt,viewport:Nt}){Pt(this,we);Pt(this,ne);Pt(this,Se,null);Pt(this,pe,null);Pt(this,Ee,new Map);this.div=wt,Wt(this,Se,q),Wt(this,pe,rt),this.l10n=Ct,this.page=Rt,this.viewport=Nt,this.zIndex=0,this.l10n||(this.l10n=Ft.NullL10n)}async render(wt){const{annotations:q}=wt,rt=this.div;(0,U.setLayerDimensions)(rt,this.viewport);const Ct=new Map,Rt={data:null,layer:rt,linkService:wt.linkService,downloadManager:wt.downloadManager,imageResourcesPath:wt.imageResourcesPath||"",renderForms:wt.renderForms!==!1,svgFactory:new U.DOMSVGFactory,annotationStorage:wt.annotationStorage||new tt.AnnotationStorage,enableScripting:wt.enableScripting===!0,hasJSActions:wt.hasJSActions,fieldObjects:wt.fieldObjects,parent:this,elements:null};for(const Nt of q){if(Nt.noHTML)continue;const zt=Nt.annotationType===D.AnnotationType.POPUP;if(zt){const fe=Ct.get(Nt.id);if(!fe)continue;Rt.elements=fe}else{const{width:fe,height:Me}=Tt(Nt.rect);if(fe<=0||Me<=0)continue}Rt.data=Nt;const ie=vt.create(Rt);if(!ie.isRenderable)continue;if(!zt&&Nt.popupRef){const fe=Ct.get(Nt.popupRef);fe?fe.push(ie):Ct.set(Nt.popupRef,[ie])}ie.annotationEditorType>0&&W(this,Ee).set(ie.data.id,ie);const me=ie.render();Nt.hidden&&(me.style.visibility="hidden"),Dt(this,we,Ps).call(this,me,Nt.id)}Dt(this,ne,Qi).call(this),await this.l10n.translate(rt)}update({viewport:wt}){const q=this.div;this.viewport=wt,(0,U.setLayerDimensions)(q,{rotation:wt.rotation}),Dt(this,ne,Qi).call(this),q.hidden=!1}getEditableAnnotations(){return Array.from(W(this,Ee).values())}getEditableAnnotation(wt){return W(this,Ee).get(wt)}}Se=new WeakMap,pe=new WeakMap,Ee=new WeakMap,we=new WeakSet,Ps=function(wt,q){var Ct;const rt=wt.firstChild||wt;rt.id=`${D.AnnotationPrefix}${q}`,this.div.append(wt),(Ct=W(this,Se))==null||Ct.moveElementInDOM(this.div,wt,rt,!1)},ne=new WeakSet,Qi=function(){if(!W(this,pe))return;const wt=this.div;for(const[q,rt]of W(this,pe)){const Ct=wt.querySelector(`[data-annotation-id="${q}"]`);if(!Ct)continue;const{firstChild:Rt}=Ct;Rt?Rt.nodeName==="CANVAS"?Rt.replaceWith(rt):Rt.before(rt):Ct.append(rt)}W(this,pe).clear()},F.AnnotationLayer=z},(B,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.ColorConverters=void 0;function O(tt){return Math.floor(Math.max(0,Math.min(1,tt))*255).toString(16).padStart(2,"0")}function D(tt){return Math.max(0,Math.min(255,255*tt))}class U{static CMYK_G([Q,Ft,ht,dt]){return["G",1-Math.min(1,.3*Q+.59*ht+.11*Ft+dt)]}static G_CMYK([Q]){return["CMYK",0,0,0,1-Q]}static G_RGB([Q]){return["RGB",Q,Q,Q]}static G_rgb([Q]){return Q=D(Q),[Q,Q,Q]}static G_HTML([Q]){const Ft=O(Q);return`#${Ft}${Ft}${Ft}`}static RGB_G([Q,Ft,ht]){return["G",.3*Q+.59*Ft+.11*ht]}static RGB_rgb(Q){return Q.map(D)}static RGB_HTML(Q){return`#${Q.map(O).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([Q,Ft,ht,dt]){return["RGB",1-Math.min(1,Q+dt),1-Math.min(1,ht+dt),1-Math.min(1,Ft+dt)]}static CMYK_rgb([Q,Ft,ht,dt]){return[D(1-Math.min(1,Q+dt)),D(1-Math.min(1,ht+dt)),D(1-Math.min(1,Ft+dt))]}static CMYK_HTML(Q){const Ft=this.CMYK_RGB(Q).slice(1);return this.RGB_HTML(Ft)}static RGB_CMYK([Q,Ft,ht]){const dt=1-Q,st=1-Ft,yt=1-ht,Tt=Math.min(dt,st,yt);return["CMYK",dt,st,yt,Tt]}}F.ColorConverters=U},(B,F)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.NullL10n=void 0,F.getL10nFallback=D;const O={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};O.print_progress_percent="{{progress}}%";function D(Q,Ft){switch(Q){case"find_match_count":Q=`find_match_count[${Ft.total===1?"one":"other"}]`;break;case"find_match_count_limit":Q=`find_match_count_limit[${Ft.limit===1?"one":"other"}]`;break}return O[Q]||""}function U(Q,Ft){return Ft?Q.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(ht,dt)=>dt in Ft?Ft[dt]:"{{"+dt+"}}"):Q}const tt={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(Q,Ft=null,ht=D(Q,Ft)){return U(ht,Ft)},async translate(Q){}};F.NullL10n=tt},(B,F,O)=>{Object.defineProperty(F,"__esModule",{value:!0}),F.XfaLayer=void 0;var D=O(25);class U{static setupStorage(Q,Ft,ht,dt,st){const yt=dt.getValue(Ft,{value:null});switch(ht.name){case"textarea":if(yt.value!==null&&(Q.textContent=yt.value),st==="print")break;Q.addEventListener("input",Tt=>{dt.setValue(Ft,{value:Tt.target.value})});break;case"input":if(ht.attributes.type==="radio"||ht.attributes.type==="checkbox"){if(yt.value===ht.attributes.xfaOn?Q.setAttribute("checked",!0):yt.value===ht.attributes.xfaOff&&Q.removeAttribute("checked"),st==="print")break;Q.addEventListener("change",Tt=>{dt.setValue(Ft,{value:Tt.target.checked?Tt.target.getAttribute("xfaOn"):Tt.target.getAttribute("xfaOff")})})}else{if(yt.value!==null&&Q.setAttribute("value",yt.value),st==="print")break;Q.addEventListener("input",Tt=>{dt.setValue(Ft,{value:Tt.target.value})})}break;case"select":if(yt.value!==null){Q.setAttribute("value",yt.value);for(const Tt of ht.children)Tt.attributes.value===yt.value?Tt.attributes.selected=!0:Tt.attributes.hasOwnProperty("selected")&&delete Tt.attributes.selected}Q.addEventListener("input",Tt=>{const vt=Tt.target.options,ut=vt.selectedIndex===-1?"":vt[vt.selectedIndex].value;dt.setValue(Ft,{value:ut})});break}}static setAttributes({html:Q,element:Ft,storage:ht=null,intent:dt,linkService:st}){const{attributes:yt}=Ft,Tt=Q instanceof HTMLAnchorElement;yt.type==="radio"&&(yt.name=`${yt.name}-${dt}`);for(const[vt,ut]of Object.entries(yt))if(ut!=null)switch(vt){case"class":ut.length&&Q.setAttribute(vt,ut.join(" "));break;case"dataId":break;case"id":Q.setAttribute("data-element-id",ut);break;case"style":Object.assign(Q.style,ut);break;case"textContent":Q.textContent=ut;break;default:(!Tt||vt!=="href"&&vt!=="newWindow")&&Q.setAttribute(vt,ut)}Tt&&st.addLinkAttributes(Q,yt.href,yt.newWindow),ht&&yt.dataId&&this.setupStorage(Q,yt.dataId,Ft,ht)}static render(Q){var ft;const Ft=Q.annotationStorage,ht=Q.linkService,dt=Q.xfaHtml,st=Q.intent||"display",yt=document.createElement(dt.name);dt.attributes&&this.setAttributes({html:yt,element:dt,intent:st,linkService:ht});const Tt=[[dt,-1,yt]],vt=Q.div;if(vt.append(yt),Q.viewport){const nt=`matrix(${Q.viewport.transform.join(",")})`;vt.style.transform=nt}st!=="richText"&&vt.setAttribute("class","xfaLayer xfaFont");const ut=[];for(;Tt.length>0;){const[nt,ct,bt]=Tt.at(-1);if(ct+1===nt.children.length){Tt.pop();continue}const _t=nt.children[++Tt.at(-1)[1]];if(_t===null)continue;const{name:pt}=_t;if(pt==="#text"){const et=document.createTextNode(_t.value);ut.push(et),bt.append(et);continue}const K=(ft=_t==null?void 0:_t.attributes)!=null&&ft.xmlns?document.createElementNS(_t.attributes.xmlns,pt):document.createElement(pt);if(bt.append(K),_t.attributes&&this.setAttributes({html:K,element:_t,storage:Ft,intent:st,linkService:ht}),_t.children&&_t.children.length>0)Tt.push([_t,-1,K]);else if(_t.value){const et=document.createTextNode(_t.value);D.XfaText.shouldBuildText(pt)&&ut.push(et),K.append(et)}}for(const nt of vt.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))nt.setAttribute("readOnly",!0);return{textDivs:ut}}static update(Q){const Ft=`matrix(${Q.viewport.transform.join(",")})`;Q.div.style.transform=Ft,Q.div.hidden=!1}}F.XfaLayer=U},(B,F,O)=>{var dt,st,yt,Tt,vt,ut,ft,nt,ct,bt,_t,pt,K,et,St,xs,Y,ks,ot,Rs,Lt,Ms,It,Zi,Xt,Fs,Kt,ts,de,Ds,gt,Os,X,Ls,J,Is,lt,Ns,xt,Ge,Ht,es,Jt,Ai,Zt,vi,Ce,ti,Ae,is,Ut,Si,Qt,$s,ue,ss,Re,Bs,Fe,Us,ke,ns,Yt,Ei,Ot,ei;Object.defineProperty(F,"__esModule",{value:!0}),F.InkEditor=void 0;var D=O(1),U=O(4),tt=O(29),Q=O(6),Ft=O(5);const ae=class ae extends U.AnnotationEditor{constructor($t){super({...$t,name:"inkEditor"});Pt(this,St);Pt(this,Y);Pt(this,ot);Pt(this,Lt);Pt(this,It);Pt(this,Xt);Pt(this,Kt);Pt(this,de);Pt(this,gt);Pt(this,X);Pt(this,J);Pt(this,lt);Pt(this,xt);Pt(this,Ht);Pt(this,Jt);Pt(this,Zt);Pt(this,Ce);Pt(this,Ae);Pt(this,Ut);Pt(this,Fe);Pt(this,ke);Pt(this,Yt);Pt(this,Ot);Pt(this,dt,0);Pt(this,st,0);Pt(this,yt,this.canvasPointermove.bind(this));Pt(this,Tt,this.canvasPointerleave.bind(this));Pt(this,vt,this.canvasPointerup.bind(this));Pt(this,ut,this.canvasPointerdown.bind(this));Pt(this,ft,new Path2D);Pt(this,nt,!1);Pt(this,ct,!1);Pt(this,bt,!1);Pt(this,_t,null);Pt(this,pt,0);Pt(this,K,0);Pt(this,et,null);this.color=$t.color||null,this.thickness=$t.thickness||null,this.opacity=$t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize($t){U.AnnotationEditor.initialize($t,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams($t,le){switch($t){case D.AnnotationEditorParamsType.INK_THICKNESS:ae._defaultThickness=le;break;case D.AnnotationEditorParamsType.INK_COLOR:ae._defaultColor=le;break;case D.AnnotationEditorParamsType.INK_OPACITY:ae._defaultOpacity=le/100;break}}updateParams($t,le){switch($t){case D.AnnotationEditorParamsType.INK_THICKNESS:Dt(this,St,xs).call(this,le);break;case D.AnnotationEditorParamsType.INK_COLOR:Dt(this,Y,ks).call(this,le);break;case D.AnnotationEditorParamsType.INK_OPACITY:Dt(this,ot,Rs).call(this,le);break}}static get defaultPropertiesToUpdate(){return[[D.AnnotationEditorParamsType.INK_THICKNESS,ae._defaultThickness],[D.AnnotationEditorParamsType.INK_COLOR,ae._defaultColor||U.AnnotationEditor._defaultLineColor],[D.AnnotationEditorParamsType.INK_OPACITY,Math.round(ae._defaultOpacity*100)]]}get propertiesToUpdate(){return[[D.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ae._defaultThickness],[D.AnnotationEditorParamsType.INK_COLOR,this.color||ae._defaultColor||U.AnnotationEditor._defaultLineColor],[D.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ae._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Dt(this,Jt,Ai).call(this),Dt(this,Zt,vi).call(this)),this.isAttachedToDOM||(this.parent.add(this),Dt(this,Ce,ti).call(this)),Dt(this,Ot,ei).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,W(this,_t).disconnect(),Wt(this,_t,null),super.remove())}setParent($t){!this.parent&&$t?this._uiManager.removeShouldRescale(this):this.parent&&$t===null&&this._uiManager.addShouldRescale(this),super.setParent($t)}onScaleChanging(){const[$t,le]=this.parentDimensions,Se=this.width*$t,pe=this.height*le;this.setDimensions(Se,pe)}enableEditMode(){W(this,nt)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",W(this,ut)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",W(this,ut)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){W(this,nt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Wt(this,nt,!0),this.div.classList.add("disabled"),Dt(this,Ot,ei).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin($t){this._focusEventsAllowed&&(super.focusin($t),this.enableEditMode())}canvasPointerdown($t){$t.button!==0||!this.isInEditMode()||W(this,nt)||(this.setInForeground(),$t.preventDefault(),$t.type!=="mouse"&&this.div.focus(),Dt(this,Xt,Fs).call(this,$t.offsetX,$t.offsetY))}canvasPointermove($t){$t.preventDefault(),Dt(this,Kt,ts).call(this,$t.offsetX,$t.offsetY)}canvasPointerup($t){$t.preventDefault(),Dt(this,Ht,es).call(this,$t)}canvasPointerleave($t){Dt(this,Ht,es).call(this,$t)}get isResizable(){return!this.isEmpty()&&W(this,nt)}render(){if(this.div)return this.div;let $t,le;this.width&&($t=this.x,le=this.y),super.render(),U.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then($e=>{var ne;return(ne=this.div)==null?void 0:ne.setAttribute("aria-label",$e)});const[Se,pe,Ee,we]=Dt(this,Lt,Ms).call(this);if(this.setAt(Se,pe,0,0),this.setDims(Ee,we),Dt(this,Jt,Ai).call(this),this.width){const[$e,ne]=this.parentDimensions;this.setAspectRatio(this.width*$e,this.height*ne),this.setAt($t*$e,le*ne,this.width*$e,this.height*ne),Wt(this,bt,!0),Dt(this,Ce,ti).call(this),this.setDims(this.width*$e,this.height*ne),Dt(this,xt,Ge).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Dt(this,Zt,vi).call(this),this.div}setDimensions($t,le){const Se=Math.round($t),pe=Math.round(le);if(W(this,pt)===Se&&W(this,K)===pe)return;Wt(this,pt,Se),Wt(this,K,pe),this.canvas.style.visibility="hidden";const[Ee,we]=this.parentDimensions;this.width=$t/Ee,this.height=le/we,this.fixAndSetPosition(),W(this,nt)&&Dt(this,Ae,is).call(this,$t,le),Dt(this,Ce,ti).call(this),Dt(this,xt,Ge).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize($t,le,Se){var Rt,Nt,zt;if($t instanceof tt.InkAnnotationElement)return null;const pe=super.deserialize($t,le,Se);pe.thickness=$t.thickness,pe.color=D.Util.makeHexColor(...$t.color),pe.opacity=$t.opacity;const[Ee,we]=pe.pageDimensions,$e=pe.width*Ee,ne=pe.height*we,Ie=pe.parentScale,ve=$t.thickness/2;Wt(pe,nt,!0),Wt(pe,pt,Math.round($e)),Wt(pe,K,Math.round(ne));const{paths:wt,rect:q,rotation:rt}=$t;for(let{bezier:ie}of wt){ie=Dt(Rt=ae,Re,Bs).call(Rt,ie,q,rt);const me=[];pe.paths.push(me);let fe=Ie*(ie[0]-ve),Me=Ie*(ie[1]-ve);for(let ye=2,Te=ie.length;ye<Te;ye+=6){const Oe=Ie*(ie[ye]-ve),Ne=Ie*(ie[ye+1]-ve),Be=Ie*(ie[ye+2]-ve),qe=Ie*(ie[ye+3]-ve),We=Ie*(ie[ye+4]-ve),ze=Ie*(ie[ye+5]-ve);me.push([[fe,Me],[Oe,Ne],[Be,qe],[We,ze]]),fe=We,Me=ze}const _e=Dt(this,Qt,$s).call(this,me);pe.bezierPath2D.push(_e)}const Ct=Dt(Nt=pe,ke,ns).call(Nt);return Wt(pe,st,Math.max(U.AnnotationEditor.MIN_SIZE,Ct[2]-Ct[0])),Wt(pe,dt,Math.max(U.AnnotationEditor.MIN_SIZE,Ct[3]-Ct[1])),Dt(zt=pe,Ae,is).call(zt,$e,ne),pe}serialize(){if(this.isEmpty())return null;const $t=this.getRect(0,0),le=U.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:D.AnnotationEditorType.INK,color:le,thickness:this.thickness,opacity:this.opacity,paths:Dt(this,Fe,Us).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,$t),pageIndex:this.pageIndex,rect:$t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};dt=new WeakMap,st=new WeakMap,yt=new WeakMap,Tt=new WeakMap,vt=new WeakMap,ut=new WeakMap,ft=new WeakMap,nt=new WeakMap,ct=new WeakMap,bt=new WeakMap,_t=new WeakMap,pt=new WeakMap,K=new WeakMap,et=new WeakMap,St=new WeakSet,xs=function($t){const le=this.thickness;this.addCommands({cmd:()=>{this.thickness=$t,Dt(this,Ot,ei).call(this)},undo:()=>{this.thickness=le,Dt(this,Ot,ei).call(this)},mustExec:!0,type:D.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Y=new WeakSet,ks=function($t){const le=this.color;this.addCommands({cmd:()=>{this.color=$t,Dt(this,xt,Ge).call(this)},undo:()=>{this.color=le,Dt(this,xt,Ge).call(this)},mustExec:!0,type:D.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ot=new WeakSet,Rs=function($t){$t/=100;const le=this.opacity;this.addCommands({cmd:()=>{this.opacity=$t,Dt(this,xt,Ge).call(this)},undo:()=>{this.opacity=le,Dt(this,xt,Ge).call(this)},mustExec:!0,type:D.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Lt=new WeakSet,Ms=function(){const{parentRotation:$t,parentDimensions:[le,Se]}=this;switch($t){case 90:return[0,Se,Se,le];case 180:return[le,Se,le,Se];case 270:return[le,0,Se,le];default:return[0,0,le,Se]}},It=new WeakSet,Zi=function(){const{ctx:$t,color:le,opacity:Se,thickness:pe,parentScale:Ee,scaleFactor:we}=this;$t.lineWidth=pe*Ee/we,$t.lineCap="round",$t.lineJoin="round",$t.miterLimit=10,$t.strokeStyle=`${le}${(0,Ft.opacityToHex)(Se)}`},Xt=new WeakSet,Fs=function($t,le){this.canvas.addEventListener("contextmenu",Q.noContextMenu),this.canvas.addEventListener("pointerleave",W(this,Tt)),this.canvas.addEventListener("pointermove",W(this,yt)),this.canvas.addEventListener("pointerup",W(this,vt)),this.canvas.removeEventListener("pointerdown",W(this,ut)),this.isEditing=!0,W(this,bt)||(Wt(this,bt,!0),Dt(this,Ce,ti).call(this),this.thickness||(this.thickness=ae._defaultThickness),this.color||(this.color=ae._defaultColor||U.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=ae._defaultOpacity)),this.currentPath.push([$t,le]),Wt(this,ct,!1),Dt(this,It,Zi).call(this),Wt(this,et,()=>{Dt(this,X,Ls).call(this),W(this,et)&&window.requestAnimationFrame(W(this,et))}),window.requestAnimationFrame(W(this,et))},Kt=new WeakSet,ts=function($t,le){const[Se,pe]=this.currentPath.at(-1);if(this.currentPath.length>1&&$t===Se&&le===pe)return;const Ee=this.currentPath;let we=W(this,ft);if(Ee.push([$t,le]),Wt(this,ct,!0),Ee.length<=2){we.moveTo(...Ee[0]),we.lineTo($t,le);return}Ee.length===3&&(Wt(this,ft,we=new Path2D),we.moveTo(...Ee[0])),Dt(this,J,Is).call(this,we,...Ee.at(-3),...Ee.at(-2),$t,le)},de=new WeakSet,Ds=function(){if(this.currentPath.length===0)return;const $t=this.currentPath.at(-1);W(this,ft).lineTo(...$t)},gt=new WeakSet,Os=function($t,le){Wt(this,et,null),$t=Math.min(Math.max($t,0),this.canvas.width),le=Math.min(Math.max(le,0),this.canvas.height),Dt(this,Kt,ts).call(this,$t,le),Dt(this,de,Ds).call(this);let Se;if(this.currentPath.length!==1)Se=Dt(this,lt,Ns).call(this);else{const ne=[$t,le];Se=[[ne,ne.slice(),ne.slice(),ne]]}const pe=W(this,ft),Ee=this.currentPath;this.currentPath=[],Wt(this,ft,new Path2D);const we=()=>{this.allRawPaths.push(Ee),this.paths.push(Se),this.bezierPath2D.push(pe),this.rebuild()},$e=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Dt(this,Jt,Ai).call(this),Dt(this,Zt,vi).call(this)),Dt(this,Ot,ei).call(this))};this.addCommands({cmd:we,undo:$e,mustExec:!0})},X=new WeakSet,Ls=function(){if(!W(this,ct))return;Wt(this,ct,!1);const $t=Math.ceil(this.thickness*this.parentScale),le=this.currentPath.slice(-3),Se=le.map(we=>we[0]),pe=le.map(we=>we[1]);Math.min(...Se)-$t,Math.max(...Se)+$t,Math.min(...pe)-$t,Math.max(...pe)+$t;const{ctx:Ee}=this;Ee.save(),Ee.clearRect(0,0,this.canvas.width,this.canvas.height);for(const we of this.bezierPath2D)Ee.stroke(we);Ee.stroke(W(this,ft)),Ee.restore()},J=new WeakSet,Is=function($t,le,Se,pe,Ee,we,$e){const ne=(le+pe)/2,Ie=(Se+Ee)/2,ve=(pe+we)/2,wt=(Ee+$e)/2;$t.bezierCurveTo(ne+2*(pe-ne)/3,Ie+2*(Ee-Ie)/3,ve+2*(pe-ve)/3,wt+2*(Ee-wt)/3,ve,wt)},lt=new WeakSet,Ns=function(){const $t=this.currentPath;if($t.length<=2)return[[$t[0],$t[0],$t.at(-1),$t.at(-1)]];const le=[];let Se,[pe,Ee]=$t[0];for(Se=1;Se<$t.length-2;Se++){const[q,rt]=$t[Se],[Ct,Rt]=$t[Se+1],Nt=(q+Ct)/2,zt=(rt+Rt)/2,ie=[pe+2*(q-pe)/3,Ee+2*(rt-Ee)/3],me=[Nt+2*(q-Nt)/3,zt+2*(rt-zt)/3];le.push([[pe,Ee],ie,me,[Nt,zt]]),[pe,Ee]=[Nt,zt]}const[we,$e]=$t[Se],[ne,Ie]=$t[Se+1],ve=[pe+2*(we-pe)/3,Ee+2*($e-Ee)/3],wt=[ne+2*(we-ne)/3,Ie+2*($e-Ie)/3];return le.push([[pe,Ee],ve,wt,[ne,Ie]]),le},xt=new WeakSet,Ge=function(){if(this.isEmpty()){Dt(this,Ut,Si).call(this);return}Dt(this,It,Zi).call(this);const{canvas:$t,ctx:le}=this;le.setTransform(1,0,0,1,0,0),le.clearRect(0,0,$t.width,$t.height),Dt(this,Ut,Si).call(this);for(const Se of this.bezierPath2D)le.stroke(Se)},Ht=new WeakSet,es=function($t){this.canvas.removeEventListener("pointerleave",W(this,Tt)),this.canvas.removeEventListener("pointermove",W(this,yt)),this.canvas.removeEventListener("pointerup",W(this,vt)),this.canvas.addEventListener("pointerdown",W(this,ut)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",Q.noContextMenu)},10),Dt(this,gt,Os).call(this,$t.offsetX,$t.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Jt=new WeakSet,Ai=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",U.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then($t=>{var le;return(le=this.canvas)==null?void 0:le.setAttribute("aria-label",$t)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Zt=new WeakSet,vi=function(){Wt(this,_t,new ResizeObserver($t=>{const le=$t[0].contentRect;le.width&&le.height&&this.setDimensions(le.width,le.height)})),W(this,_t).observe(this.div)},Ce=new WeakSet,ti=function(){if(!W(this,bt))return;const[$t,le]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*$t),this.canvas.height=Math.ceil(this.height*le),Dt(this,Ut,Si).call(this)},Ae=new WeakSet,is=function($t,le){const Se=Dt(this,Yt,Ei).call(this),pe=($t-Se)/W(this,st),Ee=(le-Se)/W(this,dt);this.scaleFactor=Math.min(pe,Ee)},Ut=new WeakSet,Si=function(){const $t=Dt(this,Yt,Ei).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+$t,this.translationY*this.scaleFactor+$t)},Qt=new WeakSet,$s=function($t){const le=new Path2D;for(let Se=0,pe=$t.length;Se<pe;Se++){const[Ee,we,$e,ne]=$t[Se];Se===0&&le.moveTo(...Ee),le.bezierCurveTo(we[0],we[1],$e[0],$e[1],ne[0],ne[1])}return le},ue=new WeakSet,ss=function($t,le,Se){const[pe,Ee,we,$e]=le;switch(Se){case 0:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2)$t[ne]+=pe,$t[ne+1]=$e-$t[ne+1];break;case 90:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2){const ve=$t[ne];$t[ne]=$t[ne+1]+pe,$t[ne+1]=ve+Ee}break;case 180:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2)$t[ne]=we-$t[ne],$t[ne+1]+=Ee;break;case 270:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2){const ve=$t[ne];$t[ne]=we-$t[ne+1],$t[ne+1]=$e-ve}break;default:throw new Error("Invalid rotation")}return $t},Re=new WeakSet,Bs=function($t,le,Se){const[pe,Ee,we,$e]=le;switch(Se){case 0:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2)$t[ne]-=pe,$t[ne+1]=$e-$t[ne+1];break;case 90:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2){const ve=$t[ne];$t[ne]=$t[ne+1]-Ee,$t[ne+1]=ve-pe}break;case 180:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2)$t[ne]=we-$t[ne],$t[ne+1]-=Ee;break;case 270:for(let ne=0,Ie=$t.length;ne<Ie;ne+=2){const ve=$t[ne];$t[ne]=$e-$t[ne+1],$t[ne+1]=we-ve}break;default:throw new Error("Invalid rotation")}return $t},Fe=new WeakSet,Us=function($t,le,Se,pe){var Ie,ve;const Ee=[],we=this.thickness/2,$e=$t*le+we,ne=$t*Se+we;for(const wt of this.paths){const q=[],rt=[];for(let Ct=0,Rt=wt.length;Ct<Rt;Ct++){const[Nt,zt,ie,me]=wt[Ct],fe=$t*Nt[0]+$e,Me=$t*Nt[1]+ne,_e=$t*zt[0]+$e,ye=$t*zt[1]+ne,Te=$t*ie[0]+$e,Oe=$t*ie[1]+ne,Ne=$t*me[0]+$e,Be=$t*me[1]+ne;Ct===0&&(q.push(fe,Me),rt.push(fe,Me)),q.push(_e,ye,Te,Oe,Ne,Be),rt.push(_e,ye),Ct===Rt-1&&rt.push(Ne,Be)}Ee.push({bezier:Dt(Ie=ae,ue,ss).call(Ie,q,pe,this.rotation),points:Dt(ve=ae,ue,ss).call(ve,rt,pe,this.rotation)})}return Ee},ke=new WeakSet,ns=function(){let $t=1/0,le=-1/0,Se=1/0,pe=-1/0;for(const Ee of this.paths)for(const[we,$e,ne,Ie]of Ee){const ve=D.Util.bezierBoundingBox(...we,...$e,...ne,...Ie);$t=Math.min($t,ve[0]),Se=Math.min(Se,ve[1]),le=Math.max(le,ve[2]),pe=Math.max(pe,ve[3])}return[$t,Se,le,pe]},Yt=new WeakSet,Ei=function(){return W(this,nt)?Math.ceil(this.thickness*this.parentScale):0},Ot=new WeakSet,ei=function($t=!1){if(this.isEmpty())return;if(!W(this,nt)){Dt(this,xt,Ge).call(this);return}const le=Dt(this,ke,ns).call(this),Se=Dt(this,Yt,Ei).call(this);Wt(this,st,Math.max(U.AnnotationEditor.MIN_SIZE,le[2]-le[0])),Wt(this,dt,Math.max(U.AnnotationEditor.MIN_SIZE,le[3]-le[1]));const pe=Math.ceil(Se+W(this,st)*this.scaleFactor),Ee=Math.ceil(Se+W(this,dt)*this.scaleFactor),[we,$e]=this.parentDimensions;this.width=pe/we,this.height=Ee/$e,this.setAspectRatio(pe,Ee);const ne=this.translationX,Ie=this.translationY;this.translationX=-le[0],this.translationY=-le[1],Dt(this,Ce,ti).call(this),Dt(this,xt,Ge).call(this),Wt(this,pt,pe),Wt(this,K,Ee),this.setDims(pe,Ee);const ve=$t?Se/this.scaleFactor/2:0;this.translate(ne-this.translationX-ve,Ie-this.translationY-ve)},Pt(ae,Qt),Pt(ae,ue),Pt(ae,Re),He(ae,"_defaultColor",null),He(ae,"_defaultOpacity",1),He(ae,"_defaultThickness",1),He(ae,"_type","ink");let ht=ae;F.InkEditor=ht},(B,F,O)=>{var ht,dt,st,yt,Tt,vt,ut,ft,nt,ct,bt,ci,pt,hi,et,wi,at,rs,At,js,kt,Hs,mt,as,Vt,Ci,Mt,Ws;Object.defineProperty(F,"__esModule",{value:!0}),F.StampEditor=void 0;var D=O(1),U=O(4),tt=O(6),Q=O(29);const ee=class ee extends U.AnnotationEditor{constructor(gt){super({...gt,name:"stampEditor"});Pt(this,bt);Pt(this,pt);Pt(this,et);Pt(this,at);Pt(this,At);Pt(this,kt);Pt(this,mt);Pt(this,Vt);Pt(this,Mt);Pt(this,ht,null);Pt(this,dt,null);Pt(this,st,null);Pt(this,yt,null);Pt(this,Tt,null);Pt(this,vt,null);Pt(this,ut,null);Pt(this,ft,null);Pt(this,nt,!1);Pt(this,ct,!1);Wt(this,yt,gt.bitmapUrl),Wt(this,Tt,gt.bitmapFile)}static initialize(gt){U.AnnotationEditor.initialize(gt)}static get supportedTypes(){const gt=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,D.shadow)(this,"supportedTypes",gt.map(z=>`image/${z}`))}static get supportedTypesStr(){return(0,D.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(gt){return this.supportedTypes.includes(gt)}static paste(gt,z){z.pasteEditor(D.AnnotationEditorType.STAMP,{bitmapFile:gt.getAsFile()})}remove(){var gt,z;W(this,dt)&&(Wt(this,ht,null),this._uiManager.imageManager.deleteId(W(this,dt)),(gt=W(this,vt))==null||gt.remove(),Wt(this,vt,null),(z=W(this,ut))==null||z.disconnect(),Wt(this,ut,null)),super.remove()}rebuild(){if(!this.parent){W(this,dt)&&Dt(this,et,wi).call(this);return}super.rebuild(),this.div!==null&&(W(this,dt)&&Dt(this,et,wi).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(W(this,st)||W(this,ht)||W(this,yt)||W(this,Tt))}get isResizable(){return!0}render(){if(this.div)return this.div;let gt,z;if(this.width&&(gt=this.x,z=this.y),super.render(),this.div.hidden=!0,W(this,ht)?Dt(this,at,rs).call(this):Dt(this,et,wi).call(this),this.width){const[X,G]=this.parentDimensions;this.setAt(gt*X,z*G,this.width*X,this.height*G)}return this.div}static deserialize(gt,z,X){if(gt instanceof Q.StampAnnotationElement)return null;const G=super.deserialize(gt,z,X),{rect:J,bitmapUrl:it,bitmapId:lt,isSvg:Et,accessibilityData:xt}=gt;lt&&X.imageManager.isValidId(lt)?Wt(G,dt,lt):Wt(G,yt,it),Wt(G,nt,Et);const[qt,Ht]=G.pageDimensions;return G.width=(J[2]-J[0])/qt,G.height=(J[3]-J[1])/Ht,xt&&(G.altTextData=xt),G}serialize(gt=!1,z=null){if(this.isEmpty())return null;const X={annotationType:D.AnnotationEditorType.STAMP,bitmapId:W(this,dt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:W(this,nt),structTreeParentId:this._structTreeParentId};if(gt)return X.bitmapUrl=Dt(this,Vt,Ci).call(this,!0),X.accessibilityData=this.altTextData,X;const{decorative:G,altText:J}=this.altTextData;if(!G&&J&&(X.accessibilityData={type:"Figure",alt:J}),z===null)return X;z.stamps||(z.stamps=new Map);const it=W(this,nt)?(X.rect[2]-X.rect[0])*(X.rect[3]-X.rect[1]):null;if(!z.stamps.has(W(this,dt)))z.stamps.set(W(this,dt),{area:it,serialized:X}),X.bitmap=Dt(this,Vt,Ci).call(this,!1);else if(W(this,nt)){const lt=z.stamps.get(W(this,dt));it>lt.area&&(lt.area=it,lt.serialized.bitmap.close(),lt.serialized.bitmap=Dt(this,Vt,Ci).call(this,!1))}return X}};ht=new WeakMap,dt=new WeakMap,st=new WeakMap,yt=new WeakMap,Tt=new WeakMap,vt=new WeakMap,ut=new WeakMap,ft=new WeakMap,nt=new WeakMap,ct=new WeakMap,bt=new WeakSet,ci=function(gt,z=!1){if(!gt){this.remove();return}Wt(this,ht,gt.bitmap),z||(Wt(this,dt,gt.id),Wt(this,nt,gt.isSvg)),Dt(this,at,rs).call(this)},pt=new WeakSet,hi=function(){Wt(this,st,null),this._uiManager.enableWaiting(!1),W(this,vt)&&this.div.focus()},et=new WeakSet,wi=function(){if(W(this,dt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(W(this,dt)).then(z=>Dt(this,bt,ci).call(this,z,!0)).finally(()=>Dt(this,pt,hi).call(this));return}if(W(this,yt)){const z=W(this,yt);Wt(this,yt,null),this._uiManager.enableWaiting(!0),Wt(this,st,this._uiManager.imageManager.getFromUrl(z).then(X=>Dt(this,bt,ci).call(this,X)).finally(()=>Dt(this,pt,hi).call(this)));return}if(W(this,Tt)){const z=W(this,Tt);Wt(this,Tt,null),this._uiManager.enableWaiting(!0),Wt(this,st,this._uiManager.imageManager.getFromFile(z).then(X=>Dt(this,bt,ci).call(this,X)).finally(()=>Dt(this,pt,hi).call(this)));return}const gt=document.createElement("input");gt.type="file",gt.accept=ee.supportedTypesStr,Wt(this,st,new Promise(z=>{gt.addEventListener("change",async()=>{if(!gt.files||gt.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const X=await this._uiManager.imageManager.getFromFile(gt.files[0]);Dt(this,bt,ci).call(this,X)}z()}),gt.addEventListener("cancel",()=>{this.remove(),z()})}).finally(()=>Dt(this,pt,hi).call(this))),gt.click()},at=new WeakSet,rs=function(){const{div:gt}=this;let{width:z,height:X}=W(this,ht);const[G,J]=this.pageDimensions,it=.75;if(this.width)z=this.width*G,X=this.height*J;else if(z>it*G||X>it*J){const qt=Math.min(it*G/z,it*J/X);z*=qt,X*=qt}const[lt,Et]=this.parentDimensions;this.setDims(z*lt/G,X*Et/J),this._uiManager.enableWaiting(!1);const xt=Wt(this,vt,document.createElement("canvas"));gt.append(xt),gt.hidden=!1,Dt(this,mt,as).call(this,z,X),Dt(this,Mt,Ws).call(this),W(this,ct)||(this.parent.addUndoableEditor(this),Wt(this,ct,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},At=new WeakSet,js=function(gt,z){var it;const[X,G]=this.parentDimensions;this.width=gt/X,this.height=z/G,this.setDims(gt,z),(it=this._initialOptions)!=null&&it.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,W(this,ft)!==null&&clearTimeout(W(this,ft)),Wt(this,ft,setTimeout(()=>{Wt(this,ft,null),Dt(this,mt,as).call(this,gt,z)},200))},kt=new WeakSet,Hs=function(gt,z){const{width:X,height:G}=W(this,ht);let J=X,it=G,lt=W(this,ht);for(;J>2*gt||it>2*z;){const Et=J,xt=it;J>2*gt&&(J=J>=16384?Math.floor(J/2)-1:Math.ceil(J/2)),it>2*z&&(it=it>=16384?Math.floor(it/2)-1:Math.ceil(it/2));const qt=new OffscreenCanvas(J,it);qt.getContext("2d").drawImage(lt,0,0,Et,xt,0,0,J,it),lt=qt.transferToImageBitmap()}return lt},mt=new WeakSet,as=function(gt,z){gt=Math.ceil(gt),z=Math.ceil(z);const X=W(this,vt);if(!X||X.width===gt&&X.height===z)return;X.width=gt,X.height=z;const G=W(this,nt)?W(this,ht):Dt(this,kt,Hs).call(this,gt,z),J=X.getContext("2d");J.filter=this._uiManager.hcmFilter,J.drawImage(G,0,0,G.width,G.height,0,0,gt,z)},Vt=new WeakSet,Ci=function(gt){if(gt){if(W(this,nt)){const G=this._uiManager.imageManager.getSvgUrl(W(this,dt));if(G)return G}const z=document.createElement("canvas");return{width:z.width,height:z.height}=W(this,ht),z.getContext("2d").drawImage(W(this,ht),0,0),z.toDataURL()}if(W(this,nt)){const[z,X]=this.pageDimensions,G=Math.round(this.width*z*tt.PixelsPerInch.PDF_TO_CSS_UNITS),J=Math.round(this.height*X*tt.PixelsPerInch.PDF_TO_CSS_UNITS),it=new OffscreenCanvas(G,J);return it.getContext("2d").drawImage(W(this,ht),0,0,W(this,ht).width,W(this,ht).height,0,0,G,J),it.transferToImageBitmap()}return structuredClone(W(this,ht))},Mt=new WeakSet,Ws=function(){Wt(this,ut,new ResizeObserver(gt=>{const z=gt[0].contentRect;z.width&&z.height&&Dt(this,At,js).call(this,z.width,z.height)})),W(this,ut).observe(this.div)},He(ee,"_type","stamp");let Ft=ee;F.StampEditor=Ft}],__webpack_module_cache__={};function __w_pdfjs_require__(B){var F=__webpack_module_cache__[B];if(F!==void 0)return F.exports;var O=__webpack_module_cache__[B]={exports:{}};return __webpack_modules__[B](O,O.exports,__w_pdfjs_require__),O.exports}var __webpack_exports__={};return(()=>{var B=__webpack_exports__;Object.defineProperty(B,"__esModule",{value:!0}),Object.defineProperty(B,"AbortException",{enumerable:!0,get:function(){return F.AbortException}}),Object.defineProperty(B,"AnnotationEditorLayer",{enumerable:!0,get:function(){return tt.AnnotationEditorLayer}}),Object.defineProperty(B,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return F.AnnotationEditorParamsType}}),Object.defineProperty(B,"AnnotationEditorType",{enumerable:!0,get:function(){return F.AnnotationEditorType}}),Object.defineProperty(B,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return Q.AnnotationEditorUIManager}}),Object.defineProperty(B,"AnnotationLayer",{enumerable:!0,get:function(){return Ft.AnnotationLayer}}),Object.defineProperty(B,"AnnotationMode",{enumerable:!0,get:function(){return F.AnnotationMode}}),Object.defineProperty(B,"CMapCompressionType",{enumerable:!0,get:function(){return F.CMapCompressionType}}),Object.defineProperty(B,"DOMSVGFactory",{enumerable:!0,get:function(){return D.DOMSVGFactory}}),Object.defineProperty(B,"FeatureTest",{enumerable:!0,get:function(){return F.FeatureTest}}),Object.defineProperty(B,"GlobalWorkerOptions",{enumerable:!0,get:function(){return ht.GlobalWorkerOptions}}),Object.defineProperty(B,"ImageKind",{enumerable:!0,get:function(){return F.ImageKind}}),Object.defineProperty(B,"InvalidPDFException",{enumerable:!0,get:function(){return F.InvalidPDFException}}),Object.defineProperty(B,"MissingPDFException",{enumerable:!0,get:function(){return F.MissingPDFException}}),Object.defineProperty(B,"OPS",{enumerable:!0,get:function(){return F.OPS}}),Object.defineProperty(B,"PDFDataRangeTransport",{enumerable:!0,get:function(){return O.PDFDataRangeTransport}}),Object.defineProperty(B,"PDFDateString",{enumerable:!0,get:function(){return D.PDFDateString}}),Object.defineProperty(B,"PDFWorker",{enumerable:!0,get:function(){return O.PDFWorker}}),Object.defineProperty(B,"PasswordResponses",{enumerable:!0,get:function(){return F.PasswordResponses}}),Object.defineProperty(B,"PermissionFlag",{enumerable:!0,get:function(){return F.PermissionFlag}}),Object.defineProperty(B,"PixelsPerInch",{enumerable:!0,get:function(){return D.PixelsPerInch}}),Object.defineProperty(B,"PromiseCapability",{enumerable:!0,get:function(){return F.PromiseCapability}}),Object.defineProperty(B,"RenderingCancelledException",{enumerable:!0,get:function(){return D.RenderingCancelledException}}),Object.defineProperty(B,"SVGGraphics",{enumerable:!0,get:function(){return O.SVGGraphics}}),Object.defineProperty(B,"UnexpectedResponseException",{enumerable:!0,get:function(){return F.UnexpectedResponseException}}),Object.defineProperty(B,"Util",{enumerable:!0,get:function(){return F.Util}}),Object.defineProperty(B,"VerbosityLevel",{enumerable:!0,get:function(){return F.VerbosityLevel}}),Object.defineProperty(B,"XfaLayer",{enumerable:!0,get:function(){return dt.XfaLayer}}),Object.defineProperty(B,"build",{enumerable:!0,get:function(){return O.build}}),Object.defineProperty(B,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return F.createValidAbsoluteUrl}}),Object.defineProperty(B,"getDocument",{enumerable:!0,get:function(){return O.getDocument}}),Object.defineProperty(B,"getFilenameFromUrl",{enumerable:!0,get:function(){return D.getFilenameFromUrl}}),Object.defineProperty(B,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return D.getPdfFilenameFromUrl}}),Object.defineProperty(B,"getXfaPageViewport",{enumerable:!0,get:function(){return D.getXfaPageViewport}}),Object.defineProperty(B,"isDataScheme",{enumerable:!0,get:function(){return D.isDataScheme}}),Object.defineProperty(B,"isPdfFile",{enumerable:!0,get:function(){return D.isPdfFile}}),Object.defineProperty(B,"loadScript",{enumerable:!0,get:function(){return D.loadScript}}),Object.defineProperty(B,"noContextMenu",{enumerable:!0,get:function(){return D.noContextMenu}}),Object.defineProperty(B,"normalizeUnicode",{enumerable:!0,get:function(){return F.normalizeUnicode}}),Object.defineProperty(B,"renderTextLayer",{enumerable:!0,get:function(){return U.renderTextLayer}}),Object.defineProperty(B,"setLayerDimensions",{enumerable:!0,get:function(){return D.setLayerDimensions}}),Object.defineProperty(B,"shadow",{enumerable:!0,get:function(){return F.shadow}}),Object.defineProperty(B,"updateTextLayer",{enumerable:!0,get:function(){return U.updateTextLayer}}),Object.defineProperty(B,"version",{enumerable:!0,get:function(){return O.version}});var F=__w_pdfjs_require__(1),O=__w_pdfjs_require__(2),D=__w_pdfjs_require__(6),U=__w_pdfjs_require__(26),tt=__w_pdfjs_require__(27),Q=__w_pdfjs_require__(5),Ft=__w_pdfjs_require__(29),ht=__w_pdfjs_require__(14),dt=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,__defProp$3=Object.defineProperty,__getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$3(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$3(F,O,U),U};pdfExports.GlobalWorkerOptions.workerSrc="pdf.worker.js";let PDFViewer=class extends s{constructor(){super(...arguments),this.tabIndex=0,this._onkeydown=B=>{B.key==="ArrowRight"?(this.position++,this.fireSelectEvent()):B.key==="ArrowLeft"&&(this.position--,this.fireSelectEvent())},this._touchStart={x:0,y:0},this._onTouchStart=B=>{this._touchStart={x:B.touches[0].clientX,y:B.touches[0].clientY}},this._onTouchEnd=B=>{const F=B.changedTouches[0].clientX,O=B.changedTouches[0].clientY,D=50;absoluteDistance(this._touchStart.y,O)>absoluteDistance(this._touchStart.x,F)||(this._touchStart.x-F>D?(this.position++,this.fireSelectEvent()):F-this._touchStart.x>D&&(this.position--,this.fireSelectEvent()))}}render(){return x`
      <slot>
        <p>
          Get your sheet together!
          <br>
          Load a PDF 
          <br>
          or try <a href="#" @click=${()=>this.load("martin.pdf")}>Bratec Martin</a> example
        </p>
      </slot>
      <div id="indicator">
        <div id="progress" style="width: ${(this.pct??0)*100}%"></div>
      </div>
    `}async load(B){this.innerHTML="";const F=window.devicePixelRatio||1,O=await pdfExports.getDocument(B).promise;for(let D=0;D<O.numPages;D++){const U=await O.getPage(D+1),tt=U.getViewport({scale:1}),Q=document.createElement("canvas"),Ft=Q.getContext("2d");Q.height=tt.height*F,Q.width=tt.width*F,this.appendChild(Q),Q.onclick=()=>{this.position=D,this.fireSelectEvent()};const ht=F!==1?[F,0,0,F,0,0]:void 0;await U.render({canvasContext:Ft,viewport:tt,transform:ht}).promise}}set position(B){if(B===this.position)return;const F=[...this.children];if(B<0||B>=F.length)return;const O=F[B];F.forEach(D=>D.removeAttribute("selected")),O.setAttribute("selected",""),O.scrollIntoView({block:"center"})}get position(){return[...this.children].findIndex(B=>B.hasAttribute("selected"))}connectedCallback(){var B;super.connectedCallback(),this.addEventListener("keydown",this._onkeydown),this.addEventListener("touchstart",this._onTouchStart),this.addEventListener("touchend",this._onTouchEnd),(B=window.ipcRenderer)==null||B.on("page",(F,O)=>{this.position=O})}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("keydown",this._onkeydown),this.removeEventListener("touchstart",this._onTouchStart),this.removeEventListener("touchend",this._onTouchEnd)}fireSelectEvent(){var B;(B=window.ipcRenderer)==null||B.send("page",this.position),this.dispatchEvent(new CustomEvent("select",{detail:this.position}))}};PDFViewer.styles=i$3`
    :host {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: center;
      align-items: center;
      overflow: auto;
      padding: 0.5rem;
      outline: none;
      box-sizing: border-box;
    }
    :host:focus {
      background: var(--theme-color-background-light);
    }
    :host:fullscreen {
      background: black;
    }
    ::slotted(canvas) {
      max-height: 100%;
      max-width: 100%;
    }
    ::slotted(canvas[selected]) {
      box-shadow: 0 0 0 5px var(--theme-color-secondary);
    }
    p {
      text-align: center;
    }

    #indicator {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 5px;
      overflow: hidden;
    }
    #progress {
      width: 0;
      height: 100%;
      background: var(--theme-color-primary);
      transition: width 0.5s;
    }

  `;__decorateClass$3([n({type:Number})],PDFViewer.prototype,"pct",2);PDFViewer=__decorateClass$3([t("pdf-viewer")],PDFViewer);var __defProp$2=Object.defineProperty,__getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$2(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$2(F,O,U),U};const storage=localStorage.getItem("recognitionOptions"),recognitionOptions=storage?JSON.parse(storage):{minDistance:7,maxDistance:42,seekStep:2.6,treshold:100},descriptions={minDistance:"Shortest seek distance from current frame.",maxDistance:"Longest seek distance from current frame.",seekStep:"How many frames to add to seek distance when recognizer predicts the same frame as before.",treshold:"How different can current microphone data be compared to a frame from recording to be considered a match. 0 means identical, 255 means completely different."};let RecognitionOptions=class extends s{constructor(){super(...arguments),this.minDistance=recognitionOptions.minDistance,this.maxDistance=recognitionOptions.maxDistance,this.seekStep=recognitionOptions.seekStep,this.treshold=recognitionOptions.treshold}render(){return x`
      <div>
        <label for="minDistance" title=${descriptions.minDistance}>Min Distance</label>
        <input 
          type="number" id="minDistance"
          min="1" max=${this.maxDistance-1}
          .value=${this.minDistance.toString()} 
          @change=${B=>{this.minDistance=Number(B.target.value),this.maxDistance=Math.max(this.minDistance+1,this.maxDistance)}} />
      </div>
      <div>
        <label for="maxDistance" title=${descriptions.maxDistance}>Max Distance</label>
        <input 
          type="number" id="maxDistance" 
          min=${this.minDistance+1}
          .value=${this.maxDistance.toString()}
          @change=${B=>{this.maxDistance=Number(B.target.value),this.minDistance=Math.max(0,Math.min(this.maxDistance-1,this.minDistance))}} />
      </div>
      <div>
        <label for="seekStep" title=${descriptions.seekStep}>Seek Step</label>
        <input 
          type="number" id="seekStep"
          step=".1" min="1"
          .value=${this.seekStep.toString()} 
          @change=${B=>this.seekStep=Number(B.target.value)} />
      </div>
      <div>
        <label for="treshold" title=${descriptions.treshold}>Treshold</label>
        <input 
          type="number" id="treshold" 
          min="0" max="255" 
          .value=${this.treshold.toString()} 
          @input=${B=>this.treshold=Number(B.target.value)} 
        />
      </div>
    `}updated(){localStorage.setItem("recognitionOptions",JSON.stringify({minDistance:this.minDistance,maxDistance:this.maxDistance,seekStep:this.seekStep,treshold:this.treshold}))}};RecognitionOptions.styles=i$3`
    :host {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 1em;
      justify-content: center;
      margin: 0 auto;
    }
    div {
      min-width: 120px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
    }
    input {
      margin: 0.5em 0;
      width: 6ch;
    }

  `;__decorateClass$2([n({type:Number})],RecognitionOptions.prototype,"minDistance",2);__decorateClass$2([n({type:Number})],RecognitionOptions.prototype,"maxDistance",2);__decorateClass$2([n({type:Number})],RecognitionOptions.prototype,"seekStep",2);__decorateClass$2([n({type:Number})],RecognitionOptions.prototype,"treshold",2);RecognitionOptions=__decorateClass$2([t("recognition-options")],RecognitionOptions);var __defProp$1=Object.defineProperty,__getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc$1(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp$1(F,O,U),U};let MarkingsEditor=class extends s{constructor(){super(...arguments),this.markSuggestion=1}render(){return this.recording?x`
      <div class="container">
        ${this.recording.markings.map((B,F)=>{const[O,D]=B;return x`
            <div 
              class="mark" 
              style="left: ${O/this.recording.data.length*100}%" 
              @click=${()=>{this.dispatchEvent(new CustomEvent("select",{detail:{position:O,mark:D}}))}} 
              @dblclick=${()=>{this.recording.markings.splice(F,1),this.requestUpdate(),this.fireChangeEvent(),this.markSuggestion=D}} 
            >${D.toString()}</div>
          `})}
      </div>
    `:null}async add(B){const F=await popup(x`
        <h3>Create Mark</h3>
        <p>Double click on a mark to remove it</p>
      `,x`
        <label for="page">Page number</label>
        <input id="page" type="number" value=${this.markSuggestion} min="1" max=${this.recording.data.length} >
      `);if(!F)return;const O=parseInt(F.get("page"));!O||O<1||(this.markSuggestion=O+1,this.recording.markings.push([B,O]),this.recording.markings.sort((D,U)=>D[0]-U[0]),this.requestUpdate(),this.fireChangeEvent())}fireChangeEvent(){this.dispatchEvent(new CustomEvent("change"))}};MarkingsEditor.styles=[buttonStyle,i$3`
      :host {
        display: block;
        text-align: center;
      }
      .container {
        position: relative;
        height: 1rem;
        margin-bottom: .5rem;
      }
      .mark {
        position: absolute;
        transform: translateX(-50%);
        border-radius: 50%;
        background: var(--theme-color-background-light);
        width: 1rem;
        height: 1rem;
        font-size: .7rem;
        line-height: 1rem;
        text-align: center;
        cursor: pointer;
        user-select: none;
      }
      .mark::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        transform: translate(-50%, -20%) rotate(45deg);
        width: .5rem;
        height: .5rem;
        background: var(--theme-color-background-light);
        z-index: -1;
      }
    `];__decorateClass$1([n({type:Object})],MarkingsEditor.prototype,"recording",2);MarkingsEditor=__decorateClass$1([t("markings-editor")],MarkingsEditor);const inputStyle=i$3`
  input {
    background: var(--theme-color-background-light);
    border: none;
    outline: none;
    display: block;
    /* box-sizing: border-box; */
  }

  input[type="range"] {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    margin: .4em 0;
    border-radius: .1em;
    cursor: pointer;
  }
  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    width: .2em;
    height: .2em;
    border-radius: .1em;
    background: var(--theme-color-primary);
    transform: scale(5);
  }
  input[type="range"]:focus::-webkit-slider-thumb {
    transform: scale(6);
  }

`;function promisifyRequest(B){return new Promise((F,O)=>{B.oncomplete=B.onsuccess=()=>F(B.result),B.onabort=B.onerror=()=>O(B.error)})}function createStore(B,F){const O=indexedDB.open(B);O.onupgradeneeded=()=>O.result.createObjectStore(F);const D=promisifyRequest(O);return(U,tt)=>D.then(Q=>tt(Q.transaction(F,U).objectStore(F)))}let defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get(B,F=defaultGetStore()){return F("readonly",O=>promisifyRequest(O.get(B)))}function set(B,F,O=defaultGetStore()){return O("readwrite",D=>(D.put(F,B),promisifyRequest(D.transaction)))}const PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(B=>{PACKET_TYPES_REVERSE[PACKET_TYPES[B]]=B});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=B=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(B):B&&B.buffer instanceof ArrayBuffer,encodePacket=({type:B,data:F},O,D)=>withNativeBlob$1&&F instanceof Blob?O?D(F):encodeBlobAsBase64(F,D):withNativeArrayBuffer$2&&(F instanceof ArrayBuffer||isView$1(F))?O?D(F):encodeBlobAsBase64(new Blob([F]),D):D(PACKET_TYPES[B]+(F||"")),encodeBlobAsBase64=(B,F)=>{const O=new FileReader;return O.onload=function(){const D=O.result.split(",")[1];F("b"+(D||""))},O.readAsDataURL(B)};function toArray(B){return B instanceof Uint8Array?B:B instanceof ArrayBuffer?new Uint8Array(B):new Uint8Array(B.buffer,B.byteOffset,B.byteLength)}let TEXT_ENCODER;function encodePacketToBinary(B,F){if(withNativeBlob$1&&B.data instanceof Blob)return B.data.arrayBuffer().then(toArray).then(F);if(withNativeArrayBuffer$2&&(B.data instanceof ArrayBuffer||isView$1(B.data)))return F(toArray(B.data));encodePacket(B,!1,O=>{TEXT_ENCODER||(TEXT_ENCODER=new TextEncoder),F(TEXT_ENCODER.encode(O))})}const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let B=0;B<chars.length;B++)lookup$1[chars.charCodeAt(B)]=B;const decode$1=B=>{let F=B.length*.75,O=B.length,D,U=0,tt,Q,Ft,ht;B[B.length-1]==="="&&(F--,B[B.length-2]==="="&&F--);const dt=new ArrayBuffer(F),st=new Uint8Array(dt);for(D=0;D<O;D+=4)tt=lookup$1[B.charCodeAt(D)],Q=lookup$1[B.charCodeAt(D+1)],Ft=lookup$1[B.charCodeAt(D+2)],ht=lookup$1[B.charCodeAt(D+3)],st[U++]=tt<<2|Q>>4,st[U++]=(Q&15)<<4|Ft>>2,st[U++]=(Ft&3)<<6|ht&63;return dt},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(B,F)=>{if(typeof B!="string")return{type:"message",data:mapBinary(B,F)};const O=B.charAt(0);return O==="b"?{type:"message",data:decodeBase64Packet(B.substring(1),F)}:PACKET_TYPES_REVERSE[O]?B.length>1?{type:PACKET_TYPES_REVERSE[O],data:B.substring(1)}:{type:PACKET_TYPES_REVERSE[O]}:ERROR_PACKET},decodeBase64Packet=(B,F)=>{if(withNativeArrayBuffer$1){const O=decode$1(B);return mapBinary(O,F)}else return{base64:!0,data:B}},mapBinary=(B,F)=>{switch(F){case"blob":return B instanceof Blob?B:new Blob([B]);case"arraybuffer":default:return B instanceof ArrayBuffer?B:B.buffer}},SEPARATOR=String.fromCharCode(30),encodePayload=(B,F)=>{const O=B.length,D=new Array(O);let U=0;B.forEach((tt,Q)=>{encodePacket(tt,!1,Ft=>{D[Q]=Ft,++U===O&&F(D.join(SEPARATOR))})})},decodePayload=(B,F)=>{const O=B.split(SEPARATOR),D=[];for(let U=0;U<O.length;U++){const tt=decodePacket(O[U],F);if(D.push(tt),tt.type==="error")break}return D};function createPacketEncoderStream(){return new TransformStream({transform(B,F){encodePacketToBinary(B,O=>{const D=O.length;let U;if(D<126)U=new Uint8Array(1),new DataView(U.buffer).setUint8(0,D);else if(D<65536){U=new Uint8Array(3);const tt=new DataView(U.buffer);tt.setUint8(0,126),tt.setUint16(1,D)}else{U=new Uint8Array(9);const tt=new DataView(U.buffer);tt.setUint8(0,127),tt.setBigUint64(1,BigInt(D))}B.data&&typeof B.data!="string"&&(U[0]|=128),F.enqueue(U),F.enqueue(O)})}})}let TEXT_DECODER;function totalLength(B){return B.reduce((F,O)=>F+O.length,0)}function concatChunks(B,F){if(B[0].length===F)return B.shift();const O=new Uint8Array(F);let D=0;for(let U=0;U<F;U++)O[U]=B[0][D++],D===B[0].length&&(B.shift(),D=0);return B.length&&D<B[0].length&&(B[0]=B[0].slice(D)),O}function createPacketDecoderStream(B,F){TEXT_DECODER||(TEXT_DECODER=new TextDecoder);const O=[];let D=0,U=-1,tt=!1;return new TransformStream({transform(Q,Ft){for(O.push(Q);;){if(D===0){if(totalLength(O)<1)break;const ht=concatChunks(O,1);tt=(ht[0]&128)===128,U=ht[0]&127,U<126?D=3:U===126?D=1:D=2}else if(D===1){if(totalLength(O)<2)break;const ht=concatChunks(O,2);U=new DataView(ht.buffer,ht.byteOffset,ht.length).getUint16(0),D=3}else if(D===2){if(totalLength(O)<8)break;const ht=concatChunks(O,8),dt=new DataView(ht.buffer,ht.byteOffset,ht.length),st=dt.getUint32(0);if(st>Math.pow(2,53-32)-1){Ft.enqueue(ERROR_PACKET);break}U=st*Math.pow(2,32)+dt.getUint32(4),D=3}else{if(totalLength(O)<U)break;const ht=concatChunks(O,U);Ft.enqueue(decodePacket(tt?ht:TEXT_DECODER.decode(ht),F)),D=0}if(U===0||U>B){Ft.enqueue(ERROR_PACKET);break}}}})}const protocol$1=4;function Emitter(B){if(B)return mixin(B)}function mixin(B){for(var F in Emitter.prototype)B[F]=Emitter.prototype[F];return B}Emitter.prototype.on=Emitter.prototype.addEventListener=function(B,F){return this._callbacks=this._callbacks||{},(this._callbacks["$"+B]=this._callbacks["$"+B]||[]).push(F),this};Emitter.prototype.once=function(B,F){function O(){this.off(B,O),F.apply(this,arguments)}return O.fn=F,this.on(B,O),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(B,F){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var O=this._callbacks["$"+B];if(!O)return this;if(arguments.length==1)return delete this._callbacks["$"+B],this;for(var D,U=0;U<O.length;U++)if(D=O[U],D===F||D.fn===F){O.splice(U,1);break}return O.length===0&&delete this._callbacks["$"+B],this};Emitter.prototype.emit=function(B){this._callbacks=this._callbacks||{};for(var F=new Array(arguments.length-1),O=this._callbacks["$"+B],D=1;D<arguments.length;D++)F[D-1]=arguments[D];if(O){O=O.slice(0);for(var D=0,U=O.length;D<U;++D)O[D].apply(this,F)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(B){return this._callbacks=this._callbacks||{},this._callbacks["$"+B]||[]};Emitter.prototype.hasListeners=function(B){return!!this.listeners(B).length};const globalThisShim=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function pick(B,...F){return F.reduce((O,D)=>(B.hasOwnProperty(D)&&(O[D]=B[D]),O),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(B,F){F.useNativeTimers?(B.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),B.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(B.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),B.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(B){return typeof B=="string"?utf8Length(B):Math.ceil((B.byteLength||B.size)*BASE64_OVERHEAD)}function utf8Length(B){let F=0,O=0;for(let D=0,U=B.length;D<U;D++)F=B.charCodeAt(D),F<128?O+=1:F<2048?O+=2:F<55296||F>=57344?O+=3:(D++,O+=4);return O}function encode$1(B){let F="";for(let O in B)B.hasOwnProperty(O)&&(F.length&&(F+="&"),F+=encodeURIComponent(O)+"="+encodeURIComponent(B[O]));return F}function decode(B){let F={},O=B.split("&");for(let D=0,U=O.length;D<U;D++){let tt=O[D].split("=");F[decodeURIComponent(tt[0])]=decodeURIComponent(tt[1])}return F}class TransportError extends Error{constructor(F,O,D){super(F),this.description=O,this.context=D,this.type="TransportError"}}class Transport extends Emitter{constructor(F){super(),this.writable=!1,installTimerFunctions(this,F),this.opts=F,this.query=F.query,this.socket=F.socket}onError(F,O,D){return super.emitReserved("error",new TransportError(F,O,D)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(F){this.readyState==="open"&&this.write(F)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(F){const O=decodePacket(F,this.socket.binaryType);this.onPacket(O)}onPacket(F){super.emitReserved("packet",F)}onClose(F){this.readyState="closed",super.emitReserved("close",F)}pause(F){}createUri(F,O={}){return F+"://"+this._hostname()+this._port()+this.opts.path+this._query(O)}_hostname(){const F=this.opts.hostname;return F.indexOf(":")===-1?F:"["+F+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(F){const O=encode$1(F);return O.length?"?"+O:""}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={};let seed=0,i=0,prev;function encode(B){let F="";do F=alphabet[B%length]+F,B=Math.floor(B/length);while(B>0);return F}function yeast(){const B=encode(+new Date);return B!==prev?(seed=0,prev=B):B+"."+encode(seed++)}for(;i<length;i++)map[alphabet[i]]=i;let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch(B){}const hasCORS=value;function XHR(B){const F=B.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!F||hasCORS))return new XMLHttpRequest}catch{}if(!F)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function createCookieJar(){}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(F){if(super(F),this.polling=!1,typeof location<"u"){const D=location.protocol==="https:";let U=location.port;U||(U=D?"443":"80"),this.xd=typeof location<"u"&&F.hostname!==location.hostname||U!==F.port}const O=F&&F.forceBase64;this.supportsBinary=hasXHR2&&!O,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(F){this.readyState="pausing";const O=()=>{this.readyState="paused",F()};if(this.polling||!this.writable){let D=0;this.polling&&(D++,this.once("pollComplete",function(){--D||O()})),this.writable||(D++,this.once("drain",function(){--D||O()}))}else O()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(F){const O=D=>{if(this.readyState==="opening"&&D.type==="open"&&this.onOpen(),D.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(D)};decodePayload(F,this.socket.binaryType).forEach(O),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const F=()=>{this.write([{type:"close"}])};this.readyState==="open"?F():this.once("open",F)}write(F){this.writable=!1,encodePayload(F,O=>{this.doWrite(O,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const F=this.opts.secure?"https":"http",O=this.query||{};return this.opts.timestampRequests!==!1&&(O[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!O.sid&&(O.b64=1),this.createUri(F,O)}request(F={}){return Object.assign(F,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Request(this.uri(),F)}doWrite(F,O){const D=this.request({method:"POST",data:F});D.on("success",O),D.on("error",(U,tt)=>{this.onError("xhr post error",U,tt)})}doPoll(){const F=this.request();F.on("data",this.onData.bind(this)),F.on("error",(O,D)=>{this.onError("xhr poll error",O,D)}),this.pollXhr=F}}class Request extends Emitter{constructor(F,O){super(),installTimerFunctions(this,O),this.opts=O,this.method=O.method||"GET",this.uri=F,this.data=O.data!==void 0?O.data:null,this.create()}create(){var F;const O=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");O.xdomain=!!this.opts.xd;const D=this.xhr=new XHR(O);try{D.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){D.setDisableHeaderCheck&&D.setDisableHeaderCheck(!0);for(let U in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(U)&&D.setRequestHeader(U,this.opts.extraHeaders[U])}}catch{}if(this.method==="POST")try{D.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{D.setRequestHeader("Accept","*/*")}catch{}(F=this.opts.cookieJar)===null||F===void 0||F.addCookies(D),"withCredentials"in D&&(D.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(D.timeout=this.opts.requestTimeout),D.onreadystatechange=()=>{var U;D.readyState===3&&((U=this.opts.cookieJar)===null||U===void 0||U.parseCookies(D)),D.readyState===4&&(D.status===200||D.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof D.status=="number"?D.status:0)},0))},D.send(this.data)}catch(U){this.setTimeoutFn(()=>{this.onError(U)},0);return}typeof document<"u"&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(F){this.emitReserved("error",F,this.xhr),this.cleanup(!0)}cleanup(F){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,F)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Request.requests[this.index],this.xhr=null}}onLoad(){const F=this.xhr.responseText;F!==null&&(this.emitReserved("data",F),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Request.requestsCount=0;Request.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const B="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(B,unloadHandler,!1)}}function unloadHandler(){for(let B in Request.requests)Request.requests.hasOwnProperty(B)&&Request.requests[B].abort()}const nextTick=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?F=>Promise.resolve().then(F):(F,O)=>O(F,0))(),WebSocket=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class WS extends Transport{constructor(F){super(F),this.supportsBinary=!F.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const F=this.uri(),O=this.opts.protocols,D=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(D.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?O?new WebSocket(F,O):new WebSocket(F):new WebSocket(F,O,D)}catch(U){return this.emitReserved("error",U)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=F=>this.onClose({description:"websocket connection closed",context:F}),this.ws.onmessage=F=>this.onData(F.data),this.ws.onerror=F=>this.onError("websocket error",F)}write(F){this.writable=!1;for(let O=0;O<F.length;O++){const D=F[O],U=O===F.length-1;encodePacket(D,this.supportsBinary,tt=>{const Q={};try{usingBrowserWebSocket&&this.ws.send(tt)}catch{}U&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const F=this.opts.secure?"wss":"ws",O=this.query||{};return this.opts.timestampRequests&&(O[this.opts.timestampParam]=yeast()),this.supportsBinary||(O.b64=1),this.createUri(F,O)}check(){return!!WebSocket}}class WT extends Transport{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(F=>{this.onError("webtransport error",F)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(F=>{const O=createPacketDecoderStream(Number.MAX_SAFE_INTEGER,this.socket.binaryType),D=F.readable.pipeThrough(O).getReader(),U=createPacketEncoderStream();U.readable.pipeTo(F.writable),this.writer=U.writable.getWriter();const tt=()=>{D.read().then(({done:Ft,value:ht})=>{Ft||(this.onPacket(ht),tt())}).catch(Ft=>{})};tt();const Q={type:"open"};this.query.sid&&(Q.data=`{"sid":"${this.query.sid}"}`),this.writer.write(Q).then(()=>this.onOpen())})}))}write(F){this.writable=!1;for(let O=0;O<F.length;O++){const D=F[O],U=O===F.length-1;this.writer.write(D).then(()=>{U&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var F;(F=this.transport)===null||F===void 0||F.close()}}const transports={websocket:WS,webtransport:WT,polling:Polling},re=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(B){if(B.length>2e3)throw"URI too long";const F=B,O=B.indexOf("["),D=B.indexOf("]");O!=-1&&D!=-1&&(B=B.substring(0,O)+B.substring(O,D).replace(/:/g,";")+B.substring(D,B.length));let U=re.exec(B||""),tt={},Q=14;for(;Q--;)tt[parts[Q]]=U[Q]||"";return O!=-1&&D!=-1&&(tt.source=F,tt.host=tt.host.substring(1,tt.host.length-1).replace(/;/g,":"),tt.authority=tt.authority.replace("[","").replace("]","").replace(/;/g,":"),tt.ipv6uri=!0),tt.pathNames=pathNames(tt,tt.path),tt.queryKey=queryKey(tt,tt.query),tt}function pathNames(B,F){const O=/\/{2,9}/g,D=F.replace(O,"/").split("/");return(F.slice(0,1)=="/"||F.length===0)&&D.splice(0,1),F.slice(-1)=="/"&&D.splice(D.length-1,1),D}function queryKey(B,F){const O={};return F.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(D,U,tt){U&&(O[U]=tt)}),O}let Socket$1=class ii extends Emitter{constructor(F,O={}){super(),this.binaryType=defaultBinaryType,this.writeBuffer=[],F&&typeof F=="object"&&(O=F,F=null),F?(F=parse(F),O.hostname=F.host,O.secure=F.protocol==="https"||F.protocol==="wss",O.port=F.port,F.query&&(O.query=F.query)):O.host&&(O.hostname=parse(O.host).host),installTimerFunctions(this,O),this.secure=O.secure!=null?O.secure:typeof location<"u"&&location.protocol==="https:",O.hostname&&!O.port&&(O.port=this.secure?"443":"80"),this.hostname=O.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=O.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=O.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},O),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(F){const O=Object.assign({},this.opts.query);O.EIO=protocol$1,O.transport=F,this.id&&(O.sid=this.id);const D=Object.assign({},this.opts,{query:O,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[F]);return new transports[F](D)}open(){let F;if(this.opts.rememberUpgrade&&ii.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)F="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else F=this.transports[0];this.readyState="opening";try{F=this.createTransport(F)}catch{this.transports.shift(),this.open();return}F.open(),this.setTransport(F)}setTransport(F){this.transport&&this.transport.removeAllListeners(),this.transport=F,F.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",O=>this.onClose("transport close",O))}probe(F){let O=this.createTransport(F),D=!1;ii.priorWebsocketSuccess=!1;const U=()=>{D||(O.send([{type:"ping",data:"probe"}]),O.once("packet",yt=>{if(!D)if(yt.type==="pong"&&yt.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",O),!O)return;ii.priorWebsocketSuccess=O.name==="websocket",this.transport.pause(()=>{D||this.readyState!=="closed"&&(st(),this.setTransport(O),O.send([{type:"upgrade"}]),this.emitReserved("upgrade",O),O=null,this.upgrading=!1,this.flush())})}else{const Tt=new Error("probe error");Tt.transport=O.name,this.emitReserved("upgradeError",Tt)}}))};function tt(){D||(D=!0,st(),O.close(),O=null)}const Q=yt=>{const Tt=new Error("probe error: "+yt);Tt.transport=O.name,tt(),this.emitReserved("upgradeError",Tt)};function Ft(){Q("transport closed")}function ht(){Q("socket closed")}function dt(yt){O&&yt.name!==O.name&&tt()}const st=()=>{O.removeListener("open",U),O.removeListener("error",Q),O.removeListener("close",Ft),this.off("close",ht),this.off("upgrading",dt)};O.once("open",U),O.once("error",Q),O.once("close",Ft),this.once("close",ht),this.once("upgrading",dt),this.upgrades.indexOf("webtransport")!==-1&&F!=="webtransport"?this.setTimeoutFn(()=>{D||O.open()},200):O.open()}onOpen(){if(this.readyState="open",ii.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let F=0;const O=this.upgrades.length;for(;F<O;F++)this.probe(this.upgrades[F])}}onPacket(F){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",F),this.emitReserved("heartbeat"),this.resetPingTimeout(),F.type){case"open":this.onHandshake(JSON.parse(F.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const O=new Error("server error");O.code=F.data,this.onError(O);break;case"message":this.emitReserved("data",F.data),this.emitReserved("message",F.data);break}}onHandshake(F){this.emitReserved("handshake",F),this.id=F.sid,this.transport.query.sid=F.sid,this.upgrades=this.filterUpgrades(F.upgrades),this.pingInterval=F.pingInterval,this.pingTimeout=F.pingTimeout,this.maxPayload=F.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const F=this.getWritablePackets();this.transport.send(F),this.prevBufferLen=F.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let O=1;for(let D=0;D<this.writeBuffer.length;D++){const U=this.writeBuffer[D].data;if(U&&(O+=byteLength(U)),D>0&&O>this.maxPayload)return this.writeBuffer.slice(0,D);O+=2}return this.writeBuffer}write(F,O,D){return this.sendPacket("message",F,O,D),this}send(F,O,D){return this.sendPacket("message",F,O,D),this}sendPacket(F,O,D,U){if(typeof O=="function"&&(U=O,O=void 0),typeof D=="function"&&(U=D,D=null),this.readyState==="closing"||this.readyState==="closed")return;D=D||{},D.compress=D.compress!==!1;const tt={type:F,data:O,options:D};this.emitReserved("packetCreate",tt),this.writeBuffer.push(tt),U&&this.once("flush",U),this.flush()}close(){const F=()=>{this.onClose("forced close"),this.transport.close()},O=()=>{this.off("upgrade",O),this.off("upgradeError",O),F()},D=()=>{this.once("upgrade",O),this.once("upgradeError",O)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?D():F()}):this.upgrading?D():F()),this}onError(F){ii.priorWebsocketSuccess=!1,this.emitReserved("error",F),this.onClose("transport error",F)}onClose(F,O){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",F,O),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(F){const O=[];let D=0;const U=F.length;for(;D<U;D++)~this.transports.indexOf(F[D])&&O.push(F[D]);return O}};Socket$1.protocol=protocol$1;function url(B,F="",O){let D=B;O=O||typeof location<"u"&&location,B==null&&(B=O.protocol+"//"+O.host),typeof B=="string"&&(B.charAt(0)==="/"&&(B.charAt(1)==="/"?B=O.protocol+B:B=O.host+B),/^(https?|wss?):\/\//.test(B)||(typeof O<"u"?B=O.protocol+"//"+B:B="https://"+B),D=parse(B)),D.port||(/^(http|ws)$/.test(D.protocol)?D.port="80":/^(http|ws)s$/.test(D.protocol)&&(D.port="443")),D.path=D.path||"/";const tt=D.host.indexOf(":")!==-1?"["+D.host+"]":D.host;return D.id=D.protocol+"://"+tt+":"+D.port+F,D.href=D.protocol+"://"+tt+(O&&O.port===D.port?"":":"+D.port),D}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=B=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(B):B.buffer instanceof ArrayBuffer,toString=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString.call(File)==="[object FileConstructor]";function isBinary(B){return withNativeArrayBuffer&&(B instanceof ArrayBuffer||isView(B))||withNativeBlob&&B instanceof Blob||withNativeFile&&B instanceof File}function hasBinary(B,F){if(!B||typeof B!="object")return!1;if(Array.isArray(B)){for(let O=0,D=B.length;O<D;O++)if(hasBinary(B[O]))return!0;return!1}if(isBinary(B))return!0;if(B.toJSON&&typeof B.toJSON=="function"&&arguments.length===1)return hasBinary(B.toJSON(),!0);for(const O in B)if(Object.prototype.hasOwnProperty.call(B,O)&&hasBinary(B[O]))return!0;return!1}function deconstructPacket(B){const F=[],O=B.data,D=B;return D.data=_deconstructPacket(O,F),D.attachments=F.length,{packet:D,buffers:F}}function _deconstructPacket(B,F){if(!B)return B;if(isBinary(B)){const O={_placeholder:!0,num:F.length};return F.push(B),O}else if(Array.isArray(B)){const O=new Array(B.length);for(let D=0;D<B.length;D++)O[D]=_deconstructPacket(B[D],F);return O}else if(typeof B=="object"&&!(B instanceof Date)){const O={};for(const D in B)Object.prototype.hasOwnProperty.call(B,D)&&(O[D]=_deconstructPacket(B[D],F));return O}return B}function reconstructPacket(B,F){return B.data=_reconstructPacket(B.data,F),delete B.attachments,B}function _reconstructPacket(B,F){if(!B)return B;if(B&&B._placeholder===!0){if(typeof B.num=="number"&&B.num>=0&&B.num<F.length)return F[B.num];throw new Error("illegal attachments")}else if(Array.isArray(B))for(let O=0;O<B.length;O++)B[O]=_reconstructPacket(B[O],F);else if(typeof B=="object")for(const O in B)Object.prototype.hasOwnProperty.call(B,O)&&(B[O]=_reconstructPacket(B[O],F));return B}const RESERVED_EVENTS$1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],protocol=5;var PacketType;(function(B){B[B.CONNECT=0]="CONNECT",B[B.DISCONNECT=1]="DISCONNECT",B[B.EVENT=2]="EVENT",B[B.ACK=3]="ACK",B[B.CONNECT_ERROR=4]="CONNECT_ERROR",B[B.BINARY_EVENT=5]="BINARY_EVENT",B[B.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder{constructor(F){this.replacer=F}encode(F){return(F.type===PacketType.EVENT||F.type===PacketType.ACK)&&hasBinary(F)?this.encodeAsBinary({type:F.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:F.nsp,data:F.data,id:F.id}):[this.encodeAsString(F)]}encodeAsString(F){let O=""+F.type;return(F.type===PacketType.BINARY_EVENT||F.type===PacketType.BINARY_ACK)&&(O+=F.attachments+"-"),F.nsp&&F.nsp!=="/"&&(O+=F.nsp+","),F.id!=null&&(O+=F.id),F.data!=null&&(O+=JSON.stringify(F.data,this.replacer)),O}encodeAsBinary(F){const O=deconstructPacket(F),D=this.encodeAsString(O.packet),U=O.buffers;return U.unshift(D),U}}function isObject(B){return Object.prototype.toString.call(B)==="[object Object]"}class Decoder extends Emitter{constructor(F){super(),this.reviver=F}add(F){let O;if(typeof F=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");O=this.decodeString(F);const D=O.type===PacketType.BINARY_EVENT;D||O.type===PacketType.BINARY_ACK?(O.type=D?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor(O),O.attachments===0&&super.emitReserved("decoded",O)):super.emitReserved("decoded",O)}else if(isBinary(F)||F.base64)if(this.reconstructor)O=this.reconstructor.takeBinaryData(F),O&&(this.reconstructor=null,super.emitReserved("decoded",O));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+F)}decodeString(F){let O=0;const D={type:Number(F.charAt(0))};if(PacketType[D.type]===void 0)throw new Error("unknown packet type "+D.type);if(D.type===PacketType.BINARY_EVENT||D.type===PacketType.BINARY_ACK){const tt=O+1;for(;F.charAt(++O)!=="-"&&O!=F.length;);const Q=F.substring(tt,O);if(Q!=Number(Q)||F.charAt(O)!=="-")throw new Error("Illegal attachments");D.attachments=Number(Q)}if(F.charAt(O+1)==="/"){const tt=O+1;for(;++O&&!(F.charAt(O)===","||O===F.length););D.nsp=F.substring(tt,O)}else D.nsp="/";const U=F.charAt(O+1);if(U!==""&&Number(U)==U){const tt=O+1;for(;++O;){const Q=F.charAt(O);if(Q==null||Number(Q)!=Q){--O;break}if(O===F.length)break}D.id=Number(F.substring(tt,O+1))}if(F.charAt(++O)){const tt=this.tryParse(F.substr(O));if(Decoder.isPayloadValid(D.type,tt))D.data=tt;else throw new Error("invalid payload")}return D}tryParse(F){try{return JSON.parse(F,this.reviver)}catch{return!1}}static isPayloadValid(F,O){switch(F){case PacketType.CONNECT:return isObject(O);case PacketType.DISCONNECT:return O===void 0;case PacketType.CONNECT_ERROR:return typeof O=="string"||isObject(O);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray(O)&&(typeof O[0]=="number"||typeof O[0]=="string"&&RESERVED_EVENTS$1.indexOf(O[0])===-1);case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray(O)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(F){this.packet=F,this.buffers=[],this.reconPack=F}takeBinaryData(F){if(this.buffers.push(F),this.buffers.length===this.reconPack.attachments){const O=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),O}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.defineProperty({__proto__:null,Decoder,Encoder,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"});function on(B,F,O){return B.on(F,O),function(){B.off(F,O)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(F,O,D){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=F,this.nsp=O,D&&D.auth&&(this.auth=D.auth),this._opts=Object.assign({},D),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const F=this.io;this.subs=[on(F,"open",this.onopen.bind(this)),on(F,"packet",this.onpacket.bind(this)),on(F,"error",this.onerror.bind(this)),on(F,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...F){return F.unshift("message"),this.emit.apply(this,F),this}emit(F,...O){if(RESERVED_EVENTS.hasOwnProperty(F))throw new Error('"'+F.toString()+'" is a reserved event name');if(O.unshift(F),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(O),this;const D={type:PacketType.EVENT,data:O};if(D.options={},D.options.compress=this.flags.compress!==!1,typeof O[O.length-1]=="function"){const Q=this.ids++,Ft=O.pop();this._registerAckCallback(Q,Ft),D.id=Q}const U=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!U||!this.connected)||(this.connected?(this.notifyOutgoingListeners(D),this.packet(D)):this.sendBuffer.push(D)),this.flags={},this}_registerAckCallback(F,O){var D;const U=(D=this.flags.timeout)!==null&&D!==void 0?D:this._opts.ackTimeout;if(U===void 0){this.acks[F]=O;return}const tt=this.io.setTimeoutFn(()=>{delete this.acks[F];for(let Ft=0;Ft<this.sendBuffer.length;Ft++)this.sendBuffer[Ft].id===F&&this.sendBuffer.splice(Ft,1);O.call(this,new Error("operation has timed out"))},U),Q=(...Ft)=>{this.io.clearTimeoutFn(tt),O.apply(this,Ft)};Q.withError=!0,this.acks[F]=Q}emitWithAck(F,...O){return new Promise((D,U)=>{const tt=(Q,Ft)=>Q?U(Q):D(Ft);tt.withError=!0,O.push(tt),this.emit(F,...O)})}_addToQueue(F){let O;typeof F[F.length-1]=="function"&&(O=F.pop());const D={id:this._queueSeq++,tryCount:0,pending:!1,args:F,flags:Object.assign({fromQueue:!0},this.flags)};F.push((U,...tt)=>D!==this._queue[0]?void 0:(U!==null?D.tryCount>this._opts.retries&&(this._queue.shift(),O&&O(U)):(this._queue.shift(),O&&O(null,...tt)),D.pending=!1,this._drainQueue())),this._queue.push(D),this._drainQueue()}_drainQueue(F=!1){if(!this.connected||this._queue.length===0)return;const O=this._queue[0];O.pending&&!F||(O.pending=!0,O.tryCount++,this.flags=O.flags,this.emit.apply(this,O.args))}packet(F){F.nsp=this.nsp,this.io._packet(F)}onopen(){typeof this.auth=="function"?this.auth(F=>{this._sendConnectPacket(F)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(F){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},F):F})}onerror(F){this.connected||this.emitReserved("connect_error",F)}onclose(F,O){this.connected=!1,delete this.id,this.emitReserved("disconnect",F,O),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(F=>{if(!this.sendBuffer.some(D=>String(D.id)===F)){const D=this.acks[F];delete this.acks[F],D.withError&&D.call(this,new Error("socket has been disconnected"))}})}onpacket(F){if(F.nsp===this.nsp)switch(F.type){case PacketType.CONNECT:F.data&&F.data.sid?this.onconnect(F.data.sid,F.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(F);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(F);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const D=new Error(F.data.message);D.data=F.data.data,this.emitReserved("connect_error",D);break}}onevent(F){const O=F.data||[];F.id!=null&&O.push(this.ack(F.id)),this.connected?this.emitEvent(O):this.receiveBuffer.push(Object.freeze(O))}emitEvent(F){if(this._anyListeners&&this._anyListeners.length){const O=this._anyListeners.slice();for(const D of O)D.apply(this,F)}super.emit.apply(this,F),this._pid&&F.length&&typeof F[F.length-1]=="string"&&(this._lastOffset=F[F.length-1])}ack(F){const O=this;let D=!1;return function(...U){D||(D=!0,O.packet({type:PacketType.ACK,id:F,data:U}))}}onack(F){const O=this.acks[F.id];typeof O=="function"&&(delete this.acks[F.id],O.withError&&F.data.unshift(null),O.apply(this,F.data))}onconnect(F,O){this.id=F,this.recovered=O&&this._pid===O,this._pid=O,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(F=>this.emitEvent(F)),this.receiveBuffer=[],this.sendBuffer.forEach(F=>{this.notifyOutgoingListeners(F),this.packet(F)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(F=>F()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(F){return this.flags.compress=F,this}get volatile(){return this.flags.volatile=!0,this}timeout(F){return this.flags.timeout=F,this}onAny(F){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(F),this}prependAny(F){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(F),this}offAny(F){if(!this._anyListeners)return this;if(F){const O=this._anyListeners;for(let D=0;D<O.length;D++)if(F===O[D])return O.splice(D,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(F){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(F),this}prependAnyOutgoing(F){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(F),this}offAnyOutgoing(F){if(!this._anyOutgoingListeners)return this;if(F){const O=this._anyOutgoingListeners;for(let D=0;D<O.length;D++)if(F===O[D])return O.splice(D,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(F){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const O=this._anyOutgoingListeners.slice();for(const D of O)D.apply(this,F.data)}}}function Backoff(B){B=B||{},this.ms=B.min||100,this.max=B.max||1e4,this.factor=B.factor||2,this.jitter=B.jitter>0&&B.jitter<=1?B.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var B=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var F=Math.random(),O=Math.floor(F*this.jitter*B);B=Math.floor(F*10)&1?B+O:B-O}return Math.min(B,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(B){this.ms=B};Backoff.prototype.setMax=function(B){this.max=B};Backoff.prototype.setJitter=function(B){this.jitter=B};class Manager extends Emitter{constructor(F,O){var D;super(),this.nsps={},this.subs=[],F&&typeof F=="object"&&(O=F,F=void 0),O=O||{},O.path=O.path||"/socket.io",this.opts=O,installTimerFunctions(this,O),this.reconnection(O.reconnection!==!1),this.reconnectionAttempts(O.reconnectionAttempts||1/0),this.reconnectionDelay(O.reconnectionDelay||1e3),this.reconnectionDelayMax(O.reconnectionDelayMax||5e3),this.randomizationFactor((D=O.randomizationFactor)!==null&&D!==void 0?D:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(O.timeout==null?2e4:O.timeout),this._readyState="closed",this.uri=F;const U=O.parser||parser;this.encoder=new U.Encoder,this.decoder=new U.Decoder,this._autoConnect=O.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(F){return arguments.length?(this._reconnection=!!F,this):this._reconnection}reconnectionAttempts(F){return F===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=F,this)}reconnectionDelay(F){var O;return F===void 0?this._reconnectionDelay:(this._reconnectionDelay=F,(O=this.backoff)===null||O===void 0||O.setMin(F),this)}randomizationFactor(F){var O;return F===void 0?this._randomizationFactor:(this._randomizationFactor=F,(O=this.backoff)===null||O===void 0||O.setJitter(F),this)}reconnectionDelayMax(F){var O;return F===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=F,(O=this.backoff)===null||O===void 0||O.setMax(F),this)}timeout(F){return arguments.length?(this._timeout=F,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(F){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const O=this.engine,D=this;this._readyState="opening",this.skipReconnect=!1;const U=on(O,"open",function(){D.onopen(),F&&F()}),tt=Ft=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",Ft),F?F(Ft):this.maybeReconnectOnOpen()},Q=on(O,"error",tt);if(this._timeout!==!1){const Ft=this._timeout,ht=this.setTimeoutFn(()=>{U(),tt(new Error("timeout")),O.close()},Ft);this.opts.autoUnref&&ht.unref(),this.subs.push(()=>{this.clearTimeoutFn(ht)})}return this.subs.push(U),this.subs.push(Q),this}connect(F){return this.open(F)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const F=this.engine;this.subs.push(on(F,"ping",this.onping.bind(this)),on(F,"data",this.ondata.bind(this)),on(F,"error",this.onerror.bind(this)),on(F,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(F){try{this.decoder.add(F)}catch(O){this.onclose("parse error",O)}}ondecoded(F){nextTick(()=>{this.emitReserved("packet",F)},this.setTimeoutFn)}onerror(F){this.emitReserved("error",F)}socket(F,O){let D=this.nsps[F];return D?this._autoConnect&&!D.active&&D.connect():(D=new Socket(this,F,O),this.nsps[F]=D),D}_destroy(F){const O=Object.keys(this.nsps);for(const D of O)if(this.nsps[D].active)return;this._close()}_packet(F){const O=this.encoder.encode(F);for(let D=0;D<O.length;D++)this.engine.write(O[D],F.options)}cleanup(){this.subs.forEach(F=>F()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(F,O){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",F,O),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const F=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const O=this.backoff.duration();this._reconnecting=!0;const D=this.setTimeoutFn(()=>{F.skipReconnect||(this.emitReserved("reconnect_attempt",F.backoff.attempts),!F.skipReconnect&&F.open(U=>{U?(F._reconnecting=!1,F.reconnect(),this.emitReserved("reconnect_error",U)):F.onreconnect()}))},O);this.opts.autoUnref&&D.unref(),this.subs.push(()=>{this.clearTimeoutFn(D)})}}onreconnect(){const F=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",F)}}const cache={};function lookup(B,F){typeof B=="object"&&(F=B,B=void 0),F=F||{};const O=url(B,F.path||"/socket.io"),D=O.source,U=O.id,tt=O.path,Q=cache[U]&&tt in cache[U].nsps,Ft=F.forceNew||F["force new connection"]||F.multiplex===!1||Q;let ht;return Ft?ht=new Manager(D,F):(cache[U]||(cache[U]=new Manager(D,F)),ht=cache[U]),O.query&&!F.query&&(F.query=O.queryKey),ht.socket(O.path,F)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(B,F,O,D)=>{for(var U=D>1?void 0:D?__getOwnPropDesc(F,O):F,tt=B.length-1,Q;tt>=0;tt--)(Q=B[tt])&&(U=(D?Q(F,O,U):Q(U))||U);return D&&U&&__defProp(F,O,U),U};let App=class extends s{constructor(){super(...arguments),this.savedState=!0,this.position=0,this.socketCreated=!1,this.socketStatus=""}render(){return[this.renderViewer(),this.renderRecording(),this.renderRecognizer(),this.renderGroup()]}updated(B){if(B.has("position")){if(this.follower&&(this.follower.position=this.position),!this.scrollable)return;const F=this.scrollable.scrollWidth-this.scrollable.clientWidth,O=this.position/this.recording.data.length;this.scrollable.scrollTo({left:O*F,behavior:"auto"})}}connectedCallback(){var B;super.connectedCallback(),this.findRecent(),(B=window.ipcRenderer)==null||B.on("page-flip",(F,O)=>{this.viewer.position=O})}async findRecent(){this.recentPDF=await get("pdf"),this.recentRecording=await get("recording"),platform==="electron"&&(await this.loadRecentPDF(),await this.loadRecentRecording())}async loadRecentPDF(){if(!this.recentPDF)return;const B=await fileOpen(this.recentPDF);this.recentPDF=void 0;const F=await B.arrayBuffer();await this.viewer.load(F)}async loadRecentRecording(){if(this.recentRecording)try{const B=await fileOpen(this.recentRecording);B.handle&&(this.recordingFile=B.handle);const F=await B.text();this.recordingFile=this.recentRecording,this.recentRecording=void 0,this.recordingElement.setAttribute("open",""),this.recording=FrequencyRecording.import(JSON.parse(F)),this.savedState=!0,this.position=0}catch{this.recentRecording=void 0}}renderHeader(){return x`
      <header>

        <button 
          title="Open Project"
          ?hidden=${platform==="legacy"}
          @click=${async()=>{const B=await directoryOpen({id:"project"});console.log(B)}}
        >
           Project
        </button>

        <project-manager></project-manager>

      </header>
    `}renderViewer(){var B;return x`
      <app-container id="viewer" .title=${"Sheet Music"}>

        <button 
          slot="header" 
          title="Open PDF" 
          @click=${async()=>{const F=await fileOpen({id:"pdf",accept:{"application/pdf":[".pdf"]}}),O=await F.arrayBuffer();this.viewer.load(O),F.handle&&set("pdf",F.handle)}} 
        >
           Open
        </button>

        <button 
          slot="header" 
          ?hidden=${!this.recentPDF} 
          title="Open Recent PDF - ${(B=this.recentPDF)==null?void 0:B.name}" 
          @click=${this.loadRecentPDF}
        >
          
        </button>

        <button 
          slot="header" 
          title="Fullscreen"
          @click=${()=>{this.viewer.requestFullscreen(),this.viewer.focus()}}
        >
          
        </button>

        <pdf-viewer
          @select=${F=>{var tt;const O=F.detail;if((tt=this.socketJoined)==null||tt.emit("page",O),!this.recording)return;const D=this.recording.markings.filter(Q=>Q[1]===O+1);if(D.length===0)return;const U=D.reduce((Q,Ft)=>Math.abs(Ft[0]-this.position)<Math.abs(Q[0]-this.position)?Ft:Q);this.position=U[0]}}
        ></pdf-viewer>
      </app-container>
    `}renderRecording(){var B,F;return x`
      <app-container
        collapsable
        id="recording"
        .title=${"Recording"+(this.recordingFile?" - "+this.recordingFile.name.replace(/\.json$/,""):"")}
        .description=${this.savedState?"":"Unsaved changes"}
      >
        <frequency-recorder 
          id="recorder" 
          title="Record" 
          slot="header" 
          @data=${O=>{this.recording.data.push(O.detail)}} 
          @start=${O=>{this.recognizer.stop();const{noiseProfile:D}=O.detail;this.recording=new FrequencyRecording,this.recording.noiseProfile=D}} 
          @stop=${()=>{this.spectrogram.requestUpdate(),this.markings.requestUpdate(),this.savedState=!1,this.recordingFile=void 0,this.recordingElement.setAttribute("open",""),this.position=0}} 
        >
           New
        </frequency-recorder>

        <button
          title="Open Recording"
          slot="header"
          @click=${async()=>{const O=await fileOpen({id:"recording",accept:{"application/json":[".json"]}}),D=await O.text();this.recordingElement.setAttribute("open",""),O.handle&&(this.recordingFile=O.handle,set("recording",O.handle)),this.recording=FrequencyRecording.import(JSON.parse(D)),this.savedState=!0,this.position=0}}
        >
          
        </button>

        <button 
          ?hidden=${!this.recentRecording} 
          title="Open Recent Recording - ${(B=this.recentRecording)==null?void 0:B.name}" 
          slot="header" 
          @click=${this.loadRecentRecording}
        >
          
        </button>

        <button 
          title="Save Recording" 
          class="primary" 
          slot="header" 
          ?hidden=${this.savedState} 
          @click=${async()=>{if(!this.recording)return;const O=JSON.stringify(this.recording.export()),D=new Blob([O],{type:"application/json"}),U=await fileSave(D,{id:"recording",fileName:"Recording.json",accept:{"application/json":[".json"]}},this.recordingFile);this.savedState=!0,U&&(this.recordingFile=U,set("recording",U))}} 
        >
          
        </button>

        ${this.recording?x`
              <div class="container">
                <div
                  id="scrollable" 
                  @mousewheel=${O=>{this.recording&&(O.preventDefault(),this.position=Math.max(0,Math.min(this.recording.data.length,this.position+O.deltaX+O.deltaY)))}} 
                >
                  <graph-2d
                    id="spectrogram"
                    .data=${((F=this.recording)==null?void 0:F.data)||[]}
                    @select=${O=>{if(!this.recording)return;const{column:D,row:U}=O.detail;console.log(`Frame: ${D}, Row: ${U}, Value: ${this.recording.data[D][U]}`),this.position=D}}
                  ></graph-2d>

                  <graph-1d id="similarity"></graph-1d>
                </div>

                <input-slider
                  id="position"
                  .max=${this.recording.data.length}
                  .value=${this.position}
                  @change=${O=>{this.recording&&(this.position=O.detail)}}
                ></input-slider>
                
                <markings-editor 
                  .recording=${this.recording}
                  @select=${O=>{const{position:D}=O.detail;this.position=D}} 
                  @change=${()=>{this.recording&&(this.savedState=!1)}} 
                ></markings-editor>

                <button
                  @click=${()=>{this.markings.add(this.position)}}
                >Add Mark</button> 

                <button 
                  @click=${async()=>{try{if(!this.recording)return;const O=await popup(x`<h3>Remove Silence</h3>`,x`
                          <label for="treshold">Silence Treshold (0-255)</label>
                          <input id="treshold" type="number" value="128" min="0" max="255">
                        `);if(!O)return;const D=parseInt(O.get("treshold"));if(isNaN(D))return;this.recording=this.recording.removeSilence(D),this.savedState=!1}catch{return}}}
                >Remove Silence</button>

              </div>
            `:x`
              <p>Make a recording to use the automatic page turner feature.</p>
            `}

      </app-container>
    `}renderRecognizer(){var B;return x`
      <app-container collapsable .title=${"Recognizer"} ?hidden=${!this.recording}>

        <frequency-recorder
          id="recognizer"
          title="Recognize"
          slot="header"
          .previousNoiseProfile=${(B=this.recording)==null?void 0:B.noiseProfile}
          @data=${F=>{if(!this.follower||!this.recording)return;const{position:O,mark:D,markPct:U,differences:tt,over:Q}=this.follower.guess(F.detail,this.recognitionOptions);if(Q){this.recognizer.stop();return}this.position=O||0;const Ft=new Uint8Array(this.recording.data.length);tt==null||tt.forEach((ht,dt)=>Ft[dt+this.position]=ht),this.similarity.data=Ft,D&&(this.viewer.position=D-1),this.viewer.pct=U}}
          @start=${()=>{this.recording&&(this.recorder.stop(),this.follower=this.recording.createFollower(),this.position>=this.recording.data.length-100&&(this.position=0))}}
        >
           Recognize
        </frequency-recorder>

        <recognition-options></recognition-options>

      </app-container>
    `}renderGroup(){return x`
      <app-container .title=${"Group"} .description=${this.socketStatus}>

        <button 
          slot="header" 
          ?hidden=${!window.ipcRenderer||this.socketCreated||!!this.socketJoined}
          @click=${async()=>{var F;const B=await((F=window.ipcRenderer)==null?void 0:F.invoke("group-create"));B&&(this.socketCreated=!0,this.socketJoined=void 0,this.socketStatus="Server running on "+B.ip+":"+B.port)}}
        >
          Create
        </button>

        <button 
          slot="header" 
          ?hidden=${!window.ipcRenderer||!this.socketCreated}
          @click=${async()=>{var B;await((B=window.ipcRenderer)==null?void 0:B.invoke("group-destroy")),this.socketCreated=!1,this.socketStatus=""}}
        >
          Destroy
        </button>

        <button 
          slot="header" 
          ?hidden=${!!this.socketJoined||this.socketCreated}
          @click=${async()=>{try{const B=await popup(x`<h3>Join Group</h3>`,x`
                  <label for="url">Group Server</label>
                  <input id="url" type="text" value=${localStorage.getItem("group-url")||"192.168.1.1:3000"}>
                `);if(!B||!B.has("url"))return;const F=B.get("url");localStorage.setItem("group-url",F),this.socketStatus="Connecting...";const O=lookup(F);this.socketJoined=O,O.on("connect_error",D=>{O.close(),this.socketJoined=void 0,this.socketStatus="",popup(x`
                  <h3>Could not connect to server</h3>
                  <p>${D.message}</p>
                `)}),O.on("connect",()=>{this.socketStatus="Connected to "+F}),O.on("disconnect",()=>{this.socketStatus="",popup(x`<h3>Disconnected from server</h3>`)}),O.on("page",D=>{this.viewer.position=D})}catch{}}}
        >
          Join
        </button>

        <button 
          slot="header" 
          ?hidden=${!this.socketJoined}
          @click=${()=>{var B;(B=this.socketJoined)==null||B.close(),this.socketJoined=void 0,this.socketStatus=""}}
        >
          Leave
        </button>

      </app-container>
    `}};App.styles=[inputStyle,buttonStyle,i$3`
      :host {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100%;
      }

      header {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 0.5em;
        margin: 10px;
      }

      #viewer {
        height: 0;
        min-height: 15em;
        flex: 1;
      }

      #viewer pdf-viewer {
        height: 100%;
      }

      #position {
        width: 100%;
      }

      #scrollable {
        overflow-y: hidden;
        overflow-x: auto;
        scrollbar-width: none;
        -ms-overflow-style: none;

        border: 1px solid grey;
        background: var(--color-black);
      }
      #scrollable::-webkit-scrollbar {
        display: none;
      }

      .container {
        width: min-content;
        max-width: 100%;
        margin: 0 auto;
      }
    `];__decorateClass([e$1("pdf-viewer")],App.prototype,"viewer",2);__decorateClass([e$1("#recording")],App.prototype,"recordingElement",2);__decorateClass([e$1("#recorder")],App.prototype,"recorder",2);__decorateClass([e$1("#scrollable")],App.prototype,"scrollable",2);__decorateClass([e$1("#spectrogram")],App.prototype,"spectrogram",2);__decorateClass([e$1("#similarity")],App.prototype,"similarity",2);__decorateClass([e$1("#position")],App.prototype,"positionSlider",2);__decorateClass([e$1("markings-editor")],App.prototype,"markings",2);__decorateClass([e$1("#recognizer")],App.prototype,"recognizer",2);__decorateClass([e$1("recognition-options")],App.prototype,"recognitionOptions",2);__decorateClass([n({type:Object})],App.prototype,"recentPDF",2);__decorateClass([n({type:Object})],App.prototype,"recentRecording",2);__decorateClass([n({type:Object})],App.prototype,"recordingFile",2);__decorateClass([n({type:Object})],App.prototype,"recording",2);__decorateClass([n({type:Boolean})],App.prototype,"savedState",2);__decorateClass([n({type:Number})],App.prototype,"position",2);__decorateClass([n({type:Boolean})],App.prototype,"socketCreated",2);__decorateClass([n({type:Object})],App.prototype,"socketJoined",2);__decorateClass([n({type:String})],App.prototype,"socketStatus",2);App=__decorateClass([t("app-root")],App);
